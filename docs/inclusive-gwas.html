<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 inclusive GWAS | GWAS Quality Control</title>
  <meta name="description" content="10 inclusive GWAS | GWAS Quality Control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="10 inclusive GWAS | GWAS Quality Control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 inclusive GWAS | GWAS Quality Control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="control.html"/>
<link rel="next" href="related-individuals.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>2</b> Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>2.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>2.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>2.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>2.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>2.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>2.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>2.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>2.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>2.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>2.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>2.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>2.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>3</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>3.1</b> test statistics ~ LD score</a></li>
<li class="chapter" data-level="3.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#new-models"><i class="fa fa-check"></i><b>3.2</b> New models?</a></li>
<li class="chapter" data-level="3.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ld-scores-based-on-individual-level-data"><i class="fa fa-check"></i><b>3.3</b> LD scores based on individual level data</a></li>
<li class="chapter" data-level="3.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-the-new-model"><i class="fa fa-check"></i><b>3.4</b> Test the new model</a></li>
<li class="chapter" data-level="3.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predictors-of-inflation"><i class="fa fa-check"></i><b>3.5</b> predictors of inflation?</a></li>
<li class="chapter" data-level="3.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#regress-bad-chisq-mean-r2_j"><i class="fa fa-check"></i><b>3.6</b> regress bad chisq ~ mean r^2_j</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mathematical-details.html"><a href="mathematical-details.html"><i class="fa fa-check"></i><b>4</b> Mathematical Details</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mathematical-details.html"><a href="mathematical-details.html#trk_rightk_left"><i class="fa fa-check"></i><b>4.1</b> <span class="math inline">\(tr(K_{right}K_{left})\)</span></a></li>
<li class="chapter" data-level="4.2" data-path="mathematical-details.html"><a href="mathematical-details.html#verification"><i class="fa fa-check"></i><b>4.2</b> verification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html"><i class="fa fa-check"></i><b>5</b> chi square ~ <span class="math inline">\(\overline{r^2_j}\)</span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#overliner2_j-choice-of-snps"><i class="fa fa-check"></i><b>5.1</b> <span class="math inline">\(\overline{r^2_j}\)</span> &amp; choice of SNPs</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#number-of-snps"><i class="fa fa-check"></i><b>5.1.1</b> number of SNPs</a></li>
<li class="chapter" data-level="5.1.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#maf"><i class="fa fa-check"></i><b>5.1.2</b> maf</a></li>
<li class="chapter" data-level="5.1.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#summary"><i class="fa fa-check"></i><b>5.1.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#varying-levels-of-confouding"><i class="fa fa-check"></i><b>5.2</b> varying levels of confouding</a></li>
<li class="chapter" data-level="5.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#results-summary"><i class="fa fa-check"></i><b>5.3</b> results summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>6</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>6.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="6.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>6.2</b> extract covariates</a></li>
<li class="chapter" data-level="6.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>6.3</b> GWAS</a></li>
<li class="chapter" data-level="6.4" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>6.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>6.4.1</b> under gcta</a></li>
<li class="chapter" data-level="6.4.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>6.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="6.4.3" data-path="good.html"><a href="good.html#summary-1"><i class="fa fa-check"></i><b>6.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>6.5</b> REML</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>6.5.1</b> making grms</a></li>
<li class="chapter" data-level="6.5.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>6.5.2</b> fast-reml</a></li>
<li class="chapter" data-level="6.5.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>6.5.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>6.6</b> HE</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>6.6.1</b> estimation</a></li>
<li class="chapter" data-level="6.6.2" data-path="good.html"><a href="good.html#summary-2"><i class="fa fa-check"></i><b>6.6.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>7</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>7.1</b> ID list</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>7.1.1</b> initial selection</a></li>
<li class="chapter" data-level="7.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>7.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="7.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>7.1.3</b> final list</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="bad.html"><a href="bad.html#gwas-lm"><i class="fa fa-check"></i><b>7.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="bad.html"><a href="bad.html#basic-cov"><i class="fa fa-check"></i><b>7.2.1</b> basic cov</a></li>
<li class="chapter" data-level="7.2.2" data-path="bad.html"><a href="bad.html#basic-cov-pc"><i class="fa fa-check"></i><b>7.2.2</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="bad.html"><a href="bad.html#gwas-bolt-lmm"><i class="fa fa-check"></i><b>7.3</b> GWAS-bolt-lmm</a></li>
<li class="chapter" data-level="7.4" data-path="bad.html"><a href="bad.html#aver2_j"><i class="fa fa-check"></i><b>7.4</b> aver2_j</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="bad.html"><a href="bad.html#calc-aver2_j"><i class="fa fa-check"></i><b>7.4.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="7.4.2" data-path="bad.html"><a href="bad.html#bolt-lmm"><i class="fa fa-check"></i><b>7.4.2</b> bolt-lmm</a></li>
<li class="chapter" data-level="7.4.3" data-path="bad.html"><a href="bad.html#basic-cov-pc-1"><i class="fa fa-check"></i><b>7.4.3</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>7.5</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>7.5.1</b> under gcta</a></li>
<li class="chapter" data-level="7.5.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>7.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="7.5.3" data-path="bad.html"><a href="bad.html#summary-3"><i class="fa fa-check"></i><b>7.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>7.6</b> REML</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>7.6.1</b> making grms</a></li>
<li class="chapter" data-level="7.6.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>7.6.2</b> fast-reml</a></li>
<li class="chapter" data-level="7.6.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>7.6.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>7.7</b> HE</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>7.7.1</b> estimation</a></li>
<li class="chapter" data-level="7.7.2" data-path="bad.html"><a href="bad.html#summary-4"><i class="fa fa-check"></i><b>7.7.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>8</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>8.1</b> total N = 337k</a></li>
<li class="chapter" data-level="8.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>8.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="8.3" data-path="ukbb.html"><a href="ukbb.html#gwas-100k"><i class="fa fa-check"></i><b>8.3</b> GWAS-100k</a></li>
<li class="chapter" data-level="8.4" data-path="ukbb.html"><a href="ukbb.html#gwas-337k"><i class="fa fa-check"></i><b>8.4</b> GWAS-337k</a></li>
<li class="chapter" data-level="8.5" data-path="ukbb.html"><a href="ukbb.html#ldsc-100k"><i class="fa fa-check"></i><b>8.5</b> ldsc-100k</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>8.5.1</b> under gcta</a></li>
<li class="chapter" data-level="8.5.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>8.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="8.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-5"><i class="fa fa-check"></i><b>8.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="ukbb.html"><a href="ukbb.html#ldsc-337k"><i class="fa fa-check"></i><b>8.6</b> ldsc-337k</a></li>
<li class="chapter" data-level="8.7" data-path="ukbb.html"><a href="ukbb.html#aver2_j-337k"><i class="fa fa-check"></i><b>8.7</b> aver2_j-337k</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="ukbb.html"><a href="ukbb.html#calc"><i class="fa fa-check"></i><b>8.7.1</b> calc</a></li>
<li class="chapter" data-level="8.7.2" data-path="ukbb.html"><a href="ukbb.html#organize-data"><i class="fa fa-check"></i><b>8.7.2</b> organize data</a></li>
<li class="chapter" data-level="8.7.3" data-path="ukbb.html"><a href="ukbb.html#chisq-aver2_j"><i class="fa fa-check"></i><b>8.7.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>8.8</b> HE</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>8.8.1</b> making grms</a></li>
<li class="chapter" data-level="8.8.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>8.8.2</b> estimation</a></li>
<li class="chapter" data-level="8.8.3" data-path="ukbb.html"><a href="ukbb.html#summary-6"><i class="fa fa-check"></i><b>8.8.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>9</b> control GWAS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>9.1</b> ID list</a></li>
<li class="chapter" data-level="9.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>9.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="9.3" data-path="control.html"><a href="control.html#gwas-1"><i class="fa fa-check"></i><b>9.3</b> GWAS</a></li>
<li class="chapter" data-level="9.4" data-path="control.html"><a href="control.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>9.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>9.4.1</b> under gcta</a></li>
<li class="chapter" data-level="9.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>9.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="9.4.3" data-path="control.html"><a href="control.html#summary-7"><i class="fa fa-check"></i><b>9.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>9.5</b> HE</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>9.5.1</b> making grms</a></li>
<li class="chapter" data-level="9.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>9.5.2</b> estimation</a></li>
<li class="chapter" data-level="9.5.3" data-path="control.html"><a href="control.html#summary-8"><i class="fa fa-check"></i><b>9.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html"><i class="fa fa-check"></i><b>10</b> inclusive GWAS</a>
<ul>
<li class="chapter" data-level="10.1" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#qc"><i class="fa fa-check"></i><b>10.1</b> QC</a></li>
<li class="chapter" data-level="10.2" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#gwas-telomere-length"><i class="fa fa-check"></i><b>10.2</b> gwas-telomere length</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#aver2_j-1"><i class="fa fa-check"></i><b>10.2.1</b> aver2_j</a></li>
<li class="chapter" data-level="10.2.2" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#organize-data-1"><i class="fa fa-check"></i><b>10.2.2</b> organize data</a></li>
<li class="chapter" data-level="10.2.3" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#chisq-aver2_j-1"><i class="fa fa-check"></i><b>10.2.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#notesconcerns"><i class="fa fa-check"></i><b>10.3</b> notes/concerns</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="related-individuals.html"><a href="related-individuals.html"><i class="fa fa-check"></i><b>11</b> related individuals</a>
<ul>
<li class="chapter" data-level="11.1" data-path="related-individuals.html"><a href="related-individuals.html#genotyped-snps"><i class="fa fa-check"></i><b>11.1</b> genotyped SNPs</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-2"><i class="fa fa-check"></i><b>11.1.1</b> aver2_j</a></li>
<li class="chapter" data-level="11.1.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-2"><i class="fa fa-check"></i><b>11.1.2</b> gwas</a></li>
<li class="chapter" data-level="11.1.3" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-2"><i class="fa fa-check"></i><b>11.1.3</b> organize data</a></li>
<li class="chapter" data-level="11.1.4" data-path="related-individuals.html"><a href="related-individuals.html#summary-9"><i class="fa fa-check"></i><b>11.1.4</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="related-individuals.html"><a href="related-individuals.html#hapmap3-snps"><i class="fa fa-check"></i><b>11.2</b> hapmap3 SNPs</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype-data"><i class="fa fa-check"></i><b>11.2.1</b> genotype data</a></li>
<li class="chapter" data-level="11.2.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-3"><i class="fa fa-check"></i><b>11.2.2</b> gwas</a></li>
<li class="chapter" data-level="11.2.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-3"><i class="fa fa-check"></i><b>11.2.3</b> aver2_j</a></li>
<li class="chapter" data-level="11.2.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-3"><i class="fa fa-check"></i><b>11.2.4</b> organize data</a></li>
<li class="chapter" data-level="11.2.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-2"><i class="fa fa-check"></i><b>11.2.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="11.2.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j"><i class="fa fa-check"></i><b>11.2.6</b> inflation ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="related-individuals.html"><a href="related-individuals.html#mix-unrel-rel"><i class="fa fa-check"></i><b>11.3</b> mix unrel &amp; rel</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype"><i class="fa fa-check"></i><b>11.3.1</b> genotype</a></li>
<li class="chapter" data-level="11.3.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-4"><i class="fa fa-check"></i><b>11.3.2</b> gwas</a></li>
<li class="chapter" data-level="11.3.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-4"><i class="fa fa-check"></i><b>11.3.3</b> aver2_j</a></li>
<li class="chapter" data-level="11.3.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-4"><i class="fa fa-check"></i><b>11.3.4</b> organize data</a></li>
<li class="chapter" data-level="11.3.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-3"><i class="fa fa-check"></i><b>11.3.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="11.3.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j-1"><i class="fa fa-check"></i><b>11.3.6</b> inflation ~ aver2_j</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="calc_aver2_j.html"><a href="calc_aver2_j.html"><i class="fa fa-check"></i><b>12</b> compute <span class="math inline">\(\sum_{i,j}^{m_1, m_2}r^2_{i,j}\)</span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="calc_aver2_j.html"><a href="calc_aver2_j.html#good-gwas-all-qced-snps"><i class="fa fa-check"></i><b>12.1</b> good GWAS-all qced snps</a></li>
<li class="chapter" data-level="12.2" data-path="calc_aver2_j.html"><a href="calc_aver2_j.html#good-gwass--ldak-thin-snps"><i class="fa fa-check"></i><b>12.2</b> good GWASs- ldak-thin snps</a></li>
<li class="chapter" data-level="12.3" data-path="calc_aver2_j.html"><a href="calc_aver2_j.html#bad-gwass-all-qced-snps"><i class="fa fa-check"></i><b>12.3</b> bad GWASs-all qced snps</a></li>
<li class="chapter" data-level="12.4" data-path="calc_aver2_j.html"><a href="calc_aver2_j.html#summary-10"><i class="fa fa-check"></i><b>12.4</b> summary</a></li>
<li class="chapter" data-level="12.5" data-path="calc_aver2_j.html"><a href="calc_aver2_j.html#compute-overliner2_j"><i class="fa fa-check"></i><b>12.5</b> compute <span class="math inline">\(\overline{r^2_j}\)</span></a></li>
<li class="chapter" data-level="12.6" data-path="calc_aver2_j.html"><a href="calc_aver2_j.html#mixed-pop-gwas-with-pc-as-covariates"><i class="fa fa-check"></i><b>12.6</b> mixed pop GWAS with PC as covariates</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GWAS Quality Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inclusive-gwas" class="section level1" number="10">
<h1><span class="header-section-number">10</span> inclusive GWAS</h1>
<p>Here we conduct a GWAS that mimic the QC steps taken by some of the most inclusive GWAS studies. For example, the GWAS conducted by Codd et al. (2021) on telomere length has the following QC step, which resulted in n = 472,174 and m = 19.4 million SNPs</p>
<blockquote>
<p>We used imputed genotypes available in the UKB2 for the GWAS. To ensure quality, we restricted the analysis to variants with a MAF of ≥0.1% (where imputation accuracy is greatest) and an INFO score of ≥0.3. We tested 19.4 million variants using the BOLT-LMM package, adjusting for age, sex, array and the first ten principal components (PCs). The analysis was run separately for chromosome 23, where males were coded as 0/2.</p>
</blockquote>
<p>Here we want to test if the test statistics from GWAS conducted in such a way are inflated using the proposed method. We do not have access to telomere length, but we can use the 14 traits as examples instead.</p>
<div id="qc" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> QC</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb66-1"><a href="inclusive-gwas.html#cb66-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-2"><a href="inclusive-gwas.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb66-3"><a href="inclusive-gwas.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract covariates</span></span>
<span id="cb66-4"><a href="inclusive-gwas.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb66-5"><a href="inclusive-gwas.html#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This has been done under &#39;Good GWAS&#39; section. Here we just want to extract from the file</span></span>
<span id="cb66-6"><a href="inclusive-gwas.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb66-7"><a href="inclusive-gwas.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="va">scipen</span><span class="op">=</span>999<span class="kw">)</span></span>
<span id="cb66-8"><a href="inclusive-gwas.html#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb66-9"><a href="inclusive-gwas.html#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;phen/covariates.phen&quot;</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb66-10"><a href="inclusive-gwas.html#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="va">pc</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;pc&quot;</span><span class="ex">,1:10</span><span class="kw">)</span></span>
<span id="cb66-11"><a href="inclusive-gwas.html#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="va">cov</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span><span class="st">&quot;age&quot;</span><span class="ex">,</span><span class="st">&quot;geno_batch&quot;</span><span class="ex">,pc</span><span class="kw">)</span></span>
<span id="cb66-12"><a href="inclusive-gwas.html#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>dat[,cov]</span>
<span id="cb66-13"><a href="inclusive-gwas.html#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="inclusive-gwas.html#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span><span class="st">&quot;phen/covariates-inclusive-gwas.use&quot;</span><span class="ex">,</span> col.names=F,</span>
<span id="cb66-15"><a href="inclusive-gwas.html#cb66-15" aria-hidden="true" tabindex="-1"></a>            <span class="ex">row.names=F,</span> quote=F<span class="kw">)</span></span>
<span id="cb66-16"><a href="inclusive-gwas.html#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">cov,</span><span class="st">&quot;phen/covariates-inclusive-gwas.use-names&quot;</span><span class="ex">,</span> col.names=F,</span>
<span id="cb66-17"><a href="inclusive-gwas.html#cb66-17" aria-hidden="true" tabindex="-1"></a>            <span class="ex">row.names=F,</span> quote=F<span class="kw">)</span></span>
<span id="cb66-18"><a href="inclusive-gwas.html#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="inclusive-gwas.html#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="va">sel</span><span class="op">=</span>out[complete.cases<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,]</span> <span class="co"># n = 488,244</span></span>
<span id="cb66-20"><a href="inclusive-gwas.html#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="va">sel</span><span class="op">[</span>,1:2<span class="op">]</span><span class="ex">,</span> <span class="st">&quot;complete-cases-covariates-inclusive-gwas.id&quot;</span>, col.names=F,</span>
<span id="cb66-21"><a href="inclusive-gwas.html#cb66-21" aria-hidden="true" tabindex="-1"></a>            <span class="ex">row.names=F,</span> quote=F<span class="kw">)</span></span>
<span id="cb66-22"><a href="inclusive-gwas.html#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="inclusive-gwas.html#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb66-24"><a href="inclusive-gwas.html#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="co"># id list of complete cases: covariates &amp; phenotypes</span></span>
<span id="cb66-25"><a href="inclusive-gwas.html#cb66-25" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb66-26"><a href="inclusive-gwas.html#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="inclusive-gwas.html#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="co"># note: to remain as much people as possible, we did not select all 14 traits. but 9.</span></span>
<span id="cb66-28"><a href="inclusive-gwas.html#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="co"># for these traits, n = 467, 104 have complete data</span></span>
<span id="cb66-29"><a href="inclusive-gwas.html#cb66-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> complete-cases-covariates-inclusive-gwas.id inclusive-gwas.id</span>
<span id="cb66-30"><a href="inclusive-gwas.html#cb66-30" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>phen/continuous-traits/</span>
<span id="cb66-31"><a href="inclusive-gwas.html#cb66-31" aria-hidden="true" tabindex="-1"></a><span class="co"># {awake,bmi,chron,ever,fvc,height,imp,neur,pulse,quals,reaction,sbp,snoring,hyper}</span></span>
<span id="cb66-32"><a href="inclusive-gwas.html#cb66-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-33"><a href="inclusive-gwas.html#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> inclusive-gwas.id temp</span>
<span id="cb66-34"><a href="inclusive-gwas.html#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $1, $2}&#39;</span> temp <span class="va">$dir</span>/<span class="va">$tt</span>.raw.pheno <span class="op">&gt;</span> inclusive-gwas.id</span>
<span id="cb66-35"><a href="inclusive-gwas.html#cb66-35" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> inclusive-gwas.id</span>
<span id="cb66-36"><a href="inclusive-gwas.html#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$tt</span></span>
<span id="cb66-37"><a href="inclusive-gwas.html#cb66-37" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb66-38"><a href="inclusive-gwas.html#cb66-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> temp</span>
<span id="cb66-39"><a href="inclusive-gwas.html#cb66-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-40"><a href="inclusive-gwas.html#cb66-40" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb66-41"><a href="inclusive-gwas.html#cb66-41" aria-hidden="true" tabindex="-1"></a><span class="co"># extract genotypes</span></span>
<span id="cb66-42"><a href="inclusive-gwas.html#cb66-42" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb66-43"><a href="inclusive-gwas.html#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="inclusive-gwas.html#cb66-44" aria-hidden="true" tabindex="-1"></a><span class="co"># QC SNPs-----------------------------------------------------------------------</span></span>
<span id="cb66-45"><a href="inclusive-gwas.html#cb66-45" aria-hidden="true" tabindex="-1"></a><span class="co"># stating number of SNPs=</span></span>
<span id="cb66-46"><a href="inclusive-gwas.html#cb66-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-47"><a href="inclusive-gwas.html#cb66-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb66-48"><a href="inclusive-gwas.html#cb66-48" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb66-49"><a href="inclusive-gwas.html#cb66-49" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb66-50"><a href="inclusive-gwas.html#cb66-50" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb66-51"><a href="inclusive-gwas.html#cb66-51" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb66-52"><a href="inclusive-gwas.html#cb66-52" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb66-53"><a href="inclusive-gwas.html#cb66-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-54"><a href="inclusive-gwas.html#cb66-54" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb66-55"><a href="inclusive-gwas.html#cb66-55" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../inclusive-gwas.id </span><span class="dt">\</span></span>
<span id="cb66-56"><a href="inclusive-gwas.html#cb66-56" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb66-57"><a href="inclusive-gwas.html#cb66-57" aria-hidden="true" tabindex="-1"></a><span class="st">         --maf 0.001 </span><span class="dt">\</span></span>
<span id="cb66-58"><a href="inclusive-gwas.html#cb66-58" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb66-59"><a href="inclusive-gwas.html#cb66-59" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.3 2 </span><span class="dt">\</span></span>
<span id="cb66-60"><a href="inclusive-gwas.html#cb66-60" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb66-61"><a href="inclusive-gwas.html#cb66-61" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb66-62"><a href="inclusive-gwas.html#cb66-62" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb66-63"><a href="inclusive-gwas.html#cb66-63" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb66-64"><a href="inclusive-gwas.html#cb66-64" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb66-65"><a href="inclusive-gwas.html#cb66-65" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb66-66"><a href="inclusive-gwas.html#cb66-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-67"><a href="inclusive-gwas.html#cb66-67" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb66-68"><a href="inclusive-gwas.html#cb66-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-69"><a href="inclusive-gwas.html#cb66-69" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb66-70"><a href="inclusive-gwas.html#cb66-70" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/qc-inclusive-gwas</span>
<span id="cb66-71"><a href="inclusive-gwas.html#cb66-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-72"><a href="inclusive-gwas.html#cb66-72" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb66-73"><a href="inclusive-gwas.html#cb66-73" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/qc-inclusive-gwas</span>
<span id="cb66-74"><a href="inclusive-gwas.html#cb66-74" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb66-75"><a href="inclusive-gwas.html#cb66-75" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb66-76"><a href="inclusive-gwas.html#cb66-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-77"><a href="inclusive-gwas.html#cb66-77" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp</span>
<span id="cb66-78"><a href="inclusive-gwas.html#cb66-78" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb66-79"><a href="inclusive-gwas.html#cb66-79" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb66-80"><a href="inclusive-gwas.html#cb66-80" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb66-81"><a href="inclusive-gwas.html#cb66-81" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb66-82"><a href="inclusive-gwas.html#cb66-82" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb66-83"><a href="inclusive-gwas.html#cb66-83" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb66-84"><a href="inclusive-gwas.html#cb66-84" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb66-85"><a href="inclusive-gwas.html#cb66-85" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb66-86"><a href="inclusive-gwas.html#cb66-86" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb66-87"><a href="inclusive-gwas.html#cb66-87" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb66-88"><a href="inclusive-gwas.html#cb66-88" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb66-89"><a href="inclusive-gwas.html#cb66-89" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb66-90"><a href="inclusive-gwas.html#cb66-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-91"><a href="inclusive-gwas.html#cb66-91" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files-------------------------------------------------------------------</span></span>
<span id="cb66-92"><a href="inclusive-gwas.html#cb66-92" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> gen/bfile-inclusive-gwas.list</span>
<span id="cb66-93"><a href="inclusive-gwas.html#cb66-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-94"><a href="inclusive-gwas.html#cb66-94" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> gen/bfile-inclusive-gwas.list</span>
<span id="cb66-95"><a href="inclusive-gwas.html#cb66-95" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb66-96"><a href="inclusive-gwas.html#cb66-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-97"><a href="inclusive-gwas.html#cb66-97" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb66-98"><a href="inclusive-gwas.html#cb66-98" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb66-99"><a href="inclusive-gwas.html#cb66-99" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb66-100"><a href="inclusive-gwas.html#cb66-100" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 80G</span></span>
<span id="cb66-101"><a href="inclusive-gwas.html#cb66-101" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb66-102"><a href="inclusive-gwas.html#cb66-102" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb66-103"><a href="inclusive-gwas.html#cb66-103" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-inclusive-gwas </span><span class="dt">\</span></span>
<span id="cb66-104"><a href="inclusive-gwas.html#cb66-104" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile-inclusive-gwas.list </span><span class="dt">\</span></span>
<span id="cb66-105"><a href="inclusive-gwas.html#cb66-105" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb66-106"><a href="inclusive-gwas.html#cb66-106" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES</span></span>
<span id="cb66-107"><a href="inclusive-gwas.html#cb66-107" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-inclusive-gwas.sh</span>
<span id="cb66-108"><a href="inclusive-gwas.html#cb66-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-109"><a href="inclusive-gwas.html#cb66-109" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script-------------------------------------------------------------</span></span>
<span id="cb66-110"><a href="inclusive-gwas.html#cb66-110" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-inclusive-gwas.sh <span class="op">&gt;</span>../job-records/mbfile-inclusive-gwas</span>
<span id="cb66-111"><a href="inclusive-gwas.html#cb66-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-112"><a href="inclusive-gwas.html#cb66-112" aria-hidden="true" tabindex="-1"></a><span class="co"># compute info score------------------------------------------------------------</span></span>
<span id="cb66-113"><a href="inclusive-gwas.html#cb66-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-114"><a href="inclusive-gwas.html#cb66-114" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb66-115"><a href="inclusive-gwas.html#cb66-115" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb66-116"><a href="inclusive-gwas.html#cb66-116" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb66-117"><a href="inclusive-gwas.html#cb66-117" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb66-118"><a href="inclusive-gwas.html#cb66-118" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb66-119"><a href="inclusive-gwas.html#cb66-119" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb66-120"><a href="inclusive-gwas.html#cb66-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-121"><a href="inclusive-gwas.html#cb66-121" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb66-122"><a href="inclusive-gwas.html#cb66-122" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb66-123"><a href="inclusive-gwas.html#cb66-123" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../inclusive-gwas.id </span><span class="dt">\</span></span>
<span id="cb66-124"><a href="inclusive-gwas.html#cb66-124" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb66-125"><a href="inclusive-gwas.html#cb66-125" aria-hidden="true" tabindex="-1"></a><span class="st">         --freq cols=chrom,ref,alt,altfreq,machr2 </span><span class="dt">\</span></span>
<span id="cb66-126"><a href="inclusive-gwas.html#cb66-126" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/info/chr</span><span class="va">$j</span></span>
<span id="cb66-127"><a href="inclusive-gwas.html#cb66-127" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb66-128"><a href="inclusive-gwas.html#cb66-128" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb66-129"><a href="inclusive-gwas.html#cb66-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-130"><a href="inclusive-gwas.html#cb66-130" aria-hidden="true" tabindex="-1"></a><span class="co"># submit file-------------------------------------------------------------------</span></span>
<span id="cb66-131"><a href="inclusive-gwas.html#cb66-131" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-132"><a href="inclusive-gwas.html#cb66-132" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb66-133"><a href="inclusive-gwas.html#cb66-133" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/compute-info-score-inclusive-gwas</span>
<span id="cb66-134"><a href="inclusive-gwas.html#cb66-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-135"><a href="inclusive-gwas.html#cb66-135" aria-hidden="true" tabindex="-1"></a><span class="co"># combine files ----------------------------------------------------------------</span></span>
<span id="cb66-136"><a href="inclusive-gwas.html#cb66-136" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>gen/info</span>
<span id="cb66-137"><a href="inclusive-gwas.html#cb66-137" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$dir</span>/inclusive-gwas-afreq</span>
<span id="cb66-138"><a href="inclusive-gwas.html#cb66-138" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-139"><a href="inclusive-gwas.html#cb66-139" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$i</span> <span class="ot">==</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb66-140"><a href="inclusive-gwas.html#cb66-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>.afreq <span class="op">&gt;</span> <span class="va">$dir</span>/inclusive-gwas-afreq</span>
<span id="cb66-141"><a href="inclusive-gwas.html#cb66-141" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb66-142"><a href="inclusive-gwas.html#cb66-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>.afreq <span class="op">&gt;&gt;</span> <span class="va">$dir</span>/inclusive-gwas-afreq</span>
<span id="cb66-143"><a href="inclusive-gwas.html#cb66-143" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb66-144"><a href="inclusive-gwas.html#cb66-144" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb66-145"><a href="inclusive-gwas.html#cb66-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-146"><a href="inclusive-gwas.html#cb66-146" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::</span></span>
<span id="cb66-147"><a href="inclusive-gwas.html#cb66-147" aria-hidden="true" tabindex="-1"></a><span class="co"># SNP list</span></span>
<span id="cb66-148"><a href="inclusive-gwas.html#cb66-148" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::</span></span>
<span id="cb66-149"><a href="inclusive-gwas.html#cb66-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-150"><a href="inclusive-gwas.html#cb66-150" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate</span></span>
<span id="cb66-151"><a href="inclusive-gwas.html#cb66-151" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> gen/bfile-inclusive-gwas.stat <span class="st">&#39;($5&gt;.001 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> snps-inclusive-gwas.use</span>
<span id="cb66-152"><a href="inclusive-gwas.html#cb66-152" aria-hidden="true" tabindex="-1"></a><span class="co"># m = SNPs</span></span></code></pre></div>
</div>
<div id="gwas-telomere-length" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> gwas-telomere length</h2>
<div id="aver2_j-1" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> aver2_j</h3>
<p>Here we want to check if there is evidence of inflation in GWAS statistics due to confouding.
Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>download the GWAS stats (<a href="https://figshare.com/s/caa99dc0f76d62990195" class="uri">https://figshare.com/s/caa99dc0f76d62990195</a>)</li>
<li>randomly chose 10k SNPs from each side of the genome</li>
<li>compute aver2_j</li>
<li>check if chi square test stats vary with respect to aver2_j</li>
</ol>
<div class="sourceCode" id="cb67"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="inclusive-gwas.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-2"><a href="inclusive-gwas.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># select SNPs &amp; organize data</span></span>
<span id="cb67-3"><a href="inclusive-gwas.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-4"><a href="inclusive-gwas.html#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="inclusive-gwas.html#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># download gwas stats-----------------------------------------------------------</span></span>
<span id="cb67-6"><a href="inclusive-gwas.html#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-telomere</span>
<span id="cb67-7"><a href="inclusive-gwas.html#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://figshare.com/ndownloader/files/28414941<span class="pp">?</span>private_link=caa99dc0f76d62990195</span>
<span id="cb67-8"><a href="inclusive-gwas.html#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 20,134,422 SNPs</span></span>
<span id="cb67-9"><a href="inclusive-gwas.html#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="inclusive-gwas.html#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co"># organize data: snp name &amp; chisq ----------------------------------------------</span></span>
<span id="cb67-11"><a href="inclusive-gwas.html#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gwas-telomere/UKB_telomere_gwas_summarystats.tsv.gz</span>
<span id="cb67-12"><a href="inclusive-gwas.html#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized</span>
<span id="cb67-13"><a href="inclusive-gwas.html#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&#39;\t&#39;</span> <span class="st">&#39;BEGIN {print &quot;chr base_pair_location chr_base rs chisq&quot;} </span></span>
<span id="cb67-14"><a href="inclusive-gwas.html#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="st">                            NR &gt;1 {print $3, $4,$3&quot;:&quot;$4, $1, ($8/$9)^2}&#39;</span> <span class="op">&gt;</span> <span class="va">$outfile</span></span>
<span id="cb67-15"><a href="inclusive-gwas.html#cb67-15" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb67-16"><a href="inclusive-gwas.html#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co"># hapmap3 SNPs------------------------------------------------------------------</span></span>
<span id="cb67-17"><a href="inclusive-gwas.html#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="va">infile1</span><span class="op">=</span>doug/ukbb.ldsc</span>
<span id="cb67-18"><a href="inclusive-gwas.html#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="va">infile2</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized</span>
<span id="cb67-19"><a href="inclusive-gwas.html#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized-hm3</span>
<span id="cb67-20"><a href="inclusive-gwas.html#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR{a[$3];next} </span></span>
<span id="cb67-21"><a href="inclusive-gwas.html#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="st">     ($3 in a || FNR==1 ){print $0}&#39;</span> <span class="va">$infile1</span> <span class="va">$infile2</span> <span class="op">&gt;</span> <span class="va">$outfile</span></span>
<span id="cb67-22"><a href="inclusive-gwas.html#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="inclusive-gwas.html#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="co"># choose snp lists--------------------------------------------------------------</span></span>
<span id="cb67-24"><a href="inclusive-gwas.html#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="co"># choose 40k for each side as the pool for selection</span></span>
<span id="cb67-25"><a href="inclusive-gwas.html#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>40000</span>
<span id="cb67-26"><a href="inclusive-gwas.html#cb67-26" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized-hm3</span>
<span id="cb67-27"><a href="inclusive-gwas.html#cb67-27" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/gwas-telomere/left-snps-pool</span>
<span id="cb67-28"><a href="inclusive-gwas.html#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/gwas-telomere/right-snps-pool</span>
<span id="cb67-29"><a href="inclusive-gwas.html#cb67-29" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&lt;8 &amp;&amp; NR &gt; 1 {print $1, $2, $3}&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$left</span></span>
<span id="cb67-30"><a href="inclusive-gwas.html#cb67-30" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&gt;=8 &amp;&amp; NR &gt; 1 {print $1, $2, $3}&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$right</span></span>
<span id="cb67-31"><a href="inclusive-gwas.html#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-32"><a href="inclusive-gwas.html#cb67-32" aria-hidden="true" tabindex="-1"></a><span class="co"># entire snp list of ukbb</span></span>
<span id="cb67-33"><a href="inclusive-gwas.html#cb67-33" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>inflation/gwas-telomere/ukbb-bhr-all-snps</span>
<span id="cb67-34"><a href="inclusive-gwas.html#cb67-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$out</span></span>
<span id="cb67-35"><a href="inclusive-gwas.html#cb67-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb67-36"><a href="inclusive-gwas.html#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="va">gen</span><span class="op">=</span>gen/geno_plink/bhr<span class="va">$i</span>.pvar</span>
<span id="cb67-37"><a href="inclusive-gwas.html#cb67-37" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $1&quot;:&quot;$2, $3}&#39;</span> <span class="va">$gen</span> <span class="op">&gt;&gt;</span> <span class="va">$out</span></span>
<span id="cb67-38"><a href="inclusive-gwas.html#cb67-38" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb67-39"><a href="inclusive-gwas.html#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="co"># wc -l gen/geno_plink/bhr{1..22}.pvar</span></span>
<span id="cb67-40"><a href="inclusive-gwas.html#cb67-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-41"><a href="inclusive-gwas.html#cb67-41" aria-hidden="true" tabindex="-1"></a><span class="co"># put the chosen 40k snps in the right format</span></span>
<span id="cb67-42"><a href="inclusive-gwas.html#cb67-42" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>inflation/gwas-telomere/ukbb-bhr-all-snps</span>
<span id="cb67-43"><a href="inclusive-gwas.html#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="va">leftin</span><span class="op">=</span>inflation/gwas-telomere/left-snps-pool</span>
<span id="cb67-44"><a href="inclusive-gwas.html#cb67-44" aria-hidden="true" tabindex="-1"></a><span class="va">rightin</span><span class="op">=</span>inflation/gwas-telomere/right-snps-pool</span>
<span id="cb67-45"><a href="inclusive-gwas.html#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="va">leftout</span><span class="op">=</span>inflation/gwas-telomere/left-snps-tmp</span>
<span id="cb67-46"><a href="inclusive-gwas.html#cb67-46" aria-hidden="true" tabindex="-1"></a><span class="va">rightout</span><span class="op">=</span>inflation/gwas-telomere/right-snps-tmp</span>
<span id="cb67-47"><a href="inclusive-gwas.html#cb67-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-48"><a href="inclusive-gwas.html#cb67-48" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$3];next}</span></span>
<span id="cb67-49"><a href="inclusive-gwas.html#cb67-49" aria-hidden="true" tabindex="-1"></a><span class="st">     ($3 in a){print $4}&#39;</span> <span class="va">$leftin</span> <span class="va">$snp</span> <span class="op">&gt;</span> <span class="va">$leftout</span></span>
<span id="cb67-50"><a href="inclusive-gwas.html#cb67-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-51"><a href="inclusive-gwas.html#cb67-51" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$3];next}</span></span>
<span id="cb67-52"><a href="inclusive-gwas.html#cb67-52" aria-hidden="true" tabindex="-1"></a><span class="st">     ($3 in a){print $4}&#39;</span> <span class="va">$rightin</span> <span class="va">$snp</span> <span class="op">&gt;</span> <span class="va">$rightout</span></span>
<span id="cb67-53"><a href="inclusive-gwas.html#cb67-53" aria-hidden="true" tabindex="-1"></a><span class="co"># note:  &gt; 40k are in the list of each side because some snps have the same basepair...    </span></span>
<span id="cb67-54"><a href="inclusive-gwas.html#cb67-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-55"><a href="inclusive-gwas.html#cb67-55" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-56"><a href="inclusive-gwas.html#cb67-56" aria-hidden="true" tabindex="-1"></a><span class="co">#  extract genotypes of the bfiles</span></span>
<span id="cb67-57"><a href="inclusive-gwas.html#cb67-57" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-58"><a href="inclusive-gwas.html#cb67-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-59"><a href="inclusive-gwas.html#cb67-59" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/gwas-telomere/left-snps-tmp</span>
<span id="cb67-60"><a href="inclusive-gwas.html#cb67-60" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/gwas-telomere/right-snps-tmp</span>
<span id="cb67-61"><a href="inclusive-gwas.html#cb67-61" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>inflation/gwas-telomere/snp-all</span>
<span id="cb67-62"><a href="inclusive-gwas.html#cb67-62" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$left</span> <span class="va">$right</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb67-63"><a href="inclusive-gwas.html#cb67-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-64"><a href="inclusive-gwas.html#cb67-64" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data -----------------------------------------------------------------</span></span>
<span id="cb67-65"><a href="inclusive-gwas.html#cb67-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-66"><a href="inclusive-gwas.html#cb67-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb67-67"><a href="inclusive-gwas.html#cb67-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb67-68"><a href="inclusive-gwas.html#cb67-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb67-69"><a href="inclusive-gwas.html#cb67-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 4G</span></span>
<span id="cb67-70"><a href="inclusive-gwas.html#cb67-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb67-71"><a href="inclusive-gwas.html#cb67-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb67-72"><a href="inclusive-gwas.html#cb67-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-73"><a href="inclusive-gwas.html#cb67-73" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb67-74"><a href="inclusive-gwas.html#cb67-74" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../inflation/gwas-telomere/snp-all </span><span class="dt">\</span></span>
<span id="cb67-75"><a href="inclusive-gwas.html#cb67-75" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb67-76"><a href="inclusive-gwas.html#cb67-76" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb67-77"><a href="inclusive-gwas.html#cb67-77" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb67-78"><a href="inclusive-gwas.html#cb67-78" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb67-79"><a href="inclusive-gwas.html#cb67-79" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb67-80"><a href="inclusive-gwas.html#cb67-80" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb67-81"><a href="inclusive-gwas.html#cb67-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-82"><a href="inclusive-gwas.html#cb67-82" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb67-83"><a href="inclusive-gwas.html#cb67-83" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-84"><a href="inclusive-gwas.html#cb67-84" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb67-85"><a href="inclusive-gwas.html#cb67-85" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/bfile-telomere</span>
<span id="cb67-86"><a href="inclusive-gwas.html#cb67-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-87"><a href="inclusive-gwas.html#cb67-87" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb67-88"><a href="inclusive-gwas.html#cb67-88" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/bfile-telomere</span>
<span id="cb67-89"><a href="inclusive-gwas.html#cb67-89" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb67-90"><a href="inclusive-gwas.html#cb67-90" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb67-91"><a href="inclusive-gwas.html#cb67-91" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-92"><a href="inclusive-gwas.html#cb67-92" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb67-93"><a href="inclusive-gwas.html#cb67-93" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb67-94"><a href="inclusive-gwas.html#cb67-94" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb67-95"><a href="inclusive-gwas.html#cb67-95" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb67-96"><a href="inclusive-gwas.html#cb67-96" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb67-97"><a href="inclusive-gwas.html#cb67-97" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb67-98"><a href="inclusive-gwas.html#cb67-98" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb67-99"><a href="inclusive-gwas.html#cb67-99" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb67-100"><a href="inclusive-gwas.html#cb67-100" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb67-101"><a href="inclusive-gwas.html#cb67-101" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb67-102"><a href="inclusive-gwas.html#cb67-102" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb67-103"><a href="inclusive-gwas.html#cb67-103" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb67-104"><a href="inclusive-gwas.html#cb67-104" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb67-105"><a href="inclusive-gwas.html#cb67-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-106"><a href="inclusive-gwas.html#cb67-106" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files-------------------------------------------------------------------</span></span>
<span id="cb67-107"><a href="inclusive-gwas.html#cb67-107" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> gen/bfile.list</span>
<span id="cb67-108"><a href="inclusive-gwas.html#cb67-108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-109"><a href="inclusive-gwas.html#cb67-109" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> gen/bfile.list</span>
<span id="cb67-110"><a href="inclusive-gwas.html#cb67-110" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb67-111"><a href="inclusive-gwas.html#cb67-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-112"><a href="inclusive-gwas.html#cb67-112" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb67-113"><a href="inclusive-gwas.html#cb67-113" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb67-114"><a href="inclusive-gwas.html#cb67-114" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb67-115"><a href="inclusive-gwas.html#cb67-115" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb67-116"><a href="inclusive-gwas.html#cb67-116" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb67-117"><a href="inclusive-gwas.html#cb67-117" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 01:00:0</span></span>
<span id="cb67-118"><a href="inclusive-gwas.html#cb67-118" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-telomere </span><span class="dt">\</span></span>
<span id="cb67-119"><a href="inclusive-gwas.html#cb67-119" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile.list </span><span class="dt">\</span></span>
<span id="cb67-120"><a href="inclusive-gwas.html#cb67-120" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb67-121"><a href="inclusive-gwas.html#cb67-121" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES</span></span>
<span id="cb67-122"><a href="inclusive-gwas.html#cb67-122" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-telomere.sh</span>
<span id="cb67-123"><a href="inclusive-gwas.html#cb67-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-124"><a href="inclusive-gwas.html#cb67-124" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script-------------------------------------------------------------</span></span>
<span id="cb67-125"><a href="inclusive-gwas.html#cb67-125" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-telomere.sh <span class="op">&gt;</span>../job-records/mbfile-telomere</span>
<span id="cb67-126"><a href="inclusive-gwas.html#cb67-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-127"><a href="inclusive-gwas.html#cb67-127" aria-hidden="true" tabindex="-1"></a><span class="co"># compute info score------------------------------------------------------------</span></span>
<span id="cb67-128"><a href="inclusive-gwas.html#cb67-128" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-129"><a href="inclusive-gwas.html#cb67-129" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>../inflation/gwas-telomere/snp-all</span>
<span id="cb67-130"><a href="inclusive-gwas.html#cb67-130" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gen/info/chr<span class="va">$j</span>-telomere</span>
<span id="cb67-131"><a href="inclusive-gwas.html#cb67-131" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb67-132"><a href="inclusive-gwas.html#cb67-132" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb67-133"><a href="inclusive-gwas.html#cb67-133" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb67-134"><a href="inclusive-gwas.html#cb67-134" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb67-135"><a href="inclusive-gwas.html#cb67-135" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb67-136"><a href="inclusive-gwas.html#cb67-136" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:20:0</span></span>
<span id="cb67-137"><a href="inclusive-gwas.html#cb67-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-138"><a href="inclusive-gwas.html#cb67-138" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb67-139"><a href="inclusive-gwas.html#cb67-139" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb67-140"><a href="inclusive-gwas.html#cb67-140" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract </span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb67-141"><a href="inclusive-gwas.html#cb67-141" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb67-142"><a href="inclusive-gwas.html#cb67-142" aria-hidden="true" tabindex="-1"></a><span class="st">         --freq cols=chrom,ref,alt,altfreq,machr2 </span><span class="dt">\</span></span>
<span id="cb67-143"><a href="inclusive-gwas.html#cb67-143" aria-hidden="true" tabindex="-1"></a><span class="st">         --out </span><span class="va">$out</span></span>
<span id="cb67-144"><a href="inclusive-gwas.html#cb67-144" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb67-145"><a href="inclusive-gwas.html#cb67-145" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb67-146"><a href="inclusive-gwas.html#cb67-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-147"><a href="inclusive-gwas.html#cb67-147" aria-hidden="true" tabindex="-1"></a><span class="co"># submit file-------------------------------------------------------------------</span></span>
<span id="cb67-148"><a href="inclusive-gwas.html#cb67-148" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-149"><a href="inclusive-gwas.html#cb67-149" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb67-150"><a href="inclusive-gwas.html#cb67-150" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/compute-info-telomere</span>
<span id="cb67-151"><a href="inclusive-gwas.html#cb67-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-152"><a href="inclusive-gwas.html#cb67-152" aria-hidden="true" tabindex="-1"></a><span class="co"># combine files ----------------------------------------------------------------</span></span>
<span id="cb67-153"><a href="inclusive-gwas.html#cb67-153" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>gen/info</span>
<span id="cb67-154"><a href="inclusive-gwas.html#cb67-154" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$dir</span>/telomere-afreq</span>
<span id="cb67-155"><a href="inclusive-gwas.html#cb67-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-156"><a href="inclusive-gwas.html#cb67-156" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$i</span> <span class="ot">==</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb67-157"><a href="inclusive-gwas.html#cb67-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>-telomere.afreq <span class="op">&gt;</span> <span class="va">$dir</span>/telomere-afreq</span>
<span id="cb67-158"><a href="inclusive-gwas.html#cb67-158" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb67-159"><a href="inclusive-gwas.html#cb67-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>-telomere.afreq <span class="op">&gt;&gt;</span> <span class="va">$dir</span>/telomere-afreq</span>
<span id="cb67-160"><a href="inclusive-gwas.html#cb67-160" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb67-161"><a href="inclusive-gwas.html#cb67-161" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb67-162"><a href="inclusive-gwas.html#cb67-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-163"><a href="inclusive-gwas.html#cb67-163" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-164"><a href="inclusive-gwas.html#cb67-164" aria-hidden="true" tabindex="-1"></a><span class="co">#  Finalize the 10k SNP list of each side</span></span>
<span id="cb67-165"><a href="inclusive-gwas.html#cb67-165" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-166"><a href="inclusive-gwas.html#cb67-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-167"><a href="inclusive-gwas.html#cb67-167" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>10000</span>
<span id="cb67-168"><a href="inclusive-gwas.html#cb67-168" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>gen/geno-telomere.bim</span>
<span id="cb67-169"><a href="inclusive-gwas.html#cb67-169" aria-hidden="true" tabindex="-1"></a><span class="va">leftin</span><span class="op">=</span>inflation/gwas-telomere/left-snps-tmp</span>
<span id="cb67-170"><a href="inclusive-gwas.html#cb67-170" aria-hidden="true" tabindex="-1"></a><span class="va">rightin</span><span class="op">=</span>inflation/gwas-telomere/right-snps-tmp</span>
<span id="cb67-171"><a href="inclusive-gwas.html#cb67-171" aria-hidden="true" tabindex="-1"></a><span class="va">leftout</span><span class="op">=</span>inflation/gwas-telomere/left-snps</span>
<span id="cb67-172"><a href="inclusive-gwas.html#cb67-172" aria-hidden="true" tabindex="-1"></a><span class="va">rightout</span><span class="op">=</span>inflation/gwas-telomere/right-snps</span>
<span id="cb67-173"><a href="inclusive-gwas.html#cb67-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-174"><a href="inclusive-gwas.html#cb67-174" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}</span></span>
<span id="cb67-175"><a href="inclusive-gwas.html#cb67-175" aria-hidden="true" tabindex="-1"></a><span class="st">     ($2 in a){print $2}&#39;</span> <span class="va">$leftin</span> <span class="va">$snp</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-</span><span class="va">$m</span>  <span class="op">&gt;</span> <span class="va">$leftout</span></span>
<span id="cb67-176"><a href="inclusive-gwas.html#cb67-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-177"><a href="inclusive-gwas.html#cb67-177" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}</span></span>
<span id="cb67-178"><a href="inclusive-gwas.html#cb67-178" aria-hidden="true" tabindex="-1"></a><span class="st">     ($2 in a){print $2}&#39;</span> <span class="va">$rightin</span> <span class="va">$snp</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-</span><span class="va">$m</span>  <span class="op">&gt;</span> <span class="va">$rightout</span></span>
<span id="cb67-179"><a href="inclusive-gwas.html#cb67-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-180"><a href="inclusive-gwas.html#cb67-180" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-181"><a href="inclusive-gwas.html#cb67-181" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r^2_j</span></span>
<span id="cb67-182"><a href="inclusive-gwas.html#cb67-182" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb67-183"><a href="inclusive-gwas.html#cb67-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-184"><a href="inclusive-gwas.html#cb67-184" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/gwas-telomere/right-snps</span>
<span id="cb67-185"><a href="inclusive-gwas.html#cb67-185" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/gwas-telomere/left-snps</span>
<span id="cb67-186"><a href="inclusive-gwas.html#cb67-186" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-telomere</span>
<span id="cb67-187"><a href="inclusive-gwas.html#cb67-187" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/gwas-telomere/out/10k-snps</span>
<span id="cb67-188"><a href="inclusive-gwas.html#cb67-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-189"><a href="inclusive-gwas.html#cb67-189" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb67-190"><a href="inclusive-gwas.html#cb67-190" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb67-191"><a href="inclusive-gwas.html#cb67-191" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb67-192"><a href="inclusive-gwas.html#cb67-192" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 80G</span></span>
<span id="cb67-193"><a href="inclusive-gwas.html#cb67-193" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb67-194"><a href="inclusive-gwas.html#cb67-194" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb67-195"><a href="inclusive-gwas.html#cb67-195" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb67-196"><a href="inclusive-gwas.html#cb67-196" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb67-197"><a href="inclusive-gwas.html#cb67-197" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb67-198"><a href="inclusive-gwas.html#cb67-198" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb67-199"><a href="inclusive-gwas.html#cb67-199" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb67-200"><a href="inclusive-gwas.html#cb67-200" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps</span>
<span id="cb67-201"><a href="inclusive-gwas.html#cb67-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-202"><a href="inclusive-gwas.html#cb67-202" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the job</span></span>
<span id="cb67-203"><a href="inclusive-gwas.html#cb67-203" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps <span class="op">&gt;</span>../job-records/calc-r-telomere</span>
<span id="cb67-204"><a href="inclusive-gwas.html#cb67-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-205"><a href="inclusive-gwas.html#cb67-205" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r_j^2 for each i-------------------------------------------------</span></span>
<span id="cb67-206"><a href="inclusive-gwas.html#cb67-206" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb67-207"><a href="inclusive-gwas.html#cb67-207" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb67-208"><a href="inclusive-gwas.html#cb67-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-209"><a href="inclusive-gwas.html#cb67-209" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span><span class="st">&quot;10k-snps&quot;</span></span>
<span id="cb67-210"><a href="inclusive-gwas.html#cb67-210" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/gwas-telomere/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.pairwise&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb67-211"><a href="inclusive-gwas.html#cb67-211" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/gwas-telomere/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsa&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb67-212"><a href="inclusive-gwas.html#cb67-212" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb67-213"><a href="inclusive-gwas.html#cb67-213" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/gwas-telomere/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsb&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb67-214"><a href="inclusive-gwas.html#cb67-214" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb67-215"><a href="inclusive-gwas.html#cb67-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-216"><a href="inclusive-gwas.html#cb67-216" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[,-c<span class="kw">(</span><span class="ex">10001</span><span class="kw">)</span><span class="ex">]^2</span></span>
<span id="cb67-217"><a href="inclusive-gwas.html#cb67-217" aria-hidden="true" tabindex="-1"></a><span class="va">outb</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>listb<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,2,</span> mean<span class="kw">))</span></span>
<span id="cb67-218"><a href="inclusive-gwas.html#cb67-218" aria-hidden="true" tabindex="-1"></a><span class="va">outa</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>lista<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,1,</span> mean<span class="kw">))</span></span>
<span id="cb67-219"><a href="inclusive-gwas.html#cb67-219" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">outa,outb</span><span class="kw">)</span></span>
<span id="cb67-220"><a href="inclusive-gwas.html#cb67-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-221"><a href="inclusive-gwas.html#cb67-221" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,paste0</span><span class="er">(</span><span class="st">&quot;summary/ave-r2-&quot;</span><span class="ex">,nm,</span> <span class="st">&quot;-ukbb-telomere&quot;</span><span class="kw">)</span><span class="ex">,</span> col.names=F, row.names=F, quote=F<span class="kw">)</span>  </span></code></pre></div>
</div>
<div id="organize-data-1" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> organize data</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb68-1"><a href="inclusive-gwas.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NEED TO CHECK THE FOLLOWING CODE</span></span>
<span id="cb68-2"><a href="inclusive-gwas.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-ukbb-telomere</span>
<span id="cb68-3"><a href="inclusive-gwas.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>doug/ukbb.ldsc</span>
<span id="cb68-4"><a href="inclusive-gwas.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-telomere/telomere-gwas-organized-hm3</span>
<span id="cb68-5"><a href="inclusive-gwas.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-telomere/telomere.out</span>
<span id="cb68-6"><a href="inclusive-gwas.html#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="inclusive-gwas.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next}</span></span>
<span id="cb68-8"><a href="inclusive-gwas.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="st">      ($1 in a) {print $1, b[$1], $2}&#39;</span> <span class="va">$rs</span> <span class="va">$aver2</span> <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb68-9"><a href="inclusive-gwas.html#cb68-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb68-10"><a href="inclusive-gwas.html#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;snp rs chisq aver2&quot;} </span></span>
<span id="cb68-11"><a href="inclusive-gwas.html#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="st">     NR==FNR {a[$2]; b[$2]=$1; c[$2]=$3; next}</span></span>
<span id="cb68-12"><a href="inclusive-gwas.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="st">     ($4 in a) {print b[$4], $4, $5, c[$4] }&#39;</span> tmp/aver2.tmp <span class="va">$gwas</span>  <span class="op">&gt;</span> <span class="va">$out</span>  </span></code></pre></div>
</div>
<div id="chisq-aver2_j-1" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> chisq ~ aver2_j</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="inclusive-gwas.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb69-2"><a href="inclusive-gwas.html#cb69-2" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;gwas-telomere/telomere.out&quot;</span>, <span class="at">col_names=</span>T)</span>
<span id="cb69-3"><a href="inclusive-gwas.html#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="inclusive-gwas.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j-----------------------------------------------</span></span>
<span id="cb69-5"><a href="inclusive-gwas.html#cb69-5" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb69-6"><a href="inclusive-gwas.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb69-7"><a href="inclusive-gwas.html#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="inclusive-gwas.html#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># make the plot---------------------------------------------------------------</span></span>
<span id="cb69-9"><a href="inclusive-gwas.html#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># bin a variable by quantile</span></span>
<span id="cb69-10"><a href="inclusive-gwas.html#cb69-10" aria-hidden="true" tabindex="-1"></a>cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb69-11"><a href="inclusive-gwas.html#cb69-11" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb69-12"><a href="inclusive-gwas.html#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co"># average chisq by bin values</span></span>
<span id="cb69-13"><a href="inclusive-gwas.html#cb69-13" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb69-14"><a href="inclusive-gwas.html#cb69-14" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb69-15"><a href="inclusive-gwas.html#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="inclusive-gwas.html#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-telomere.png&quot;</span>,</span>
<span id="cb69-17"><a href="inclusive-gwas.html#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb69-18"><a href="inclusive-gwas.html#cb69-18" aria-hidden="true" tabindex="-1"></a>start<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb69-19"><a href="inclusive-gwas.html#cb69-19" aria-hidden="true" tabindex="-1"></a>end<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb69-20"><a href="inclusive-gwas.html#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb69-21"><a href="inclusive-gwas.html#cb69-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave chisq&quot;</span>,</span>
<span id="cb69-22"><a href="inclusive-gwas.html#cb69-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim=</span><span class="fu">c</span>(start,end),</span>
<span id="cb69-23"><a href="inclusive-gwas.html#cb69-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb69-24"><a href="inclusive-gwas.html#cb69-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb69-25"><a href="inclusive-gwas.html#cb69-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb69-26"><a href="inclusive-gwas.html#cb69-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-27"><a href="inclusive-gwas.html#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot ------------------------------------------------------------------</span></span>
<span id="cb69-28"><a href="inclusive-gwas.html#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="inclusive-gwas.html#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb69-30"><a href="inclusive-gwas.html#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="co">#cuts=c(&quot;cut.125&quot;,&quot;cut.25&quot;,&quot;cut.5&quot;)</span></span>
<span id="cb69-31"><a href="inclusive-gwas.html#cb69-31" aria-hidden="true" tabindex="-1"></a>cuts<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span></span>
<span id="cb69-32"><a href="inclusive-gwas.html#cb69-32" aria-hidden="true" tabindex="-1"></a>related<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;rel&quot;</span>,<span class="st">&quot;unrel&quot;</span>)</span>
<span id="cb69-33"><a href="inclusive-gwas.html#cb69-33" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb69-34"><a href="inclusive-gwas.html#cb69-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb69-35"><a href="inclusive-gwas.html#cb69-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb69-36"><a href="inclusive-gwas.html#cb69-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-37"><a href="inclusive-gwas.html#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cuts)){</span>
<span id="cb69-38"><a href="inclusive-gwas.html#cb69-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-39"><a href="inclusive-gwas.html#cb69-39" aria-hidden="true" tabindex="-1"></a>  cut<span class="ot">=</span>cuts[j]</span>
<span id="cb69-40"><a href="inclusive-gwas.html#cb69-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot chisq ~ aver2 by rel for a given cutoff for relatedness</span></span>
<span id="cb69-41"><a href="inclusive-gwas.html#cb69-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-related-gwas-&quot;</span>,cut,<span class="st">&quot;.png&quot;</span>),</span>
<span id="cb69-42"><a href="inclusive-gwas.html#cb69-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb69-43"><a href="inclusive-gwas.html#cb69-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb69-44"><a href="inclusive-gwas.html#cb69-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb69-45"><a href="inclusive-gwas.html#cb69-45" aria-hidden="true" tabindex="-1"></a>        trait<span class="ot">=</span>traits[i]</span>
<span id="cb69-46"><a href="inclusive-gwas.html#cb69-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">make_plot</span>(trait, cut)</span>
<span id="cb69-47"><a href="inclusive-gwas.html#cb69-47" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb69-48"><a href="inclusive-gwas.html#cb69-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb69-49"><a href="inclusive-gwas.html#cb69-49" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="notesconcerns" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> notes/concerns</h2>
<ul>
<li>Telomere length GWAS:
<ul>
<li>The QC seems too rough so that some SNPs have multiple alleles.</li>
</ul></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="control.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="related-individuals.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04.5-inclusive-gwas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
