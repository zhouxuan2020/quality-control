[["control-gwas.html", "6 control GWAS 6.1 ID list 6.2 QC of hp3 SNPs", " 6 control GWAS Here we want to do GWASs that will serve as the control group of the good GWASs. Recall for the bad GWASs (section 4), we have a total of 100k individuals, which consist of 93,528 unrelated white British and 6,472 blacks and Asians. We observed inflation of the test statistics. Although unlikely, it is still possible that some of the inflation is due to random errors. To rule out this possibility [to ascertain that the observed inflation is due to population stratification, not random errors], we used the same 93,528 unrelated white British but replaced the 6,472 blacks and Asians with unrelated white British that are not included in the good GWASs. 6.1 ID list We used previously obtained id lists (see section 3.1 for the good GWAS id list and section 4.1 for the bad GWAS id list ) to derive the id list for the control GWASs. These are: overlap-complete-cases.id: N = 147,008. Unrelated white British who have no missing data for all 14 traits and covariates. rand.100000: ID list for the good gwas. Randomly selected from overlap-complete-cases.id white.rand.93528: unrelated whites as a part of the bad gwas ID list. Randomly selected from rand.100000 Here are the steps: identify IDs from overlap-complete-cases.id not included in rand.100000. randomly select 6,472 from the identified IDs. combine white.rand.93528 with the randomly selected 6,472 IDs. options(scipen = 100) id1=read.table(&quot;unrelated/overlap-complete-cases.id&quot;, header=F) id2=read.table(&quot;unrelated/rand.100000&quot;, header=F) id3=read.table(&quot;white.rand.93528&quot;, header=F) # pool for selection common=intersect(id1$V1, id2$V1) pool=id1[!id1$V1%in%common,] # randomly select 6,472 from the pool sel=pool[sample(dim(pool)[1], 6472, replace=F),] # combine with &#39;white.rand.93528&#39; write.table(rbind(sel,id3), &#39;control-gwas.id&#39;, quote=F, row.names=F, col.names=F) 6.2 QC of hp3 SNPs # QC SNPs----------------------------------------------------------------------- # stating number of SNPs= 1,184,423 for j in {1..22}; do echo &quot;#&quot;&#39;!&#39;&quot;/bin/bash #SBATCH --constraint \\&quot;s04|s05\\&quot; #SBATCH --partition normal #SBATCH --mem 20G #SBATCH -c 3 #SBATCH -t 1:0:0 ./plink2 --pfile ../gen/geno_plink/bhr$j \\ --keep ../control-gwas.id \\ --extract ../doug/ukbb.ldsc \\ --hwe 0.0001 \\ --hard-call-threshold .05 \\ --mach-r2-filter 0.8 2 \\ --make-bed \\ --memory 20000 \\ --out ../gen/tmp/bhr$j \\ --threads 3 &quot;&gt; sh_script/chr$j.sh done # submit jobs for j in {1..22}; do sbatch -A snpher ../sh_script/chr$j.sh done &gt; ../job-records/qc-control-gwas # merge files rm bfile-control-gwas.list for j in {1..22}; do echo &quot;../gen/tmp/bhr$j&quot; &gt;&gt;bfile-control-gwas.list done echo &quot;#&quot;&#39;!&#39;&quot;/bin/bash #SBATCH --constraint \\&quot;s04|s05\\&quot; #SBATCH --partition normal #SBATCH --mem 20G #SBATCH -c 3 #SBATCH -t 40:0:0 ./ldak5.1 --make-bed ../gen/geno-control \\ --mbfile ../gen/bfile-control-gwas.list \\ --max-threads 3 \\ --exclude-dups YES &quot;&gt; sh_script/mbfile-control.sh # submit the script sbatch -A snpher ../sh_script/mbfile-control.sh &gt;../job-records/mbfiles-control-gwas # MAF &amp; call-rate awk &lt; geno-control.stats &#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39; &gt; snps-control-gwas.use # m = 1,103,209 SNPs "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
