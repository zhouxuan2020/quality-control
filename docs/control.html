<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 control GWAS | GWAS Quality Control</title>
  <meta name="description" content="9 control GWAS | GWAS Quality Control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="9 control GWAS | GWAS Quality Control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 control GWAS | GWAS Quality Control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ukbb.html"/>
<link rel="next" href="compute-sum_ijm_1-m_2r2_ij.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>2</b> Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>2.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>2.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>2.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>2.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>2.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>2.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>2.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>2.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>2.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>2.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>2.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>2.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>3</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>3.1</b> test statistics ~ LD score</a></li>
<li class="chapter" data-level="3.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#new-models"><i class="fa fa-check"></i><b>3.2</b> New models?</a></li>
<li class="chapter" data-level="3.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ld-scores-based-on-individual-level-data"><i class="fa fa-check"></i><b>3.3</b> LD scores based on individual level data</a></li>
<li class="chapter" data-level="3.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-the-new-model"><i class="fa fa-check"></i><b>3.4</b> Test the new model</a></li>
<li class="chapter" data-level="3.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predictors-of-inflation"><i class="fa fa-check"></i><b>3.5</b> predictors of inflation?</a></li>
<li class="chapter" data-level="3.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#regress-bad-chisq-mean-r2_j"><i class="fa fa-check"></i><b>3.6</b> regress bad chisq ~ mean r^2_j</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mathematical-details.html"><a href="mathematical-details.html"><i class="fa fa-check"></i><b>4</b> Mathematical Details</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mathematical-details.html"><a href="mathematical-details.html#trk_rightk_left"><i class="fa fa-check"></i><b>4.1</b> <span class="math inline">\(tr(K_{right}K_{left})\)</span></a></li>
<li class="chapter" data-level="4.2" data-path="mathematical-details.html"><a href="mathematical-details.html#verification"><i class="fa fa-check"></i><b>4.2</b> verification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html"><i class="fa fa-check"></i><b>5</b> chi square ~ <span class="math inline">\(\overline{r^2_j}\)</span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#overliner2_j-choice-of-snps"><i class="fa fa-check"></i><b>5.1</b> <span class="math inline">\(\overline{r^2_j}\)</span> &amp; choice of SNPs</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#number-of-snps"><i class="fa fa-check"></i><b>5.1.1</b> number of SNPs</a></li>
<li class="chapter" data-level="5.1.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#maf"><i class="fa fa-check"></i><b>5.1.2</b> maf</a></li>
<li class="chapter" data-level="5.1.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#summary"><i class="fa fa-check"></i><b>5.1.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#varying-levels-of-confouding"><i class="fa fa-check"></i><b>5.2</b> varying levels of confouding</a></li>
<li class="chapter" data-level="5.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#results-summary"><i class="fa fa-check"></i><b>5.3</b> results summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>6</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>6.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="6.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>6.2</b> extract covariates</a></li>
<li class="chapter" data-level="6.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>6.3</b> GWAS</a></li>
<li class="chapter" data-level="6.4" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>6.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>6.4.1</b> under gcta</a></li>
<li class="chapter" data-level="6.4.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>6.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="6.4.3" data-path="good.html"><a href="good.html#summary-1"><i class="fa fa-check"></i><b>6.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>6.5</b> REML</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>6.5.1</b> making grms</a></li>
<li class="chapter" data-level="6.5.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>6.5.2</b> fast-reml</a></li>
<li class="chapter" data-level="6.5.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>6.5.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>6.6</b> HE</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>6.6.1</b> estimation</a></li>
<li class="chapter" data-level="6.6.2" data-path="good.html"><a href="good.html#summary-2"><i class="fa fa-check"></i><b>6.6.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>7</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>7.1</b> ID list</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>7.1.1</b> initial selection</a></li>
<li class="chapter" data-level="7.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>7.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="7.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>7.1.3</b> final list</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="bad.html"><a href="bad.html#gwas-1"><i class="fa fa-check"></i><b>7.2</b> GWAS</a></li>
<li class="chapter" data-level="7.3" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>7.3</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>7.3.1</b> under gcta</a></li>
<li class="chapter" data-level="7.3.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>7.3.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="7.3.3" data-path="bad.html"><a href="bad.html#summary-3"><i class="fa fa-check"></i><b>7.3.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>7.4</b> REML</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>7.4.1</b> making grms</a></li>
<li class="chapter" data-level="7.4.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>7.4.2</b> fast-reml</a></li>
<li class="chapter" data-level="7.4.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>7.4.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>7.5</b> HE</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>7.5.1</b> estimation</a></li>
<li class="chapter" data-level="7.5.2" data-path="bad.html"><a href="bad.html#summary-4"><i class="fa fa-check"></i><b>7.5.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>8</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>8.1</b> total N = 337k</a></li>
<li class="chapter" data-level="8.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>8.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="8.3" data-path="ukbb.html"><a href="ukbb.html#gwas-2"><i class="fa fa-check"></i><b>8.3</b> GWAS</a></li>
<li class="chapter" data-level="8.4" data-path="ukbb.html"><a href="ukbb.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>8.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>8.4.1</b> under gcta</a></li>
<li class="chapter" data-level="8.4.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>8.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="8.4.3" data-path="ukbb.html"><a href="ukbb.html#summary-5"><i class="fa fa-check"></i><b>8.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>8.5</b> HE</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>8.5.1</b> making grms</a></li>
<li class="chapter" data-level="8.5.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>8.5.2</b> estimation</a></li>
<li class="chapter" data-level="8.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-6"><i class="fa fa-check"></i><b>8.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>9</b> control GWAS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>9.1</b> ID list</a></li>
<li class="chapter" data-level="9.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>9.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="9.3" data-path="control.html"><a href="control.html#gwas-3"><i class="fa fa-check"></i><b>9.3</b> GWAS</a></li>
<li class="chapter" data-level="9.4" data-path="control.html"><a href="control.html#ldsc-intercept-3"><i class="fa fa-check"></i><b>9.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>9.4.1</b> under gcta</a></li>
<li class="chapter" data-level="9.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>9.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="9.4.3" data-path="control.html"><a href="control.html#summary-7"><i class="fa fa-check"></i><b>9.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>9.5</b> HE</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>9.5.1</b> making grms</a></li>
<li class="chapter" data-level="9.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>9.5.2</b> estimation</a></li>
<li class="chapter" data-level="9.5.3" data-path="control.html"><a href="control.html#summary-8"><i class="fa fa-check"></i><b>9.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html"><i class="fa fa-check"></i><b>10</b> compute <span class="math inline">\(\sum_{i,j}^{m_1, m_2}r^2_{i,j}\)</span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwas-all-qced-snps"><i class="fa fa-check"></i><b>10.1</b> good GWAS-all qced snps</a></li>
<li class="chapter" data-level="10.2" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwass--ldak-thin-snps"><i class="fa fa-check"></i><b>10.2</b> good GWASs- ldak-thin snps</a></li>
<li class="chapter" data-level="10.3" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#bad-gwass-all-qced-snps"><i class="fa fa-check"></i><b>10.3</b> bad GWASs-all qced snps</a></li>
<li class="chapter" data-level="10.4" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#summary-9"><i class="fa fa-check"></i><b>10.4</b> summary</a></li>
<li class="chapter" data-level="10.5" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#compute-overliner2_j"><i class="fa fa-check"></i><b>10.5</b> compute <span class="math inline">\(\overline{r^2_j}\)</span></a></li>
<li class="chapter" data-level="10.6" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#mixed-pop-gwas-with-pc-as-covariates"><i class="fa fa-check"></i><b>10.6</b> mixed pop GWAS with PC as covariates</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GWAS Quality Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="control" class="section level1" number="9">
<h1><span class="header-section-number">9</span> control GWAS</h1>
<p>Here we perform GWASs that serve as the control group for the good versus bad GWASs comparison. For the bad GWASs (section <a href="bad.html#bad">7</a>), we have a total of 100k individuals, which consist of 93,528 unrelated white British (from the good GWASs) and 6,472 blacks and Asians. We observed inflation of the test statistics. Although unlikely, it is still possible that some of the inflation is due to random errors. To rule out this possibility [or to ascertain that the observed inflation is due to population stratification not random errors], we used the same 93,528 unrelated white British but replaced the 6,472 blacks and Asians with unrelated white British that were not included in the good GWASs.</p>
<div id="id-list" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> ID list</h2>
<p>We used previously obtained id lists (see section <a href="good.html#goodid">6.1</a> for the good GWAS id list and section <a href="bad.html#badid">7.1</a> for the bad GWAS id list ) to derive the id list for the control GWASs. These are:</p>
<ul>
<li><code>overlap-complete-cases.id</code>: N = 147,008. Unrelated white British who have no missing data for all 14 traits and covariates.</li>
<li><code>rand.100000</code>: ID list for the good gwas. Randomly selected from <code>overlap-complete-cases.id</code><br />
</li>
<li><code>white.rand.93528</code>: unrelated whites as a part of the bad gwas ID list. Randomly selected from <code>rand.100000</code></li>
</ul>
<p>Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>identify IDs from <code>overlap-complete-cases.id</code> not included in <code>rand.100000</code>.</li>
<li>randomly select 6,472 from the identified IDs.</li>
<li>combine <code>white.rand.93528</code> with the randomly selected 6,472 IDs.</li>
</ol>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="control.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">100</span>)</span>
<span id="cb48-2"><a href="control.html#cb48-2" aria-hidden="true" tabindex="-1"></a>id1<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;unrelated/overlap-complete-cases.id&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb48-3"><a href="control.html#cb48-3" aria-hidden="true" tabindex="-1"></a>id2<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;unrelated/rand.100000&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb48-4"><a href="control.html#cb48-4" aria-hidden="true" tabindex="-1"></a>id3<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;white.rand.93528&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb48-5"><a href="control.html#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="control.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pool for selection</span></span>
<span id="cb48-7"><a href="control.html#cb48-7" aria-hidden="true" tabindex="-1"></a>common<span class="ot">=</span><span class="fu">intersect</span>(id1<span class="sc">$</span>V1, id2<span class="sc">$</span>V1)</span>
<span id="cb48-8"><a href="control.html#cb48-8" aria-hidden="true" tabindex="-1"></a>pool<span class="ot">=</span>id1[<span class="sc">!</span>id1<span class="sc">$</span>V1<span class="sc">%in%</span>common,]</span>
<span id="cb48-9"><a href="control.html#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="control.html#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly select 6,472 from the pool</span></span>
<span id="cb48-11"><a href="control.html#cb48-11" aria-hidden="true" tabindex="-1"></a>sel<span class="ot">=</span>pool[<span class="fu">sample</span>(<span class="fu">dim</span>(pool)[<span class="dv">1</span>], <span class="dv">6472</span>, <span class="at">replace=</span>F),]</span>
<span id="cb48-12"><a href="control.html#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="control.html#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  combine with &#39;white.rand.93528&#39;</span></span>
<span id="cb48-14"><a href="control.html#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">rbind</span>(sel,id3), <span class="st">&#39;control-gwas.id&#39;</span>, <span class="at">quote=</span>F, <span class="at">row.names=</span>F, <span class="at">col.names=</span>F)</span></code></pre></div>
</div>
<div id="qc-of-hp3-snps-1" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> QC of hp3 SNPs</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="control.html#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="control.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QC SNPs-----------------------------------------------------------------------</span></span>
<span id="cb49-3"><a href="control.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stating number of SNPs= 1,184,423 </span></span>
<span id="cb49-4"><a href="control.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-5"><a href="control.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb49-6"><a href="control.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb49-7"><a href="control.html#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb49-8"><a href="control.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb49-9"><a href="control.html#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb49-10"><a href="control.html#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb49-11"><a href="control.html#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="control.html#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb49-13"><a href="control.html#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../control-gwas.id </span><span class="dt">\</span></span>
<span id="cb49-14"><a href="control.html#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../doug/ukbb.ldsc </span><span class="dt">\</span></span>
<span id="cb49-15"><a href="control.html#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb49-16"><a href="control.html#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb49-17"><a href="control.html#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.8 2 </span><span class="dt">\</span></span>
<span id="cb49-18"><a href="control.html#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb49-19"><a href="control.html#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb49-20"><a href="control.html#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb49-21"><a href="control.html#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb49-22"><a href="control.html#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb49-23"><a href="control.html#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb49-24"><a href="control.html#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="control.html#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb49-26"><a href="control.html#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-27"><a href="control.html#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb49-28"><a href="control.html#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/qc-control-gwas</span>
<span id="cb49-29"><a href="control.html#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="control.html#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/qc-control-gwas</span>
<span id="cb49-31"><a href="control.html#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb49-32"><a href="control.html#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb49-33"><a href="control.html#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-34"><a href="control.html#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb49-35"><a href="control.html#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb49-36"><a href="control.html#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb49-37"><a href="control.html#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb49-38"><a href="control.html#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb49-39"><a href="control.html#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb49-40"><a href="control.html#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb49-41"><a href="control.html#cb49-41" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb49-42"><a href="control.html#cb49-42" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb49-43"><a href="control.html#cb49-43" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb49-44"><a href="control.html#cb49-44" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb49-45"><a href="control.html#cb49-45" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb49-46"><a href="control.html#cb49-46" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb49-47"><a href="control.html#cb49-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-48"><a href="control.html#cb49-48" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files</span></span>
<span id="cb49-49"><a href="control.html#cb49-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile-control-gwas.list</span>
<span id="cb49-50"><a href="control.html#cb49-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-51"><a href="control.html#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span>bfile-control-gwas.list</span>
<span id="cb49-52"><a href="control.html#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb49-53"><a href="control.html#cb49-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-54"><a href="control.html#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb49-55"><a href="control.html#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb49-56"><a href="control.html#cb49-56" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb49-57"><a href="control.html#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb49-58"><a href="control.html#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb49-59"><a href="control.html#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 40:0:0</span></span>
<span id="cb49-60"><a href="control.html#cb49-60" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-control </span><span class="dt">\</span></span>
<span id="cb49-61"><a href="control.html#cb49-61" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile-control-gwas.list </span><span class="dt">\</span></span>
<span id="cb49-62"><a href="control.html#cb49-62" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb49-63"><a href="control.html#cb49-63" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb49-64"><a href="control.html#cb49-64" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-control.sh</span>
<span id="cb49-65"><a href="control.html#cb49-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-66"><a href="control.html#cb49-66" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb49-67"><a href="control.html#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-control.sh <span class="op">&gt;</span>../job-records/mbfiles-control-gwas</span>
<span id="cb49-68"><a href="control.html#cb49-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-69"><a href="control.html#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate </span></span>
<span id="cb49-70"><a href="control.html#cb49-70" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> geno-control.stats <span class="st">&#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> snps-control-gwas.use</span>
<span id="cb49-71"><a href="control.html#cb49-71" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 1,103,182 SNPs</span></span></code></pre></div>
</div>
<div id="gwas-3" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> GWAS</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="control.html#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="control.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression-------------------------------------------------------------</span></span>
<span id="cb50-3"><a href="control.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-control</span>
<span id="cb50-4"><a href="control.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="control.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>gwas-control</span>
<span id="cb50-6"><a href="control.html#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="va">filein</span><span class="op">=</span>geno-control</span>
<span id="cb50-7"><a href="control.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>control-gwas.id</span>
<span id="cb50-8"><a href="control.html#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>snps-control-gwas.use</span>
<span id="cb50-9"><a href="control.html#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb50-10"><a href="control.html#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb50-11"><a href="control.html#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb50-12"><a href="control.html#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb50-13"><a href="control.html#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb50-14"><a href="control.html#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb50-15"><a href="control.html#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb50-16"><a href="control.html#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="control.html#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-linear </span><span class="dt">\</span></span>
<span id="cb50-18"><a href="control.html#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb50-19"><a href="control.html#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb50-20"><a href="control.html#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../</span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb50-21"><a href="control.html#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb50-22"><a href="control.html#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb50-23"><a href="control.html#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb50-24"><a href="control.html#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb50-25"><a href="control.html#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb50-26"><a href="control.html#cb50-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-27"><a href="control.html#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb50-28"><a href="control.html#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb50-29"><a href="control.html#cb50-29" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb50-30"><a href="control.html#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-control</span>
<span id="cb50-31"><a href="control.html#cb50-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-32"><a href="control.html#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb50-33"><a href="control.html#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-control</span>
<span id="cb50-34"><a href="control.html#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb50-35"><a href="control.html#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb50-36"><a href="control.html#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb50-37"><a href="control.html#cb50-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb50-38"><a href="control.html#cb50-38" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb50-39"><a href="control.html#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb50-40"><a href="control.html#cb50-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb50-41"><a href="control.html#cb50-41" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb50-42"><a href="control.html#cb50-42" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb50-43"><a href="control.html#cb50-43" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb50-44"><a href="control.html#cb50-44" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb50-45"><a href="control.html#cb50-45" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb50-46"><a href="control.html#cb50-46" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb50-47"><a href="control.html#cb50-47" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb50-48"><a href="control.html#cb50-48" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb50-49"><a href="control.html#cb50-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="ldsc-intercept-3" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> ldsc intercept</h2>
<div id="under-gcta-3" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> under gcta</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="control.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UP TO HERE</span></span>
<span id="cb51-2"><a href="control.html#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="control.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb51-4"><a href="control.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># using original ldsc</span></span>
<span id="cb51-5"><a href="control.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb51-6"><a href="control.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="control.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># format stats for ldsc--------------------------------------------------------- </span></span>
<span id="cb51-8"><a href="control.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb51-9"><a href="control.html#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb51-10"><a href="control.html#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;doug/ukbb.ldsc&quot;</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb51-11"><a href="control.html#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="va">phen</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span><span class="st">&quot;fvc&quot;</span><span class="ex">,</span></span>
<span id="cb51-12"><a href="control.html#cb51-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;height&quot;</span><span class="ex">,</span><span class="st">&quot;imp&quot;</span><span class="ex">,</span><span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span></span>
<span id="cb51-13"><a href="control.html#cb51-13" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="ex">,</span> <span class="st">&quot;quals&quot;</span><span class="kw">)</span></span>
<span id="cb51-14"><a href="control.html#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="control.html#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in phen<span class="kw">){</span></span>
<span id="cb51-16"><a href="control.html#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="va">stat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-control/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb51-17"><a href="control.html#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="va">p</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-control/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.pvalues&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb51-18"><a href="control.html#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> stat<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb51-19"><a href="control.html#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> p<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb51-20"><a href="control.html#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">SNP</span><span class="op">=</span>rs<span class="va">$X2</span>,</span>
<span id="cb51-21"><a href="control.html#cb51-21" aria-hidden="true" tabindex="-1"></a>                 <span class="va">N</span><span class="op">=</span>stat<span class="va">$n</span>[m1],</span>
<span id="cb51-22"><a href="control.html#cb51-22" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Z</span><span class="op">=</span><span class="va">(</span>sqrt<span class="er">(</span>stat<span class="va">$Stat)</span><span class="pp">*</span>stat<span class="va">$Direction</span><span class="kw">)</span><span class="ex">[m1],</span></span>
<span id="cb51-23"><a href="control.html#cb51-23" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A1</span><span class="op">=</span>stat<span class="va">$A1</span>[m1],</span>
<span id="cb51-24"><a href="control.html#cb51-24" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A2</span><span class="op">=</span>stat<span class="va">$A2</span>[m1], </span>
<span id="cb51-25"><a href="control.html#cb51-25" aria-hidden="true" tabindex="-1"></a>                 <span class="va">pval</span><span class="op">=</span>p<span class="va">$P</span>[m2], <span class="va">stringsAsFactors</span><span class="op">=</span>F<span class="er">)</span></span>
<span id="cb51-26"><a href="control.html#cb51-26" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>out[complete.cases<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb51-27"><a href="control.html#cb51-27" aria-hidden="true" tabindex="-1"></a>  <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;gwas-control/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear-rs.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb51-28"><a href="control.html#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb51-29"><a href="control.html#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb51-30"><a href="control.html#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="control.html#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co"># perform ldsc------------------------------------------------------------------</span></span>
<span id="cb51-32"><a href="control.html#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> out-control</span>
<span id="cb51-33"><a href="control.html#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-34"><a href="control.html#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb51-35"><a href="control.html#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb51-36"><a href="control.html#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb51-37"><a href="control.html#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb51-38"><a href="control.html#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb51-39"><a href="control.html#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 24:00:0</span></span>
<span id="cb51-40"><a href="control.html#cb51-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-41"><a href="control.html#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="st">.././munge_sumstats.py </span><span class="dt">\</span></span>
<span id="cb51-42"><a href="control.html#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="st">--sumstats ../../gwas-control/</span><span class="va">$i</span><span class="st">-linear-rs.summaries </span><span class="dt">\</span></span>
<span id="cb51-43"><a href="control.html#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-control/</span><span class="va">$i</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb51-44"><a href="control.html#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="st">--merge-alleles ../w_hm3.snplist</span></span>
<span id="cb51-45"><a href="control.html#cb51-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-46"><a href="control.html#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="st">.././ldsc.py </span><span class="dt">\</span></span>
<span id="cb51-47"><a href="control.html#cb51-47" aria-hidden="true" tabindex="-1"></a><span class="st">--h2 ../out-control/</span><span class="va">$i</span><span class="st">.sumstats.gz </span><span class="dt">\</span></span>
<span id="cb51-48"><a href="control.html#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="st">--ref-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb51-49"><a href="control.html#cb51-49" aria-hidden="true" tabindex="-1"></a><span class="st">--w-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb51-50"><a href="control.html#cb51-50" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-control/</span><span class="va">$i</span><span class="st">-ldsc</span></span>
<span id="cb51-51"><a href="control.html#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/ldsc-<span class="va">$i</span>-control.sh</span>
<span id="cb51-52"><a href="control.html#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb51-53"><a href="control.html#cb51-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-54"><a href="control.html#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb51-55"><a href="control.html#cb51-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper</span><span class="op">,</span><span class="dt">quals}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-56"><a href="control.html#cb51-56" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldsc-<span class="va">$i</span>-control.sh</span>
<span id="cb51-57"><a href="control.html#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../../job-records/ldsc-control</span>
<span id="cb51-58"><a href="control.html#cb51-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-59"><a href="control.html#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb51-60"><a href="control.html#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="co"># using sumher</span></span>
<span id="cb51-61"><a href="control.html#cb51-61" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb51-62"><a href="control.html#cb51-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-63"><a href="control.html#cb51-63" aria-hidden="true" tabindex="-1"></a><span class="co"># insert genetic distance into bim file-----------------------------------------</span></span>
<span id="cb51-64"><a href="control.html#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> geno-control.fam <span class="op">&gt;</span> small-control</span>
<span id="cb51-65"><a href="control.html#cb51-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-66"><a href="control.html#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-67"><a href="control.html#cb51-67" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb51-68"><a href="control.html#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb51-69"><a href="control.html#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb51-70"><a href="control.html#cb51-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 3:00:0</span></span>
<span id="cb51-71"><a href="control.html#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb51-72"><a href="control.html#cb51-72" aria-hidden="true" tabindex="-1"></a><span class="st">./plink1.9 --bfile ../gen/geno-control </span><span class="dt">\</span></span>
<span id="cb51-73"><a href="control.html#cb51-73" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb51-74"><a href="control.html#cb51-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --cm-map /home/zhoux/snpher/faststorage/genetic_maps/genetic_map_chr@_combined_b37.txt </span><span class="dt">\</span></span>
<span id="cb51-75"><a href="control.html#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --make-bed </span><span class="dt">\</span></span>
<span id="cb51-76"><a href="control.html#cb51-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --out new</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb51-77"><a href="control.html#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../gen/small-control</span></span>
<span id="cb51-78"><a href="control.html#cb51-78" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/map<span class="va">$j</span></span>
<span id="cb51-79"><a href="control.html#cb51-79" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb51-80"><a href="control.html#cb51-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-81"><a href="control.html#cb51-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-82"><a href="control.html#cb51-82" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/map<span class="va">$j</span></span>
<span id="cb51-83"><a href="control.html#cb51-83" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> genetic-distance-hapmap3</span>
<span id="cb51-84"><a href="control.html#cb51-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-85"><a href="control.html#cb51-85" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /home/zhoux/dsmwpred/xuan/quality-control/qc-10oct/gen</span>
<span id="cb51-86"><a href="control.html#cb51-86" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> new<span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span>.bim <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $2, $3}&#39;</span> <span class="op">&gt;</span> maps-hapmap3-control.txt</span>
<span id="cb51-87"><a href="control.html#cb51-87" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> new<span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span>.<span class="dt">{bim</span><span class="op">,</span><span class="dt">bed</span><span class="op">,</span><span class="dt">fam</span><span class="op">,</span><span class="dt">log}</span></span>
<span id="cb51-88"><a href="control.html#cb51-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-89"><a href="control.html#cb51-89" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){arr[$1]=$2;next}{print $1, $2, arr[$2], $4, $5, $6}&#39;</span> <span class="op">&gt;</span> geno-control.bim2 maps-hapmap3-control.txt geno-control.bim</span>
<span id="cb51-90"><a href="control.html#cb51-90" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-control.bim geno-control.bim0</span>
<span id="cb51-91"><a href="control.html#cb51-91" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-control.bim2 geno-control.bim</span>
<span id="cb51-92"><a href="control.html#cb51-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-93"><a href="control.html#cb51-93" aria-hidden="true" tabindex="-1"></a><span class="co"># compute tagging under gcta----------------------------------------------------</span></span>
<span id="cb51-94"><a href="control.html#cb51-94" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> tagging-control</span>
<span id="cb51-95"><a href="control.html#cb51-95" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-96"><a href="control.html#cb51-96" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb51-97"><a href="control.html#cb51-97" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb51-98"><a href="control.html#cb51-98" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb51-99"><a href="control.html#cb51-99" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb51-100"><a href="control.html#cb51-100" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb51-101"><a href="control.html#cb51-101" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb51-102"><a href="control.html#cb51-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-103"><a href="control.html#cb51-103" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../tagging-control/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb51-104"><a href="control.html#cb51-104" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-control </span><span class="dt">\</span></span>
<span id="cb51-105"><a href="control.html#cb51-105" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb51-106"><a href="control.html#cb51-106" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb51-107"><a href="control.html#cb51-107" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb51-108"><a href="control.html#cb51-108" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb51-109"><a href="control.html#cb51-109" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span></span>
<span id="cb51-110"><a href="control.html#cb51-110" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb51-111"><a href="control.html#cb51-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-112"><a href="control.html#cb51-112" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-113"><a href="control.html#cb51-113" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span> </span>
<span id="cb51-114"><a href="control.html#cb51-114" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-gcta-hapmap3-control</span>
<span id="cb51-115"><a href="control.html#cb51-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-116"><a href="control.html#cb51-116" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb51-117"><a href="control.html#cb51-117" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-gcta-hapmap3-control</span>
<span id="cb51-118"><a href="control.html#cb51-118" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb51-119"><a href="control.html#cb51-119" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb51-120"><a href="control.html#cb51-120" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-121"><a href="control.html#cb51-121" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb51-122"><a href="control.html#cb51-122" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb51-123"><a href="control.html#cb51-123" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb51-124"><a href="control.html#cb51-124" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb51-125"><a href="control.html#cb51-125" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb51-126"><a href="control.html#cb51-126" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb51-127"><a href="control.html#cb51-127" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb51-128"><a href="control.html#cb51-128" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb51-129"><a href="control.html#cb51-129" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb51-130"><a href="control.html#cb51-130" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb51-131"><a href="control.html#cb51-131" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb51-132"><a href="control.html#cb51-132" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb51-133"><a href="control.html#cb51-133" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb51-134"><a href="control.html#cb51-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-135"><a href="control.html#cb51-135" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb51-136"><a href="control.html#cb51-136" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb51-137"><a href="control.html#cb51-137" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb51-138"><a href="control.html#cb51-138" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-control/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb51-139"><a href="control.html#cb51-139" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb51-140"><a href="control.html#cb51-140" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> tagging-control/gcta-hapmap3 <span class="at">--taglist</span> list.txt</span>
<span id="cb51-141"><a href="control.html#cb51-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-142"><a href="control.html#cb51-142" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb51-143"><a href="control.html#cb51-143" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> sumher-control</span>
<span id="cb51-144"><a href="control.html#cb51-144" aria-hidden="true" tabindex="-1"></a><span class="va">dirin1</span><span class="op">=</span>tagging-control</span>
<span id="cb51-145"><a href="control.html#cb51-145" aria-hidden="true" tabindex="-1"></a><span class="va">dirin2</span><span class="op">=</span>gwas-control</span>
<span id="cb51-146"><a href="control.html#cb51-146" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>sumher-control</span>
<span id="cb51-147"><a href="control.html#cb51-147" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-148"><a href="control.html#cb51-148" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb51-149"><a href="control.html#cb51-149" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb51-150"><a href="control.html#cb51-150" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb51-151"><a href="control.html#cb51-151" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb51-152"><a href="control.html#cb51-152" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb51-153"><a href="control.html#cb51-153" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb51-154"><a href="control.html#cb51-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-155"><a href="control.html#cb51-155" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-sumher-gcta </span><span class="dt">\</span></span>
<span id="cb51-156"><a href="control.html#cb51-156" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../</span><span class="va">$dirin1</span><span class="st">/gcta-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb51-157"><a href="control.html#cb51-157" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../</span><span class="va">$dirin2</span><span class="st">/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb51-158"><a href="control.html#cb51-158" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb51-159"><a href="control.html#cb51-159" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb51-160"><a href="control.html#cb51-160" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-gcta</span>
<span id="cb51-161"><a href="control.html#cb51-161" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb51-162"><a href="control.html#cb51-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-163"><a href="control.html#cb51-163" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb51-164"><a href="control.html#cb51-164" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-gcta</span>
<span id="cb51-165"><a href="control.html#cb51-165" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-gcta-control</span></code></pre></div>
</div>
<div id="under-ldak-thin-3" class="section level3" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> under ldak-thin</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="control.html#cb52-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2"><a href="control.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get weights-------------------------------------------------------------------</span></span>
<span id="cb52-3"><a href="control.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> ldak-thin/ldak-thin-control.in <span class="st">&#39;{print $1, 1}&#39;</span> <span class="op">&gt;</span> ldak-thin/weights.ldak-thin-control</span>
<span id="cb52-4"><a href="control.html#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="control.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate tagging under ldak-thin---------------------------------------------</span></span>
<span id="cb52-6"><a href="control.html#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>tagging-control</span>
<span id="cb52-7"><a href="control.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="va">filein1</span><span class="op">=</span>geno-control</span>
<span id="cb52-8"><a href="control.html#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="va">filein2</span><span class="op">=</span>weights.ldak-thin-control</span>
<span id="cb52-9"><a href="control.html#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-10"><a href="control.html#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb52-11"><a href="control.html#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb52-12"><a href="control.html#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 40G</span></span>
<span id="cb52-13"><a href="control.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb52-14"><a href="control.html#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb52-15"><a href="control.html#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb52-16"><a href="control.html#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../</span><span class="va">$dirout</span><span class="st">/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb52-17"><a href="control.html#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein1</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb52-18"><a href="control.html#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --weights ../ldak-thin/</span><span class="va">$filein2</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb52-19"><a href="control.html#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -.25 </span><span class="dt">\</span></span>
<span id="cb52-20"><a href="control.html#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb52-21"><a href="control.html#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb52-22"><a href="control.html#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --save-matrix YES </span><span class="dt">\</span></span>
<span id="cb52-23"><a href="control.html#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb52-24"><a href="control.html#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb52-25"><a href="control.html#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-26"><a href="control.html#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="control.html#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># submit scripts</span></span>
<span id="cb52-28"><a href="control.html#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-29"><a href="control.html#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb52-30"><a href="control.html#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-ldak-thin-control</span>
<span id="cb52-31"><a href="control.html#cb52-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-32"><a href="control.html#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb52-33"><a href="control.html#cb52-33" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-ldak-thin-control</span>
<span id="cb52-34"><a href="control.html#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb52-35"><a href="control.html#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb52-36"><a href="control.html#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-37"><a href="control.html#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb52-38"><a href="control.html#cb52-38" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb52-39"><a href="control.html#cb52-39" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb52-40"><a href="control.html#cb52-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb52-41"><a href="control.html#cb52-41" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb52-42"><a href="control.html#cb52-42" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-43"><a href="control.html#cb52-43" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb52-44"><a href="control.html#cb52-44" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb52-45"><a href="control.html#cb52-45" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb52-46"><a href="control.html#cb52-46" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb52-47"><a href="control.html#cb52-47" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb52-48"><a href="control.html#cb52-48" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb52-49"><a href="control.html#cb52-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb52-50"><a href="control.html#cb52-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-51"><a href="control.html#cb52-51" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb52-52"><a href="control.html#cb52-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb52-53"><a href="control.html#cb52-53" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> matlist.txt</span>
<span id="cb52-54"><a href="control.html#cb52-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-55"><a href="control.html#cb52-55" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-control/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb52-56"><a href="control.html#cb52-56" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-control/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.matrix&quot;</span> <span class="op">&gt;&gt;</span> matlist.txt</span>
<span id="cb52-57"><a href="control.html#cb52-57" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-58"><a href="control.html#cb52-58" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>tagging-control</span>
<span id="cb52-59"><a href="control.html#cb52-59" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> <span class="va">$dirout</span>/ldak-thin-hapmap3 <span class="at">--taglist</span> list.txt <span class="at">--matlist</span> matlist.txt</span>
<span id="cb52-60"><a href="control.html#cb52-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-61"><a href="control.html#cb52-61" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb52-62"><a href="control.html#cb52-62" aria-hidden="true" tabindex="-1"></a><span class="va">dirin1</span><span class="op">=</span>tagging-control</span>
<span id="cb52-63"><a href="control.html#cb52-63" aria-hidden="true" tabindex="-1"></a><span class="va">dirin2</span><span class="op">=</span>gwas-control</span>
<span id="cb52-64"><a href="control.html#cb52-64" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>sumher-control</span>
<span id="cb52-65"><a href="control.html#cb52-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-66"><a href="control.html#cb52-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb52-67"><a href="control.html#cb52-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb52-68"><a href="control.html#cb52-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb52-69"><a href="control.html#cb52-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb52-70"><a href="control.html#cb52-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb52-71"><a href="control.html#cb52-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb52-72"><a href="control.html#cb52-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-73"><a href="control.html#cb52-73" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-sumher-ldak-thin </span><span class="dt">\</span></span>
<span id="cb52-74"><a href="control.html#cb52-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../</span><span class="va">$dirin1</span><span class="st">/ldak-thin-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb52-75"><a href="control.html#cb52-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../</span><span class="va">$dirin2</span><span class="st">/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb52-76"><a href="control.html#cb52-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb52-77"><a href="control.html#cb52-77" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb52-78"><a href="control.html#cb52-78" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-ldak-thin</span>
<span id="cb52-79"><a href="control.html#cb52-79" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-80"><a href="control.html#cb52-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-81"><a href="control.html#cb52-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-82"><a href="control.html#cb52-82" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-ldak-thin</span>
<span id="cb52-83"><a href="control.html#cb52-83" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-ldak-thin-control</span></code></pre></div>
</div>
<div id="summary-7" class="section level3" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> summary</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="control.html#cb53-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2"><a href="control.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span>control</span>
<span id="cb53-3"><a href="control.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="control.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># original ldsc</span></span>
<span id="cb53-5"><a href="control.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ldsc/out-control</span>
<span id="cb53-6"><a href="control.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept <span class="pp">*</span>ldsc.log <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[-]/); split($3, b, /[()]/); print a[1], $2, b[2]}&#39;</span> <span class="op">&gt;</span> ../../summary/ldsc-<span class="va">$nm</span></span>
<span id="cb53-7"><a href="control.html#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="control.html#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sumher under gcta</span></span>
<span id="cb53-9"><a href="control.html#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> sumher-control</span>
<span id="cb53-10"><a href="control.html#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-<span class="va">$nm</span>-est</span>
<span id="cb53-11"><a href="control.html#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-<span class="va">$nm</span>-sd</span>
<span id="cb53-12"><a href="control.html#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb53-13"><a href="control.html#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-gcta-<span class="va">$nm</span>-est sumher-gcta-<span class="va">$nm</span>-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-gcta-<span class="va">$nm</span></span>
<span id="cb53-14"><a href="control.html#cb53-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-15"><a href="control.html#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># suhmer under ldak-thin</span></span>
<span id="cb53-16"><a href="control.html#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-<span class="va">$nm</span>-est</span>
<span id="cb53-17"><a href="control.html#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-<span class="va">$nm</span>-sd</span>
<span id="cb53-18"><a href="control.html#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb53-19"><a href="control.html#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-ldak-thin-<span class="va">$nm</span>-est sumher-ldak-thin-<span class="va">$nm</span>-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-ldak-thin-<span class="va">$nm</span></span></code></pre></div>
</div>
</div>
<div id="he-3" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> HE</h2>
<div id="making-grms-3" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> making grms</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="control.html#cb54-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-2"><a href="control.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># making grm -------------------------------------------------------------------</span></span>
<span id="cb54-3"><a href="control.html#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="control.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb54-5"><a href="control.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb54-6"><a href="control.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb54-7"><a href="control.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="va">fileout</span><span class="op">=</span>gcta-all-control</span>
<span id="cb54-8"><a href="control.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="va">filein</span><span class="op">=</span>geno-control</span>
<span id="cb54-9"><a href="control.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>snps-control-gwas.use</span>
<span id="cb54-10"><a href="control.html#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="control.html#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># all snps</span></span>
<span id="cb54-12"><a href="control.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-13"><a href="control.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-14"><a href="control.html#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb54-15"><a href="control.html#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb54-16"><a href="control.html#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb54-17"><a href="control.html#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-18"><a href="control.html#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="control.html#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb54-20"><a href="control.html#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/</span><span class="va">$fileout</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-21"><a href="control.html#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-22"><a href="control.html#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-23"><a href="control.html#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb54-24"><a href="control.html#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb54-25"><a href="control.html#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb54-26"><a href="control.html#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-all-snps</span>
<span id="cb54-27"><a href="control.html#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="control.html#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-all-snps <span class="op">&gt;</span> ../job-records/grm-all-snps-control</span>
<span id="cb54-29"><a href="control.html#cb54-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-30"><a href="control.html#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb54-31"><a href="control.html#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&lt;8 {print $2}&#39;</span> geno-control.bim <span class="op">&gt;</span> left-snps-control.use </span>
<span id="cb54-32"><a href="control.html#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&gt;=8 {print $2}&#39;</span> geno-control.bim <span class="op">&gt;</span> right-snps-control.use</span>
<span id="cb54-33"><a href="control.html#cb54-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-34"><a href="control.html#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="va">filein</span><span class="op">=</span>geno-control</span>
<span id="cb54-35"><a href="control.html#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-36"><a href="control.html#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-37"><a href="control.html#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-38"><a href="control.html#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb54-39"><a href="control.html#cb54-39" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb54-40"><a href="control.html#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb54-41"><a href="control.html#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-42"><a href="control.html#cb54-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-43"><a href="control.html#cb54-43" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb54-44"><a href="control.html#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/gcta-</span><span class="va">$i</span><span class="st">-control </span><span class="dt">\</span></span>
<span id="cb54-45"><a href="control.html#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-46"><a href="control.html#cb54-46" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-snps-control.use </span><span class="dt">\</span></span>
<span id="cb54-47"><a href="control.html#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb54-48"><a href="control.html#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb54-49"><a href="control.html#cb54-49" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb54-50"><a href="control.html#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-gcta-<span class="va">$i</span></span>
<span id="cb54-51"><a href="control.html#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-52"><a href="control.html#cb54-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-53"><a href="control.html#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-54"><a href="control.html#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-gcta-<span class="va">$i</span> </span>
<span id="cb54-55"><a href="control.html#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-gcta-by-snps-control</span>
<span id="cb54-56"><a href="control.html#cb54-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-57"><a href="control.html#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb54-58"><a href="control.html#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb54-59"><a href="control.html#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb54-60"><a href="control.html#cb54-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-61"><a href="control.html#cb54-61" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb54-62"><a href="control.html#cb54-62" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. thin snps</span></span>
<span id="cb54-63"><a href="control.html#cb54-63" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb54-64"><a href="control.html#cb54-64" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>snps-control-gwas.use</span>
<span id="cb54-65"><a href="control.html#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="va">filein</span><span class="op">=</span>geno-control</span>
<span id="cb54-66"><a href="control.html#cb54-66" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-67"><a href="control.html#cb54-67" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-68"><a href="control.html#cb54-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-69"><a href="control.html#cb54-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb54-70"><a href="control.html#cb54-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 4</span></span>
<span id="cb54-71"><a href="control.html#cb54-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 4:0:0</span></span>
<span id="cb54-72"><a href="control.html#cb54-72" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-73"><a href="control.html#cb54-73" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 4 </span><span class="dt">\</span></span>
<span id="cb54-74"><a href="control.html#cb54-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-prune 0.98 </span><span class="dt">\</span></span>
<span id="cb54-75"><a href="control.html#cb54-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-kb 100 </span><span class="dt">\</span></span>
<span id="cb54-76"><a href="control.html#cb54-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-77"><a href="control.html#cb54-77" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-78"><a href="control.html#cb54-78" aria-hidden="true" tabindex="-1"></a><span class="st">          --thin ../ldak-thin/chr</span><span class="va">$j</span><span class="st">-control </span><span class="dt">\</span></span>
<span id="cb54-79"><a href="control.html#cb54-79" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb54-80"><a href="control.html#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin<span class="va">$j</span></span>
<span id="cb54-81"><a href="control.html#cb54-81" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-82"><a href="control.html#cb54-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-83"><a href="control.html#cb54-83" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb54-84"><a href="control.html#cb54-84" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-85"><a href="control.html#cb54-85" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin<span class="va">$j</span></span>
<span id="cb54-86"><a href="control.html#cb54-86" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/ldak-thin-control</span>
<span id="cb54-87"><a href="control.html#cb54-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-88"><a href="control.html#cb54-88" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion---</span></span>
<span id="cb54-89"><a href="control.html#cb54-89" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/ldak-thin-control</span>
<span id="cb54-90"><a href="control.html#cb54-90" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb54-91"><a href="control.html#cb54-91" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb54-92"><a href="control.html#cb54-92" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-93"><a href="control.html#cb54-93" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb54-94"><a href="control.html#cb54-94" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb54-95"><a href="control.html#cb54-95" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb54-96"><a href="control.html#cb54-96" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb54-97"><a href="control.html#cb54-97" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb54-98"><a href="control.html#cb54-98" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-99"><a href="control.html#cb54-99" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb54-100"><a href="control.html#cb54-100" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb54-101"><a href="control.html#cb54-101" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb54-102"><a href="control.html#cb54-102" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb54-103"><a href="control.html#cb54-103" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb54-104"><a href="control.html#cb54-104" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb54-105"><a href="control.html#cb54-105" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb54-106"><a href="control.html#cb54-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-107"><a href="control.html#cb54-107" aria-hidden="true" tabindex="-1"></a><span class="co"># combine snp list</span></span>
<span id="cb54-108"><a href="control.html#cb54-108" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> ldak-thin/chr{1..22}-control.in <span class="op">&gt;</span> ldak-thin/ldak-thin-control.in</span>
<span id="cb54-109"><a href="control.html#cb54-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-110"><a href="control.html#cb54-110" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------</span></span>
<span id="cb54-111"><a href="control.html#cb54-111" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. kinship matrix under ldak-thin</span></span>
<span id="cb54-112"><a href="control.html#cb54-112" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------</span></span>
<span id="cb54-113"><a href="control.html#cb54-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-114"><a href="control.html#cb54-114" aria-hidden="true" tabindex="-1"></a><span class="va">fileout</span><span class="op">=</span>ldak-thin-all-control</span>
<span id="cb54-115"><a href="control.html#cb54-115" aria-hidden="true" tabindex="-1"></a><span class="va">filein</span><span class="op">=</span>geno-control</span>
<span id="cb54-116"><a href="control.html#cb54-116" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>ldak-thin-control.in</span>
<span id="cb54-117"><a href="control.html#cb54-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-118"><a href="control.html#cb54-118" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-119"><a href="control.html#cb54-119" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-120"><a href="control.html#cb54-120" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb54-121"><a href="control.html#cb54-121" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb54-122"><a href="control.html#cb54-122" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb54-123"><a href="control.html#cb54-123" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-124"><a href="control.html#cb54-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-125"><a href="control.html#cb54-125" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb54-126"><a href="control.html#cb54-126" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/</span><span class="va">$fileout</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-127"><a href="control.html#cb54-127" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-128"><a href="control.html#cb54-128" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../ldak-thin/</span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-129"><a href="control.html#cb54-129" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb54-130"><a href="control.html#cb54-130" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb54-131"><a href="control.html#cb54-131" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb54-132"><a href="control.html#cb54-132" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-all-snps</span>
<span id="cb54-133"><a href="control.html#cb54-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-134"><a href="control.html#cb54-134" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-all-snps <span class="op">&gt;</span> ../job-records/ldak-thin-grm-all-snps-control</span>
<span id="cb54-135"><a href="control.html#cb54-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-136"><a href="control.html#cb54-136" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb54-137"><a href="control.html#cb54-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-138"><a href="control.html#cb54-138" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&lt;8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb54-139"><a href="control.html#cb54-139" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-control.in <span class="op">&gt;</span> gen/left-ldak-thin-control.snps </span>
<span id="cb54-140"><a href="control.html#cb54-140" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&gt;=8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb54-141"><a href="control.html#cb54-141" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-control.in <span class="op">&gt;</span> gen/right-ldak-thin-control.snps </span>
<span id="cb54-142"><a href="control.html#cb54-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-143"><a href="control.html#cb54-143" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-144"><a href="control.html#cb54-144" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-145"><a href="control.html#cb54-145" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-146"><a href="control.html#cb54-146" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb54-147"><a href="control.html#cb54-147" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb54-148"><a href="control.html#cb54-148" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb54-149"><a href="control.html#cb54-149" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-150"><a href="control.html#cb54-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-151"><a href="control.html#cb54-151" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb54-152"><a href="control.html#cb54-152" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/ldak-thin-</span><span class="va">$i</span><span class="st">-control </span><span class="dt">\</span></span>
<span id="cb54-153"><a href="control.html#cb54-153" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-control </span><span class="dt">\</span></span>
<span id="cb54-154"><a href="control.html#cb54-154" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-ldak-thin-control.snps </span><span class="dt">\</span></span>
<span id="cb54-155"><a href="control.html#cb54-155" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb54-156"><a href="control.html#cb54-156" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb54-157"><a href="control.html#cb54-157" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb54-158"><a href="control.html#cb54-158" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-<span class="va">$i</span></span>
<span id="cb54-159"><a href="control.html#cb54-159" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-160"><a href="control.html#cb54-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-161"><a href="control.html#cb54-161" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-162"><a href="control.html#cb54-162" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-<span class="va">$i</span> </span>
<span id="cb54-163"><a href="control.html#cb54-163" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-ldak-thin-by-snps-control</span></code></pre></div>
</div>
<div id="estimation-3" class="section level3" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> estimation</h3>
<p>NEED To check what covariates to adjust for HE
basic.covariates.use or covariates.use?</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="control.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regress grm on covariates-----------------------------------------------------</span></span>
<span id="cb55-2"><a href="control.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="control.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-control gcta-left-control gcta-right-control ldak-thin-all-control ldak-thin-left-control ldak-thin-right-control<span class="kw">;</span> <span class="cf">do</span>  </span>
<span id="cb55-4"><a href="control.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb55-5"><a href="control.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb55-6"><a href="control.html#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb55-7"><a href="control.html#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 50G</span></span>
<span id="cb55-8"><a href="control.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb55-9"><a href="control.html#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb55-10"><a href="control.html#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --adjust-grm ../kinship/</span><span class="va">$grm</span><span class="st">.covar </span><span class="dt">\</span></span>
<span id="cb55-11"><a href="control.html#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/</span><span class="va">$grm</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb55-12"><a href="control.html#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb55-13"><a href="control.html#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb55-14"><a href="control.html#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb55-15"><a href="control.html#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-16"><a href="control.html#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="control.html#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb55-18"><a href="control.html#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-control gcta-left-control gcta-right-control ldak-thin-all-control ldak-thin-left-control ldak-thin-right-control<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-19"><a href="control.html#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb55-20"><a href="control.html#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-adjust-for-HE-control</span>
<span id="cb55-21"><a href="control.html#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="control.html#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb55-23"><a href="control.html#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/grm-adjust-for-HE-control</span>
<span id="cb55-24"><a href="control.html#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb55-25"><a href="control.html#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb55-26"><a href="control.html#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-27"><a href="control.html#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb55-28"><a href="control.html#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb55-29"><a href="control.html#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb55-30"><a href="control.html#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb55-31"><a href="control.html#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb55-32"><a href="control.html#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-33"><a href="control.html#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb55-34"><a href="control.html#cb55-34" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb55-35"><a href="control.html#cb55-35" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb55-36"><a href="control.html#cb55-36" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb55-37"><a href="control.html#cb55-37" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb55-38"><a href="control.html#cb55-38" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb55-39"><a href="control.html#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb55-40"><a href="control.html#cb55-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-41"><a href="control.html#cb55-41" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under gcta-----------------------------------------------------------------</span></span>
<span id="cb55-42"><a href="control.html#cb55-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-43"><a href="control.html#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> he-control</span>
<span id="cb55-44"><a href="control.html#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>he-control</span>
<span id="cb55-45"><a href="control.html#cb55-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-46"><a href="control.html#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-47"><a href="control.html#cb55-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb55-48"><a href="control.html#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb55-49"><a href="control.html#cb55-49" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb55-50"><a href="control.html#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb55-51"><a href="control.html#cb55-51" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb55-52"><a href="control.html#cb55-52" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb55-53"><a href="control.html#cb55-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-54"><a href="control.html#cb55-54" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-he-gcta-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb55-55"><a href="control.html#cb55-55" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb55-56"><a href="control.html#cb55-56" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/gcta-</span><span class="va">$k</span><span class="st">-control.covar </span><span class="dt">\</span></span>
<span id="cb55-57"><a href="control.html#cb55-57" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb55-58"><a href="control.html#cb55-58" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb55-59"><a href="control.html#cb55-59" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb55-60"><a href="control.html#cb55-60" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb55-61"><a href="control.html#cb55-61" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb55-62"><a href="control.html#cb55-62" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps-control.sh</span>
<span id="cb55-63"><a href="control.html#cb55-63" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-64"><a href="control.html#cb55-64" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-65"><a href="control.html#cb55-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-66"><a href="control.html#cb55-66" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb55-67"><a href="control.html#cb55-67" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-68"><a href="control.html#cb55-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-69"><a href="control.html#cb55-69" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps-control.sh</span>
<span id="cb55-70"><a href="control.html#cb55-70" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-71"><a href="control.html#cb55-71" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-gcta-control</span>
<span id="cb55-72"><a href="control.html#cb55-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-73"><a href="control.html#cb55-73" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under ldak-thin------------------------------------------------------------</span></span>
<span id="cb55-74"><a href="control.html#cb55-74" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>he-control</span>
<span id="cb55-75"><a href="control.html#cb55-75" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-76"><a href="control.html#cb55-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-77"><a href="control.html#cb55-77" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb55-78"><a href="control.html#cb55-78" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb55-79"><a href="control.html#cb55-79" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb55-80"><a href="control.html#cb55-80" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb55-81"><a href="control.html#cb55-81" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb55-82"><a href="control.html#cb55-82" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 0:30:0</span></span>
<span id="cb55-83"><a href="control.html#cb55-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-84"><a href="control.html#cb55-84" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-he-ldak-thin-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb55-85"><a href="control.html#cb55-85" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb55-86"><a href="control.html#cb55-86" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/ldak-thin-</span><span class="va">$k</span><span class="st">-control.covar </span><span class="dt">\</span></span>
<span id="cb55-87"><a href="control.html#cb55-87" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb55-88"><a href="control.html#cb55-88" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb55-89"><a href="control.html#cb55-89" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb55-90"><a href="control.html#cb55-90" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb55-91"><a href="control.html#cb55-91" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb55-92"><a href="control.html#cb55-92" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-control.sh</span>
<span id="cb55-93"><a href="control.html#cb55-93" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-94"><a href="control.html#cb55-94" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-95"><a href="control.html#cb55-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-96"><a href="control.html#cb55-96" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb55-97"><a href="control.html#cb55-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-98"><a href="control.html#cb55-98" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-99"><a href="control.html#cb55-99" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-control.sh</span>
<span id="cb55-100"><a href="control.html#cb55-100" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-101"><a href="control.html#cb55-101" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-ldak-thin-control</span></code></pre></div>
</div>
<div id="summary-8" class="section level3" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> summary</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="control.html#cb56-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-2"><a href="control.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb56-3"><a href="control.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb56-4"><a href="control.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb56-5"><a href="control.html#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="control.html#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span>control</span>
<span id="cb56-7"><a href="control.html#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb56-8"><a href="control.html#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb56-9"><a href="control.html#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-<span class="va">$nm</span>.right </span>
<span id="cb56-10"><a href="control.html#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb56-11"><a href="control.html#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-<span class="va">$nm</span>/<span class="va">$i</span>-he-gcta-right.he</span>
<span id="cb56-12"><a href="control.html#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-<span class="va">$nm</span>.right</span>
<span id="cb56-13"><a href="control.html#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb56-14"><a href="control.html#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="control.html#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb56-16"><a href="control.html#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-<span class="va">$nm</span>.left</span>
<span id="cb56-17"><a href="control.html#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb56-18"><a href="control.html#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-<span class="va">$nm</span>/<span class="va">$i</span>-he-gcta-left.he</span>
<span id="cb56-19"><a href="control.html#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-<span class="va">$nm</span>.left</span>
<span id="cb56-20"><a href="control.html#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb56-21"><a href="control.html#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="control.html#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb56-23"><a href="control.html#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-<span class="va">$nm</span>.all</span>
<span id="cb56-24"><a href="control.html#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb56-25"><a href="control.html#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-<span class="va">$nm</span>/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb56-26"><a href="control.html#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-<span class="va">$nm</span>.all</span>
<span id="cb56-27"><a href="control.html#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb56-28"><a href="control.html#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="control.html#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb56-30"><a href="control.html#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb56-31"><a href="control.html#cb56-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-32"><a href="control.html#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-control.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb56-33"><a href="control.html#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-control.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb56-34"><a href="control.html#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-control.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb56-35"><a href="control.html#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb56-36"><a href="control.html#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb56-37"><a href="control.html#cb56-37" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb56-38"><a href="control.html#cb56-38" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-39"><a href="control.html#cb56-39" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-40"><a href="control.html#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-41"><a href="control.html#cb56-41" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-42"><a href="control.html#cb56-42" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-43"><a href="control.html#cb56-43" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb56-44"><a href="control.html#cb56-44" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb56-45"><a href="control.html#cb56-45" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb56-46"><a href="control.html#cb56-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-47"><a href="control.html#cb56-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb56-48"><a href="control.html#cb56-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-49"><a href="control.html#cb56-49" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb56-50"><a href="control.html#cb56-50" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb56-51"><a href="control.html#cb56-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb56-52"><a href="control.html#cb56-52" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb56-53"><a href="control.html#cb56-53" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb56-54"><a href="control.html#cb56-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb56-55"><a href="control.html#cb56-55" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb56-56"><a href="control.html#cb56-56" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb56-57"><a href="control.html#cb56-57" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb56-58"><a href="control.html#cb56-58" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb56-59"><a href="control.html#cb56-59" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb56-60"><a href="control.html#cb56-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-61"><a href="control.html#cb56-61" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb56-62"><a href="control.html#cb56-62" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb56-63"><a href="control.html#cb56-63" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb56-64"><a href="control.html#cb56-64" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb56-65"><a href="control.html#cb56-65" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb56-66"><a href="control.html#cb56-66" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb56-67"><a href="control.html#cb56-67" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb56-68"><a href="control.html#cb56-68" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb56-69"><a href="control.html#cb56-69" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb56-70"><a href="control.html#cb56-70" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb56-71"><a href="control.html#cb56-71" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-gcta-inflation-control.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb56-72"><a href="control.html#cb56-72" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb56-73"><a href="control.html#cb56-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-74"><a href="control.html#cb56-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-75"><a href="control.html#cb56-75" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb56-76"><a href="control.html#cb56-76" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb56-77"><a href="control.html#cb56-77" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb56-78"><a href="control.html#cb56-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-79"><a href="control.html#cb56-79" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span>control</span>
<span id="cb56-80"><a href="control.html#cb56-80" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb56-81"><a href="control.html#cb56-81" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb56-82"><a href="control.html#cb56-82" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-<span class="va">$nm</span>.right </span>
<span id="cb56-83"><a href="control.html#cb56-83" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb56-84"><a href="control.html#cb56-84" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-<span class="va">$nm</span>/<span class="va">$i</span>-he-ldak-thin-right.he</span>
<span id="cb56-85"><a href="control.html#cb56-85" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-<span class="va">$nm</span>.right</span>
<span id="cb56-86"><a href="control.html#cb56-86" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb56-87"><a href="control.html#cb56-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-88"><a href="control.html#cb56-88" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb56-89"><a href="control.html#cb56-89" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-<span class="va">$nm</span>.left</span>
<span id="cb56-90"><a href="control.html#cb56-90" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb56-91"><a href="control.html#cb56-91" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-<span class="va">$nm</span>/<span class="va">$i</span>-he-ldak-thin-left.he</span>
<span id="cb56-92"><a href="control.html#cb56-92" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-<span class="va">$nm</span>.left</span>
<span id="cb56-93"><a href="control.html#cb56-93" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb56-94"><a href="control.html#cb56-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-95"><a href="control.html#cb56-95" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb56-96"><a href="control.html#cb56-96" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-<span class="va">$nm</span>.all</span>
<span id="cb56-97"><a href="control.html#cb56-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb56-98"><a href="control.html#cb56-98" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-<span class="va">$nm</span>/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb56-99"><a href="control.html#cb56-99" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-<span class="va">$nm</span>.all</span>
<span id="cb56-100"><a href="control.html#cb56-100" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb56-101"><a href="control.html#cb56-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-102"><a href="control.html#cb56-102" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb56-103"><a href="control.html#cb56-103" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb56-104"><a href="control.html#cb56-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-105"><a href="control.html#cb56-105" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-control.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb56-106"><a href="control.html#cb56-106" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-control.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb56-107"><a href="control.html#cb56-107" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-control.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb56-108"><a href="control.html#cb56-108" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb56-109"><a href="control.html#cb56-109" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb56-110"><a href="control.html#cb56-110" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb56-111"><a href="control.html#cb56-111" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-112"><a href="control.html#cb56-112" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-113"><a href="control.html#cb56-113" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-114"><a href="control.html#cb56-114" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-115"><a href="control.html#cb56-115" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb56-116"><a href="control.html#cb56-116" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb56-117"><a href="control.html#cb56-117" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb56-118"><a href="control.html#cb56-118" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb56-119"><a href="control.html#cb56-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-120"><a href="control.html#cb56-120" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb56-121"><a href="control.html#cb56-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-122"><a href="control.html#cb56-122" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb56-123"><a href="control.html#cb56-123" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb56-124"><a href="control.html#cb56-124" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb56-125"><a href="control.html#cb56-125" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb56-126"><a href="control.html#cb56-126" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb56-127"><a href="control.html#cb56-127" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb56-128"><a href="control.html#cb56-128" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb56-129"><a href="control.html#cb56-129" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb56-130"><a href="control.html#cb56-130" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb56-131"><a href="control.html#cb56-131" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb56-132"><a href="control.html#cb56-132" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb56-133"><a href="control.html#cb56-133" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-134"><a href="control.html#cb56-134" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb56-135"><a href="control.html#cb56-135" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb56-136"><a href="control.html#cb56-136" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb56-137"><a href="control.html#cb56-137" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb56-138"><a href="control.html#cb56-138" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb56-139"><a href="control.html#cb56-139" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb56-140"><a href="control.html#cb56-140" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb56-141"><a href="control.html#cb56-141" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb56-142"><a href="control.html#cb56-142" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb56-143"><a href="control.html#cb56-143" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb56-144"><a href="control.html#cb56-144" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-inflation-control.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb56-145"><a href="control.html#cb56-145" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ukbb.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="compute-sum_ijm_1-m_2r2_ij.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04.4-control-gwas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
