<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 previous GWAS | GWAS Quality Control</title>
  <meta name="description" content="12 previous GWAS | GWAS Quality Control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="12 previous GWAS | GWAS Quality Control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 previous GWAS | GWAS Quality Control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="control.html"/>
<link rel="next" href="gwas-white-british-irish.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>2</b> summary</a></li>
<li class="chapter" data-level="3" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>3</b> Summaries</a>
<ul>
<li class="chapter" data-level="3.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>3.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>3.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>3.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>3.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>3.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>3.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>3.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>3.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>3.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>3.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>3.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>3.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>4</b> summary</a></li>
<li class="chapter" data-level="5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>5</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>5.1</b> test statistics ~ LD score</a></li>
<li class="chapter" data-level="5.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#new-models"><i class="fa fa-check"></i><b>5.2</b> New models?</a></li>
<li class="chapter" data-level="5.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ld-scores-based-on-individual-level-data"><i class="fa fa-check"></i><b>5.3</b> LD scores based on individual level data</a></li>
<li class="chapter" data-level="5.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-the-new-model"><i class="fa fa-check"></i><b>5.4</b> Test the new model</a></li>
<li class="chapter" data-level="5.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predictors-of-inflation"><i class="fa fa-check"></i><b>5.5</b> predictors of inflation?</a></li>
<li class="chapter" data-level="5.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#regress-chisq-mean-r2_j"><i class="fa fa-check"></i><b>5.6</b> regress chisq ~ mean r^2_j</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plots"><i class="fa fa-check"></i><b>5.6.1</b> plots</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predict-inflation-aver2_j"><i class="fa fa-check"></i><b>5.7</b> predict inflation | aver2_j ?</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good_chisq-vs.-adj_chisq"><i class="fa fa-check"></i><b>5.7.1</b> good_chisq vs. adj_chisq</a></li>
<li class="chapter" data-level="5.7.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>5.7.2</b> bad gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="5.7.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>5.7.3</b> bad gwas: inf. vs. inf._hat: ave</a></li>
<li class="chapter" data-level="5.7.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-from-full-model"><i class="fa fa-check"></i><b>5.7.4</b> bad gwas: inf. from full model</a></li>
<li class="chapter" data-level="5.7.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#to-explore-change"><i class="fa fa-check"></i><b>5.7.5</b> To Explore: change??</a></li>
<li class="chapter" data-level="5.7.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>5.7.6</b> good gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="5.7.7" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>5.7.7</b> good gwas: inf. vs. inf._hat: ave</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ukbb_337k_inflation"><i class="fa fa-check"></i><b>5.8</b> UKBB N = 337k</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#organize-data"><i class="fa fa-check"></i><b>5.8.1</b> organize data</a></li>
<li class="chapter" data-level="5.8.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plot"><i class="fa fa-check"></i><b>5.8.2</b> plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mathematical-details.html"><a href="mathematical-details.html"><i class="fa fa-check"></i><b>6</b> Mathematical Details</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mathematical-details.html"><a href="mathematical-details.html#trk_rightk_left"><i class="fa fa-check"></i><b>6.1</b> <span class="math inline">\(tr(K_{right}K_{left})\)</span></a></li>
<li class="chapter" data-level="6.2" data-path="mathematical-details.html"><a href="mathematical-details.html#verification"><i class="fa fa-check"></i><b>6.2</b> verification</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html"><i class="fa fa-check"></i><b>7</b> chi square ~ <span class="math inline">\(\overline{r^2_j}\)</span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#overliner2_j-choice-of-snps"><i class="fa fa-check"></i><b>7.1</b> <span class="math inline">\(\overline{r^2_j}\)</span> &amp; choice of SNPs</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#number-of-snps"><i class="fa fa-check"></i><b>7.1.1</b> number of SNPs</a></li>
<li class="chapter" data-level="7.1.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#maf"><i class="fa fa-check"></i><b>7.1.2</b> maf</a></li>
<li class="chapter" data-level="7.1.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#summary-2"><i class="fa fa-check"></i><b>7.1.3</b> summary</a></li>
<li class="chapter" data-level="7.1.4" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#final-plots"><i class="fa fa-check"></i><b>7.1.4</b> Final plots</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#varying-levels-of-confouding"><i class="fa fa-check"></i><b>7.2</b> varying levels of confouding</a></li>
<li class="chapter" data-level="7.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#results-summary"><i class="fa fa-check"></i><b>7.3</b> results summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>8</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>8.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="8.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>8.2</b> extract covariates</a></li>
<li class="chapter" data-level="8.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>8.3</b> GWAS</a></li>
<li class="chapter" data-level="8.4" data-path="good.html"><a href="good.html#chisq-aver2_j"><i class="fa fa-check"></i><b>8.4</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="8.5" data-path="good.html"><a href="good.html#ldsc-interce"><i class="fa fa-check"></i><b>8.5</b> ldsc interce</a></li>
<li class="chapter" data-level="8.6" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>8.6</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>8.6.1</b> under gcta</a></li>
<li class="chapter" data-level="8.6.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>8.6.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="8.6.3" data-path="good.html"><a href="good.html#summary-3"><i class="fa fa-check"></i><b>8.6.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>8.7</b> REML</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>8.7.1</b> making grms</a></li>
<li class="chapter" data-level="8.7.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>8.7.2</b> fast-reml</a></li>
<li class="chapter" data-level="8.7.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>8.7.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>8.8</b> HE</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>8.8.1</b> estimation</a></li>
<li class="chapter" data-level="8.8.2" data-path="good.html"><a href="good.html#summary-4"><i class="fa fa-check"></i><b>8.8.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>9</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>9.1</b> ID list</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>9.1.1</b> initial selection</a></li>
<li class="chapter" data-level="9.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>9.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="9.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>9.1.3</b> final list</a></li>
<li class="chapter" data-level="9.1.4" data-path="bad.html"><a href="bad.html#pc-plot"><i class="fa fa-check"></i><b>9.1.4</b> PC plot</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bad.html"><a href="bad.html#gwas-lm"><i class="fa fa-check"></i><b>9.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="bad.html"><a href="bad.html#basic-cov"><i class="fa fa-check"></i><b>9.2.1</b> basic cov</a></li>
<li class="chapter" data-level="9.2.2" data-path="bad.html"><a href="bad.html#basic-cov-pc"><i class="fa fa-check"></i><b>9.2.2</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="bad.html"><a href="bad.html#gwas-bolt-lmm"><i class="fa fa-check"></i><b>9.3</b> GWAS-bolt-lmm</a></li>
<li class="chapter" data-level="9.4" data-path="bad.html"><a href="bad.html#correct-genotypes"><i class="fa fa-check"></i><b>9.4</b> correct genotypes</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="bad.html"><a href="bad.html#cal-aver2"><i class="fa fa-check"></i><b>9.4.1</b> cal-aver2</a></li>
<li class="chapter" data-level="9.4.2" data-path="bad.html"><a href="bad.html#compare-changes-in-aver2"><i class="fa fa-check"></i><b>9.4.2</b> compare changes in aver2</a></li>
<li class="chapter" data-level="9.4.3" data-path="bad.html"><a href="bad.html#chisq-aver2"><i class="fa fa-check"></i><b>9.4.3</b> chisq ~ aver2</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="bad.html"><a href="bad.html#chisq-aver2_j-1"><i class="fa fa-check"></i><b>9.5</b> chisq ~ aver2_j</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="bad.html"><a href="bad.html#calc-aver2_j"><i class="fa fa-check"></i><b>9.5.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="9.5.2" data-path="bad.html"><a href="bad.html#bolt-lmm"><i class="fa fa-check"></i><b>9.5.2</b> bolt-lmm</a></li>
<li class="chapter" data-level="9.5.3" data-path="bad.html"><a href="bad.html#basic-cov-pc-1"><i class="fa fa-check"></i><b>9.5.3</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>9.6</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>9.6.1</b> under gcta</a></li>
<li class="chapter" data-level="9.6.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>9.6.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="9.6.3" data-path="bad.html"><a href="bad.html#summary-5"><i class="fa fa-check"></i><b>9.6.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>9.7</b> REML</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>9.7.1</b> making grms</a></li>
<li class="chapter" data-level="9.7.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>9.7.2</b> fast-reml</a></li>
<li class="chapter" data-level="9.7.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>9.7.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>9.8</b> HE</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>9.8.1</b> estimation</a></li>
<li class="chapter" data-level="9.8.2" data-path="bad.html"><a href="bad.html#summary-6"><i class="fa fa-check"></i><b>9.8.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>10</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>10.1</b> total N = 337k</a></li>
<li class="chapter" data-level="10.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>10.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="10.3" data-path="ukbb.html"><a href="ukbb.html#gwas-100k"><i class="fa fa-check"></i><b>10.3</b> GWAS-100k</a></li>
<li class="chapter" data-level="10.4" data-path="ukbb.html"><a href="ukbb.html#gwas-337k"><i class="fa fa-check"></i><b>10.4</b> GWAS-337k</a></li>
<li class="chapter" data-level="10.5" data-path="ukbb.html"><a href="ukbb.html#ldsc-100k"><i class="fa fa-check"></i><b>10.5</b> ldsc-100k</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>10.5.1</b> under gcta</a></li>
<li class="chapter" data-level="10.5.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>10.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="10.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-7"><i class="fa fa-check"></i><b>10.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="ukbb.html"><a href="ukbb.html#ldsc-337k"><i class="fa fa-check"></i><b>10.6</b> ldsc-337k</a></li>
<li class="chapter" data-level="10.7" data-path="ukbb.html"><a href="ukbb.html#aver2_j-337k"><i class="fa fa-check"></i><b>10.7</b> aver2_j-337k</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="ukbb.html"><a href="ukbb.html#calc"><i class="fa fa-check"></i><b>10.7.1</b> calc</a></li>
<li class="chapter" data-level="10.7.2" data-path="ukbb.html"><a href="ukbb.html#organize-data-1"><i class="fa fa-check"></i><b>10.7.2</b> organize data</a></li>
<li class="chapter" data-level="10.7.3" data-path="ukbb.html"><a href="ukbb.html#chisq-aver2_j-2"><i class="fa fa-check"></i><b>10.7.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>10.8</b> HE</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>10.8.1</b> making grms</a></li>
<li class="chapter" data-level="10.8.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>10.8.2</b> estimation</a></li>
<li class="chapter" data-level="10.8.3" data-path="ukbb.html"><a href="ukbb.html#summary-8"><i class="fa fa-check"></i><b>10.8.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>11</b> control GWAS</a>
<ul>
<li class="chapter" data-level="11.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>11.1</b> ID list</a></li>
<li class="chapter" data-level="11.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>11.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="11.3" data-path="control.html"><a href="control.html#gwas-1"><i class="fa fa-check"></i><b>11.3</b> GWAS</a></li>
<li class="chapter" data-level="11.4" data-path="control.html"><a href="control.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>11.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>11.4.1</b> under gcta</a></li>
<li class="chapter" data-level="11.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>11.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="11.4.3" data-path="control.html"><a href="control.html#summary-9"><i class="fa fa-check"></i><b>11.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>11.5</b> HE</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>11.5.1</b> making grms</a></li>
<li class="chapter" data-level="11.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>11.5.2</b> estimation</a></li>
<li class="chapter" data-level="11.5.3" data-path="control.html"><a href="control.html#summary-10"><i class="fa fa-check"></i><b>11.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="previous-gwas.html"><a href="previous-gwas.html"><i class="fa fa-check"></i><b>12</b> previous GWAS</a>
<ul>
<li class="chapter" data-level="12.1" data-path="previous-gwas.html"><a href="previous-gwas.html#qc"><i class="fa fa-check"></i><b>12.1</b> QC</a></li>
<li class="chapter" data-level="12.2" data-path="previous-gwas.html"><a href="previous-gwas.html#gwas-telomere-length"><i class="fa fa-check"></i><b>12.2</b> gwas-telomere length</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="previous-gwas.html"><a href="previous-gwas.html#aver2_j"><i class="fa fa-check"></i><b>12.2.1</b> aver2_j</a></li>
<li class="chapter" data-level="12.2.2" data-path="previous-gwas.html"><a href="previous-gwas.html#organize-data-2"><i class="fa fa-check"></i><b>12.2.2</b> organize data</a></li>
<li class="chapter" data-level="12.2.3" data-path="previous-gwas.html"><a href="previous-gwas.html#chisq-aver2_j-3"><i class="fa fa-check"></i><b>12.2.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="previous-gwas.html"><a href="previous-gwas.html#pr-interval-gwas"><i class="fa fa-check"></i><b>12.3</b> PR interval GWAS</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="previous-gwas.html"><a href="previous-gwas.html#aver2_j-1"><i class="fa fa-check"></i><b>12.3.1</b> aver2_j</a></li>
<li class="chapter" data-level="12.3.2" data-path="previous-gwas.html"><a href="previous-gwas.html#organize-data-3"><i class="fa fa-check"></i><b>12.3.2</b> organize data</a></li>
<li class="chapter" data-level="12.3.3" data-path="previous-gwas.html"><a href="previous-gwas.html#chisq-aver2_j-4"><i class="fa fa-check"></i><b>12.3.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="previous-gwas.html"><a href="previous-gwas.html#ben-neale-pan-ukbb"><i class="fa fa-check"></i><b>12.4</b> Ben Neale Pan-UKBB</a></li>
<li class="chapter" data-level="12.5" data-path="previous-gwas.html"><a href="previous-gwas.html#notesconcerns"><i class="fa fa-check"></i><b>12.5</b> notes/concerns</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html"><i class="fa fa-check"></i><b>13</b> GWAS: White British + Irish</a>
<ul>
<li class="chapter" data-level="13.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#id-list-1"><i class="fa fa-check"></i><b>13.1</b> ID list</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ids-who-have-no-missing-data"><i class="fa fa-check"></i><b>13.1.1</b> Ids who have no missing data</a></li>
<li class="chapter" data-level="13.1.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#relatedness-filtering-1"><i class="fa fa-check"></i><b>13.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="13.1.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#pc-plot-1"><i class="fa fa-check"></i><b>13.1.3</b> PC plot</a></li>
<li class="chapter" data-level="13.1.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#phenotypic-differences"><i class="fa fa-check"></i><b>13.1.4</b> phenotypic differences</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#gwas-lm-1"><i class="fa fa-check"></i><b>13.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#basic-covariates"><i class="fa fa-check"></i><b>13.2.1</b> basic covariates</a></li>
<li class="chapter" data-level="13.2.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#basic-covariates-pcs"><i class="fa fa-check"></i><b>13.2.2</b> basic covariates + PCs</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#chisq-aver2_j-5"><i class="fa fa-check"></i><b>13.3</b> chisq ~ aver2_j</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#calc-aver2_j-1"><i class="fa fa-check"></i><b>13.3.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="13.3.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#organize-data-4"><i class="fa fa-check"></i><b>13.3.2</b> organize data</a></li>
<li class="chapter" data-level="13.3.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#detect-confounding-wt-pcs"><i class="fa fa-check"></i><b>13.3.3</b> detect confounding: w/t PCs</a></li>
<li class="chapter" data-level="13.3.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#detect-confounding-with-pcs"><i class="fa fa-check"></i><b>13.3.4</b> detect confounding: with PCs</a></li>
<li class="chapter" data-level="13.3.5" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#inflation-good-gwas-vs.-control-vs.-british-irish"><i class="fa fa-check"></i><b>13.3.5</b> inflation: good gwas vs. control vs. british-irish</a></li>
<li class="chapter" data-level="13.3.6" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#inflation-aver2"><i class="fa fa-check"></i><b>13.3.6</b> inflation | aver2</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ideas-to-explore-to-do-list"><i class="fa fa-check"></i><b>13.4</b> Ideas to explore/ to do list:</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="related-individuals.html"><a href="related-individuals.html"><i class="fa fa-check"></i><b>14</b> related individuals</a>
<ul>
<li class="chapter" data-level="14.1" data-path="related-individuals.html"><a href="related-individuals.html#genotyped-snps"><i class="fa fa-check"></i><b>14.1</b> genotyped SNPs</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-2"><i class="fa fa-check"></i><b>14.1.1</b> aver2_j</a></li>
<li class="chapter" data-level="14.1.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-2"><i class="fa fa-check"></i><b>14.1.2</b> gwas</a></li>
<li class="chapter" data-level="14.1.3" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-5"><i class="fa fa-check"></i><b>14.1.3</b> organize data</a></li>
<li class="chapter" data-level="14.1.4" data-path="related-individuals.html"><a href="related-individuals.html#summary-11"><i class="fa fa-check"></i><b>14.1.4</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="related-individuals.html"><a href="related-individuals.html#hapmap3-snps"><i class="fa fa-check"></i><b>14.2</b> hapmap3 SNPs</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype-data"><i class="fa fa-check"></i><b>14.2.1</b> genotype data</a></li>
<li class="chapter" data-level="14.2.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-3"><i class="fa fa-check"></i><b>14.2.2</b> gwas</a></li>
<li class="chapter" data-level="14.2.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-3"><i class="fa fa-check"></i><b>14.2.3</b> aver2_j</a></li>
<li class="chapter" data-level="14.2.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-6"><i class="fa fa-check"></i><b>14.2.4</b> organize data</a></li>
<li class="chapter" data-level="14.2.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-6"><i class="fa fa-check"></i><b>14.2.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="14.2.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j"><i class="fa fa-check"></i><b>14.2.6</b> inflation ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="related-individuals.html"><a href="related-individuals.html#mix-unrel-rel"><i class="fa fa-check"></i><b>14.3</b> mix unrel &amp; rel</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype"><i class="fa fa-check"></i><b>14.3.1</b> genotype</a></li>
<li class="chapter" data-level="14.3.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-4"><i class="fa fa-check"></i><b>14.3.2</b> gwas</a></li>
<li class="chapter" data-level="14.3.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-4"><i class="fa fa-check"></i><b>14.3.3</b> aver2_j</a></li>
<li class="chapter" data-level="14.3.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-7"><i class="fa fa-check"></i><b>14.3.4</b> organize data</a></li>
<li class="chapter" data-level="14.3.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-7"><i class="fa fa-check"></i><b>14.3.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="14.3.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j-1"><i class="fa fa-check"></i><b>14.3.6</b> inflation ~ aver2_j</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html"><i class="fa fa-check"></i><b>15</b> compute <span class="math inline">\(\sum_{i,j}^{m_1, m_2}r^2_{i,j}\)</span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwas-all-qced-snps"><i class="fa fa-check"></i><b>15.1</b> good GWAS-all qced snps</a></li>
<li class="chapter" data-level="15.2" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwass--ldak-thin-snps"><i class="fa fa-check"></i><b>15.2</b> good GWASs- ldak-thin snps</a></li>
<li class="chapter" data-level="15.3" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#bad-gwass-all-qced-snps"><i class="fa fa-check"></i><b>15.3</b> bad GWASs-all qced snps</a></li>
<li class="chapter" data-level="15.4" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#summary-12"><i class="fa fa-check"></i><b>15.4</b> summary</a></li>
<li class="chapter" data-level="15.5" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#aver2j"><i class="fa fa-check"></i><b>15.5</b> compute aver2_j</a></li>
<li class="chapter" data-level="15.6" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#mixed-pop-gwas-with-pc-as-covariates"><i class="fa fa-check"></i><b>15.6</b> mixed pop GWAS with PC as covariates</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="assortative-mating.html"><a href="assortative-mating.html"><i class="fa fa-check"></i><b>16</b> Assortative mating</a>
<ul>
<li class="chapter" data-level="16.1" data-path="assortative-mating.html"><a href="assortative-mating.html#test-the-idea"><i class="fa fa-check"></i><b>16.1</b> Test the idea</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="assortative-mating.html"><a href="assortative-mating.html#st-try"><i class="fa fa-check"></i><b>16.1.1</b> 1st try</a></li>
<li class="chapter" data-level="16.1.2" data-path="assortative-mating.html"><a href="assortative-mating.html#nd-try"><i class="fa fa-check"></i><b>16.1.2</b> 2nd try</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html"><i class="fa fa-check"></i><b>17</b> Reference Panel: 1k Genome</a>
<ul>
<li class="chapter" data-level="17.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#common-snplist"><i class="fa fa-check"></i><b>17.1</b> common snplist</a></li>
<li class="chapter" data-level="17.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#compute-aver2"><i class="fa fa-check"></i><b>17.2</b> compute aver2</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-1"><i class="fa fa-check"></i><b>17.2.1</b> bad gwas</a></li>
<li class="chapter" data-level="17.2.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding"><i class="fa fa-check"></i><b>17.2.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="17.2.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-1"><i class="fa fa-check"></i><b>17.2.3</b> good gwas</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#detect-confounding"><i class="fa fa-check"></i><b>17.3</b> detect confounding</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-2"><i class="fa fa-check"></i><b>17.3.1</b> bad gwas</a></li>
<li class="chapter" data-level="17.3.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding-1"><i class="fa fa-check"></i><b>17.3.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="17.3.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-2"><i class="fa fa-check"></i><b>17.3.3</b> good gwas</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#estimate-inflation"><i class="fa fa-check"></i><b>17.4</b> estimate inflation</a></li>
<li class="chapter" data-level="17.5" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#stratified-aver2"><i class="fa fa-check"></i><b>17.5</b> stratified aver2</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#calc-aver2"><i class="fa fa-check"></i><b>17.5.1</b> calc aver2</a></li>
<li class="chapter" data-level="17.5.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#organize-data-8"><i class="fa fa-check"></i><b>17.5.2</b> organize data</a></li>
<li class="chapter" data-level="17.5.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#plot-aver2-of-pairwise-mixture-pops"><i class="fa fa-check"></i><b>17.5.3</b> plot aver2 of pairwise mixture pops</a></li>
<li class="chapter" data-level="17.5.4" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#chisq-1-x-aver2"><i class="fa fa-check"></i><b>17.5.4</b> chisq ~ 1 x aver2</a></li>
<li class="chapter" data-level="17.5.5" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#chisq-multi-aver2"><i class="fa fa-check"></i><b>17.5.5</b> chisq ~ multi-aver2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html"><i class="fa fa-check"></i><b>18</b> Fine-scale population stratification</a>
<ul>
<li class="chapter" data-level="18.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#birth-location-data"><i class="fa fa-check"></i><b>18.1</b> birth location data</a></li>
<li class="chapter" data-level="18.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#pca-of-337k"><i class="fa fa-check"></i><b>18.2</b> pca of 337k</a></li>
<li class="chapter" data-level="18.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#birth-place-gwas"><i class="fa fa-check"></i><b>18.3</b> birth place gwas</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-5"><i class="fa fa-check"></i><b>18.3.1</b> gwas</a></li>
<li class="chapter" data-level="18.3.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#chisq-aver2-1"><i class="fa fa-check"></i><b>18.3.2</b> chisq ~ aver2</a></li>
<li class="chapter" data-level="18.3.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#detect-inflation-using-1kg"><i class="fa fa-check"></i><b>18.3.3</b> detect inflation using 1kg</a></li>
<li class="chapter" data-level="18.3.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-results"><i class="fa fa-check"></i><b>18.3.4</b> gwas results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-based-on-pc-clusters"><i class="fa fa-check"></i><b>18.4</b> GWAS based on PC clusters</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-lists"><i class="fa fa-check"></i><b>18.4.1</b> id lists</a></li>
<li class="chapter" data-level="18.4.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-list-for-bad-gwas2"><i class="fa fa-check"></i><b>18.4.2</b> id list for bad gwas2</a></li>
<li class="chapter" data-level="18.4.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-list-for-bad-gwas3"><i class="fa fa-check"></i><b>18.4.3</b> id list for bad gwas3</a></li>
<li class="chapter" data-level="18.4.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-3"><i class="fa fa-check"></i><b>18.4.4</b> bad gwas</a></li>
<li class="chapter" data-level="18.4.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2"><i class="fa fa-check"></i><b>18.4.5</b> bad gwas#2</a></li>
<li class="chapter" data-level="18.4.6" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3"><i class="fa fa-check"></i><b>18.4.6</b> bad gwas#3</a></li>
<li class="chapter" data-level="18.4.7" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-3"><i class="fa fa-check"></i><b>18.4.7</b> good gwas</a></li>
<li class="chapter" data-level="18.4.8" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-1"><i class="fa fa-check"></i><b>18.4.8</b> control gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#compute-aver2-1"><i class="fa fa-check"></i><b>18.5</b> compute aver2</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-4"><i class="fa fa-check"></i><b>18.5.1</b> bad-gwas</a></li>
<li class="chapter" data-level="18.5.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2-1"><i class="fa fa-check"></i><b>18.5.2</b> bad-gwas#2</a></li>
<li class="chapter" data-level="18.5.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3-1"><i class="fa fa-check"></i><b>18.5.3</b> bad-gwas#3</a></li>
<li class="chapter" data-level="18.5.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-4"><i class="fa fa-check"></i><b>18.5.4</b> good-gwas</a></li>
<li class="chapter" data-level="18.5.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-2"><i class="fa fa-check"></i><b>18.5.5</b> control-gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#chisq-aver2-2"><i class="fa fa-check"></i><b>18.6</b> chisq ~ aver2</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-5"><i class="fa fa-check"></i><b>18.6.1</b> bad gwas</a></li>
<li class="chapter" data-level="18.6.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2-2"><i class="fa fa-check"></i><b>18.6.2</b> bad gwas#2</a></li>
<li class="chapter" data-level="18.6.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3-2"><i class="fa fa-check"></i><b>18.6.3</b> bad gwas#3</a></li>
<li class="chapter" data-level="18.6.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-5"><i class="fa fa-check"></i><b>18.6.4</b> good gwas</a></li>
<li class="chapter" data-level="18.6.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-3"><i class="fa fa-check"></i><b>18.6.5</b> control gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#inflation-aver2-1"><i class="fa fa-check"></i><b>18.7</b> inflation ~ aver2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GWAS Quality Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="previous-gwas" class="section level1" number="12">
<h1><span class="header-section-number">12</span> previous GWAS</h1>
<p>Here we conduct a GWAS that mimic the QC steps taken by some of the most inclusive GWAS studies. For example, the GWAS conducted by Codd et al. (2021) on telomere length has the following QC step, which resulted in n = 472,174 and m = 19.4 million SNPs</p>
<blockquote>
<p>We used imputed genotypes available in the UKB2 for the GWAS. To ensure quality, we restricted the analysis to variants with a MAF of ≥0.1% (where imputation accuracy is greatest) and an INFO score of ≥0.3. We tested 19.4 million variants using the BOLT-LMM package, adjusting for age, sex, array and the first ten principal components (PCs). The analysis was run separately for chromosome 23, where males were coded as 0/2.</p>
</blockquote>
<p>Here we want to test if the test statistics from GWAS conducted in such a way are inflated using the proposed method. We do not have access to telomere length, but we can use the 14 traits as examples instead.</p>
<div id="qc" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> QC</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb91-1"><a href="previous-gwas.html#cb91-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-2"><a href="previous-gwas.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb91-3"><a href="previous-gwas.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract covariates</span></span>
<span id="cb91-4"><a href="previous-gwas.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb91-5"><a href="previous-gwas.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This has been done under &#39;Good GWAS&#39; section. Here we just want to extract from the file</span></span>
<span id="cb91-6"><a href="previous-gwas.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb91-7"><a href="previous-gwas.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="va">scipen</span><span class="op">=</span>999<span class="kw">)</span></span>
<span id="cb91-8"><a href="previous-gwas.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb91-9"><a href="previous-gwas.html#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;phen/covariates.phen&quot;</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb91-10"><a href="previous-gwas.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="va">pc</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;pc&quot;</span><span class="ex">,1:10</span><span class="kw">)</span></span>
<span id="cb91-11"><a href="previous-gwas.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="va">cov</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span><span class="st">&quot;age&quot;</span><span class="ex">,</span><span class="st">&quot;geno_batch&quot;</span><span class="ex">,pc</span><span class="kw">)</span></span>
<span id="cb91-12"><a href="previous-gwas.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>dat[,cov]</span>
<span id="cb91-13"><a href="previous-gwas.html#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="previous-gwas.html#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span><span class="st">&quot;phen/covariates-inclusive-gwas.use&quot;</span><span class="ex">,</span> col.names=F,</span>
<span id="cb91-15"><a href="previous-gwas.html#cb91-15" aria-hidden="true" tabindex="-1"></a>            <span class="ex">row.names=F,</span> quote=F<span class="kw">)</span></span>
<span id="cb91-16"><a href="previous-gwas.html#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">cov,</span><span class="st">&quot;phen/covariates-inclusive-gwas.use-names&quot;</span><span class="ex">,</span> col.names=F,</span>
<span id="cb91-17"><a href="previous-gwas.html#cb91-17" aria-hidden="true" tabindex="-1"></a>            <span class="ex">row.names=F,</span> quote=F<span class="kw">)</span></span>
<span id="cb91-18"><a href="previous-gwas.html#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="previous-gwas.html#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="va">sel</span><span class="op">=</span>out[complete.cases<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,]</span> <span class="co"># n = 488,244</span></span>
<span id="cb91-20"><a href="previous-gwas.html#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="va">sel</span><span class="op">[</span>,1:2<span class="op">]</span><span class="ex">,</span> <span class="st">&quot;complete-cases-covariates-inclusive-gwas.id&quot;</span>, col.names=F,</span>
<span id="cb91-21"><a href="previous-gwas.html#cb91-21" aria-hidden="true" tabindex="-1"></a>            <span class="ex">row.names=F,</span> quote=F<span class="kw">)</span></span>
<span id="cb91-22"><a href="previous-gwas.html#cb91-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-23"><a href="previous-gwas.html#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb91-24"><a href="previous-gwas.html#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="co"># id list of complete cases: covariates &amp; phenotypes</span></span>
<span id="cb91-25"><a href="previous-gwas.html#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb91-26"><a href="previous-gwas.html#cb91-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-27"><a href="previous-gwas.html#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="co"># note: to remain as much people as possible, we did not select all 14 traits. but 9.</span></span>
<span id="cb91-28"><a href="previous-gwas.html#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="co"># for these traits, n = 467, 104 have complete data</span></span>
<span id="cb91-29"><a href="previous-gwas.html#cb91-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> complete-cases-covariates-inclusive-gwas.id inclusive-gwas.id</span>
<span id="cb91-30"><a href="previous-gwas.html#cb91-30" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>phen/continuous-traits/</span>
<span id="cb91-31"><a href="previous-gwas.html#cb91-31" aria-hidden="true" tabindex="-1"></a><span class="co"># {awake,bmi,chron,ever,fvc,height,imp,neur,pulse,quals,reaction,sbp,snoring,hyper}</span></span>
<span id="cb91-32"><a href="previous-gwas.html#cb91-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-33"><a href="previous-gwas.html#cb91-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> inclusive-gwas.id temp</span>
<span id="cb91-34"><a href="previous-gwas.html#cb91-34" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $1, $2}&#39;</span> temp <span class="va">$dir</span>/<span class="va">$tt</span>.raw.pheno <span class="op">&gt;</span> inclusive-gwas.id</span>
<span id="cb91-35"><a href="previous-gwas.html#cb91-35" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> inclusive-gwas.id</span>
<span id="cb91-36"><a href="previous-gwas.html#cb91-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$tt</span></span>
<span id="cb91-37"><a href="previous-gwas.html#cb91-37" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb91-38"><a href="previous-gwas.html#cb91-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> temp</span>
<span id="cb91-39"><a href="previous-gwas.html#cb91-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-40"><a href="previous-gwas.html#cb91-40" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb91-41"><a href="previous-gwas.html#cb91-41" aria-hidden="true" tabindex="-1"></a><span class="co"># extract genotypes</span></span>
<span id="cb91-42"><a href="previous-gwas.html#cb91-42" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb91-43"><a href="previous-gwas.html#cb91-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-44"><a href="previous-gwas.html#cb91-44" aria-hidden="true" tabindex="-1"></a><span class="co"># QC SNPs-----------------------------------------------------------------------</span></span>
<span id="cb91-45"><a href="previous-gwas.html#cb91-45" aria-hidden="true" tabindex="-1"></a><span class="co"># stating number of SNPs=</span></span>
<span id="cb91-46"><a href="previous-gwas.html#cb91-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-47"><a href="previous-gwas.html#cb91-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb91-48"><a href="previous-gwas.html#cb91-48" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb91-49"><a href="previous-gwas.html#cb91-49" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb91-50"><a href="previous-gwas.html#cb91-50" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb91-51"><a href="previous-gwas.html#cb91-51" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb91-52"><a href="previous-gwas.html#cb91-52" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb91-53"><a href="previous-gwas.html#cb91-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-54"><a href="previous-gwas.html#cb91-54" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb91-55"><a href="previous-gwas.html#cb91-55" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../inclusive-gwas.id </span><span class="dt">\</span></span>
<span id="cb91-56"><a href="previous-gwas.html#cb91-56" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb91-57"><a href="previous-gwas.html#cb91-57" aria-hidden="true" tabindex="-1"></a><span class="st">         --maf 0.001 </span><span class="dt">\</span></span>
<span id="cb91-58"><a href="previous-gwas.html#cb91-58" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb91-59"><a href="previous-gwas.html#cb91-59" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.3 2 </span><span class="dt">\</span></span>
<span id="cb91-60"><a href="previous-gwas.html#cb91-60" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb91-61"><a href="previous-gwas.html#cb91-61" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb91-62"><a href="previous-gwas.html#cb91-62" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb91-63"><a href="previous-gwas.html#cb91-63" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb91-64"><a href="previous-gwas.html#cb91-64" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb91-65"><a href="previous-gwas.html#cb91-65" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb91-66"><a href="previous-gwas.html#cb91-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-67"><a href="previous-gwas.html#cb91-67" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb91-68"><a href="previous-gwas.html#cb91-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-69"><a href="previous-gwas.html#cb91-69" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb91-70"><a href="previous-gwas.html#cb91-70" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/qc-inclusive-gwas</span>
<span id="cb91-71"><a href="previous-gwas.html#cb91-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-72"><a href="previous-gwas.html#cb91-72" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb91-73"><a href="previous-gwas.html#cb91-73" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/qc-inclusive-gwas</span>
<span id="cb91-74"><a href="previous-gwas.html#cb91-74" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb91-75"><a href="previous-gwas.html#cb91-75" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb91-76"><a href="previous-gwas.html#cb91-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-77"><a href="previous-gwas.html#cb91-77" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp</span>
<span id="cb91-78"><a href="previous-gwas.html#cb91-78" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb91-79"><a href="previous-gwas.html#cb91-79" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb91-80"><a href="previous-gwas.html#cb91-80" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb91-81"><a href="previous-gwas.html#cb91-81" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb91-82"><a href="previous-gwas.html#cb91-82" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb91-83"><a href="previous-gwas.html#cb91-83" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb91-84"><a href="previous-gwas.html#cb91-84" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb91-85"><a href="previous-gwas.html#cb91-85" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb91-86"><a href="previous-gwas.html#cb91-86" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb91-87"><a href="previous-gwas.html#cb91-87" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb91-88"><a href="previous-gwas.html#cb91-88" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb91-89"><a href="previous-gwas.html#cb91-89" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb91-90"><a href="previous-gwas.html#cb91-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-91"><a href="previous-gwas.html#cb91-91" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files-------------------------------------------------------------------</span></span>
<span id="cb91-92"><a href="previous-gwas.html#cb91-92" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> gen/bfile-inclusive-gwas.list</span>
<span id="cb91-93"><a href="previous-gwas.html#cb91-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-94"><a href="previous-gwas.html#cb91-94" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> gen/bfile-inclusive-gwas.list</span>
<span id="cb91-95"><a href="previous-gwas.html#cb91-95" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb91-96"><a href="previous-gwas.html#cb91-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-97"><a href="previous-gwas.html#cb91-97" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb91-98"><a href="previous-gwas.html#cb91-98" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb91-99"><a href="previous-gwas.html#cb91-99" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb91-100"><a href="previous-gwas.html#cb91-100" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 80G</span></span>
<span id="cb91-101"><a href="previous-gwas.html#cb91-101" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb91-102"><a href="previous-gwas.html#cb91-102" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb91-103"><a href="previous-gwas.html#cb91-103" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-inclusive-gwas </span><span class="dt">\</span></span>
<span id="cb91-104"><a href="previous-gwas.html#cb91-104" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile-inclusive-gwas.list </span><span class="dt">\</span></span>
<span id="cb91-105"><a href="previous-gwas.html#cb91-105" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb91-106"><a href="previous-gwas.html#cb91-106" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES</span></span>
<span id="cb91-107"><a href="previous-gwas.html#cb91-107" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-inclusive-gwas.sh</span>
<span id="cb91-108"><a href="previous-gwas.html#cb91-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-109"><a href="previous-gwas.html#cb91-109" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script-------------------------------------------------------------</span></span>
<span id="cb91-110"><a href="previous-gwas.html#cb91-110" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-inclusive-gwas.sh <span class="op">&gt;</span>../job-records/mbfile-inclusive-gwas</span>
<span id="cb91-111"><a href="previous-gwas.html#cb91-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-112"><a href="previous-gwas.html#cb91-112" aria-hidden="true" tabindex="-1"></a><span class="co"># compute info score------------------------------------------------------------</span></span>
<span id="cb91-113"><a href="previous-gwas.html#cb91-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-114"><a href="previous-gwas.html#cb91-114" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb91-115"><a href="previous-gwas.html#cb91-115" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb91-116"><a href="previous-gwas.html#cb91-116" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb91-117"><a href="previous-gwas.html#cb91-117" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb91-118"><a href="previous-gwas.html#cb91-118" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb91-119"><a href="previous-gwas.html#cb91-119" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb91-120"><a href="previous-gwas.html#cb91-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-121"><a href="previous-gwas.html#cb91-121" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb91-122"><a href="previous-gwas.html#cb91-122" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb91-123"><a href="previous-gwas.html#cb91-123" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../inclusive-gwas.id </span><span class="dt">\</span></span>
<span id="cb91-124"><a href="previous-gwas.html#cb91-124" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb91-125"><a href="previous-gwas.html#cb91-125" aria-hidden="true" tabindex="-1"></a><span class="st">         --freq cols=chrom,ref,alt,altfreq,machr2 </span><span class="dt">\</span></span>
<span id="cb91-126"><a href="previous-gwas.html#cb91-126" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/info/chr</span><span class="va">$j</span></span>
<span id="cb91-127"><a href="previous-gwas.html#cb91-127" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb91-128"><a href="previous-gwas.html#cb91-128" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb91-129"><a href="previous-gwas.html#cb91-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-130"><a href="previous-gwas.html#cb91-130" aria-hidden="true" tabindex="-1"></a><span class="co"># submit file-------------------------------------------------------------------</span></span>
<span id="cb91-131"><a href="previous-gwas.html#cb91-131" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-132"><a href="previous-gwas.html#cb91-132" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb91-133"><a href="previous-gwas.html#cb91-133" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/compute-info-score-inclusive-gwas</span>
<span id="cb91-134"><a href="previous-gwas.html#cb91-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-135"><a href="previous-gwas.html#cb91-135" aria-hidden="true" tabindex="-1"></a><span class="co"># combine files ----------------------------------------------------------------</span></span>
<span id="cb91-136"><a href="previous-gwas.html#cb91-136" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>gen/info</span>
<span id="cb91-137"><a href="previous-gwas.html#cb91-137" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$dir</span>/inclusive-gwas-afreq</span>
<span id="cb91-138"><a href="previous-gwas.html#cb91-138" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb91-139"><a href="previous-gwas.html#cb91-139" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$i</span> <span class="ot">==</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb91-140"><a href="previous-gwas.html#cb91-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>.afreq <span class="op">&gt;</span> <span class="va">$dir</span>/inclusive-gwas-afreq</span>
<span id="cb91-141"><a href="previous-gwas.html#cb91-141" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb91-142"><a href="previous-gwas.html#cb91-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>.afreq <span class="op">&gt;&gt;</span> <span class="va">$dir</span>/inclusive-gwas-afreq</span>
<span id="cb91-143"><a href="previous-gwas.html#cb91-143" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb91-144"><a href="previous-gwas.html#cb91-144" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb91-145"><a href="previous-gwas.html#cb91-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-146"><a href="previous-gwas.html#cb91-146" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::</span></span>
<span id="cb91-147"><a href="previous-gwas.html#cb91-147" aria-hidden="true" tabindex="-1"></a><span class="co"># SNP list</span></span>
<span id="cb91-148"><a href="previous-gwas.html#cb91-148" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::</span></span>
<span id="cb91-149"><a href="previous-gwas.html#cb91-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-150"><a href="previous-gwas.html#cb91-150" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate</span></span>
<span id="cb91-151"><a href="previous-gwas.html#cb91-151" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> gen/bfile-inclusive-gwas.stat <span class="st">&#39;($5&gt;.001 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> snps-inclusive-gwas.use</span>
<span id="cb91-152"><a href="previous-gwas.html#cb91-152" aria-hidden="true" tabindex="-1"></a><span class="co"># m = SNPs</span></span></code></pre></div>
</div>
<div id="gwas-telomere-length" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> gwas-telomere length</h2>
<div id="aver2_j" class="section level3" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> aver2_j</h3>
<p>Here we want to check for evidence of inflation in the telomere GWAS statistics (Codd et al. 2021) due to confouding from population stratification.</p>
<p>Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>download the GWAS stats (<a href="https://figshare.com/s/caa99dc0f76d62990195" class="uri">https://figshare.com/s/caa99dc0f76d62990195</a>)</li>
<li>randomly chose 10k SNPs from each side of the genome</li>
<li>compute aver2_j for the 20k SNPs</li>
<li>check if the chi square test stats vary with respect to aver2_j.</li>
</ol>
<p>We show below that the slope of the regression line is not sig. different from zero. Hence, there is no evidence of confounding by the proposed method. It should be noted though that we used the genotype data of n = 487,409 individuals to compute aver2_j, and the original GWAS was based on n = 472,174.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb92-1"><a href="previous-gwas.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-2"><a href="previous-gwas.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># select SNPs &amp; organize data</span></span>
<span id="cb92-3"><a href="previous-gwas.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-4"><a href="previous-gwas.html#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="previous-gwas.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># download gwas stats-----------------------------------------------------------</span></span>
<span id="cb92-6"><a href="previous-gwas.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-telomere</span>
<span id="cb92-7"><a href="previous-gwas.html#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://figshare.com/ndownloader/files/28414941<span class="pp">?</span>private_link=caa99dc0f76d62990195</span>
<span id="cb92-8"><a href="previous-gwas.html#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 20,134,422 SNPs</span></span>
<span id="cb92-9"><a href="previous-gwas.html#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="previous-gwas.html#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co"># organize data: snp name &amp; chisq ----------------------------------------------</span></span>
<span id="cb92-11"><a href="previous-gwas.html#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gwas-telomere/UKB_telomere_gwas_summarystats.tsv.gz</span>
<span id="cb92-12"><a href="previous-gwas.html#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized</span>
<span id="cb92-13"><a href="previous-gwas.html#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&#39;\t&#39;</span> <span class="st">&#39;BEGIN {print &quot;chr base_pair_location chr_base rs chisq&quot;} </span></span>
<span id="cb92-14"><a href="previous-gwas.html#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="st">                            NR &gt;1 {print $3, $4,$3&quot;:&quot;$4, $1, ($8/$9)^2}&#39;</span> <span class="op">&gt;</span> <span class="va">$outfile</span></span>
<span id="cb92-15"><a href="previous-gwas.html#cb92-15" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb92-16"><a href="previous-gwas.html#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co"># hapmap3 SNPs------------------------------------------------------------------</span></span>
<span id="cb92-17"><a href="previous-gwas.html#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="va">infile1</span><span class="op">=</span>doug/ukbb.ldsc</span>
<span id="cb92-18"><a href="previous-gwas.html#cb92-18" aria-hidden="true" tabindex="-1"></a><span class="va">infile2</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized</span>
<span id="cb92-19"><a href="previous-gwas.html#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized-hm3</span>
<span id="cb92-20"><a href="previous-gwas.html#cb92-20" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR{a[$3];next} </span></span>
<span id="cb92-21"><a href="previous-gwas.html#cb92-21" aria-hidden="true" tabindex="-1"></a><span class="st">     ($3 in a || FNR==1 ){print $0}&#39;</span> <span class="va">$infile1</span> <span class="va">$infile2</span> <span class="op">&gt;</span> <span class="va">$outfile</span></span>
<span id="cb92-22"><a href="previous-gwas.html#cb92-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-23"><a href="previous-gwas.html#cb92-23" aria-hidden="true" tabindex="-1"></a><span class="co"># choose snp lists--------------------------------------------------------------</span></span>
<span id="cb92-24"><a href="previous-gwas.html#cb92-24" aria-hidden="true" tabindex="-1"></a><span class="co"># choose 40k for each side as the pool for selection</span></span>
<span id="cb92-25"><a href="previous-gwas.html#cb92-25" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>40000</span>
<span id="cb92-26"><a href="previous-gwas.html#cb92-26" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gwas-telomere/telemere-gwas-organized-hm3</span>
<span id="cb92-27"><a href="previous-gwas.html#cb92-27" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/gwas-telomere/left-snps-pool</span>
<span id="cb92-28"><a href="previous-gwas.html#cb92-28" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/gwas-telomere/right-snps-pool</span>
<span id="cb92-29"><a href="previous-gwas.html#cb92-29" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&lt;8 &amp;&amp; NR &gt; 1 {print $1, $2, $3}&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$left</span></span>
<span id="cb92-30"><a href="previous-gwas.html#cb92-30" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&gt;=8 &amp;&amp; NR &gt; 1 {print $1, $2, $3}&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$right</span></span>
<span id="cb92-31"><a href="previous-gwas.html#cb92-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-32"><a href="previous-gwas.html#cb92-32" aria-hidden="true" tabindex="-1"></a><span class="co"># entire snp list of ukbb</span></span>
<span id="cb92-33"><a href="previous-gwas.html#cb92-33" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>inflation/gwas-telomere/ukbb-bhr-all-snps</span>
<span id="cb92-34"><a href="previous-gwas.html#cb92-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$out</span></span>
<span id="cb92-35"><a href="previous-gwas.html#cb92-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb92-36"><a href="previous-gwas.html#cb92-36" aria-hidden="true" tabindex="-1"></a><span class="va">gen</span><span class="op">=</span>gen/geno_plink/bhr<span class="va">$i</span>.pvar</span>
<span id="cb92-37"><a href="previous-gwas.html#cb92-37" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $1&quot;:&quot;$2, $3}&#39;</span> <span class="va">$gen</span> <span class="op">&gt;&gt;</span> <span class="va">$out</span></span>
<span id="cb92-38"><a href="previous-gwas.html#cb92-38" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb92-39"><a href="previous-gwas.html#cb92-39" aria-hidden="true" tabindex="-1"></a><span class="co"># wc -l gen/geno_plink/bhr{1..22}.pvar</span></span>
<span id="cb92-40"><a href="previous-gwas.html#cb92-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-41"><a href="previous-gwas.html#cb92-41" aria-hidden="true" tabindex="-1"></a><span class="co"># put the chosen 40k snps in the right format</span></span>
<span id="cb92-42"><a href="previous-gwas.html#cb92-42" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>inflation/gwas-telomere/ukbb-bhr-all-snps</span>
<span id="cb92-43"><a href="previous-gwas.html#cb92-43" aria-hidden="true" tabindex="-1"></a><span class="va">leftin</span><span class="op">=</span>inflation/gwas-telomere/left-snps-pool</span>
<span id="cb92-44"><a href="previous-gwas.html#cb92-44" aria-hidden="true" tabindex="-1"></a><span class="va">rightin</span><span class="op">=</span>inflation/gwas-telomere/right-snps-pool</span>
<span id="cb92-45"><a href="previous-gwas.html#cb92-45" aria-hidden="true" tabindex="-1"></a><span class="va">leftout</span><span class="op">=</span>inflation/gwas-telomere/left-snps-tmp</span>
<span id="cb92-46"><a href="previous-gwas.html#cb92-46" aria-hidden="true" tabindex="-1"></a><span class="va">rightout</span><span class="op">=</span>inflation/gwas-telomere/right-snps-tmp</span>
<span id="cb92-47"><a href="previous-gwas.html#cb92-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-48"><a href="previous-gwas.html#cb92-48" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$3];next}</span></span>
<span id="cb92-49"><a href="previous-gwas.html#cb92-49" aria-hidden="true" tabindex="-1"></a><span class="st">     ($3 in a){print $4}&#39;</span> <span class="va">$leftin</span> <span class="va">$snp</span> <span class="op">&gt;</span> <span class="va">$leftout</span></span>
<span id="cb92-50"><a href="previous-gwas.html#cb92-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-51"><a href="previous-gwas.html#cb92-51" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$3];next}</span></span>
<span id="cb92-52"><a href="previous-gwas.html#cb92-52" aria-hidden="true" tabindex="-1"></a><span class="st">     ($3 in a){print $4}&#39;</span> <span class="va">$rightin</span> <span class="va">$snp</span> <span class="op">&gt;</span> <span class="va">$rightout</span></span>
<span id="cb92-53"><a href="previous-gwas.html#cb92-53" aria-hidden="true" tabindex="-1"></a><span class="co"># note:  &gt; 40k are in the list of each side because some snps have the same basepair...    </span></span>
<span id="cb92-54"><a href="previous-gwas.html#cb92-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-55"><a href="previous-gwas.html#cb92-55" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-56"><a href="previous-gwas.html#cb92-56" aria-hidden="true" tabindex="-1"></a><span class="co">#  extract genotypes of the bfiles</span></span>
<span id="cb92-57"><a href="previous-gwas.html#cb92-57" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-58"><a href="previous-gwas.html#cb92-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-59"><a href="previous-gwas.html#cb92-59" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/gwas-telomere/left-snps-tmp</span>
<span id="cb92-60"><a href="previous-gwas.html#cb92-60" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/gwas-telomere/right-snps-tmp</span>
<span id="cb92-61"><a href="previous-gwas.html#cb92-61" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>inflation/gwas-telomere/snp-all</span>
<span id="cb92-62"><a href="previous-gwas.html#cb92-62" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$left</span> <span class="va">$right</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb92-63"><a href="previous-gwas.html#cb92-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-64"><a href="previous-gwas.html#cb92-64" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data -----------------------------------------------------------------</span></span>
<span id="cb92-65"><a href="previous-gwas.html#cb92-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb92-66"><a href="previous-gwas.html#cb92-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb92-67"><a href="previous-gwas.html#cb92-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb92-68"><a href="previous-gwas.html#cb92-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb92-69"><a href="previous-gwas.html#cb92-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 4G</span></span>
<span id="cb92-70"><a href="previous-gwas.html#cb92-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb92-71"><a href="previous-gwas.html#cb92-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb92-72"><a href="previous-gwas.html#cb92-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-73"><a href="previous-gwas.html#cb92-73" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb92-74"><a href="previous-gwas.html#cb92-74" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../inflation/gwas-telomere/snp-all </span><span class="dt">\</span></span>
<span id="cb92-75"><a href="previous-gwas.html#cb92-75" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb92-76"><a href="previous-gwas.html#cb92-76" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb92-77"><a href="previous-gwas.html#cb92-77" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb92-78"><a href="previous-gwas.html#cb92-78" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb92-79"><a href="previous-gwas.html#cb92-79" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb92-80"><a href="previous-gwas.html#cb92-80" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb92-81"><a href="previous-gwas.html#cb92-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-82"><a href="previous-gwas.html#cb92-82" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb92-83"><a href="previous-gwas.html#cb92-83" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb92-84"><a href="previous-gwas.html#cb92-84" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb92-85"><a href="previous-gwas.html#cb92-85" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/bfile-telomere</span>
<span id="cb92-86"><a href="previous-gwas.html#cb92-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-87"><a href="previous-gwas.html#cb92-87" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb92-88"><a href="previous-gwas.html#cb92-88" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/bfile-telomere</span>
<span id="cb92-89"><a href="previous-gwas.html#cb92-89" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb92-90"><a href="previous-gwas.html#cb92-90" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb92-91"><a href="previous-gwas.html#cb92-91" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb92-92"><a href="previous-gwas.html#cb92-92" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb92-93"><a href="previous-gwas.html#cb92-93" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb92-94"><a href="previous-gwas.html#cb92-94" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb92-95"><a href="previous-gwas.html#cb92-95" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb92-96"><a href="previous-gwas.html#cb92-96" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb92-97"><a href="previous-gwas.html#cb92-97" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb92-98"><a href="previous-gwas.html#cb92-98" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb92-99"><a href="previous-gwas.html#cb92-99" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb92-100"><a href="previous-gwas.html#cb92-100" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb92-101"><a href="previous-gwas.html#cb92-101" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb92-102"><a href="previous-gwas.html#cb92-102" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb92-103"><a href="previous-gwas.html#cb92-103" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb92-104"><a href="previous-gwas.html#cb92-104" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb92-105"><a href="previous-gwas.html#cb92-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-106"><a href="previous-gwas.html#cb92-106" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files-------------------------------------------------------------------</span></span>
<span id="cb92-107"><a href="previous-gwas.html#cb92-107" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> gen/bfile.list</span>
<span id="cb92-108"><a href="previous-gwas.html#cb92-108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb92-109"><a href="previous-gwas.html#cb92-109" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> gen/bfile.list</span>
<span id="cb92-110"><a href="previous-gwas.html#cb92-110" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb92-111"><a href="previous-gwas.html#cb92-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-112"><a href="previous-gwas.html#cb92-112" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb92-113"><a href="previous-gwas.html#cb92-113" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb92-114"><a href="previous-gwas.html#cb92-114" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb92-115"><a href="previous-gwas.html#cb92-115" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb92-116"><a href="previous-gwas.html#cb92-116" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb92-117"><a href="previous-gwas.html#cb92-117" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 01:00:0</span></span>
<span id="cb92-118"><a href="previous-gwas.html#cb92-118" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-telomere </span><span class="dt">\</span></span>
<span id="cb92-119"><a href="previous-gwas.html#cb92-119" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile.list </span><span class="dt">\</span></span>
<span id="cb92-120"><a href="previous-gwas.html#cb92-120" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb92-121"><a href="previous-gwas.html#cb92-121" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES</span></span>
<span id="cb92-122"><a href="previous-gwas.html#cb92-122" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-telomere.sh</span>
<span id="cb92-123"><a href="previous-gwas.html#cb92-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-124"><a href="previous-gwas.html#cb92-124" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script-------------------------------------------------------------</span></span>
<span id="cb92-125"><a href="previous-gwas.html#cb92-125" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-telomere.sh <span class="op">&gt;</span>../job-records/mbfile-telomere</span>
<span id="cb92-126"><a href="previous-gwas.html#cb92-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-127"><a href="previous-gwas.html#cb92-127" aria-hidden="true" tabindex="-1"></a><span class="co"># compute info score------------------------------------------------------------</span></span>
<span id="cb92-128"><a href="previous-gwas.html#cb92-128" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb92-129"><a href="previous-gwas.html#cb92-129" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>../inflation/gwas-telomere/snp-all</span>
<span id="cb92-130"><a href="previous-gwas.html#cb92-130" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gen/info/chr<span class="va">$j</span>-telomere</span>
<span id="cb92-131"><a href="previous-gwas.html#cb92-131" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb92-132"><a href="previous-gwas.html#cb92-132" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb92-133"><a href="previous-gwas.html#cb92-133" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb92-134"><a href="previous-gwas.html#cb92-134" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb92-135"><a href="previous-gwas.html#cb92-135" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb92-136"><a href="previous-gwas.html#cb92-136" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:20:0</span></span>
<span id="cb92-137"><a href="previous-gwas.html#cb92-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-138"><a href="previous-gwas.html#cb92-138" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb92-139"><a href="previous-gwas.html#cb92-139" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb92-140"><a href="previous-gwas.html#cb92-140" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract </span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb92-141"><a href="previous-gwas.html#cb92-141" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb92-142"><a href="previous-gwas.html#cb92-142" aria-hidden="true" tabindex="-1"></a><span class="st">         --freq cols=chrom,ref,alt,altfreq,machr2 </span><span class="dt">\</span></span>
<span id="cb92-143"><a href="previous-gwas.html#cb92-143" aria-hidden="true" tabindex="-1"></a><span class="st">         --out </span><span class="va">$out</span></span>
<span id="cb92-144"><a href="previous-gwas.html#cb92-144" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb92-145"><a href="previous-gwas.html#cb92-145" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb92-146"><a href="previous-gwas.html#cb92-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-147"><a href="previous-gwas.html#cb92-147" aria-hidden="true" tabindex="-1"></a><span class="co"># submit file-------------------------------------------------------------------</span></span>
<span id="cb92-148"><a href="previous-gwas.html#cb92-148" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb92-149"><a href="previous-gwas.html#cb92-149" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/info-chr<span class="va">$j</span>.sh</span>
<span id="cb92-150"><a href="previous-gwas.html#cb92-150" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/compute-info-telomere</span>
<span id="cb92-151"><a href="previous-gwas.html#cb92-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-152"><a href="previous-gwas.html#cb92-152" aria-hidden="true" tabindex="-1"></a><span class="co"># combine files ----------------------------------------------------------------</span></span>
<span id="cb92-153"><a href="previous-gwas.html#cb92-153" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>gen/info</span>
<span id="cb92-154"><a href="previous-gwas.html#cb92-154" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$dir</span>/telomere-afreq</span>
<span id="cb92-155"><a href="previous-gwas.html#cb92-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb92-156"><a href="previous-gwas.html#cb92-156" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$i</span> <span class="ot">==</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb92-157"><a href="previous-gwas.html#cb92-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>-telomere.afreq <span class="op">&gt;</span> <span class="va">$dir</span>/telomere-afreq</span>
<span id="cb92-158"><a href="previous-gwas.html#cb92-158" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb92-159"><a href="previous-gwas.html#cb92-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$dir</span>/chr<span class="va">$i</span>-telomere.afreq <span class="op">&gt;&gt;</span> <span class="va">$dir</span>/telomere-afreq</span>
<span id="cb92-160"><a href="previous-gwas.html#cb92-160" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb92-161"><a href="previous-gwas.html#cb92-161" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb92-162"><a href="previous-gwas.html#cb92-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-163"><a href="previous-gwas.html#cb92-163" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-164"><a href="previous-gwas.html#cb92-164" aria-hidden="true" tabindex="-1"></a><span class="co">#  Finalize the 10k SNP list of each side</span></span>
<span id="cb92-165"><a href="previous-gwas.html#cb92-165" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-166"><a href="previous-gwas.html#cb92-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-167"><a href="previous-gwas.html#cb92-167" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>10000</span>
<span id="cb92-168"><a href="previous-gwas.html#cb92-168" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>gen/geno-telomere.bim</span>
<span id="cb92-169"><a href="previous-gwas.html#cb92-169" aria-hidden="true" tabindex="-1"></a><span class="va">leftin</span><span class="op">=</span>inflation/gwas-telomere/left-snps-tmp</span>
<span id="cb92-170"><a href="previous-gwas.html#cb92-170" aria-hidden="true" tabindex="-1"></a><span class="va">rightin</span><span class="op">=</span>inflation/gwas-telomere/right-snps-tmp</span>
<span id="cb92-171"><a href="previous-gwas.html#cb92-171" aria-hidden="true" tabindex="-1"></a><span class="va">leftout</span><span class="op">=</span>inflation/gwas-telomere/left-snps</span>
<span id="cb92-172"><a href="previous-gwas.html#cb92-172" aria-hidden="true" tabindex="-1"></a><span class="va">rightout</span><span class="op">=</span>inflation/gwas-telomere/right-snps</span>
<span id="cb92-173"><a href="previous-gwas.html#cb92-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-174"><a href="previous-gwas.html#cb92-174" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}</span></span>
<span id="cb92-175"><a href="previous-gwas.html#cb92-175" aria-hidden="true" tabindex="-1"></a><span class="st">     ($2 in a){print $2}&#39;</span> <span class="va">$leftin</span> <span class="va">$snp</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-</span><span class="va">$m</span>  <span class="op">&gt;</span> <span class="va">$leftout</span></span>
<span id="cb92-176"><a href="previous-gwas.html#cb92-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-177"><a href="previous-gwas.html#cb92-177" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}</span></span>
<span id="cb92-178"><a href="previous-gwas.html#cb92-178" aria-hidden="true" tabindex="-1"></a><span class="st">     ($2 in a){print $2}&#39;</span> <span class="va">$rightin</span> <span class="va">$snp</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-</span><span class="va">$m</span>  <span class="op">&gt;</span> <span class="va">$rightout</span></span>
<span id="cb92-179"><a href="previous-gwas.html#cb92-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-180"><a href="previous-gwas.html#cb92-180" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-181"><a href="previous-gwas.html#cb92-181" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r^2_j</span></span>
<span id="cb92-182"><a href="previous-gwas.html#cb92-182" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb92-183"><a href="previous-gwas.html#cb92-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-184"><a href="previous-gwas.html#cb92-184" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/gwas-telomere/right-snps</span>
<span id="cb92-185"><a href="previous-gwas.html#cb92-185" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/gwas-telomere/left-snps</span>
<span id="cb92-186"><a href="previous-gwas.html#cb92-186" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-telomere</span>
<span id="cb92-187"><a href="previous-gwas.html#cb92-187" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/gwas-telomere/out/10k-snps</span>
<span id="cb92-188"><a href="previous-gwas.html#cb92-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-189"><a href="previous-gwas.html#cb92-189" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb92-190"><a href="previous-gwas.html#cb92-190" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb92-191"><a href="previous-gwas.html#cb92-191" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb92-192"><a href="previous-gwas.html#cb92-192" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 80G</span></span>
<span id="cb92-193"><a href="previous-gwas.html#cb92-193" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb92-194"><a href="previous-gwas.html#cb92-194" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb92-195"><a href="previous-gwas.html#cb92-195" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb92-196"><a href="previous-gwas.html#cb92-196" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb92-197"><a href="previous-gwas.html#cb92-197" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb92-198"><a href="previous-gwas.html#cb92-198" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb92-199"><a href="previous-gwas.html#cb92-199" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb92-200"><a href="previous-gwas.html#cb92-200" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps</span>
<span id="cb92-201"><a href="previous-gwas.html#cb92-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-202"><a href="previous-gwas.html#cb92-202" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the job</span></span>
<span id="cb92-203"><a href="previous-gwas.html#cb92-203" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps <span class="op">&gt;</span>../job-records/calc-r-telomere</span>
<span id="cb92-204"><a href="previous-gwas.html#cb92-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-205"><a href="previous-gwas.html#cb92-205" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r_j^2 for each i-------------------------------------------------</span></span>
<span id="cb92-206"><a href="previous-gwas.html#cb92-206" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb92-207"><a href="previous-gwas.html#cb92-207" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb92-208"><a href="previous-gwas.html#cb92-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-209"><a href="previous-gwas.html#cb92-209" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span><span class="st">&quot;10k-snps&quot;</span></span>
<span id="cb92-210"><a href="previous-gwas.html#cb92-210" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/gwas-telomere/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.pairwise&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb92-211"><a href="previous-gwas.html#cb92-211" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/gwas-telomere/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsa&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb92-212"><a href="previous-gwas.html#cb92-212" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb92-213"><a href="previous-gwas.html#cb92-213" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/gwas-telomere/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsb&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb92-214"><a href="previous-gwas.html#cb92-214" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb92-215"><a href="previous-gwas.html#cb92-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-216"><a href="previous-gwas.html#cb92-216" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[,-c<span class="kw">(</span><span class="ex">10001</span><span class="kw">)</span><span class="ex">]^2</span></span>
<span id="cb92-217"><a href="previous-gwas.html#cb92-217" aria-hidden="true" tabindex="-1"></a><span class="va">outb</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>listb<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,2,</span> mean<span class="kw">))</span></span>
<span id="cb92-218"><a href="previous-gwas.html#cb92-218" aria-hidden="true" tabindex="-1"></a><span class="va">outa</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>lista<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,1,</span> mean<span class="kw">))</span></span>
<span id="cb92-219"><a href="previous-gwas.html#cb92-219" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">outa,outb</span><span class="kw">)</span></span>
<span id="cb92-220"><a href="previous-gwas.html#cb92-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-221"><a href="previous-gwas.html#cb92-221" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,paste0</span><span class="er">(</span><span class="st">&quot;summary/ave-r2-&quot;</span><span class="ex">,nm,</span> <span class="st">&quot;-ukbb-telomere&quot;</span><span class="kw">)</span><span class="ex">,</span> col.names=F, row.names=F, quote=F<span class="kw">)</span>  </span></code></pre></div>
</div>
<div id="organize-data-2" class="section level3" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> organize data</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb93-1"><a href="previous-gwas.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NEED TO CHECK THE FOLLOWING CODE</span></span>
<span id="cb93-2"><a href="previous-gwas.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-ukbb-telomere</span>
<span id="cb93-3"><a href="previous-gwas.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>doug/ukbb.ldsc</span>
<span id="cb93-4"><a href="previous-gwas.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-telomere/telomere-gwas-organized-hm3</span>
<span id="cb93-5"><a href="previous-gwas.html#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-telomere/telomere.out</span>
<span id="cb93-6"><a href="previous-gwas.html#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="previous-gwas.html#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next}</span></span>
<span id="cb93-8"><a href="previous-gwas.html#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="st">      ($1 in a) {print $1, b[$1], $2}&#39;</span> <span class="va">$rs</span> <span class="va">$aver2</span> <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb93-9"><a href="previous-gwas.html#cb93-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb93-10"><a href="previous-gwas.html#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;snp rs chisq aver2&quot;} </span></span>
<span id="cb93-11"><a href="previous-gwas.html#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="st">     NR==FNR {a[$2]; b[$2]=$1; c[$2]=$3; next}</span></span>
<span id="cb93-12"><a href="previous-gwas.html#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="st">     ($4 in a) {print b[$4], $4, $5, c[$4] }&#39;</span> tmp/aver2.tmp <span class="va">$gwas</span>  <span class="op">&gt;</span> <span class="va">$out</span>  </span></code></pre></div>
</div>
<div id="chisq-aver2_j-3" class="section level3" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> chisq ~ aver2_j</h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="previous-gwas.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb94-2"><a href="previous-gwas.html#cb94-2" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;gwas-telomere/telomere.out&quot;</span>, <span class="at">col_names=</span>T)</span>
<span id="cb94-3"><a href="previous-gwas.html#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="previous-gwas.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j-----------------------------------------------</span></span>
<span id="cb94-5"><a href="previous-gwas.html#cb94-5" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb94-6"><a href="previous-gwas.html#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb94-7"><a href="previous-gwas.html#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="previous-gwas.html#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Coefficients:</span></span>
<span id="cb94-9"><a href="previous-gwas.html#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb94-10"><a href="previous-gwas.html#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co">#(Intercept)    1.65142    0.09146  18.057   &lt;2e-16 ***</span></span>
<span id="cb94-11"><a href="previous-gwas.html#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co">#aver2       -196.61028  248.64693  -0.791    0.429    </span></span>
<span id="cb94-12"><a href="previous-gwas.html#cb94-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-13"><a href="previous-gwas.html#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="co"># make the plot: binned aver2_j-------------------------------------------------</span></span>
<span id="cb94-14"><a href="previous-gwas.html#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="previous-gwas.html#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co"># bin a variable by quantile</span></span>
<span id="cb94-16"><a href="previous-gwas.html#cb94-16" aria-hidden="true" tabindex="-1"></a>cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb94-17"><a href="previous-gwas.html#cb94-17" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb94-18"><a href="previous-gwas.html#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="co"># average chisq by bin values</span></span>
<span id="cb94-19"><a href="previous-gwas.html#cb94-19" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb94-20"><a href="previous-gwas.html#cb94-20" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb94-21"><a href="previous-gwas.html#cb94-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-22"><a href="previous-gwas.html#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-telomere.png&quot;</span>,</span>
<span id="cb94-23"><a href="previous-gwas.html#cb94-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb94-24"><a href="previous-gwas.html#cb94-24" aria-hidden="true" tabindex="-1"></a>start<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb94-25"><a href="previous-gwas.html#cb94-25" aria-hidden="true" tabindex="-1"></a>end<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb94-26"><a href="previous-gwas.html#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb94-27"><a href="previous-gwas.html#cb94-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave chisq&quot;</span>,</span>
<span id="cb94-28"><a href="previous-gwas.html#cb94-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim=</span><span class="fu">c</span>(start,<span class="dv">8</span>),</span>
<span id="cb94-29"><a href="previous-gwas.html#cb94-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb94-30"><a href="previous-gwas.html#cb94-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb94-31"><a href="previous-gwas.html#cb94-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb94-32"><a href="previous-gwas.html#cb94-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-33"><a href="previous-gwas.html#cb94-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-34"><a href="previous-gwas.html#cb94-34" aria-hidden="true" tabindex="-1"></a><span class="co"># make the plot: raw aver2_j &amp; chisq--------------------------------------------</span></span>
<span id="cb94-35"><a href="previous-gwas.html#cb94-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-36"><a href="previous-gwas.html#cb94-36" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-telomere-raw.png&quot;</span>,</span>
<span id="cb94-37"><a href="previous-gwas.html#cb94-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb94-38"><a href="previous-gwas.html#cb94-38" aria-hidden="true" tabindex="-1"></a>start<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb94-39"><a href="previous-gwas.html#cb94-39" aria-hidden="true" tabindex="-1"></a>end<span class="ot">=</span><span class="fu">max</span>(dat<span class="sc">$</span>chisq)</span>
<span id="cb94-40"><a href="previous-gwas.html#cb94-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>aver2, dat<span class="sc">$</span>chisq,</span>
<span id="cb94-41"><a href="previous-gwas.html#cb94-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;chisq&quot;</span>,</span>
<span id="cb94-42"><a href="previous-gwas.html#cb94-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim=</span><span class="fu">c</span>(start,<span class="dv">400</span>),</span>
<span id="cb94-43"><a href="previous-gwas.html#cb94-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb94-44"><a href="previous-gwas.html#cb94-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb94-45"><a href="previous-gwas.html#cb94-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="pr-interval-gwas" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> PR interval GWAS</h2>
<p>Here we want to check whether previous GWAS was affected by confounding.
We use the PR interval GWAS as an example to work out the workflow.</p>
<div id="aver2_j-1" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> aver2_j</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="previous-gwas.html#cb95-1" aria-hidden="true" tabindex="-1"></a>mkdir previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats</span>
<span id="cb95-2"><a href="previous-gwas.html#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="previous-gwas.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># common SNPs: 1kg, gwas &amp; ldsc-------------------------------------------------</span></span>
<span id="cb95-4"><a href="previous-gwas.html#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="previous-gwas.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1kg &amp; ldsc</span></span>
<span id="cb95-6"><a href="previous-gwas.html#cb95-6" aria-hidden="true" tabindex="-1"></a>dir<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats</span>
<span id="cb95-7"><a href="previous-gwas.html#cb95-7" aria-hidden="true" tabindex="-1"></a>ldsc<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>snp<span class="sc">-</span>list<span class="sc">/</span>ldsc.snps</span>
<span id="cb95-8"><a href="previous-gwas.html#cb95-8" aria-hidden="true" tabindex="-1"></a>snp1kg<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>snp<span class="sc">-</span>list<span class="sc">/</span>1kg.snps</span>
<span id="cb95-9"><a href="previous-gwas.html#cb95-9" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>snp<span class="sc">-</span>list<span class="sc">/</span>ldsc<span class="sc">-</span>1kg<span class="sc">-</span>common.snps</span>
<span id="cb95-10"><a href="previous-gwas.html#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="previous-gwas.html#cb95-11" aria-hidden="true" tabindex="-1"></a>awk <span class="st">&#39;{a=$5; </span></span>
<span id="cb95-12"><a href="previous-gwas.html#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="st">      b=$6;</span></span>
<span id="cb95-13"><a href="previous-gwas.html#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="st">      if(a&lt;b) </span></span>
<span id="cb95-14"><a href="previous-gwas.html#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="st">      print $2, $2 &quot;_&quot; a &quot;_&quot; b;</span></span>
<span id="cb95-15"><a href="previous-gwas.html#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="st">      else </span></span>
<span id="cb95-16"><a href="previous-gwas.html#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="st">      print $2, $2 &quot;_&quot; b &quot;_&quot;a}&#39;</span> \</span>
<span id="cb95-17"><a href="previous-gwas.html#cb95-17" aria-hidden="true" tabindex="-1"></a>      <span class="sc">$</span>snp1kg <span class="sc">&gt;</span> 1kg.tmp</span>
<span id="cb95-18"><a href="previous-gwas.html#cb95-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-19"><a href="previous-gwas.html#cb95-19" aria-hidden="true" tabindex="-1"></a>awk <span class="st">&#39;{a=$3; </span></span>
<span id="cb95-20"><a href="previous-gwas.html#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="st">      b=$4;</span></span>
<span id="cb95-21"><a href="previous-gwas.html#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="st">      if(a&lt;b) </span></span>
<span id="cb95-22"><a href="previous-gwas.html#cb95-22" aria-hidden="true" tabindex="-1"></a><span class="st">      print $1, $2&quot;_&quot; a &quot;_&quot; b;</span></span>
<span id="cb95-23"><a href="previous-gwas.html#cb95-23" aria-hidden="true" tabindex="-1"></a><span class="st">      else </span></span>
<span id="cb95-24"><a href="previous-gwas.html#cb95-24" aria-hidden="true" tabindex="-1"></a><span class="st">      print $1, $2&quot;_&quot; b &quot;_&quot; a}&#39;</span> \</span>
<span id="cb95-25"><a href="previous-gwas.html#cb95-25" aria-hidden="true" tabindex="-1"></a>      <span class="sc">$</span>ldsc <span class="sc">&gt;</span> ldsc.tmp</span>
<span id="cb95-26"><a href="previous-gwas.html#cb95-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-27"><a href="previous-gwas.html#cb95-27" aria-hidden="true" tabindex="-1"></a>awk <span class="st">&#39;NR==FNR {a[$2]; b[$2]=$1; next} </span></span>
<span id="cb95-28"><a href="previous-gwas.html#cb95-28" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($2 in a) print $1, b[$2], $2}&#39;</span> 1kg.tmp ldsc.tmp <span class="sc">&gt;</span> <span class="er">$</span>out</span>
<span id="cb95-29"><a href="previous-gwas.html#cb95-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-30"><a href="previous-gwas.html#cb95-30" aria-hidden="true" tabindex="-1"></a><span class="co"># gwas snps</span></span>
<span id="cb95-31"><a href="previous-gwas.html#cb95-31" aria-hidden="true" tabindex="-1"></a>dir<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats</span>
<span id="cb95-32"><a href="previous-gwas.html#cb95-32" aria-hidden="true" tabindex="-1"></a>infile<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>PR_1000g_GWAS_ALL.zip</span>
<span id="cb95-33"><a href="previous-gwas.html#cb95-33" aria-hidden="true" tabindex="-1"></a>outfile<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>snp<span class="sc">-</span>list<span class="sc">/</span>pr.snps</span>
<span id="cb95-34"><a href="previous-gwas.html#cb95-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-35"><a href="previous-gwas.html#cb95-35" aria-hidden="true" tabindex="-1"></a>zcat <span class="sc">$</span>infile <span class="sc">|</span> awk <span class="st">&#39;NR &gt;1 {a=$2;</span></span>
<span id="cb95-36"><a href="previous-gwas.html#cb95-36" aria-hidden="true" tabindex="-1"></a><span class="st">                 b=$3;</span></span>
<span id="cb95-37"><a href="previous-gwas.html#cb95-37" aria-hidden="true" tabindex="-1"></a><span class="st">                 if(a&lt;b)</span></span>
<span id="cb95-38"><a href="previous-gwas.html#cb95-38" aria-hidden="true" tabindex="-1"></a><span class="st">                 print $1, $5 &quot;:&quot; $6 &quot;_&quot; toupper(a) &quot;_&quot; toupper(b);</span></span>
<span id="cb95-39"><a href="previous-gwas.html#cb95-39" aria-hidden="true" tabindex="-1"></a><span class="st">                 else </span></span>
<span id="cb95-40"><a href="previous-gwas.html#cb95-40" aria-hidden="true" tabindex="-1"></a><span class="st">                 print $1, $5 &quot;:&quot; $6 &quot;_&quot; toupper(b) &quot;_&quot; toupper(a)}&#39;</span> <span class="sc">&gt;</span> <span class="er">$</span>outfile </span>
<span id="cb95-41"><a href="previous-gwas.html#cb95-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-42"><a href="previous-gwas.html#cb95-42" aria-hidden="true" tabindex="-1"></a><span class="co"># select gwas snps common to 1kg &amp; ldsc</span></span>
<span id="cb95-43"><a href="previous-gwas.html#cb95-43" aria-hidden="true" tabindex="-1"></a>dir<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats</span>
<span id="cb95-44"><a href="previous-gwas.html#cb95-44" aria-hidden="true" tabindex="-1"></a>snp<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>snp<span class="sc">-</span>list<span class="sc">/</span>ldsc<span class="sc">-</span>1kg<span class="sc">-</span>common.snps</span>
<span id="cb95-45"><a href="previous-gwas.html#cb95-45" aria-hidden="true" tabindex="-1"></a>gwas<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>snp<span class="sc">-</span>list<span class="sc">/</span>pr.snps</span>
<span id="cb95-46"><a href="previous-gwas.html#cb95-46" aria-hidden="true" tabindex="-1"></a>outfile<span class="ot">=</span><span class="er">$</span>dir<span class="sc">/</span>pr<span class="sc">-</span>sel.snps</span>
<span id="cb95-47"><a href="previous-gwas.html#cb95-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-48"><a href="previous-gwas.html#cb95-48" aria-hidden="true" tabindex="-1"></a>awk <span class="st">&#39;NR==FNR {a[$3]; next} </span></span>
<span id="cb95-49"><a href="previous-gwas.html#cb95-49" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($2 in a) print $0}&#39;</span> <span class="sc">$</span>snp <span class="sc">$</span>gwas <span class="sc">&gt;</span> <span class="er">$</span>outfile </span>
<span id="cb95-50"><a href="previous-gwas.html#cb95-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-51"><a href="previous-gwas.html#cb95-51" aria-hidden="true" tabindex="-1"></a><span class="co"># organize gwas data------------------------------------------------------------</span></span>
<span id="cb95-52"><a href="previous-gwas.html#cb95-52" aria-hidden="true" tabindex="-1"></a>infile<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>PR_1000g_GWAS_ALL.zip</span>
<span id="cb95-53"><a href="previous-gwas.html#cb95-53" aria-hidden="true" tabindex="-1"></a>outfile<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>pr.gwas</span>
<span id="cb95-54"><a href="previous-gwas.html#cb95-54" aria-hidden="true" tabindex="-1"></a>zcat <span class="sc">$</span>infile <span class="sc">|</span> awk <span class="st">&#39;BEGIN {print &quot;snp chr pos chisq p_val&quot;}</span></span>
<span id="cb95-55"><a href="previous-gwas.html#cb95-55" aria-hidden="true" tabindex="-1"></a><span class="st">                   NR &gt;1 {print $1, $5, $6, ($7/$8)^2, $9}&#39;</span> <span class="sc">&gt;</span> <span class="er">$</span>outfile</span>
<span id="cb95-56"><a href="previous-gwas.html#cb95-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-57"><a href="previous-gwas.html#cb95-57" aria-hidden="true" tabindex="-1"></a><span class="co"># select gwas data for snps common with 1kg &amp; ldsc</span></span>
<span id="cb95-58"><a href="previous-gwas.html#cb95-58" aria-hidden="true" tabindex="-1"></a>infile<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>pr.gwas</span>
<span id="cb95-59"><a href="previous-gwas.html#cb95-59" aria-hidden="true" tabindex="-1"></a>snpfile<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>pr<span class="sc">-</span>sel.snps</span>
<span id="cb95-60"><a href="previous-gwas.html#cb95-60" aria-hidden="true" tabindex="-1"></a>outfile<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>pr<span class="sc">-</span>sel.gwas</span>
<span id="cb95-61"><a href="previous-gwas.html#cb95-61" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-62"><a href="previous-gwas.html#cb95-62" aria-hidden="true" tabindex="-1"></a>awk <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2 ; next}</span></span>
<span id="cb95-63"><a href="previous-gwas.html#cb95-63" aria-hidden="true" tabindex="-1"></a><span class="st">     BEGIN {print &quot;snp rs chr pos chisq p_val&quot;}</span></span>
<span id="cb95-64"><a href="previous-gwas.html#cb95-64" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1], $0}&#39;</span> <span class="sc">$</span>snpfile <span class="sc">$</span>infile <span class="sc">&gt;</span> <span class="er">$</span>outfile</span>
<span id="cb95-65"><a href="previous-gwas.html#cb95-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-66"><a href="previous-gwas.html#cb95-66" aria-hidden="true" tabindex="-1"></a><span class="co"># select 10k SNPs to compute ave r2_j-------------------------------------------</span></span>
<span id="cb95-67"><a href="previous-gwas.html#cb95-67" aria-hidden="true" tabindex="-1"></a><span class="co"># selection based on percentiles of chisq</span></span>
<span id="cb95-68"><a href="previous-gwas.html#cb95-68" aria-hidden="true" tabindex="-1"></a>R</span>
<span id="cb95-69"><a href="previous-gwas.html#cb95-69" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb95-70"><a href="previous-gwas.html#cb95-70" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;previous-gwas-sumstats/pr-sel.gwas&quot;</span>, <span class="at">col_names=</span>T)</span>
<span id="cb95-71"><a href="previous-gwas.html#cb95-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-72"><a href="previous-gwas.html#cb95-72" aria-hidden="true" tabindex="-1"></a><span class="co"># bin snps by percentiles of chisq to get a good range of test statistics</span></span>
<span id="cb95-73"><a href="previous-gwas.html#cb95-73" aria-hidden="true" tabindex="-1"></a>cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>chisq, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb95-74"><a href="previous-gwas.html#cb95-74" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>chisq_bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>chisq, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb95-75"><a href="previous-gwas.html#cb95-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-76"><a href="previous-gwas.html#cb95-76" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 200 SNPs from each percentile bin</span></span>
<span id="cb95-77"><a href="previous-gwas.html#cb95-77" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">unlist</span>(<span class="fu">tapply</span>(dat<span class="sc">$</span>snp, dat<span class="sc">$</span>chisq_bin, </span>
<span id="cb95-78"><a href="previous-gwas.html#cb95-78" aria-hidden="true" tabindex="-1"></a>           <span class="cf">function</span>(x) <span class="fu">sample</span>(x, <span class="dv">200</span>, <span class="at">replace=</span>F)))</span>
<span id="cb95-79"><a href="previous-gwas.html#cb95-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-80"><a href="previous-gwas.html#cb95-80" aria-hidden="true" tabindex="-1"></a><span class="co"># check which chromosomes they come from</span></span>
<span id="cb95-81"><a href="previous-gwas.html#cb95-81" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">match</span>(out,dat<span class="sc">$</span>snp)</span>
<span id="cb95-82"><a href="previous-gwas.html#cb95-82" aria-hidden="true" tabindex="-1"></a>sel<span class="ot">=</span>dat[m,]</span>
<span id="cb95-83"><a href="previous-gwas.html#cb95-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-84"><a href="previous-gwas.html#cb95-84" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(sel[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="st">&quot;previous-gwas-sumstats/pr-20k.snps&quot;</span>,</span>
<span id="cb95-85"><a href="previous-gwas.html#cb95-85" aria-hidden="true" tabindex="-1"></a>            <span class="at">col.names=</span>F, <span class="at">row.names=</span>F, <span class="at">quote=</span>F)</span>
<span id="cb95-86"><a href="previous-gwas.html#cb95-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-87"><a href="previous-gwas.html#cb95-87" aria-hidden="true" tabindex="-1"></a><span class="co"># compute aver2 using 1kg genotype data-----------------------------------------</span></span>
<span id="cb95-88"><a href="previous-gwas.html#cb95-88" aria-hidden="true" tabindex="-1"></a>mkdir previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>aver2</span>
<span id="cb95-89"><a href="previous-gwas.html#cb95-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-90"><a href="previous-gwas.html#cb95-90" aria-hidden="true" tabindex="-1"></a>snp<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>snp<span class="sc">-</span>list<span class="sc">/</span>ldsc<span class="sc">-</span>1kg<span class="sc">-</span>common.snps</span>
<span id="cb95-91"><a href="previous-gwas.html#cb95-91" aria-hidden="true" tabindex="-1"></a>infile<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>pr<span class="sc">-</span>20k.snps</span>
<span id="cb95-92"><a href="previous-gwas.html#cb95-92" aria-hidden="true" tabindex="-1"></a>outfile<span class="ot">=</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>aver2<span class="sc">/</span>pr<span class="sc">-</span>20k.use</span>
<span id="cb95-93"><a href="previous-gwas.html#cb95-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-94"><a href="previous-gwas.html#cb95-94" aria-hidden="true" tabindex="-1"></a>awk <span class="st">&#39;NR==FNR {a[$1]; next}</span></span>
<span id="cb95-95"><a href="previous-gwas.html#cb95-95" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($3 in a) print $2, $2}&#39;</span> <span class="sc">$</span>infile <span class="sc">$</span>snp <span class="sc">&gt;</span> <span class="er">$</span>outfile</span>
<span id="cb95-96"><a href="previous-gwas.html#cb95-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-97"><a href="previous-gwas.html#cb95-97" aria-hidden="true" tabindex="-1"></a><span class="co"># calc aver2</span></span>
<span id="cb95-98"><a href="previous-gwas.html#cb95-98" aria-hidden="true" tabindex="-1"></a>list<span class="ot">=</span>..<span class="sc">/</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>aver2<span class="sc">/</span>pr<span class="sc">-</span>20k.use</span>
<span id="cb95-99"><a href="previous-gwas.html#cb95-99" aria-hidden="true" tabindex="-1"></a>bfile<span class="ot">=</span>..<span class="sc">/</span>ref<span class="sc">-</span>1kg<span class="sc">/</span>1kg<span class="sc">/</span>gen<span class="sc">/</span>1000b</span>
<span id="cb95-100"><a href="previous-gwas.html#cb95-100" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span>..<span class="sc">/</span>previous<span class="sc">-</span>gwas<span class="sc">-</span>sumstats<span class="sc">/</span>aver2<span class="sc">/</span>pr.aver2</span>
<span id="cb95-101"><a href="previous-gwas.html#cb95-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-102"><a href="previous-gwas.html#cb95-102" aria-hidden="true" tabindex="-1"></a>echo <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb95-103"><a href="previous-gwas.html#cb95-103" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="sc">\&quot;</span><span class="st">s04|s05</span><span class="sc">\&quot;</span></span>
<span id="cb95-104"><a href="previous-gwas.html#cb95-104" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb95-105"><a href="previous-gwas.html#cb95-105" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb95-106"><a href="previous-gwas.html#cb95-106" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb95-107"><a href="previous-gwas.html#cb95-107" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:40:0</span></span>
<span id="cb95-108"><a href="previous-gwas.html#cb95-108" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 \</span></span>
<span id="cb95-109"><a href="previous-gwas.html#cb95-109" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation $out \</span></span>
<span id="cb95-110"><a href="previous-gwas.html#cb95-110" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile $bfile \</span></span>
<span id="cb95-111"><a href="previous-gwas.html#cb95-111" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista $list \</span></span>
<span id="cb95-112"><a href="previous-gwas.html#cb95-112" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb $list</span></span>
<span id="cb95-113"><a href="previous-gwas.html#cb95-113" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="sc">&gt;</span>sh_script<span class="sc">/</span>calc<span class="sc">-</span>aver2<span class="sc">-</span>pr</span>
<span id="cb95-114"><a href="previous-gwas.html#cb95-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-115"><a href="previous-gwas.html#cb95-115" aria-hidden="true" tabindex="-1"></a>sbatch <span class="sc">-</span>A snpher ..<span class="sc">/</span>sh_script<span class="sc">/</span>calc<span class="sc">-</span>aver2<span class="sc">-</span>pr</span></code></pre></div>
</div>
<div id="organize-data-3" class="section level3" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> organize data</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb96-1"><a href="previous-gwas.html#cb96-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-2"><a href="previous-gwas.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract ld scores for SNPs common to 1kg &amp; ldsc-------------------------------</span></span>
<span id="cb96-3"><a href="previous-gwas.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>ldsc/eur_w_ld_chr</span>
<span id="cb96-4"><a href="previous-gwas.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="va">snps</span><span class="op">=</span>previous-gwas-sumstats/snp-list/ldsc-1kg-common.snps</span>
<span id="cb96-5"><a href="previous-gwas.html#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>previous-gwas-sumstats/ldsc-1kg-common-snps.ldscore</span>
<span id="cb96-6"><a href="previous-gwas.html#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chrom <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb96-7"><a href="previous-gwas.html#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> <span class="va">$dir</span>/<span class="va">$chrom</span>.l2.ldscore.gz <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $2, $6}&#39;</span> <span class="op">&gt;</span> ldscore</span>
<span id="cb96-8"><a href="previous-gwas.html#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1]; b[$1]=$2; c[$1]=$3; next}</span></span>
<span id="cb96-9"><a href="previous-gwas.html#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="st">     ($1 in a){print $1, b[$1], c[$1], $2}&#39;</span> <span class="va">$snps</span> ldscore <span class="op">&gt;</span> temp</span>
<span id="cb96-10"><a href="previous-gwas.html#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$chrom</span> <span class="ot">-eq</span> 1 <span class="bu">]</span></span>
<span id="cb96-11"><a href="previous-gwas.html#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="cf">then</span> </span>
<span id="cb96-12"><a href="previous-gwas.html#cb96-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">mv</span> temp <span class="va">$out</span></span>
<span id="cb96-13"><a href="previous-gwas.html#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb96-14"><a href="previous-gwas.html#cb96-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span> <span class="va">$out</span> temp <span class="op">&gt;</span> temp2</span>
<span id="cb96-15"><a href="previous-gwas.html#cb96-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">mv</span> temp2 <span class="va">$out</span></span>
<span id="cb96-16"><a href="previous-gwas.html#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb96-17"><a href="previous-gwas.html#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$chrom</span></span>
<span id="cb96-18"><a href="previous-gwas.html#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb96-19"><a href="previous-gwas.html#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="previous-gwas.html#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="co"># organize data ----------------------------------------------------------------</span></span>
<span id="cb96-21"><a href="previous-gwas.html#cb96-21" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>previous-gwas-sumstats</span>
<span id="cb96-22"><a href="previous-gwas.html#cb96-22" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span><span class="va">$dir</span>/pr-sel.gwas</span>
<span id="cb96-23"><a href="previous-gwas.html#cb96-23" aria-hidden="true" tabindex="-1"></a><span class="va">snps</span><span class="op">=</span>previous-gwas-sumstats/snp-list/ldsc-1kg-common.snps</span>
<span id="cb96-24"><a href="previous-gwas.html#cb96-24" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span><span class="va">$dir</span>/aver2/pr.aver2.rjk2.average</span>
<span id="cb96-25"><a href="previous-gwas.html#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="va">ldsc</span><span class="op">=</span><span class="va">$dir</span>/ldsc-1kg-common-snps.ldscore</span>
<span id="cb96-26"><a href="previous-gwas.html#cb96-26" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span><span class="va">$dir</span>/pr.out</span>
<span id="cb96-27"><a href="previous-gwas.html#cb96-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-28"><a href="previous-gwas.html#cb96-28" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp</span>
<span id="cb96-29"><a href="previous-gwas.html#cb96-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-30"><a href="previous-gwas.html#cb96-30" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$3]; b[$3]=$4; next} </span></span>
<span id="cb96-31"><a href="previous-gwas.html#cb96-31" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb96-32"><a href="previous-gwas.html#cb96-32" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$ldsc</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/ldsc.tmp</span>
<span id="cb96-33"><a href="previous-gwas.html#cb96-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-34"><a href="previous-gwas.html#cb96-34" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$2]; b[$2]=$3; next} </span></span>
<span id="cb96-35"><a href="previous-gwas.html#cb96-35" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1], $2}&#39;</span> <span class="va">$snps</span> <span class="va">$aver2</span> <span class="op">&gt;</span> tmp/aver2.tmp0</span>
<span id="cb96-36"><a href="previous-gwas.html#cb96-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-37"><a href="previous-gwas.html#cb96-37" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb96-38"><a href="previous-gwas.html#cb96-38" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb96-39"><a href="previous-gwas.html#cb96-39" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> tmp/aver2.tmp0 tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb96-40"><a href="previous-gwas.html#cb96-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-41"><a href="previous-gwas.html#cb96-41" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb96-42"><a href="previous-gwas.html#cb96-42" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb96-43"><a href="previous-gwas.html#cb96-43" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb96-44"><a href="previous-gwas.html#cb96-44" aria-hidden="true" tabindex="-1"></a>      tmp/ldsc.tmp <span class="dt">\</span></span>
<span id="cb96-45"><a href="previous-gwas.html#cb96-45" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb96-46"><a href="previous-gwas.html#cb96-46" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2;ldsc&quot;}</span></span>
<span id="cb96-47"><a href="previous-gwas.html#cb96-47" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span></code></pre></div>
</div>
<div id="chisq-aver2_j-4" class="section level3" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> chisq ~ aver2_j</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="previous-gwas.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb97-2"><a href="previous-gwas.html#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="previous-gwas.html#cb97-3" aria-hidden="true" tabindex="-1"></a>trait<span class="ot">=</span><span class="st">&quot;pr&quot;</span></span>
<span id="cb97-4"><a href="previous-gwas.html#cb97-4" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;previous-gwas-sumstats/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb97-5"><a href="previous-gwas.html#cb97-5" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb97-6"><a href="previous-gwas.html#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="previous-gwas.html#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model</span></span>
<span id="cb97-8"><a href="previous-gwas.html#cb97-8" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2 <span class="sc">+</span> ldsc,<span class="at">data=</span>dat)</span>
<span id="cb97-9"><a href="previous-gwas.html#cb97-9" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb97-10"><a href="previous-gwas.html#cb97-10" aria-hidden="true" tabindex="-1"></a>p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb97-11"><a href="previous-gwas.html#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="previous-gwas.html#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># bin a variable by quantile</span></span>
<span id="cb97-13"><a href="previous-gwas.html#cb97-13" aria-hidden="true" tabindex="-1"></a>cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb97-14"><a href="previous-gwas.html#cb97-14" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb97-15"><a href="previous-gwas.html#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="previous-gwas.html#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="co"># average chisq by bin values</span></span>
<span id="cb97-17"><a href="previous-gwas.html#cb97-17" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb97-18"><a href="previous-gwas.html#cb97-18" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb97-19"><a href="previous-gwas.html#cb97-19" aria-hidden="true" tabindex="-1"></a>px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb97-20"><a href="previous-gwas.html#cb97-20" aria-hidden="true" tabindex="-1"></a>py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb97-21"><a href="previous-gwas.html#cb97-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-22"><a href="previous-gwas.html#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot binned chisq</span></span>
<span id="cb97-23"><a href="previous-gwas.html#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-bin-pr-interval.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb97-24"><a href="previous-gwas.html#cb97-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb97-25"><a href="previous-gwas.html#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="previous-gwas.html#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb97-27"><a href="previous-gwas.html#cb97-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb97-28"><a href="previous-gwas.html#cb97-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb97-29"><a href="previous-gwas.html#cb97-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb97-30"><a href="previous-gwas.html#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(chisq <span class="sc">~</span> aver2, <span class="at">data=</span>dat),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb97-31"><a href="previous-gwas.html#cb97-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb97-32"><a href="previous-gwas.html#cb97-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb97-33"><a href="previous-gwas.html#cb97-33" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb97-34"><a href="previous-gwas.html#cb97-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb97-35"><a href="previous-gwas.html#cb97-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-36"><a href="previous-gwas.html#cb97-36" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb97-37"><a href="previous-gwas.html#cb97-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-38"><a href="previous-gwas.html#cb97-38" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raw chisq</span></span>
<span id="cb97-39"><a href="previous-gwas.html#cb97-39" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-pr-interval.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb97-40"><a href="previous-gwas.html#cb97-40" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb97-41"><a href="previous-gwas.html#cb97-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-42"><a href="previous-gwas.html#cb97-42" aria-hidden="true" tabindex="-1"></a>px<span class="ot">=</span><span class="fu">min</span>(dat<span class="sc">$</span>aver2)</span>
<span id="cb97-43"><a href="previous-gwas.html#cb97-43" aria-hidden="true" tabindex="-1"></a>py<span class="ot">=</span><span class="fu">max</span>(dat<span class="sc">$</span>chisq)</span>
<span id="cb97-44"><a href="previous-gwas.html#cb97-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>aver2, dat<span class="sc">$</span>chisq,</span>
<span id="cb97-45"><a href="previous-gwas.html#cb97-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;chisq&quot;</span>,</span>
<span id="cb97-46"><a href="previous-gwas.html#cb97-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb97-47"><a href="previous-gwas.html#cb97-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb97-48"><a href="previous-gwas.html#cb97-48" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(chisq <span class="sc">~</span> aver2, <span class="at">data=</span>dat),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb97-49"><a href="previous-gwas.html#cb97-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb97-50"><a href="previous-gwas.html#cb97-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb97-51"><a href="previous-gwas.html#cb97-51" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb97-52"><a href="previous-gwas.html#cb97-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb97-53"><a href="previous-gwas.html#cb97-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-54"><a href="previous-gwas.html#cb97-54" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb97-55"><a href="previous-gwas.html#cb97-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-56"><a href="previous-gwas.html#cb97-56" aria-hidden="true" tabindex="-1"></a><span class="co"># test------------------</span></span>
<span id="cb97-57"><a href="previous-gwas.html#cb97-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-58"><a href="previous-gwas.html#cb97-58" aria-hidden="true" tabindex="-1"></a><span class="co"># bin a variable by quantile</span></span>
<span id="cb97-59"><a href="previous-gwas.html#cb97-59" aria-hidden="true" tabindex="-1"></a>cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>chisq, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb97-60"><a href="previous-gwas.html#cb97-60" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>chisq_bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>chisq, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb97-61"><a href="previous-gwas.html#cb97-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-62"><a href="previous-gwas.html#cb97-62" aria-hidden="true" tabindex="-1"></a><span class="co"># average chisq by bin values</span></span>
<span id="cb97-63"><a href="previous-gwas.html#cb97-63" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">aver2_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>chisq_bin, mean))</span>
<span id="cb97-64"><a href="previous-gwas.html#cb97-64" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>chisq_bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>chisq_bin, mean)</span>
<span id="cb97-65"><a href="previous-gwas.html#cb97-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-66"><a href="previous-gwas.html#cb97-66" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-pr-interval-test.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb97-67"><a href="previous-gwas.html#cb97-67" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb97-68"><a href="previous-gwas.html#cb97-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-69"><a href="previous-gwas.html#cb97-69" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>chisq_bin_val[<span class="dv">60</span><span class="sc">:</span><span class="dv">99</span>], out<span class="sc">$</span>aver2_ave[<span class="dv">60</span><span class="sc">:</span><span class="dv">99</span>],</span>
<span id="cb97-70"><a href="previous-gwas.html#cb97-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;chisq&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave r2&quot;</span>,</span>
<span id="cb97-71"><a href="previous-gwas.html#cb97-71" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb97-72"><a href="previous-gwas.html#cb97-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb97-73"><a href="previous-gwas.html#cb97-73" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(chisq_bin_val[<span class="dv">80</span><span class="sc">:</span><span class="dv">99</span>] <span class="sc">~</span> aver2_ave[<span class="dv">80</span><span class="sc">:</span><span class="dv">99</span>], <span class="at">data=</span>out),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb97-74"><a href="previous-gwas.html#cb97-74" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb97-75"><a href="previous-gwas.html#cb97-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-76"><a href="previous-gwas.html#cb97-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-77"><a href="previous-gwas.html#cb97-77" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-pr-interval-test2.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb97-78"><a href="previous-gwas.html#cb97-78" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb97-79"><a href="previous-gwas.html#cb97-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-80"><a href="previous-gwas.html#cb97-80" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span>, out<span class="sc">$</span>chisq_bin_val[<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span>],</span>
<span id="cb97-81"><a href="previous-gwas.html#cb97-81" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;chisq&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave r2&quot;</span>,</span>
<span id="cb97-82"><a href="previous-gwas.html#cb97-82" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb97-83"><a href="previous-gwas.html#cb97-83" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb97-84"><a href="previous-gwas.html#cb97-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-85"><a href="previous-gwas.html#cb97-85" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="ben-neale-pan-ukbb" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Ben Neale Pan-UKBB</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb98-1"><a href="previous-gwas.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> neale-pangwas</span>
<span id="cb98-2"><a href="previous-gwas.html#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="previous-gwas.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>neale-pangwas</span>
<span id="cb98-4"><a href="previous-gwas.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span><span class="va">$dir</span>/biomarkers-30600-both_sexes-irnt.tsv.bgz</span>
<span id="cb98-5"><a href="previous-gwas.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span><span class="va">$dir</span>/biomarkers-30600.gwas</span>
<span id="cb98-6"><a href="previous-gwas.html#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="previous-gwas.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;snp chisq&quot;}</span></span>
<span id="cb98-8"><a href="previous-gwas.html#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="st">                     NR&gt;1{a=$3;b=$4;</span></span>
<span id="cb98-9"><a href="previous-gwas.html#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="st">                     if(a&lt;b &amp;&amp; $6!=&quot;NA&quot; &amp;&amp; $7!=&quot;NA&quot;)</span></span>
<span id="cb98-10"><a href="previous-gwas.html#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="st">                     print $1&quot;:&quot;$2&quot;_&quot;$3&quot;_&quot;$4, ($6/$7)^2;</span></span>
<span id="cb98-11"><a href="previous-gwas.html#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="st">                     if(a&gt;b &amp;&amp; $6!=&quot;NA&quot; &amp;&amp; $7!=&quot;NA&quot;)</span></span>
<span id="cb98-12"><a href="previous-gwas.html#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="st">                     print $1&quot;:&quot;$2&quot;_&quot;$4&quot;_&quot;$3,($6/$7)^2}&#39;</span> <span class="op">&gt;</span> <span class="va">$outfile</span></span>
<span id="cb98-13"><a href="previous-gwas.html#cb98-13" aria-hidden="true" tabindex="-1"></a>                     </span></code></pre></div>
</div>
<div id="notesconcerns" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> notes/concerns</h2>
<ul>
<li>Telomere length GWAS:
<ul>
<li>The QC seems too rough so that some SNPs have multiple alleles.</li>
</ul></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="control.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gwas-white-british-irish.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04.5-inclusive-gwas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
