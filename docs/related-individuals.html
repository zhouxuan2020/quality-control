<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14 related individuals | GWAS Quality Control</title>
  <meta name="description" content="14 related individuals | GWAS Quality Control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="14 related individuals | GWAS Quality Control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14 related individuals | GWAS Quality Control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gwas-white-british-irish.html"/>
<link rel="next" href="compute-sum_ijm_1-m_2r2_ij.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>2</b> summary</a></li>
<li class="chapter" data-level="3" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>3</b> Summaries</a>
<ul>
<li class="chapter" data-level="3.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>3.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>3.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>3.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>3.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>3.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>3.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>3.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>3.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>3.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>3.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>3.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>3.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>4</b> summary</a></li>
<li class="chapter" data-level="5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>5</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>5.1</b> test statistics ~ LD score</a></li>
<li class="chapter" data-level="5.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#new-models"><i class="fa fa-check"></i><b>5.2</b> New models?</a></li>
<li class="chapter" data-level="5.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ld-scores-based-on-individual-level-data"><i class="fa fa-check"></i><b>5.3</b> LD scores based on individual level data</a></li>
<li class="chapter" data-level="5.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-the-new-model"><i class="fa fa-check"></i><b>5.4</b> Test the new model</a></li>
<li class="chapter" data-level="5.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predictors-of-inflation"><i class="fa fa-check"></i><b>5.5</b> predictors of inflation?</a></li>
<li class="chapter" data-level="5.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#regress-chisq-mean-r2_j"><i class="fa fa-check"></i><b>5.6</b> regress chisq ~ mean r^2_j</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plots"><i class="fa fa-check"></i><b>5.6.1</b> plots</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predict-inflation-aver2_j"><i class="fa fa-check"></i><b>5.7</b> predict inflation | aver2_j ?</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good_chisq-vs.-adj_chisq"><i class="fa fa-check"></i><b>5.7.1</b> good_chisq vs. adj_chisq</a></li>
<li class="chapter" data-level="5.7.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>5.7.2</b> bad gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="5.7.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>5.7.3</b> bad gwas: inf. vs. inf._hat: ave</a></li>
<li class="chapter" data-level="5.7.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-from-full-model"><i class="fa fa-check"></i><b>5.7.4</b> bad gwas: inf. from full model</a></li>
<li class="chapter" data-level="5.7.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#to-explore-change"><i class="fa fa-check"></i><b>5.7.5</b> To Explore: change??</a></li>
<li class="chapter" data-level="5.7.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>5.7.6</b> good gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="5.7.7" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>5.7.7</b> good gwas: inf. vs. inf._hat: ave</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ukbb_337k_inflation"><i class="fa fa-check"></i><b>5.8</b> UKBB N = 337k</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#organize-data"><i class="fa fa-check"></i><b>5.8.1</b> organize data</a></li>
<li class="chapter" data-level="5.8.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plot"><i class="fa fa-check"></i><b>5.8.2</b> plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mathematical-details.html"><a href="mathematical-details.html"><i class="fa fa-check"></i><b>6</b> Mathematical Details</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mathematical-details.html"><a href="mathematical-details.html#trk_rightk_left"><i class="fa fa-check"></i><b>6.1</b> <span class="math inline">\(tr(K_{right}K_{left})\)</span></a></li>
<li class="chapter" data-level="6.2" data-path="mathematical-details.html"><a href="mathematical-details.html#verification"><i class="fa fa-check"></i><b>6.2</b> verification</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html"><i class="fa fa-check"></i><b>7</b> chi square ~ <span class="math inline">\(\overline{r^2_j}\)</span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#overliner2_j-choice-of-snps"><i class="fa fa-check"></i><b>7.1</b> <span class="math inline">\(\overline{r^2_j}\)</span> &amp; choice of SNPs</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#number-of-snps"><i class="fa fa-check"></i><b>7.1.1</b> number of SNPs</a></li>
<li class="chapter" data-level="7.1.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#maf"><i class="fa fa-check"></i><b>7.1.2</b> maf</a></li>
<li class="chapter" data-level="7.1.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#summary-2"><i class="fa fa-check"></i><b>7.1.3</b> summary</a></li>
<li class="chapter" data-level="7.1.4" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#final-plots"><i class="fa fa-check"></i><b>7.1.4</b> Final plots</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#varying-levels-of-confouding"><i class="fa fa-check"></i><b>7.2</b> varying levels of confouding</a></li>
<li class="chapter" data-level="7.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#results-summary"><i class="fa fa-check"></i><b>7.3</b> results summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>8</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>8.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="8.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>8.2</b> extract covariates</a></li>
<li class="chapter" data-level="8.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>8.3</b> GWAS</a></li>
<li class="chapter" data-level="8.4" data-path="good.html"><a href="good.html#chisq-aver2_j"><i class="fa fa-check"></i><b>8.4</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="8.5" data-path="good.html"><a href="good.html#correct-genotypes"><i class="fa fa-check"></i><b>8.5</b> correct genotypes</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="good.html"><a href="good.html#organize-covariate-files"><i class="fa fa-check"></i><b>8.5.1</b> organize covariate files</a></li>
<li class="chapter" data-level="8.5.2" data-path="good.html"><a href="good.html#compute-aver2"><i class="fa fa-check"></i><b>8.5.2</b> compute aver2</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>8.6</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>8.6.1</b> under gcta</a></li>
<li class="chapter" data-level="8.6.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>8.6.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="8.6.3" data-path="good.html"><a href="good.html#summary-3"><i class="fa fa-check"></i><b>8.6.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>8.7</b> REML</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>8.7.1</b> making grms</a></li>
<li class="chapter" data-level="8.7.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>8.7.2</b> fast-reml</a></li>
<li class="chapter" data-level="8.7.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>8.7.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>8.8</b> HE</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>8.8.1</b> estimation</a></li>
<li class="chapter" data-level="8.8.2" data-path="good.html"><a href="good.html#summary-4"><i class="fa fa-check"></i><b>8.8.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>9</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>9.1</b> ID list</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>9.1.1</b> initial selection</a></li>
<li class="chapter" data-level="9.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>9.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="9.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>9.1.3</b> final list</a></li>
<li class="chapter" data-level="9.1.4" data-path="bad.html"><a href="bad.html#pc-plot"><i class="fa fa-check"></i><b>9.1.4</b> PC plot</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bad.html"><a href="bad.html#gwas-lm"><i class="fa fa-check"></i><b>9.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="bad.html"><a href="bad.html#basic-cov"><i class="fa fa-check"></i><b>9.2.1</b> basic cov</a></li>
<li class="chapter" data-level="9.2.2" data-path="bad.html"><a href="bad.html#basic-cov-pc"><i class="fa fa-check"></i><b>9.2.2</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="bad.html"><a href="bad.html#gwas-bolt-lmm"><i class="fa fa-check"></i><b>9.3</b> GWAS-bolt-lmm</a></li>
<li class="chapter" data-level="9.4" data-path="bad.html"><a href="bad.html#correct-genotypes-1"><i class="fa fa-check"></i><b>9.4</b> correct genotypes</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="bad.html"><a href="bad.html#cal-aver2"><i class="fa fa-check"></i><b>9.4.1</b> cal-aver2</a></li>
<li class="chapter" data-level="9.4.2" data-path="bad.html"><a href="bad.html#compare-changes-in-aver2"><i class="fa fa-check"></i><b>9.4.2</b> compare changes in aver2</a></li>
<li class="chapter" data-level="9.4.3" data-path="bad.html"><a href="bad.html#chisq-aver2"><i class="fa fa-check"></i><b>9.4.3</b> chisq ~ aver2</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="bad.html"><a href="bad.html#chisq-aver2_j-1"><i class="fa fa-check"></i><b>9.5</b> chisq ~ aver2_j</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="bad.html"><a href="bad.html#calc-aver2_j"><i class="fa fa-check"></i><b>9.5.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="9.5.2" data-path="bad.html"><a href="bad.html#bolt-lmm"><i class="fa fa-check"></i><b>9.5.2</b> bolt-lmm</a></li>
<li class="chapter" data-level="9.5.3" data-path="bad.html"><a href="bad.html#basic-cov-pc-1"><i class="fa fa-check"></i><b>9.5.3</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>9.6</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>9.6.1</b> under gcta</a></li>
<li class="chapter" data-level="9.6.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>9.6.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="9.6.3" data-path="bad.html"><a href="bad.html#summary-5"><i class="fa fa-check"></i><b>9.6.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>9.7</b> REML</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>9.7.1</b> making grms</a></li>
<li class="chapter" data-level="9.7.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>9.7.2</b> fast-reml</a></li>
<li class="chapter" data-level="9.7.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>9.7.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>9.8</b> HE</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>9.8.1</b> estimation</a></li>
<li class="chapter" data-level="9.8.2" data-path="bad.html"><a href="bad.html#summary-6"><i class="fa fa-check"></i><b>9.8.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>10</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>10.1</b> total N = 337k</a></li>
<li class="chapter" data-level="10.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>10.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="10.3" data-path="ukbb.html"><a href="ukbb.html#gwas-100k"><i class="fa fa-check"></i><b>10.3</b> GWAS-100k</a></li>
<li class="chapter" data-level="10.4" data-path="ukbb.html"><a href="ukbb.html#gwas-337k"><i class="fa fa-check"></i><b>10.4</b> GWAS-337k</a></li>
<li class="chapter" data-level="10.5" data-path="ukbb.html"><a href="ukbb.html#ldsc-100k"><i class="fa fa-check"></i><b>10.5</b> ldsc-100k</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>10.5.1</b> under gcta</a></li>
<li class="chapter" data-level="10.5.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>10.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="10.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-7"><i class="fa fa-check"></i><b>10.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="ukbb.html"><a href="ukbb.html#ldsc-337k"><i class="fa fa-check"></i><b>10.6</b> ldsc-337k</a></li>
<li class="chapter" data-level="10.7" data-path="ukbb.html"><a href="ukbb.html#aver2_j-337k"><i class="fa fa-check"></i><b>10.7</b> aver2_j-337k</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="ukbb.html"><a href="ukbb.html#calc"><i class="fa fa-check"></i><b>10.7.1</b> calc</a></li>
<li class="chapter" data-level="10.7.2" data-path="ukbb.html"><a href="ukbb.html#organize-data-1"><i class="fa fa-check"></i><b>10.7.2</b> organize data</a></li>
<li class="chapter" data-level="10.7.3" data-path="ukbb.html"><a href="ukbb.html#chisq-aver2_j-2"><i class="fa fa-check"></i><b>10.7.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>10.8</b> HE</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>10.8.1</b> making grms</a></li>
<li class="chapter" data-level="10.8.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>10.8.2</b> estimation</a></li>
<li class="chapter" data-level="10.8.3" data-path="ukbb.html"><a href="ukbb.html#summary-8"><i class="fa fa-check"></i><b>10.8.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>11</b> control GWAS</a>
<ul>
<li class="chapter" data-level="11.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>11.1</b> ID list</a></li>
<li class="chapter" data-level="11.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>11.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="11.3" data-path="control.html"><a href="control.html#gwas-1"><i class="fa fa-check"></i><b>11.3</b> GWAS</a></li>
<li class="chapter" data-level="11.4" data-path="control.html"><a href="control.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>11.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>11.4.1</b> under gcta</a></li>
<li class="chapter" data-level="11.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>11.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="11.4.3" data-path="control.html"><a href="control.html#summary-9"><i class="fa fa-check"></i><b>11.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>11.5</b> HE</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>11.5.1</b> making grms</a></li>
<li class="chapter" data-level="11.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>11.5.2</b> estimation</a></li>
<li class="chapter" data-level="11.5.3" data-path="control.html"><a href="control.html#summary-10"><i class="fa fa-check"></i><b>11.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="previous-gwas.html"><a href="previous-gwas.html"><i class="fa fa-check"></i><b>12</b> previous GWAS</a>
<ul>
<li class="chapter" data-level="12.1" data-path="previous-gwas.html"><a href="previous-gwas.html#qc"><i class="fa fa-check"></i><b>12.1</b> QC</a></li>
<li class="chapter" data-level="12.2" data-path="previous-gwas.html"><a href="previous-gwas.html#gwas-telomere-length"><i class="fa fa-check"></i><b>12.2</b> gwas-telomere length</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="previous-gwas.html"><a href="previous-gwas.html#aver2_j"><i class="fa fa-check"></i><b>12.2.1</b> aver2_j</a></li>
<li class="chapter" data-level="12.2.2" data-path="previous-gwas.html"><a href="previous-gwas.html#organize-data-2"><i class="fa fa-check"></i><b>12.2.2</b> organize data</a></li>
<li class="chapter" data-level="12.2.3" data-path="previous-gwas.html"><a href="previous-gwas.html#chisq-aver2_j-3"><i class="fa fa-check"></i><b>12.2.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="previous-gwas.html"><a href="previous-gwas.html#pr-interval-gwas"><i class="fa fa-check"></i><b>12.3</b> PR interval GWAS</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="previous-gwas.html"><a href="previous-gwas.html#aver2_j-1"><i class="fa fa-check"></i><b>12.3.1</b> aver2_j</a></li>
<li class="chapter" data-level="12.3.2" data-path="previous-gwas.html"><a href="previous-gwas.html#organize-data-3"><i class="fa fa-check"></i><b>12.3.2</b> organize data</a></li>
<li class="chapter" data-level="12.3.3" data-path="previous-gwas.html"><a href="previous-gwas.html#chisq-aver2_j-4"><i class="fa fa-check"></i><b>12.3.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="previous-gwas.html"><a href="previous-gwas.html#ben-neale-pan-ukbb"><i class="fa fa-check"></i><b>12.4</b> Ben Neale Pan-UKBB</a></li>
<li class="chapter" data-level="12.5" data-path="previous-gwas.html"><a href="previous-gwas.html#notesconcerns"><i class="fa fa-check"></i><b>12.5</b> notes/concerns</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html"><i class="fa fa-check"></i><b>13</b> GWAS: White British + Irish</a>
<ul>
<li class="chapter" data-level="13.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#id-list-1"><i class="fa fa-check"></i><b>13.1</b> ID list</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ids-who-have-no-missing-data"><i class="fa fa-check"></i><b>13.1.1</b> Ids who have no missing data</a></li>
<li class="chapter" data-level="13.1.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#relatedness-filtering-1"><i class="fa fa-check"></i><b>13.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="13.1.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#pc-plot-1"><i class="fa fa-check"></i><b>13.1.3</b> PC plot</a></li>
<li class="chapter" data-level="13.1.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#phenotypic-differences"><i class="fa fa-check"></i><b>13.1.4</b> phenotypic differences</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#gwas-lm-1"><i class="fa fa-check"></i><b>13.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#basic-covariates"><i class="fa fa-check"></i><b>13.2.1</b> basic covariates</a></li>
<li class="chapter" data-level="13.2.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#basic-covariates-pcs"><i class="fa fa-check"></i><b>13.2.2</b> basic covariates + PCs</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#chisq-aver2_j-5"><i class="fa fa-check"></i><b>13.3</b> chisq ~ aver2_j</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#calc-aver2_j-1"><i class="fa fa-check"></i><b>13.3.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="13.3.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#organize-data-4"><i class="fa fa-check"></i><b>13.3.2</b> organize data</a></li>
<li class="chapter" data-level="13.3.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#detect-confounding-wt-pcs"><i class="fa fa-check"></i><b>13.3.3</b> detect confounding: w/t PCs</a></li>
<li class="chapter" data-level="13.3.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#detect-confounding-with-pcs"><i class="fa fa-check"></i><b>13.3.4</b> detect confounding: with PCs</a></li>
<li class="chapter" data-level="13.3.5" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#inflation-good-gwas-vs.-control-vs.-british-irish"><i class="fa fa-check"></i><b>13.3.5</b> inflation: good gwas vs. control vs. british-irish</a></li>
<li class="chapter" data-level="13.3.6" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#inflation-aver2"><i class="fa fa-check"></i><b>13.3.6</b> inflation | aver2</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ideas-to-explore-to-do-list"><i class="fa fa-check"></i><b>13.4</b> Ideas to explore/ to do list:</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="related-individuals.html"><a href="related-individuals.html"><i class="fa fa-check"></i><b>14</b> related individuals</a>
<ul>
<li class="chapter" data-level="14.1" data-path="related-individuals.html"><a href="related-individuals.html#genotyped-snps"><i class="fa fa-check"></i><b>14.1</b> genotyped SNPs</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-2"><i class="fa fa-check"></i><b>14.1.1</b> aver2_j</a></li>
<li class="chapter" data-level="14.1.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-2"><i class="fa fa-check"></i><b>14.1.2</b> gwas</a></li>
<li class="chapter" data-level="14.1.3" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-5"><i class="fa fa-check"></i><b>14.1.3</b> organize data</a></li>
<li class="chapter" data-level="14.1.4" data-path="related-individuals.html"><a href="related-individuals.html#summary-11"><i class="fa fa-check"></i><b>14.1.4</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="related-individuals.html"><a href="related-individuals.html#hapmap3-snps"><i class="fa fa-check"></i><b>14.2</b> hapmap3 SNPs</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype-data"><i class="fa fa-check"></i><b>14.2.1</b> genotype data</a></li>
<li class="chapter" data-level="14.2.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-3"><i class="fa fa-check"></i><b>14.2.2</b> gwas</a></li>
<li class="chapter" data-level="14.2.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-3"><i class="fa fa-check"></i><b>14.2.3</b> aver2_j</a></li>
<li class="chapter" data-level="14.2.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-6"><i class="fa fa-check"></i><b>14.2.4</b> organize data</a></li>
<li class="chapter" data-level="14.2.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-6"><i class="fa fa-check"></i><b>14.2.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="14.2.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j"><i class="fa fa-check"></i><b>14.2.6</b> inflation ~ aver2_j</a></li>
<li class="chapter" data-level="14.2.7" data-path="related-individuals.html"><a href="related-individuals.html#chisq-test-statistics"><i class="fa fa-check"></i><b>14.2.7</b> chisq test statistics</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="related-individuals.html"><a href="related-individuals.html#mix-unrel-rel"><i class="fa fa-check"></i><b>14.3</b> mix unrel &amp; rel</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype"><i class="fa fa-check"></i><b>14.3.1</b> genotype</a></li>
<li class="chapter" data-level="14.3.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-4"><i class="fa fa-check"></i><b>14.3.2</b> gwas</a></li>
<li class="chapter" data-level="14.3.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-4"><i class="fa fa-check"></i><b>14.3.3</b> aver2_j</a></li>
<li class="chapter" data-level="14.3.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-7"><i class="fa fa-check"></i><b>14.3.4</b> organize data</a></li>
<li class="chapter" data-level="14.3.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-7"><i class="fa fa-check"></i><b>14.3.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="14.3.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j-1"><i class="fa fa-check"></i><b>14.3.6</b> inflation ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="related-individuals.html"><a href="related-individuals.html#fake-quintuplets"><i class="fa fa-check"></i><b>14.4</b> fake quintuplets</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="related-individuals.html"><a href="related-individuals.html#id-lists"><i class="fa fa-check"></i><b>14.4.1</b> id lists</a></li>
<li class="chapter" data-level="14.4.2" data-path="related-individuals.html"><a href="related-individuals.html#make-bfiles"><i class="fa fa-check"></i><b>14.4.2</b> make bfiles</a></li>
<li class="chapter" data-level="14.4.3" data-path="related-individuals.html"><a href="related-individuals.html#simulate-phenotypes"><i class="fa fa-check"></i><b>14.4.3</b> simulate phenotypes</a></li>
<li class="chapter" data-level="14.4.4" data-path="related-individuals.html"><a href="related-individuals.html#gwas-5"><i class="fa fa-check"></i><b>14.4.4</b> gwas</a></li>
<li class="chapter" data-level="14.4.5" data-path="related-individuals.html"><a href="related-individuals.html#compute-aver2-1"><i class="fa fa-check"></i><b>14.4.5</b> compute aver2</a></li>
<li class="chapter" data-level="14.4.6" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2-1"><i class="fa fa-check"></i><b>14.4.6</b> chisq ~ aver2</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="related-individuals.html"><a href="related-individuals.html#unrelated-controls"><i class="fa fa-check"></i><b>14.5</b> unrelated controls</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="related-individuals.html"><a href="related-individuals.html#id-lists-1"><i class="fa fa-check"></i><b>14.5.1</b> id lists</a></li>
<li class="chapter" data-level="14.5.2" data-path="related-individuals.html"><a href="related-individuals.html#make-bfiles-1"><i class="fa fa-check"></i><b>14.5.2</b> make bfiles</a></li>
<li class="chapter" data-level="14.5.3" data-path="related-individuals.html"><a href="related-individuals.html#simulate-phenotypes-1"><i class="fa fa-check"></i><b>14.5.3</b> simulate phenotypes</a></li>
<li class="chapter" data-level="14.5.4" data-path="related-individuals.html"><a href="related-individuals.html#gwas-6"><i class="fa fa-check"></i><b>14.5.4</b> gwas</a></li>
<li class="chapter" data-level="14.5.5" data-path="related-individuals.html"><a href="related-individuals.html#compute-aver2-2"><i class="fa fa-check"></i><b>14.5.5</b> compute aver2</a></li>
<li class="chapter" data-level="14.5.6" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2-2"><i class="fa fa-check"></i><b>14.5.6</b> chisq ~ aver2</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="related-individuals.html"><a href="related-individuals.html#related-vs.-unrelated"><i class="fa fa-check"></i><b>14.6</b> related vs. unrelated</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="related-individuals.html"><a href="related-individuals.html#chisq-test-statistics-1"><i class="fa fa-check"></i><b>14.6.1</b> chisq test statistics</a></li>
<li class="chapter" data-level="14.6.2" data-path="related-individuals.html"><a href="related-individuals.html#aver2"><i class="fa fa-check"></i><b>14.6.2</b> aver2</a></li>
<li class="chapter" data-level="14.6.3" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2-1"><i class="fa fa-check"></i><b>14.6.3</b> inflation ~ aver2</a></li>
<li class="chapter" data-level="14.6.4" data-path="related-individuals.html"><a href="related-individuals.html#chisq-ldscore"><i class="fa fa-check"></i><b>14.6.4</b> chisq ~ ldscore</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html"><i class="fa fa-check"></i><b>15</b> compute <span class="math inline">\(\sum_{i,j}^{m_1, m_2}r^2_{i,j}\)</span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwas-all-qced-snps"><i class="fa fa-check"></i><b>15.1</b> good GWAS-all qced snps</a></li>
<li class="chapter" data-level="15.2" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwass--ldak-thin-snps"><i class="fa fa-check"></i><b>15.2</b> good GWASs- ldak-thin snps</a></li>
<li class="chapter" data-level="15.3" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#bad-gwass-all-qced-snps"><i class="fa fa-check"></i><b>15.3</b> bad GWASs-all qced snps</a></li>
<li class="chapter" data-level="15.4" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#summary-12"><i class="fa fa-check"></i><b>15.4</b> summary</a></li>
<li class="chapter" data-level="15.5" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#aver2j"><i class="fa fa-check"></i><b>15.5</b> compute aver2_j</a></li>
<li class="chapter" data-level="15.6" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#mixed-pop-gwas-with-pc-as-covariates"><i class="fa fa-check"></i><b>15.6</b> mixed pop GWAS with PC as covariates</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="assortative-mating.html"><a href="assortative-mating.html"><i class="fa fa-check"></i><b>16</b> Assortative mating</a>
<ul>
<li class="chapter" data-level="16.1" data-path="assortative-mating.html"><a href="assortative-mating.html#test-the-idea"><i class="fa fa-check"></i><b>16.1</b> Test the idea</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="assortative-mating.html"><a href="assortative-mating.html#st-try"><i class="fa fa-check"></i><b>16.1.1</b> 1st try</a></li>
<li class="chapter" data-level="16.1.2" data-path="assortative-mating.html"><a href="assortative-mating.html#nd-try"><i class="fa fa-check"></i><b>16.1.2</b> 2nd try</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html"><i class="fa fa-check"></i><b>17</b> Reference Panel: 1k Genome</a>
<ul>
<li class="chapter" data-level="17.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#common-snplist"><i class="fa fa-check"></i><b>17.1</b> common snplist</a></li>
<li class="chapter" data-level="17.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#compute-aver2-3"><i class="fa fa-check"></i><b>17.2</b> compute aver2</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-1"><i class="fa fa-check"></i><b>17.2.1</b> bad gwas</a></li>
<li class="chapter" data-level="17.2.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding"><i class="fa fa-check"></i><b>17.2.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="17.2.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-1"><i class="fa fa-check"></i><b>17.2.3</b> good gwas</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#detect-confounding"><i class="fa fa-check"></i><b>17.3</b> detect confounding</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-2"><i class="fa fa-check"></i><b>17.3.1</b> bad gwas</a></li>
<li class="chapter" data-level="17.3.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding-1"><i class="fa fa-check"></i><b>17.3.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="17.3.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-2"><i class="fa fa-check"></i><b>17.3.3</b> good gwas</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#estimate-inflation"><i class="fa fa-check"></i><b>17.4</b> estimate inflation</a></li>
<li class="chapter" data-level="17.5" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#stratified-aver2"><i class="fa fa-check"></i><b>17.5</b> stratified aver2</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#calc-aver2"><i class="fa fa-check"></i><b>17.5.1</b> calc aver2</a></li>
<li class="chapter" data-level="17.5.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#organize-data-8"><i class="fa fa-check"></i><b>17.5.2</b> organize data</a></li>
<li class="chapter" data-level="17.5.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#plot-aver2-of-pairwise-mixture-pops"><i class="fa fa-check"></i><b>17.5.3</b> plot aver2 of pairwise mixture pops</a></li>
<li class="chapter" data-level="17.5.4" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#chisq-1-x-aver2"><i class="fa fa-check"></i><b>17.5.4</b> chisq ~ 1 x aver2</a></li>
<li class="chapter" data-level="17.5.5" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#chisq-multi-aver2"><i class="fa fa-check"></i><b>17.5.5</b> chisq ~ multi-aver2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html"><i class="fa fa-check"></i><b>18</b> Fine-scale population stratification</a>
<ul>
<li class="chapter" data-level="18.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#birth-location-data"><i class="fa fa-check"></i><b>18.1</b> birth location data</a></li>
<li class="chapter" data-level="18.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#pca-of-337k"><i class="fa fa-check"></i><b>18.2</b> pca of 337k</a></li>
<li class="chapter" data-level="18.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#birth-place-gwas"><i class="fa fa-check"></i><b>18.3</b> birth place gwas</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-7"><i class="fa fa-check"></i><b>18.3.1</b> gwas</a></li>
<li class="chapter" data-level="18.3.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#chisq-aver2-3"><i class="fa fa-check"></i><b>18.3.2</b> chisq ~ aver2</a></li>
<li class="chapter" data-level="18.3.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#detect-inflation-using-1kg"><i class="fa fa-check"></i><b>18.3.3</b> detect inflation using 1kg</a></li>
<li class="chapter" data-level="18.3.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-results"><i class="fa fa-check"></i><b>18.3.4</b> gwas results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-based-on-pc-clusters"><i class="fa fa-check"></i><b>18.4</b> GWAS based on PC clusters</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-lists-2"><i class="fa fa-check"></i><b>18.4.1</b> id lists</a></li>
<li class="chapter" data-level="18.4.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-list-for-bad-gwas2"><i class="fa fa-check"></i><b>18.4.2</b> id list for bad gwas2</a></li>
<li class="chapter" data-level="18.4.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-list-for-bad-gwas3"><i class="fa fa-check"></i><b>18.4.3</b> id list for bad gwas3</a></li>
<li class="chapter" data-level="18.4.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-3"><i class="fa fa-check"></i><b>18.4.4</b> bad gwas</a></li>
<li class="chapter" data-level="18.4.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2"><i class="fa fa-check"></i><b>18.4.5</b> bad gwas#2</a></li>
<li class="chapter" data-level="18.4.6" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3"><i class="fa fa-check"></i><b>18.4.6</b> bad gwas#3</a></li>
<li class="chapter" data-level="18.4.7" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-3"><i class="fa fa-check"></i><b>18.4.7</b> good gwas</a></li>
<li class="chapter" data-level="18.4.8" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-1"><i class="fa fa-check"></i><b>18.4.8</b> control gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#compute-aver2-4"><i class="fa fa-check"></i><b>18.5</b> compute aver2</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-4"><i class="fa fa-check"></i><b>18.5.1</b> bad-gwas</a></li>
<li class="chapter" data-level="18.5.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2-1"><i class="fa fa-check"></i><b>18.5.2</b> bad-gwas#2</a></li>
<li class="chapter" data-level="18.5.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3-1"><i class="fa fa-check"></i><b>18.5.3</b> bad-gwas#3</a></li>
<li class="chapter" data-level="18.5.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-4"><i class="fa fa-check"></i><b>18.5.4</b> good-gwas</a></li>
<li class="chapter" data-level="18.5.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-2"><i class="fa fa-check"></i><b>18.5.5</b> control-gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#chisq-aver2-4"><i class="fa fa-check"></i><b>18.6</b> chisq ~ aver2</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-5"><i class="fa fa-check"></i><b>18.6.1</b> bad gwas</a></li>
<li class="chapter" data-level="18.6.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2-2"><i class="fa fa-check"></i><b>18.6.2</b> bad gwas#2</a></li>
<li class="chapter" data-level="18.6.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3-2"><i class="fa fa-check"></i><b>18.6.3</b> bad gwas#3</a></li>
<li class="chapter" data-level="18.6.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-5"><i class="fa fa-check"></i><b>18.6.4</b> good gwas</a></li>
<li class="chapter" data-level="18.6.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-3"><i class="fa fa-check"></i><b>18.6.5</b> control gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#inflation-aver2-2"><i class="fa fa-check"></i><b>18.7</b> inflation ~ aver2</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="genotyping-errors.html"><a href="genotyping-errors.html"><i class="fa fa-check"></i><b>19</b> genotyping errors</a>
<ul>
<li class="chapter" data-level="19.1" data-path="genotyping-errors.html"><a href="genotyping-errors.html#id-list-phenotypes"><i class="fa fa-check"></i><b>19.1</b> id list &amp; phenotypes</a></li>
<li class="chapter" data-level="19.2" data-path="genotyping-errors.html"><a href="genotyping-errors.html#gwas-8"><i class="fa fa-check"></i><b>19.2</b> gwas</a></li>
<li class="chapter" data-level="19.3" data-path="genotyping-errors.html"><a href="genotyping-errors.html#compute-aver2-5"><i class="fa fa-check"></i><b>19.3</b> compute aver2</a></li>
<li class="chapter" data-level="19.4" data-path="genotyping-errors.html"><a href="genotyping-errors.html#chisq-aver2-5"><i class="fa fa-check"></i><b>19.4</b> chisq ~ aver2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GWAS Quality Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="related-individuals" class="section level1" number="14">
<h1><span class="header-section-number">14</span> related individuals</h1>
<div id="genotyped-snps" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> genotyped SNPs</h2>
<div id="aver2_j-2" class="section level3" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> aver2_j</h3>
<p>Previously we performed analyses on icd10 traits using related individuals. Here are relevant files:</p>
<ul>
<li><strong>bfile</strong>: gen/geno-rel: created using icd10/related.inds</li>
<li><strong>id lists</strong>:
<ul>
<li>56757 icd10/related.inds</li>
<li>56754 relatedness/cut.05.related: relatedness &gt;= 0.05.</li>
<li>56753 relatedness/cut.125.related</li>
<li>48197 relatedness/cut.25.related</li>
<li>18294 relatedness/cut.5.related</li>
</ul></li>
<li><strong>snp list</strong> after QC: gen/snps-rel-inds.use : 627,320 SNPs</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="related-individuals.html#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="related-individuals.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb1-3"><a href="related-individuals.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create id lists &amp; snp lists</span></span>
<span id="cb1-4"><a href="related-individuals.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb1-5"><a href="related-individuals.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="related-individuals.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># unrelated ids----------------------------------------------------------------</span></span>
<span id="cb1-7"><a href="related-individuals.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># serve as control groups</span></span>
<span id="cb1-8"><a href="related-individuals.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="va">n</span><span class="op">=</span><span class="va">(</span>56753 48197 18294<span class="va">)</span></span>
<span id="cb1-9"><a href="related-individuals.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span><span class="va">(</span>cut.125 cut.25 cut.5<span class="va">)</span></span>
<span id="cb1-10"><a href="related-individuals.html#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="related-individuals.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">0</span><span class="dt">..</span><span class="dv">2</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb1-12"><a href="related-individuals.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ex">shuf</span> rand.100000 <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">${n</span><span class="op">[</span><span class="va">$i</span><span class="op">]</span><span class="va">}</span> <span class="op">&gt;</span> white-unrel-rand-control-for-<span class="va">${nm</span><span class="op">[</span><span class="va">$i</span><span class="op">]</span><span class="va">}</span></span>
<span id="cb1-13"><a href="related-individuals.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb1-14"><a href="related-individuals.html#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="related-individuals.html#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># snp list----------------------------------------------------------------------</span></span>
<span id="cb1-16"><a href="related-individuals.html#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># common snps of related &amp; unrelated</span></span>
<span id="cb1-17"><a href="related-individuals.html#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="va">unrel</span><span class="op">=</span>gen/snps-unrel-inds.use <span class="co"># 1,103,209</span></span>
<span id="cb1-18"><a href="related-individuals.html#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="va">rel</span><span class="op">=</span>gen/snps-rel-inds.use <span class="co"># 627,320 SNPs</span></span>
<span id="cb1-19"><a href="related-individuals.html#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR{a[$1];next} </span></span>
<span id="cb1-20"><a href="related-individuals.html#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="st">    ($1 in a) {print $1}&#39;</span> <span class="va">$unrel</span> <span class="va">$rel</span> <span class="op">&gt;</span> gen/common-unrel-rel-snps <span class="co"># 153,313</span></span>
<span id="cb1-21"><a href="related-individuals.html#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="related-individuals.html#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># lista &amp; listb</span></span>
<span id="cb1-23"><a href="related-individuals.html#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># this will be common for all id lists</span></span>
<span id="cb1-24"><a href="related-individuals.html#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>10000</span>
<span id="cb1-25"><a href="related-individuals.html#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gen/common-unrel-rel-snps</span>
<span id="cb1-26"><a href="related-individuals.html#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/related/left-snps</span>
<span id="cb1-27"><a href="related-individuals.html#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/related/right-snps</span>
<span id="cb1-28"><a href="related-individuals.html#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="related-individuals.html#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb1-30"><a href="related-individuals.html#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&lt;8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$left</span>  </span>
<span id="cb1-31"><a href="related-individuals.html#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb1-32"><a href="related-individuals.html#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&gt;=8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$right</span></span>
<span id="cb1-33"><a href="related-individuals.html#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="related-individuals.html#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb1-35"><a href="related-individuals.html#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r^2_j</span></span>
<span id="cb1-36"><a href="related-individuals.html#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb1-37"><a href="related-individuals.html#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="related-individuals.html#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> nm <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb1-39"><a href="related-individuals.html#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="related-individuals.html#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># common snp lists</span></span>
<span id="cb1-41"><a href="related-individuals.html#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/related/right-snps</span>
<span id="cb1-42"><a href="related-individuals.html#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/related/left-snps</span>
<span id="cb1-43"><a href="related-individuals.html#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="related-individuals.html#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># related individuals</span></span>
<span id="cb1-45"><a href="related-individuals.html#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../relatedness/<span class="va">$nm</span>.related</span>
<span id="cb1-46"><a href="related-individuals.html#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-rel</span>
<span id="cb1-47"><a href="related-individuals.html#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/related/out/10k-snps-<span class="va">$nm</span>-rel</span>
<span id="cb1-48"><a href="related-individuals.html#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="related-individuals.html#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb1-50"><a href="related-individuals.html#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb1-51"><a href="related-individuals.html#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb1-52"><a href="related-individuals.html#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb1-53"><a href="related-individuals.html#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb1-54"><a href="related-individuals.html#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:10:0</span></span>
<span id="cb1-55"><a href="related-individuals.html#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb1-56"><a href="related-individuals.html#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-57"><a href="related-individuals.html#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-58"><a href="related-individuals.html#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-59"><a href="related-individuals.html#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-60"><a href="related-individuals.html#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb1-61"><a href="related-individuals.html#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps-<span class="va">$nm</span>-rel</span>
<span id="cb1-62"><a href="related-individuals.html#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="related-individuals.html#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># unrelated controls</span></span>
<span id="cb1-64"><a href="related-individuals.html#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../white-unrel-rand-control-for-<span class="va">$nm</span></span>
<span id="cb1-65"><a href="related-individuals.html#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-unrel</span>
<span id="cb1-66"><a href="related-individuals.html#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/related/out/10k-snps-<span class="va">$nm</span>-unrel</span>
<span id="cb1-67"><a href="related-individuals.html#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="related-individuals.html#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb1-69"><a href="related-individuals.html#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb1-70"><a href="related-individuals.html#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb1-71"><a href="related-individuals.html#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb1-72"><a href="related-individuals.html#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb1-73"><a href="related-individuals.html#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:10:0</span></span>
<span id="cb1-74"><a href="related-individuals.html#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb1-75"><a href="related-individuals.html#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-76"><a href="related-individuals.html#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-77"><a href="related-individuals.html#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-78"><a href="related-individuals.html#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb1-79"><a href="related-individuals.html#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb1-80"><a href="related-individuals.html#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps-<span class="va">$nm</span>-unrel</span>
<span id="cb1-81"><a href="related-individuals.html#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb1-82"><a href="related-individuals.html#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="related-individuals.html#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the job</span></span>
<span id="cb1-84"><a href="related-individuals.html#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> nm <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb1-85"><a href="related-individuals.html#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps-<span class="va">$nm</span>-rel</span>
<span id="cb1-86"><a href="related-individuals.html#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps-<span class="va">$nm</span>-unrel</span>
<span id="cb1-87"><a href="related-individuals.html#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/calc-r-related</span>
<span id="cb1-88"><a href="related-individuals.html#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="related-individuals.html#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r_j^2 for each i-------------------------------------------------</span></span>
<span id="cb1-90"><a href="related-individuals.html#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb1-91"><a href="related-individuals.html#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb1-92"><a href="related-individuals.html#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="va">cut</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;cut.125&quot;</span><span class="ex">,</span><span class="st">&quot;cut.25&quot;</span><span class="ex">,</span><span class="st">&quot;cut.5&quot;</span><span class="kw">)</span></span>
<span id="cb1-93"><a href="related-individuals.html#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="va">rel</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;rel&quot;</span><span class="ex">,</span><span class="st">&quot;unrel&quot;</span><span class="kw">)</span></span>
<span id="cb1-94"><a href="related-individuals.html#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="related-individuals.html#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">j</span> in 1:length<span class="er">(</span><span class="ex">rel</span><span class="kw">)){</span></span>
<span id="cb1-96"><a href="related-individuals.html#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="fu">cut</span><span class="kw">)){</span></span>
<span id="cb1-97"><a href="related-individuals.html#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="va">nm</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;10k-snps-&quot;</span><span class="ex">,cut[i],</span><span class="st">&quot;-&quot;</span><span class="ex">,rel[j]</span><span class="kw">)</span></span>
<span id="cb1-98"><a href="related-individuals.html#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/related/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.pairwise&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb1-99"><a href="related-individuals.html#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="va">lista</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/related/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsa&quot;</span><span class="kw">)</span><span class="ex">,</span> stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb1-100"><a href="related-individuals.html#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="va">listb</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/related/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsb&quot;</span><span class="kw">)</span><span class="ex">,</span> stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb1-101"><a href="related-individuals.html#cb1-101" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-102"><a href="related-individuals.html#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat</span><span class="op">=</span>dat[,-c<span class="kw">(</span><span class="ex">10001</span><span class="kw">)</span><span class="ex">]^2</span></span>
<span id="cb1-103"><a href="related-individuals.html#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="va">outb</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>listb<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,2,</span> mean<span class="kw">))</span></span>
<span id="cb1-104"><a href="related-individuals.html#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="va">outa</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>lista<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,1,</span> mean<span class="kw">))</span></span>
<span id="cb1-105"><a href="related-individuals.html#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">outa,outb</span><span class="kw">)</span></span>
<span id="cb1-106"><a href="related-individuals.html#cb1-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-107"><a href="related-individuals.html#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,paste0</span><span class="er">(</span><span class="st">&quot;summary/ave-r2-&quot;</span><span class="ex">,nm</span><span class="kw">)</span><span class="ex">,</span> col.names=F, row.names=F, quote=F<span class="kw">)</span>  </span>
<span id="cb1-108"><a href="related-individuals.html#cb1-108" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb1-109"><a href="related-individuals.html#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb1-110"><a href="related-individuals.html#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="related-individuals.html#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb1-112"><a href="related-individuals.html#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb1-113"><a href="related-individuals.html#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb1-114"><a href="related-individuals.html#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="related-individuals.html#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="co"># check if mean r^2_j differs for rel vs. unrel</span></span>
<span id="cb1-116"><a href="related-individuals.html#cb1-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-117"><a href="related-individuals.html#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="va">cut</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;cut.125&quot;</span><span class="ex">,</span><span class="st">&quot;cut.25&quot;</span><span class="ex">,</span><span class="st">&quot;cut.5&quot;</span><span class="kw">)</span></span>
<span id="cb1-118"><a href="related-individuals.html#cb1-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-119"><a href="related-individuals.html#cb1-119" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="fu">cut</span><span class="kw">)){</span></span>
<span id="cb1-120"><a href="related-individuals.html#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="va">nm_rel</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;ave-r2-10k-snps-&quot;</span><span class="ex">,cut[i],</span><span class="st">&quot;-rel&quot;</span><span class="kw">)</span></span>
<span id="cb1-121"><a href="related-individuals.html#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="va">nm_unrel</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;ave-r2-10k-snps-&quot;</span><span class="ex">,cut[i],</span><span class="st">&quot;-unrel&quot;</span><span class="kw">)</span></span>
<span id="cb1-122"><a href="related-individuals.html#cb1-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-123"><a href="related-individuals.html#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat_rel</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/&quot;</span><span class="ex">,nm_rel</span><span class="kw">)</span><span class="ex">,stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb1-124"><a href="related-individuals.html#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat_unrel</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/&quot;</span><span class="ex">,nm_unrel</span><span class="kw">)</span><span class="ex">,stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb1-125"><a href="related-individuals.html#cb1-125" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-126"><a href="related-individuals.html#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">rel</span><span class="op">=</span>cut[i],</span>
<span id="cb1-127"><a href="related-individuals.html#cb1-127" aria-hidden="true" tabindex="-1"></a>                    <span class="va">rel_ave</span><span class="op">=</span>mean<span class="kw">(</span><span class="ex">dat_rel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb1-128"><a href="related-individuals.html#cb1-128" aria-hidden="true" tabindex="-1"></a>                    <span class="va">rel_sd</span><span class="op">=</span>sd<span class="kw">(</span><span class="ex">dat_rel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb1-129"><a href="related-individuals.html#cb1-129" aria-hidden="true" tabindex="-1"></a>                    <span class="va">unrel_ave</span><span class="op">=</span>mean<span class="kw">(</span><span class="ex">dat_unrel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb1-130"><a href="related-individuals.html#cb1-130" aria-hidden="true" tabindex="-1"></a>                    <span class="va">unrel_sd</span><span class="op">=</span>sd<span class="kw">(</span><span class="ex">dat_unrel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb1-131"><a href="related-individuals.html#cb1-131" aria-hidden="true" tabindex="-1"></a>                    <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb1-132"><a href="related-individuals.html#cb1-132" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out1=out0}else</span><span class="dt">{out1=rbind(out1</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb1-133"><a href="related-individuals.html#cb1-133" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span></code></pre></div>
</div>
<div id="gwas-2" class="section level3" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> gwas</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="related-individuals.html#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="related-individuals.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create directories------------------------------------------------------------</span></span>
<span id="cb2-3"><a href="related-individuals.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-4"><a href="related-individuals.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{rel</span><span class="op">,</span><span class="dt">unrel}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb2-5"><a href="related-individuals.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-<span class="va">$j</span>-<span class="va">$i</span></span>
<span id="cb2-6"><a href="related-individuals.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-7"><a href="related-individuals.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-8"><a href="related-individuals.html#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="related-individuals.html#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gwas -------------------------------------------------------------------------</span></span>
<span id="cb2-10"><a href="related-individuals.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-11"><a href="related-individuals.html#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-12"><a href="related-individuals.html#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="related-individuals.html#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># related individuals----------------------</span></span>
<span id="cb2-14"><a href="related-individuals.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gwas-<span class="va">$j</span>-rel/<span class="va">$i</span>-linear</span>
<span id="cb2-15"><a href="related-individuals.html#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../relatedness/<span class="va">$j</span>.related</span>
<span id="cb2-16"><a href="related-individuals.html#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>../gen/snps-rel-inds.use</span>
<span id="cb2-17"><a href="related-individuals.html#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-rel</span>
<span id="cb2-18"><a href="related-individuals.html#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb2-19"><a href="related-individuals.html#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb2-20"><a href="related-individuals.html#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb2-21"><a href="related-individuals.html#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb2-22"><a href="related-individuals.html#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb2-23"><a href="related-individuals.html#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 8:0:0</span></span>
<span id="cb2-24"><a href="related-individuals.html#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="related-individuals.html#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-26"><a href="related-individuals.html#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb2-27"><a href="related-individuals.html#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-28"><a href="related-individuals.html#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-29"><a href="related-individuals.html#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract </span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-30"><a href="related-individuals.html#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb2-31"><a href="related-individuals.html#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb2-32"><a href="related-individuals.html#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span>-rel.sh</span>
<span id="cb2-33"><a href="related-individuals.html#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="related-individuals.html#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># unrelated individuals----------------------</span></span>
<span id="cb2-35"><a href="related-individuals.html#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gwas-<span class="va">$j</span>-unrel/<span class="va">$i</span>-linear</span>
<span id="cb2-36"><a href="related-individuals.html#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../white-unrel-rand-control-for-<span class="va">$j</span></span>
<span id="cb2-37"><a href="related-individuals.html#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>../gen/snps-unrel-inds.use</span>
<span id="cb2-38"><a href="related-individuals.html#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-unrel</span>
<span id="cb2-39"><a href="related-individuals.html#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb2-40"><a href="related-individuals.html#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb2-41"><a href="related-individuals.html#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb2-42"><a href="related-individuals.html#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb2-43"><a href="related-individuals.html#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb2-44"><a href="related-individuals.html#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 8:0:0</span></span>
<span id="cb2-45"><a href="related-individuals.html#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="related-individuals.html#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-47"><a href="related-individuals.html#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb2-48"><a href="related-individuals.html#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-49"><a href="related-individuals.html#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-50"><a href="related-individuals.html#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract </span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-51"><a href="related-individuals.html#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb2-52"><a href="related-individuals.html#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb2-53"><a href="related-individuals.html#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span>-unrel.sh</span>
<span id="cb2-54"><a href="related-individuals.html#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-55"><a href="related-individuals.html#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-56"><a href="related-individuals.html#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="related-individuals.html#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb2-58"><a href="related-individuals.html#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-59"><a href="related-individuals.html#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-60"><a href="related-individuals.html#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span>-rel.sh</span>
<span id="cb2-61"><a href="related-individuals.html#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span>-unrel.sh</span>
<span id="cb2-62"><a href="related-individuals.html#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-63"><a href="related-individuals.html#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-related</span>
<span id="cb2-64"><a href="related-individuals.html#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="related-individuals.html#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion</span></span>
<span id="cb2-66"><a href="related-individuals.html#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-related</span>
<span id="cb2-67"><a href="related-individuals.html#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb2-68"><a href="related-individuals.html#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb2-69"><a href="related-individuals.html#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-70"><a href="related-individuals.html#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb2-71"><a href="related-individuals.html#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb2-72"><a href="related-individuals.html#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb2-73"><a href="related-individuals.html#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb2-74"><a href="related-individuals.html#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb2-75"><a href="related-individuals.html#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-76"><a href="related-individuals.html#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb2-77"><a href="related-individuals.html#cb2-77" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb2-78"><a href="related-individuals.html#cb2-78" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb2-79"><a href="related-individuals.html#cb2-79" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb2-80"><a href="related-individuals.html#cb2-80" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb2-81"><a href="related-individuals.html#cb2-81" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb2-82"><a href="related-individuals.html#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="organize-data-5" class="section level3" number="14.1.3">
<h3><span class="header-section-number">14.1.3</span> organize data</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="related-individuals.html#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="related-individuals.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb3-3"><a href="related-individuals.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># compute MAF</span></span>
<span id="cb3-4"><a href="related-individuals.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb3-5"><a href="related-individuals.html#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="related-individuals.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-7"><a href="related-individuals.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{rel</span><span class="op">,</span><span class="dt">unrel}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb3-8"><a href="related-individuals.html#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="related-individuals.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gen/maf/geno-<span class="va">$j</span>-<span class="va">$i</span></span>
<span id="cb3-10"><a href="related-individuals.html#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="related-individuals.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$i</span> <span class="ot">==</span> rel <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-12"><a href="related-individuals.html#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="va">bfile</span><span class="op">=</span>../gen/geno-rel</span>
<span id="cb3-13"><a href="related-individuals.html#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="va">id</span><span class="op">=</span>../relatedness/<span class="va">$j</span>.related</span>
<span id="cb3-14"><a href="related-individuals.html#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb3-15"><a href="related-individuals.html#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="va">bfile</span><span class="op">=</span>../gen/geno-unrel</span>
<span id="cb3-16"><a href="related-individuals.html#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="va">id</span><span class="op">=</span>../white-unrel-rand-control-for-<span class="va">$j</span></span>
<span id="cb3-17"><a href="related-individuals.html#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-18"><a href="related-individuals.html#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="related-individuals.html#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb3-20"><a href="related-individuals.html#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb3-21"><a href="related-individuals.html#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb3-22"><a href="related-individuals.html#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb3-23"><a href="related-individuals.html#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb3-24"><a href="related-individuals.html#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb3-25"><a href="related-individuals.html#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="related-individuals.html#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-stats </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb3-27"><a href="related-individuals.html#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb3-28"><a href="related-individuals.html#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span></span>
<span id="cb3-29"><a href="related-individuals.html#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb3-30"><a href="related-individuals.html#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/calc-maf-<span class="va">$j</span>-<span class="va">$i</span>.sh</span>
<span id="cb3-31"><a href="related-individuals.html#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-32"><a href="related-individuals.html#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-33"><a href="related-individuals.html#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="related-individuals.html#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb3-35"><a href="related-individuals.html#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-36"><a href="related-individuals.html#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{rel</span><span class="op">,</span><span class="dt">unrel}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb3-37"><a href="related-individuals.html#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-maf-<span class="va">$j</span>-<span class="va">$i</span>.sh</span>
<span id="cb3-38"><a href="related-individuals.html#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-39"><a href="related-individuals.html#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/calc-maf-rel</span>
<span id="cb3-40"><a href="related-individuals.html#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="related-individuals.html#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb3-42"><a href="related-individuals.html#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co"># extract LD scores</span></span>
<span id="cb3-43"><a href="related-individuals.html#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb3-44"><a href="related-individuals.html#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># we do this for related individuals.</span></span>
<span id="cb3-45"><a href="related-individuals.html#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ld scores of snp list for unrelated id: snps-unrel-maf.001.ldscore </span></span>
<span id="cb3-46"><a href="related-individuals.html#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="related-individuals.html#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co"># convert snp list to rs system ------------------------------------------------</span></span>
<span id="cb3-48"><a href="related-individuals.html#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gen/snps-rel-inds.use</span>
<span id="cb3-49"><a href="related-individuals.html#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>gen/snps-rel-rs</span>
<span id="cb3-50"><a href="related-individuals.html#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1]; b[$1]=$2; next}</span></span>
<span id="cb3-51"><a href="related-individuals.html#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="st">     ($1 in a){print b[$1], $2}&#39;</span> doug/ukbb.ldsc <span class="va">$infile</span> <span class="op">&gt;</span> <span class="va">$outfile</span></span>
<span id="cb3-52"><a href="related-individuals.html#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="related-individuals.html#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co">#  extract ld scores -----------------------------------------------------------</span></span>
<span id="cb3-54"><a href="related-individuals.html#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>ldsc/eur_w_ld_chr</span>
<span id="cb3-55"><a href="related-individuals.html#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chrom <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-56"><a href="related-individuals.html#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> <span class="va">$dir</span>/<span class="va">$chrom</span>.l2.ldscore.gz <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $2, $6}&#39;</span> <span class="op">&gt;</span> ldscore</span>
<span id="cb3-57"><a href="related-individuals.html#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $0}&#39;</span> gen/snps-rel-rs ldscore <span class="op">&gt;</span> temp</span>
<span id="cb3-58"><a href="related-individuals.html#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$chrom</span> <span class="ot">-eq</span> 1 <span class="bu">]</span></span>
<span id="cb3-59"><a href="related-individuals.html#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="cf">then</span> </span>
<span id="cb3-60"><a href="related-individuals.html#cb3-60" aria-hidden="true" tabindex="-1"></a> <span class="fu">mv</span> temp snps-rel.ldscore</span>
<span id="cb3-61"><a href="related-individuals.html#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb3-62"><a href="related-individuals.html#cb3-62" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span> snps-rel.ldscore temp <span class="op">&gt;</span> temp2</span>
<span id="cb3-63"><a href="related-individuals.html#cb3-63" aria-hidden="true" tabindex="-1"></a> <span class="fu">mv</span> temp2 snps-rel.ldscore</span>
<span id="cb3-64"><a href="related-individuals.html#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-65"><a href="related-individuals.html#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$chrom</span></span>
<span id="cb3-66"><a href="related-individuals.html#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-67"><a href="related-individuals.html#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="related-individuals.html#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb3-69"><a href="related-individuals.html#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="co">#  put info together</span></span>
<span id="cb3-70"><a href="related-individuals.html#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb3-71"><a href="related-individuals.html#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="related-individuals.html#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co"># maf: gen/maf/geno-[cut.125]-[rel]</span></span>
<span id="cb3-73"><a href="related-individuals.html#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="co"># chi square : gwas-[cut.125]-[rel]/[trait]-linear.summaries</span></span>
<span id="cb3-74"><a href="related-individuals.html#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="co"># ave r^2_j: summary/ave-r2-10k-snps-[cut.25]-[unrel]</span></span>
<span id="cb3-75"><a href="related-individuals.html#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="co"># ld score from ldsc ref panel: snps-unrel-maf.001.ldscore; snps-rel.ldscore</span></span>
<span id="cb3-76"><a href="related-individuals.html#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="related-individuals.html#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed file</span></span>
<span id="cb3-78"><a href="related-individuals.html#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>doug/ukbb.ldsc</span>
<span id="cb3-79"><a href="related-individuals.html#cb3-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-80"><a href="related-individuals.html#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{cut.125</span><span class="op">,</span><span class="dt">cut.25</span><span class="op">,</span><span class="dt">cut.5}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-81"><a href="related-individuals.html#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{rel</span><span class="op">,</span><span class="dt">unrel}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb3-82"><a href="related-individuals.html#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="related-individuals.html#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="co"># files vary depending on j &amp;/or  i</span></span>
<span id="cb3-84"><a href="related-individuals.html#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="va">maf</span><span class="op">=</span>gen/maf/geno-<span class="va">$j</span>-<span class="va">$i</span>.stats <span class="co"># use as the snp list to integrate all info</span></span>
<span id="cb3-85"><a href="related-individuals.html#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-<span class="va">$j</span>-<span class="va">$i</span></span>
<span id="cb3-86"><a href="related-individuals.html#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="related-individuals.html#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$i</span> <span class="ot">==</span> rel <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-88"><a href="related-individuals.html#cb3-88" aria-hidden="true" tabindex="-1"></a>  <span class="va">ldsc</span><span class="op">=</span>snps-rel.ldscore</span>
<span id="cb3-89"><a href="related-individuals.html#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb3-90"><a href="related-individuals.html#cb3-90" aria-hidden="true" tabindex="-1"></a>  <span class="va">ldsc</span><span class="op">=</span>snps-unrel-maf.001.ldscore</span>
<span id="cb3-91"><a href="related-individuals.html#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-92"><a href="related-individuals.html#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="related-individuals.html#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="co"># create temporary files</span></span>
<span id="cb3-94"><a href="related-individuals.html#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR &gt; 1 {print $1, $5 }&#39;</span> <span class="va">$maf</span> <span class="op">&gt;</span> tmp/maf.tmp</span>
<span id="cb3-95"><a href="related-individuals.html#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$2]; b[$2]=$1; next} ($1 in a) {print b[$1], $0}&#39;</span> <span class="va">$rs</span> <span class="va">$ldsc</span> <span class="op">&gt;</span> tmp/ldsc.tmp1</span>
<span id="cb3-96"><a href="related-individuals.html#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="co"># here we make sure the order of the rows are the same as maf.tmp</span></span>
<span id="cb3-97"><a href="related-individuals.html#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; c[$1]=$3 ; next} </span></span>
<span id="cb3-98"><a href="related-individuals.html#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1], c[$1];</span></span>
<span id="cb3-99"><a href="related-individuals.html#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="st">      else print &quot;NA&quot;}&#39;</span> tmp/ldsc.tmp1 tmp/maf.tmp <span class="op">&gt;</span> tmp/ldsc.tmp</span>
<span id="cb3-100"><a href="related-individuals.html#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb3-101"><a href="related-individuals.html#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb3-102"><a href="related-individuals.html#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/maf.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb3-103"><a href="related-individuals.html#cb3-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-104"><a href="related-individuals.html#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-105"><a href="related-individuals.html#cb3-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-106"><a href="related-individuals.html#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="co"># files vary with j, i and trait</span></span>
<span id="cb3-107"><a href="related-individuals.html#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-<span class="va">$j</span>-<span class="va">$i</span>/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb3-108"><a href="related-individuals.html#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-related-all-out/<span class="va">$trait</span>-<span class="va">$j</span>-<span class="va">$i</span>.out</span>
<span id="cb3-109"><a href="related-individuals.html#cb3-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-110"><a href="related-individuals.html#cb3-110" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$5; next} </span></span>
<span id="cb3-111"><a href="related-individuals.html#cb3-111" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb3-112"><a href="related-individuals.html#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$gwas</span> tmp/maf.tmp <span class="op">&gt;</span> tmp/gwas.tmp     </span>
<span id="cb3-113"><a href="related-individuals.html#cb3-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-114"><a href="related-individuals.html#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb3-115"><a href="related-individuals.html#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/maf.tmp <span class="dt">\</span></span>
<span id="cb3-116"><a href="related-individuals.html#cb3-116" aria-hidden="true" tabindex="-1"></a>      tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb3-117"><a href="related-individuals.html#cb3-117" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb3-118"><a href="related-individuals.html#cb3-118" aria-hidden="true" tabindex="-1"></a>      tmp/ldsc.tmp <span class="dt">\</span></span>
<span id="cb3-119"><a href="related-individuals.html#cb3-119" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb3-120"><a href="related-individuals.html#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;maf;chisq;aver2;rs;ldsc&quot;}</span></span>
<span id="cb3-121"><a href="related-individuals.html#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb3-122"><a href="related-individuals.html#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-123"><a href="related-individuals.html#cb3-123" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-124"><a href="related-individuals.html#cb3-124" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="summary-11" class="section level3" number="14.1.4">
<h3><span class="header-section-number">14.1.4</span> summary</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="related-individuals.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb4-2"><a href="related-individuals.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j</span></span>
<span id="cb4-3"><a href="related-individuals.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb4-4"><a href="related-individuals.html#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="related-individuals.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb4-6"><a href="related-individuals.html#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="related-individuals.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#cuts=c(&quot;cut.125&quot;,&quot;cut.25&quot;,&quot;cut.5&quot;)</span></span>
<span id="cb4-8"><a href="related-individuals.html#cb4-8" aria-hidden="true" tabindex="-1"></a>cuts<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span></span>
<span id="cb4-9"><a href="related-individuals.html#cb4-9" aria-hidden="true" tabindex="-1"></a>related<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;rel&quot;</span>,<span class="st">&quot;unrel&quot;</span>)</span>
<span id="cb4-10"><a href="related-individuals.html#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="related-individuals.html#cb4-11" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb4-12"><a href="related-individuals.html#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb4-13"><a href="related-individuals.html#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb4-14"><a href="related-individuals.html#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="related-individuals.html#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(related)){</span>
<span id="cb4-16"><a href="related-individuals.html#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cuts)){</span>
<span id="cb4-17"><a href="related-individuals.html#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb4-18"><a href="related-individuals.html#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="related-individuals.html#cb4-19" aria-hidden="true" tabindex="-1"></a>    rel<span class="ot">=</span>related[i]</span>
<span id="cb4-20"><a href="related-individuals.html#cb4-20" aria-hidden="true" tabindex="-1"></a>    cut<span class="ot">=</span>cuts[j]</span>
<span id="cb4-21"><a href="related-individuals.html#cb4-21" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[k]</span>
<span id="cb4-22"><a href="related-individuals.html#cb4-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-23"><a href="related-individuals.html#cb4-23" aria-hidden="true" tabindex="-1"></a>    file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,</span>
<span id="cb4-24"><a href="related-individuals.html#cb4-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;-&quot;</span>,rel,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb4-25"><a href="related-individuals.html#cb4-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-26"><a href="related-individuals.html#cb4-26" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb4-27"><a href="related-individuals.html#cb4-27" aria-hidden="true" tabindex="-1"></a>    mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb4-28"><a href="related-individuals.html#cb4-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-29"><a href="related-individuals.html#cb4-29" aria-hidden="true" tabindex="-1"></a>    slope0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb4-30"><a href="related-individuals.html#cb4-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cutoff=</span>cut,</span>
<span id="cb4-31"><a href="related-individuals.html#cb4-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rel=</span>rel,</span>
<span id="cb4-32"><a href="related-individuals.html#cb4-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">slope_aver2=</span><span class="fu">coef</span>(mod)[<span class="dv">2</span>],</span>
<span id="cb4-33"><a href="related-individuals.html#cb4-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">p_aver2=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>],</span>
<span id="cb4-34"><a href="related-individuals.html#cb4-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb4-35"><a href="related-individuals.html#cb4-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-36"><a href="related-individuals.html#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> j<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>){slope<span class="ot">=</span>slope0} <span class="cf">else</span> {slope<span class="ot">=</span><span class="fu">rbind</span>(slope,slope0)}</span>
<span id="cb4-37"><a href="related-individuals.html#cb4-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-38"><a href="related-individuals.html#cb4-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-39"><a href="related-individuals.html#cb4-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-40"><a href="related-individuals.html#cb4-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-41"><a href="related-individuals.html#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="related-individuals.html#cb4-42" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span>slope[<span class="fu">order</span>(slope<span class="sc">$</span>trait, slope<span class="sc">$</span>cutoff, slope<span class="sc">$</span>rel),]</span>
<span id="cb4-43"><a href="related-individuals.html#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co">#write.table(out,&quot;summary/chisq-aver2-slope-gwas-related.txt&quot;, </span></span>
<span id="cb4-44"><a href="related-individuals.html#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co">#            col.names=T, row.names=F, quote=F)</span></span>
<span id="cb4-45"><a href="related-individuals.html#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="related-individuals.html#cb4-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="related-individuals.html#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb4-48"><a href="related-individuals.html#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="co"># plot chisq ~ aver2_j  by rel | cut</span></span>
<span id="cb4-49"><a href="related-individuals.html#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb4-50"><a href="related-individuals.html#cb4-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-51"><a href="related-individuals.html#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="co"># function to plot a single trait---------------------------------------------------</span></span>
<span id="cb4-52"><a href="related-individuals.html#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="related-individuals.html#cb4-53" aria-hidden="true" tabindex="-1"></a>make_plot<span class="ot">=</span><span class="cf">function</span>(trait, cut){</span>
<span id="cb4-54"><a href="related-individuals.html#cb4-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-55"><a href="related-individuals.html#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define variables</span></span>
<span id="cb4-56"><a href="related-individuals.html#cb4-56" aria-hidden="true" tabindex="-1"></a>  cut<span class="ot">=</span>cut</span>
<span id="cb4-57"><a href="related-individuals.html#cb4-57" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>trait</span>
<span id="cb4-58"><a href="related-individuals.html#cb4-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-59"><a href="related-individuals.html#cb4-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define color</span></span>
<span id="cb4-60"><a href="related-individuals.html#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(RColorBrewer)</span>
<span id="cb4-61"><a href="related-individuals.html#cb4-61" aria-hidden="true" tabindex="-1"></a>  qual_col_pals <span class="ot">=</span> brewer.pal.info[brewer.pal.info<span class="sc">$</span>category <span class="sc">==</span> <span class="st">&#39;qual&#39;</span>,]</span>
<span id="cb4-62"><a href="related-individuals.html#cb4-62" aria-hidden="true" tabindex="-1"></a>  col_vector <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">mapply</span>(brewer.pal, qual_col_pals<span class="sc">$</span>maxcolors, <span class="fu">rownames</span>(qual_col_pals)))</span>
<span id="cb4-63"><a href="related-individuals.html#cb4-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">14</span>)</span>
<span id="cb4-64"><a href="related-individuals.html#cb4-64" aria-hidden="true" tabindex="-1"></a>  mycol<span class="ot">=</span><span class="fu">sample</span>(col_vector,<span class="dv">2</span>)</span>
<span id="cb4-65"><a href="related-individuals.html#cb4-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-66"><a href="related-individuals.html#cb4-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># related </span></span>
<span id="cb4-67"><a href="related-individuals.html#cb4-67" aria-hidden="true" tabindex="-1"></a>    file1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-rel.out&quot;</span>)</span>
<span id="cb4-68"><a href="related-individuals.html#cb4-68" aria-hidden="true" tabindex="-1"></a>    dat1<span class="ot">=</span><span class="fu">vroom</span>(file1, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb4-69"><a href="related-individuals.html#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb4-70"><a href="related-individuals.html#cb4-70" aria-hidden="true" tabindex="-1"></a>    cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat1<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb4-71"><a href="related-individuals.html#cb4-71" aria-hidden="true" tabindex="-1"></a>    dat1<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat1<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb4-72"><a href="related-individuals.html#cb4-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average chisq by bin values</span></span>
<span id="cb4-73"><a href="related-individuals.html#cb4-73" aria-hidden="true" tabindex="-1"></a>    out1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat1<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat1<span class="sc">$</span>bin, mean))</span>
<span id="cb4-74"><a href="related-individuals.html#cb4-74" aria-hidden="true" tabindex="-1"></a>    out1<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat1<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat1<span class="sc">$</span>bin, mean)</span>
<span id="cb4-75"><a href="related-individuals.html#cb4-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-76"><a href="related-individuals.html#cb4-76" aria-hidden="true" tabindex="-1"></a>   <span class="co"># unrelated </span></span>
<span id="cb4-77"><a href="related-individuals.html#cb4-77" aria-hidden="true" tabindex="-1"></a>    file2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-unrel.out&quot;</span>)</span>
<span id="cb4-78"><a href="related-individuals.html#cb4-78" aria-hidden="true" tabindex="-1"></a>    dat2<span class="ot">=</span><span class="fu">vroom</span>(file2, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb4-79"><a href="related-individuals.html#cb4-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb4-80"><a href="related-individuals.html#cb4-80" aria-hidden="true" tabindex="-1"></a>    cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat2<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb4-81"><a href="related-individuals.html#cb4-81" aria-hidden="true" tabindex="-1"></a>    dat2<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat2<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb4-82"><a href="related-individuals.html#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average chisq by bin values</span></span>
<span id="cb4-83"><a href="related-individuals.html#cb4-83" aria-hidden="true" tabindex="-1"></a>    out2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat2<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat2<span class="sc">$</span>bin, mean))</span>
<span id="cb4-84"><a href="related-individuals.html#cb4-84" aria-hidden="true" tabindex="-1"></a>    out2<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat2<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat2<span class="sc">$</span>bin, mean)  </span>
<span id="cb4-85"><a href="related-individuals.html#cb4-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-86"><a href="related-individuals.html#cb4-86" aria-hidden="true" tabindex="-1"></a>    xstart<span class="ot">=</span><span class="fu">min</span>(out1<span class="sc">$</span>bin_val,out2<span class="sc">$</span>bin_val)</span>
<span id="cb4-87"><a href="related-individuals.html#cb4-87" aria-hidden="true" tabindex="-1"></a>    xend<span class="ot">=</span><span class="fu">max</span>(out1<span class="sc">$</span>bin_val,out2<span class="sc">$</span>bin_val)</span>
<span id="cb4-88"><a href="related-individuals.html#cb4-88" aria-hidden="true" tabindex="-1"></a>    ystart<span class="ot">=</span><span class="fu">min</span>(out1<span class="sc">$</span>chisq_ave,out2<span class="sc">$</span>chisq_ave)</span>
<span id="cb4-89"><a href="related-individuals.html#cb4-89" aria-hidden="true" tabindex="-1"></a>    yend<span class="ot">=</span><span class="fu">max</span>(out1<span class="sc">$</span>chisq_ave,out2<span class="sc">$</span>chisq_ave)</span>
<span id="cb4-90"><a href="related-individuals.html#cb4-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-91"><a href="related-individuals.html#cb4-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(out1<span class="sc">$</span>bin_val, out1<span class="sc">$</span>chisq_ave,</span>
<span id="cb4-92"><a href="related-individuals.html#cb4-92" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave chisq&quot;</span>,</span>
<span id="cb4-93"><a href="related-individuals.html#cb4-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlim=</span><span class="fu">c</span>(xstart,xend), <span class="at">ylim=</span><span class="fu">c</span>(ystart,yend),</span>
<span id="cb4-94"><a href="related-individuals.html#cb4-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="fu">paste0</span>(trait,<span class="st">&quot; &quot;</span>, cut), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb4-95"><a href="related-individuals.html#cb4-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span>mycol[<span class="dv">1</span>], <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-96"><a href="related-individuals.html#cb4-96" aria-hidden="true" tabindex="-1"></a>      <span class="fu">points</span>(out2<span class="sc">$</span>bin_val, out2<span class="sc">$</span>chisq_ave,</span>
<span id="cb4-97"><a href="related-individuals.html#cb4-97" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">bg=</span>mycol[<span class="dv">2</span>], <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-98"><a href="related-individuals.html#cb4-98" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(trait<span class="sc">==</span><span class="st">&quot;awake&quot;</span>){</span>
<span id="cb4-99"><a href="related-individuals.html#cb4-99" aria-hidden="true" tabindex="-1"></a>     <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;rel&quot;</span>,<span class="st">&quot;unrel&quot;</span>), </span>
<span id="cb4-100"><a href="related-individuals.html#cb4-100" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span>mycol, <span class="at">cex=</span><span class="fl">1.5</span>, <span class="at">box.lty=</span><span class="dv">0</span>)}</span>
<span id="cb4-101"><a href="related-individuals.html#cb4-101" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb4-102"><a href="related-individuals.html#cb4-102" aria-hidden="true" tabindex="-1"></a>} <span class="co"># end of function</span></span>
<span id="cb4-103"><a href="related-individuals.html#cb4-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-104"><a href="related-individuals.html#cb4-104" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot ------------------------------------------------------------------</span></span>
<span id="cb4-105"><a href="related-individuals.html#cb4-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-106"><a href="related-individuals.html#cb4-106" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb4-107"><a href="related-individuals.html#cb4-107" aria-hidden="true" tabindex="-1"></a>cuts<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;cut.125&quot;</span>,<span class="st">&quot;cut.25&quot;</span>,<span class="st">&quot;cut.5&quot;</span>)</span>
<span id="cb4-108"><a href="related-individuals.html#cb4-108" aria-hidden="true" tabindex="-1"></a>related<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;rel&quot;</span>,<span class="st">&quot;unrel&quot;</span>)</span>
<span id="cb4-109"><a href="related-individuals.html#cb4-109" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb4-110"><a href="related-individuals.html#cb4-110" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb4-111"><a href="related-individuals.html#cb4-111" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb4-112"><a href="related-individuals.html#cb4-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-113"><a href="related-individuals.html#cb4-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cuts)){</span>
<span id="cb4-114"><a href="related-individuals.html#cb4-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-115"><a href="related-individuals.html#cb4-115" aria-hidden="true" tabindex="-1"></a>  cut<span class="ot">=</span>cuts[j]</span>
<span id="cb4-116"><a href="related-individuals.html#cb4-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot chisq ~ aver2 by rel for a given cutoff for relatedness</span></span>
<span id="cb4-117"><a href="related-individuals.html#cb4-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-related-gwas-&quot;</span>,cut,<span class="st">&quot;.png&quot;</span>),</span>
<span id="cb4-118"><a href="related-individuals.html#cb4-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb4-119"><a href="related-individuals.html#cb4-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb4-120"><a href="related-individuals.html#cb4-120" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb4-121"><a href="related-individuals.html#cb4-121" aria-hidden="true" tabindex="-1"></a>        trait<span class="ot">=</span>traits[i]</span>
<span id="cb4-122"><a href="related-individuals.html#cb4-122" aria-hidden="true" tabindex="-1"></a>        <span class="fu">make_plot</span>(trait, cut)</span>
<span id="cb4-123"><a href="related-individuals.html#cb4-123" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-124"><a href="related-individuals.html#cb4-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb4-125"><a href="related-individuals.html#cb4-125" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="hapmap3-snps" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> hapmap3 SNPs</h2>
<div id="genotype-data" class="section level3" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> genotype data</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="related-individuals.html#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="related-individuals.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb5-3"><a href="related-individuals.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># make bfiles by chromosome</span></span>
<span id="cb5-4"><a href="related-individuals.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::</span></span>
<span id="cb5-5"><a href="related-individuals.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb5-6"><a href="related-individuals.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb5-7"><a href="related-individuals.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb5-8"><a href="related-individuals.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb5-9"><a href="related-individuals.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb5-10"><a href="related-individuals.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb5-11"><a href="related-individuals.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb5-12"><a href="related-individuals.html#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="related-individuals.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb5-14"><a href="related-individuals.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../icd10/related.inds </span><span class="dt">\</span></span>
<span id="cb5-15"><a href="related-individuals.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../doug/ukbb.ldsc </span><span class="dt">\</span></span>
<span id="cb5-16"><a href="related-individuals.html#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb5-17"><a href="related-individuals.html#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb5-18"><a href="related-individuals.html#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.8 2 </span><span class="dt">\</span></span>
<span id="cb5-19"><a href="related-individuals.html#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb5-20"><a href="related-individuals.html#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb5-21"><a href="related-individuals.html#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb5-22"><a href="related-individuals.html#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb5-23"><a href="related-individuals.html#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb5-24"><a href="related-individuals.html#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb5-25"><a href="related-individuals.html#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="related-individuals.html#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb5-27"><a href="related-individuals.html#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb5-28"><a href="related-individuals.html#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$i</span>.sh</span>
<span id="cb5-29"><a href="related-individuals.html#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/mkbfile-related</span>
<span id="cb5-30"><a href="related-individuals.html#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="related-individuals.html#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion</span></span>
<span id="cb5-32"><a href="related-individuals.html#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/mkbfile-related</span>
<span id="cb5-33"><a href="related-individuals.html#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb5-34"><a href="related-individuals.html#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb5-35"><a href="related-individuals.html#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb5-36"><a href="related-individuals.html#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb5-37"><a href="related-individuals.html#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb5-38"><a href="related-individuals.html#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb5-39"><a href="related-individuals.html#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb5-40"><a href="related-individuals.html#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb5-41"><a href="related-individuals.html#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb5-42"><a href="related-individuals.html#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb5-43"><a href="related-individuals.html#cb5-43" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb5-44"><a href="related-individuals.html#cb5-44" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb5-45"><a href="related-individuals.html#cb5-45" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb5-46"><a href="related-individuals.html#cb5-46" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb5-47"><a href="related-individuals.html#cb5-47" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb5-48"><a href="related-individuals.html#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb5-49"><a href="related-individuals.html#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="related-individuals.html#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::</span></span>
<span id="cb5-51"><a href="related-individuals.html#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="co"># merge bfiles </span></span>
<span id="cb5-52"><a href="related-individuals.html#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="co">#::::</span></span>
<span id="cb5-53"><a href="related-individuals.html#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="related-individuals.html#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile.list</span>
<span id="cb5-55"><a href="related-individuals.html#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb5-56"><a href="related-individuals.html#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span>bfile.list</span>
<span id="cb5-57"><a href="related-individuals.html#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb5-58"><a href="related-individuals.html#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="related-individuals.html#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb5-60"><a href="related-individuals.html#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb5-61"><a href="related-individuals.html#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb5-62"><a href="related-individuals.html#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb5-63"><a href="related-individuals.html#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb5-64"><a href="related-individuals.html#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 40:0:0</span></span>
<span id="cb5-65"><a href="related-individuals.html#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-rel-hmp3 </span><span class="dt">\</span></span>
<span id="cb5-66"><a href="related-individuals.html#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile.list </span><span class="dt">\</span></span>
<span id="cb5-67"><a href="related-individuals.html#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb5-68"><a href="related-individuals.html#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb5-69"><a href="related-individuals.html#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile.sh</span>
<span id="cb5-70"><a href="related-individuals.html#cb5-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-71"><a href="related-individuals.html#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb5-72"><a href="related-individuals.html#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile.sh <span class="op">&gt;</span>../job-records/mbfiles-related</span>
<span id="cb5-73"><a href="related-individuals.html#cb5-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-74"><a href="related-individuals.html#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="co"># snp list --------------------------------------------------------------------</span></span>
<span id="cb5-75"><a href="related-individuals.html#cb5-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-76"><a href="related-individuals.html#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate </span></span>
<span id="cb5-77"><a href="related-individuals.html#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> gen/geno-rel-hmp3.stats <span class="st">&#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> gen/snps-rel-hmp3.use</span>
<span id="cb5-78"><a href="related-individuals.html#cb5-78" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 1,105,446 SNPs</span></span></code></pre></div>
</div>
<div id="gwas-3" class="section level3" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> gwas</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="related-individuals.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># script ----------------------------------------------------------------------</span></span>
<span id="cb6-2"><a href="related-individuals.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb6-3"><a href="related-individuals.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for j in {cut.125,cut.25,cut.5}; do</span></span>
<span id="cb6-4"><a href="related-individuals.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="va">j</span><span class="op">=</span>cut.125</span>
<span id="cb6-5"><a href="related-individuals.html#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="related-individuals.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chr <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb6-7"><a href="related-individuals.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../relatedness/<span class="va">$j</span>.related</span>
<span id="cb6-8"><a href="related-individuals.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>../gen/snps-rel-hmp3.use</span>
<span id="cb6-9"><a href="related-individuals.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-rel-hmp3</span>
<span id="cb6-10"><a href="related-individuals.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gwas-<span class="va">$j</span>-rel/<span class="va">$i</span>-linear-<span class="va">$chr</span></span>
<span id="cb6-11"><a href="related-individuals.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb6-12"><a href="related-individuals.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb6-13"><a href="related-individuals.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb6-14"><a href="related-individuals.html#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb6-15"><a href="related-individuals.html#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb6-16"><a href="related-individuals.html#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 8:0:0</span></span>
<span id="cb6-17"><a href="related-individuals.html#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="related-individuals.html#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb6-19"><a href="related-individuals.html#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb6-20"><a href="related-individuals.html#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb6-21"><a href="related-individuals.html#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb6-22"><a href="related-individuals.html#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract </span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb6-23"><a href="related-individuals.html#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb6-24"><a href="related-individuals.html#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb6-25"><a href="related-individuals.html#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$chr</span></span>
<span id="cb6-26"><a href="related-individuals.html#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span>-rel-chr-<span class="va">$chr</span>.sh</span>
<span id="cb6-27"><a href="related-individuals.html#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb6-28"><a href="related-individuals.html#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb6-29"><a href="related-individuals.html#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#done</span></span>
<span id="cb6-30"><a href="related-individuals.html#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="related-individuals.html#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb6-32"><a href="related-individuals.html#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb6-33"><a href="related-individuals.html#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="va">j</span><span class="op">=</span>cut.125</span>
<span id="cb6-34"><a href="related-individuals.html#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chr <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb6-35"><a href="related-individuals.html#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">#for j in {cut.125,cut.25,cut.5}; do</span></span>
<span id="cb6-36"><a href="related-individuals.html#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span>-rel-chr-<span class="va">$chr</span>.sh</span>
<span id="cb6-37"><a href="related-individuals.html#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co">#sbatch -A snpher ../sh_script/$i-linear-$j-unrel.sh</span></span>
<span id="cb6-38"><a href="related-individuals.html#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb6-39"><a href="related-individuals.html#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-related</span>
<span id="cb6-40"><a href="related-individuals.html#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="related-individuals.html#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb6-42"><a href="related-individuals.html#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-related</span>
<span id="cb6-43"><a href="related-individuals.html#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb6-44"><a href="related-individuals.html#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb6-45"><a href="related-individuals.html#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb6-46"><a href="related-individuals.html#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb6-47"><a href="related-individuals.html#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb6-48"><a href="related-individuals.html#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb6-49"><a href="related-individuals.html#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb6-50"><a href="related-individuals.html#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb6-51"><a href="related-individuals.html#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb6-52"><a href="related-individuals.html#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb6-53"><a href="related-individuals.html#cb6-53" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb6-54"><a href="related-individuals.html#cb6-54" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb6-55"><a href="related-individuals.html#cb6-55" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb6-56"><a href="related-individuals.html#cb6-56" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb6-57"><a href="related-individuals.html#cb6-57" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb6-58"><a href="related-individuals.html#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb6-59"><a href="related-individuals.html#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="related-individuals.html#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files-------------------------------------------------------------------</span></span>
<span id="cb6-61"><a href="related-individuals.html#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="related-individuals.html#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co"># only do .summaries &amp; .pvalues</span></span>
<span id="cb6-63"><a href="related-individuals.html#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb6-64"><a href="related-individuals.html#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb6-65"><a href="related-individuals.html#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$j</span> <span class="ot">==</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb6-66"><a href="related-individuals.html#cb6-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.summaries <span class="op">&gt;</span> <span class="va">$i</span>-linear.summaries</span>
<span id="cb6-67"><a href="related-individuals.html#cb6-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.pvalues <span class="op">&gt;</span> <span class="va">$i</span>-linear.pvalues</span>
<span id="cb6-68"><a href="related-individuals.html#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb6-69"><a href="related-individuals.html#cb6-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.summaries <span class="op">&gt;&gt;</span> <span class="va">$i</span>-linear.summaries</span>
<span id="cb6-70"><a href="related-individuals.html#cb6-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.pvalues <span class="op">&gt;&gt;</span> <span class="va">$i</span>-linear.pvalues</span>
<span id="cb6-71"><a href="related-individuals.html#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb6-72"><a href="related-individuals.html#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb6-73"><a href="related-individuals.html#cb6-73" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="aver2_j-3" class="section level3" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> aver2_j</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="related-individuals.html#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="related-individuals.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb7-3"><a href="related-individuals.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  snp lists</span></span>
<span id="cb7-4"><a href="related-individuals.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb7-5"><a href="related-individuals.html#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="related-individuals.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># snp list----------------------------------------------------------------------</span></span>
<span id="cb7-7"><a href="related-individuals.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># common snps of related &amp; unrelated</span></span>
<span id="cb7-8"><a href="related-individuals.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="va">unrel</span><span class="op">=</span>gen/snps-unrel-inds.use <span class="co"># 1,103,209</span></span>
<span id="cb7-9"><a href="related-individuals.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="va">rel</span><span class="op">=</span>gen/snps-rel-hmp3.use <span class="co"># 1,105,446 SNPs</span></span>
<span id="cb7-10"><a href="related-individuals.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR{a[$1];next} </span></span>
<span id="cb7-11"><a href="related-individuals.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="st">    ($1 in a) {print $1}&#39;</span> <span class="va">$unrel</span> <span class="va">$rel</span> <span class="op">&gt;</span> gen/common-unrel-rel-snps <span class="co"># 1,101,844</span></span>
<span id="cb7-12"><a href="related-individuals.html#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="related-individuals.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># lista &amp; listb</span></span>
<span id="cb7-14"><a href="related-individuals.html#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># this will be common for all id lists</span></span>
<span id="cb7-15"><a href="related-individuals.html#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>10000</span>
<span id="cb7-16"><a href="related-individuals.html#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gen/common-unrel-rel-snps</span>
<span id="cb7-17"><a href="related-individuals.html#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/related/left-snps</span>
<span id="cb7-18"><a href="related-individuals.html#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/related/right-snps</span>
<span id="cb7-19"><a href="related-individuals.html#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="related-individuals.html#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb7-21"><a href="related-individuals.html#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&lt;8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$left</span>  </span>
<span id="cb7-22"><a href="related-individuals.html#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb7-23"><a href="related-individuals.html#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&gt;=8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$right</span></span>
<span id="cb7-24"><a href="related-individuals.html#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="related-individuals.html#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb7-26"><a href="related-individuals.html#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r^2_j</span></span>
<span id="cb7-27"><a href="related-individuals.html#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb7-28"><a href="related-individuals.html#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="related-individuals.html#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#for nm in {cut.125,cut.25,cut.5}; do</span></span>
<span id="cb7-30"><a href="related-individuals.html#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span>cut.125</span>
<span id="cb7-31"><a href="related-individuals.html#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># common snp lists</span></span>
<span id="cb7-32"><a href="related-individuals.html#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/related/right-snps</span>
<span id="cb7-33"><a href="related-individuals.html#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/related/left-snps</span>
<span id="cb7-34"><a href="related-individuals.html#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="related-individuals.html#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># related individuals</span></span>
<span id="cb7-36"><a href="related-individuals.html#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../relatedness/<span class="va">$nm</span>.related</span>
<span id="cb7-37"><a href="related-individuals.html#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-rel-hmp3</span>
<span id="cb7-38"><a href="related-individuals.html#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/related/out/10k-snps-<span class="va">$nm</span>-rel</span>
<span id="cb7-39"><a href="related-individuals.html#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="related-individuals.html#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb7-41"><a href="related-individuals.html#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb7-42"><a href="related-individuals.html#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb7-43"><a href="related-individuals.html#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb7-44"><a href="related-individuals.html#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb7-45"><a href="related-individuals.html#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:10:0</span></span>
<span id="cb7-46"><a href="related-individuals.html#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb7-47"><a href="related-individuals.html#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-48"><a href="related-individuals.html#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-49"><a href="related-individuals.html#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-50"><a href="related-individuals.html#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-51"><a href="related-individuals.html#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb7-52"><a href="related-individuals.html#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps-<span class="va">$nm</span>-rel</span>
<span id="cb7-53"><a href="related-individuals.html#cb7-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-54"><a href="related-individuals.html#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co"># unrelated controls</span></span>
<span id="cb7-55"><a href="related-individuals.html#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../white-unrel-rand-control-for-<span class="va">$nm</span></span>
<span id="cb7-56"><a href="related-individuals.html#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-unrel</span>
<span id="cb7-57"><a href="related-individuals.html#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/related/out/10k-snps-<span class="va">$nm</span>-unrel</span>
<span id="cb7-58"><a href="related-individuals.html#cb7-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-59"><a href="related-individuals.html#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb7-60"><a href="related-individuals.html#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb7-61"><a href="related-individuals.html#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb7-62"><a href="related-individuals.html#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb7-63"><a href="related-individuals.html#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb7-64"><a href="related-individuals.html#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:10:0</span></span>
<span id="cb7-65"><a href="related-individuals.html#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb7-66"><a href="related-individuals.html#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-67"><a href="related-individuals.html#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-68"><a href="related-individuals.html#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-69"><a href="related-individuals.html#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb7-70"><a href="related-individuals.html#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb7-71"><a href="related-individuals.html#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps-<span class="va">$nm</span>-unrel</span>
<span id="cb7-72"><a href="related-individuals.html#cb7-72" aria-hidden="true" tabindex="-1"></a><span class="co">#done</span></span>
<span id="cb7-73"><a href="related-individuals.html#cb7-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-74"><a href="related-individuals.html#cb7-74" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the job</span></span>
<span id="cb7-75"><a href="related-individuals.html#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="co">#for nm in {cut.125,cut.25,cut.5}; do</span></span>
<span id="cb7-76"><a href="related-individuals.html#cb7-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> nm <span class="kw">in</span> cut.125<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb7-77"><a href="related-individuals.html#cb7-77" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps-<span class="va">$nm</span>-rel</span>
<span id="cb7-78"><a href="related-individuals.html#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps-<span class="va">$nm</span>-unrel</span>
<span id="cb7-79"><a href="related-individuals.html#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/calc-r-related</span>
<span id="cb7-80"><a href="related-individuals.html#cb7-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-81"><a href="related-individuals.html#cb7-81" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r_j^2 for each i-------------------------------------------------</span></span>
<span id="cb7-82"><a href="related-individuals.html#cb7-82" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb7-83"><a href="related-individuals.html#cb7-83" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb7-84"><a href="related-individuals.html#cb7-84" aria-hidden="true" tabindex="-1"></a><span class="co">#cut=c(&quot;cut.125&quot;,&quot;cut.25&quot;,&quot;cut.5&quot;)</span></span>
<span id="cb7-85"><a href="related-individuals.html#cb7-85" aria-hidden="true" tabindex="-1"></a><span class="va">cut</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;cut.125&quot;</span><span class="kw">)</span></span>
<span id="cb7-86"><a href="related-individuals.html#cb7-86" aria-hidden="true" tabindex="-1"></a><span class="va">rel</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;rel&quot;</span><span class="ex">,</span><span class="st">&quot;unrel&quot;</span><span class="kw">)</span></span>
<span id="cb7-87"><a href="related-individuals.html#cb7-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-88"><a href="related-individuals.html#cb7-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">j</span> in 1:length<span class="er">(</span><span class="ex">rel</span><span class="kw">)){</span></span>
<span id="cb7-89"><a href="related-individuals.html#cb7-89" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="fu">cut</span><span class="kw">)){</span></span>
<span id="cb7-90"><a href="related-individuals.html#cb7-90" aria-hidden="true" tabindex="-1"></a>    <span class="va">nm</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;10k-snps-&quot;</span><span class="ex">,cut[i],</span><span class="st">&quot;-&quot;</span><span class="ex">,rel[j]</span><span class="kw">)</span></span>
<span id="cb7-91"><a href="related-individuals.html#cb7-91" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/related/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.pairwise&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb7-92"><a href="related-individuals.html#cb7-92" aria-hidden="true" tabindex="-1"></a>    <span class="va">lista</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/related/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsa&quot;</span><span class="kw">)</span><span class="ex">,</span> stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb7-93"><a href="related-individuals.html#cb7-93" aria-hidden="true" tabindex="-1"></a>    <span class="va">listb</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/related/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsb&quot;</span><span class="kw">)</span><span class="ex">,</span> stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb7-94"><a href="related-individuals.html#cb7-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-95"><a href="related-individuals.html#cb7-95" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat</span><span class="op">=</span>dat[,-c<span class="kw">(</span><span class="ex">10001</span><span class="kw">)</span><span class="ex">]^2</span></span>
<span id="cb7-96"><a href="related-individuals.html#cb7-96" aria-hidden="true" tabindex="-1"></a>    <span class="va">outb</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>listb<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,2,</span> mean<span class="kw">))</span></span>
<span id="cb7-97"><a href="related-individuals.html#cb7-97" aria-hidden="true" tabindex="-1"></a>    <span class="va">outa</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>lista<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,1,</span> mean<span class="kw">))</span></span>
<span id="cb7-98"><a href="related-individuals.html#cb7-98" aria-hidden="true" tabindex="-1"></a>    <span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">outa,outb</span><span class="kw">)</span></span>
<span id="cb7-99"><a href="related-individuals.html#cb7-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-100"><a href="related-individuals.html#cb7-100" aria-hidden="true" tabindex="-1"></a>    <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,paste0</span><span class="er">(</span><span class="st">&quot;summary/ave-r2-&quot;</span><span class="ex">,nm</span><span class="kw">)</span><span class="ex">,</span> col.names=F, row.names=F, quote=F<span class="kw">)</span>  </span>
<span id="cb7-101"><a href="related-individuals.html#cb7-101" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb7-102"><a href="related-individuals.html#cb7-102" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb7-103"><a href="related-individuals.html#cb7-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-104"><a href="related-individuals.html#cb7-104" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb7-105"><a href="related-individuals.html#cb7-105" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb7-106"><a href="related-individuals.html#cb7-106" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb7-107"><a href="related-individuals.html#cb7-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-108"><a href="related-individuals.html#cb7-108" aria-hidden="true" tabindex="-1"></a><span class="co"># check if mean r^2_j differs for rel vs. unrel</span></span>
<span id="cb7-109"><a href="related-individuals.html#cb7-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-110"><a href="related-individuals.html#cb7-110" aria-hidden="true" tabindex="-1"></a><span class="co">#cut=c(&quot;cut.125&quot;,&quot;cut.25&quot;,&quot;cut.5&quot;)</span></span>
<span id="cb7-111"><a href="related-individuals.html#cb7-111" aria-hidden="true" tabindex="-1"></a><span class="va">cut</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;cut.125&quot;</span><span class="kw">)</span></span>
<span id="cb7-112"><a href="related-individuals.html#cb7-112" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="fu">cut</span><span class="kw">)){</span></span>
<span id="cb7-113"><a href="related-individuals.html#cb7-113" aria-hidden="true" tabindex="-1"></a>    <span class="va">nm_rel</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;ave-r2-10k-snps-&quot;</span><span class="ex">,cut[i],</span><span class="st">&quot;-rel&quot;</span><span class="kw">)</span></span>
<span id="cb7-114"><a href="related-individuals.html#cb7-114" aria-hidden="true" tabindex="-1"></a>    <span class="va">nm_unrel</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;ave-r2-10k-snps-&quot;</span><span class="ex">,cut[i],</span><span class="st">&quot;-unrel&quot;</span><span class="kw">)</span></span>
<span id="cb7-115"><a href="related-individuals.html#cb7-115" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-116"><a href="related-individuals.html#cb7-116" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat_rel</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/&quot;</span><span class="ex">,nm_rel</span><span class="kw">)</span><span class="ex">,stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb7-117"><a href="related-individuals.html#cb7-117" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat_unrel</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/&quot;</span><span class="ex">,nm_unrel</span><span class="kw">)</span><span class="ex">,stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb7-118"><a href="related-individuals.html#cb7-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-119"><a href="related-individuals.html#cb7-119" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">rel</span><span class="op">=</span>cut[i],</span>
<span id="cb7-120"><a href="related-individuals.html#cb7-120" aria-hidden="true" tabindex="-1"></a>                    <span class="va">rel_ave</span><span class="op">=</span>mean<span class="kw">(</span><span class="ex">dat_rel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb7-121"><a href="related-individuals.html#cb7-121" aria-hidden="true" tabindex="-1"></a>                    <span class="va">rel_sd</span><span class="op">=</span>sd<span class="kw">(</span><span class="ex">dat_rel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb7-122"><a href="related-individuals.html#cb7-122" aria-hidden="true" tabindex="-1"></a>                    <span class="va">unrel_ave</span><span class="op">=</span>mean<span class="kw">(</span><span class="ex">dat_unrel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb7-123"><a href="related-individuals.html#cb7-123" aria-hidden="true" tabindex="-1"></a>                    <span class="va">unrel_sd</span><span class="op">=</span>sd<span class="kw">(</span><span class="ex">dat_unrel</span><span class="va">$V2</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb7-124"><a href="related-individuals.html#cb7-124" aria-hidden="true" tabindex="-1"></a>                    <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb7-125"><a href="related-individuals.html#cb7-125" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out1=out0}else</span><span class="dt">{out1=rbind(out1</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb7-126"><a href="related-individuals.html#cb7-126" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span></code></pre></div>
</div>
<div id="organize-data-6" class="section level3" number="14.2.4">
<h3><span class="header-section-number">14.2.4</span> organize data</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="related-individuals.html#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="related-individuals.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#for j in {cut.125,cut.25,cut.5}; do</span></span>
<span id="cb8-3"><a href="related-individuals.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> cut.125<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb8-4"><a href="related-individuals.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{rel</span><span class="op">,</span><span class="dt">unrel}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb8-5"><a href="related-individuals.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb8-6"><a href="related-individuals.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-<span class="va">$j</span>-<span class="va">$i</span>/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb8-7"><a href="related-individuals.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-<span class="va">$j</span>-<span class="va">$i</span></span>
<span id="cb8-8"><a href="related-individuals.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-related-all-out/<span class="va">$trait</span>-<span class="va">$j</span>-<span class="va">$i</span>.out</span>
<span id="cb8-9"><a href="related-individuals.html#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="related-individuals.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp</span>
<span id="cb8-11"><a href="related-individuals.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb8-12"><a href="related-individuals.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb8-13"><a href="related-individuals.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb8-14"><a href="related-individuals.html#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="related-individuals.html#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb8-16"><a href="related-individuals.html#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb8-17"><a href="related-individuals.html#cb8-17" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb8-18"><a href="related-individuals.html#cb8-18" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb8-19"><a href="related-individuals.html#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2&quot;}</span></span>
<span id="cb8-20"><a href="related-individuals.html#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb8-21"><a href="related-individuals.html#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb8-22"><a href="related-individuals.html#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb8-23"><a href="related-individuals.html#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="chisq-aver2_j-6" class="section level3" number="14.2.5">
<h3><span class="header-section-number">14.2.5</span> chisq ~ aver2_j</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="related-individuals.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb9-2"><a href="related-individuals.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j</span></span>
<span id="cb9-3"><a href="related-individuals.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb9-4"><a href="related-individuals.html#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="related-individuals.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb9-6"><a href="related-individuals.html#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="related-individuals.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#cuts=c(&quot;cut.125&quot;,&quot;cut.25&quot;,&quot;cut.5&quot;)</span></span>
<span id="cb9-8"><a href="related-individuals.html#cb9-8" aria-hidden="true" tabindex="-1"></a>cuts<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span></span>
<span id="cb9-9"><a href="related-individuals.html#cb9-9" aria-hidden="true" tabindex="-1"></a>related<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;rel&quot;</span>,<span class="st">&quot;unrel&quot;</span>)</span>
<span id="cb9-10"><a href="related-individuals.html#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="related-individuals.html#cb9-11" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb9-12"><a href="related-individuals.html#cb9-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb9-13"><a href="related-individuals.html#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb9-14"><a href="related-individuals.html#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="related-individuals.html#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(related)){</span>
<span id="cb9-16"><a href="related-individuals.html#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cuts)){</span>
<span id="cb9-17"><a href="related-individuals.html#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb9-18"><a href="related-individuals.html#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="related-individuals.html#cb9-19" aria-hidden="true" tabindex="-1"></a>    rel<span class="ot">=</span>related[i]</span>
<span id="cb9-20"><a href="related-individuals.html#cb9-20" aria-hidden="true" tabindex="-1"></a>    cut<span class="ot">=</span>cuts[j]</span>
<span id="cb9-21"><a href="related-individuals.html#cb9-21" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[k]</span>
<span id="cb9-22"><a href="related-individuals.html#cb9-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-23"><a href="related-individuals.html#cb9-23" aria-hidden="true" tabindex="-1"></a>    file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,</span>
<span id="cb9-24"><a href="related-individuals.html#cb9-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;-&quot;</span>,rel,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb9-25"><a href="related-individuals.html#cb9-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-26"><a href="related-individuals.html#cb9-26" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb9-27"><a href="related-individuals.html#cb9-27" aria-hidden="true" tabindex="-1"></a>    mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb9-28"><a href="related-individuals.html#cb9-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-29"><a href="related-individuals.html#cb9-29" aria-hidden="true" tabindex="-1"></a>    slope0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb9-30"><a href="related-individuals.html#cb9-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cutoff=</span>cut,</span>
<span id="cb9-31"><a href="related-individuals.html#cb9-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rel=</span>rel,</span>
<span id="cb9-32"><a href="related-individuals.html#cb9-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">slope_aver2=</span><span class="fu">coef</span>(mod)[<span class="dv">2</span>],</span>
<span id="cb9-33"><a href="related-individuals.html#cb9-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">p_aver2=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>],</span>
<span id="cb9-34"><a href="related-individuals.html#cb9-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb9-35"><a href="related-individuals.html#cb9-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-36"><a href="related-individuals.html#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> j<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>){slope<span class="ot">=</span>slope0} <span class="cf">else</span> {slope<span class="ot">=</span><span class="fu">rbind</span>(slope,slope0)}</span>
<span id="cb9-37"><a href="related-individuals.html#cb9-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-38"><a href="related-individuals.html#cb9-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-39"><a href="related-individuals.html#cb9-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-40"><a href="related-individuals.html#cb9-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-41"><a href="related-individuals.html#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="related-individuals.html#cb9-42" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span>slope[<span class="fu">order</span>(slope<span class="sc">$</span>trait, slope<span class="sc">$</span>cutoff, slope<span class="sc">$</span>rel),]</span>
<span id="cb9-43"><a href="related-individuals.html#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#write.table(out,&quot;summary/chisq-aver2-slope-gwas-related.txt&quot;, </span></span>
<span id="cb9-44"><a href="related-individuals.html#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#            col.names=T, row.names=F, quote=F)</span></span>
<span id="cb9-45"><a href="related-individuals.html#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="related-individuals.html#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="related-individuals.html#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb9-48"><a href="related-individuals.html#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co"># plot chisq ~ aver2_j  by rel | cut</span></span>
<span id="cb9-49"><a href="related-individuals.html#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb9-50"><a href="related-individuals.html#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="related-individuals.html#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co"># function to plot a single trait---------------------------------------------------</span></span>
<span id="cb9-52"><a href="related-individuals.html#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="related-individuals.html#cb9-53" aria-hidden="true" tabindex="-1"></a>make_plot<span class="ot">=</span><span class="cf">function</span>(trait, cut){</span>
<span id="cb9-54"><a href="related-individuals.html#cb9-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-55"><a href="related-individuals.html#cb9-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define variables</span></span>
<span id="cb9-56"><a href="related-individuals.html#cb9-56" aria-hidden="true" tabindex="-1"></a>  cut<span class="ot">=</span>cut</span>
<span id="cb9-57"><a href="related-individuals.html#cb9-57" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>trait</span>
<span id="cb9-58"><a href="related-individuals.html#cb9-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-59"><a href="related-individuals.html#cb9-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define color</span></span>
<span id="cb9-60"><a href="related-individuals.html#cb9-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(RColorBrewer)</span>
<span id="cb9-61"><a href="related-individuals.html#cb9-61" aria-hidden="true" tabindex="-1"></a>  qual_col_pals <span class="ot">=</span> brewer.pal.info[brewer.pal.info<span class="sc">$</span>category <span class="sc">==</span> <span class="st">&#39;qual&#39;</span>,]</span>
<span id="cb9-62"><a href="related-individuals.html#cb9-62" aria-hidden="true" tabindex="-1"></a>  col_vector <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">mapply</span>(brewer.pal, qual_col_pals<span class="sc">$</span>maxcolors, <span class="fu">rownames</span>(qual_col_pals)))</span>
<span id="cb9-63"><a href="related-individuals.html#cb9-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">14</span>)</span>
<span id="cb9-64"><a href="related-individuals.html#cb9-64" aria-hidden="true" tabindex="-1"></a>  mycol<span class="ot">=</span><span class="fu">sample</span>(col_vector,<span class="dv">2</span>)</span>
<span id="cb9-65"><a href="related-individuals.html#cb9-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-66"><a href="related-individuals.html#cb9-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># related </span></span>
<span id="cb9-67"><a href="related-individuals.html#cb9-67" aria-hidden="true" tabindex="-1"></a>    file1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-rel.out&quot;</span>)</span>
<span id="cb9-68"><a href="related-individuals.html#cb9-68" aria-hidden="true" tabindex="-1"></a>    dat1<span class="ot">=</span><span class="fu">vroom</span>(file1, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb9-69"><a href="related-individuals.html#cb9-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb9-70"><a href="related-individuals.html#cb9-70" aria-hidden="true" tabindex="-1"></a>    cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat1<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb9-71"><a href="related-individuals.html#cb9-71" aria-hidden="true" tabindex="-1"></a>    dat1<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat1<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb9-72"><a href="related-individuals.html#cb9-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average chisq by bin values</span></span>
<span id="cb9-73"><a href="related-individuals.html#cb9-73" aria-hidden="true" tabindex="-1"></a>    out1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat1<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat1<span class="sc">$</span>bin, mean))</span>
<span id="cb9-74"><a href="related-individuals.html#cb9-74" aria-hidden="true" tabindex="-1"></a>    out1<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat1<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat1<span class="sc">$</span>bin, mean)</span>
<span id="cb9-75"><a href="related-individuals.html#cb9-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-76"><a href="related-individuals.html#cb9-76" aria-hidden="true" tabindex="-1"></a>   <span class="co"># unrelated </span></span>
<span id="cb9-77"><a href="related-individuals.html#cb9-77" aria-hidden="true" tabindex="-1"></a>    file2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-unrel.out&quot;</span>)</span>
<span id="cb9-78"><a href="related-individuals.html#cb9-78" aria-hidden="true" tabindex="-1"></a>    dat2<span class="ot">=</span><span class="fu">vroom</span>(file2, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb9-79"><a href="related-individuals.html#cb9-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb9-80"><a href="related-individuals.html#cb9-80" aria-hidden="true" tabindex="-1"></a>    cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat2<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb9-81"><a href="related-individuals.html#cb9-81" aria-hidden="true" tabindex="-1"></a>    dat2<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat2<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb9-82"><a href="related-individuals.html#cb9-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average chisq by bin values</span></span>
<span id="cb9-83"><a href="related-individuals.html#cb9-83" aria-hidden="true" tabindex="-1"></a>    out2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat2<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat2<span class="sc">$</span>bin, mean))</span>
<span id="cb9-84"><a href="related-individuals.html#cb9-84" aria-hidden="true" tabindex="-1"></a>    out2<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat2<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat2<span class="sc">$</span>bin, mean)  </span>
<span id="cb9-85"><a href="related-individuals.html#cb9-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-86"><a href="related-individuals.html#cb9-86" aria-hidden="true" tabindex="-1"></a>    xstart<span class="ot">=</span><span class="fu">min</span>(out1<span class="sc">$</span>bin_val,out2<span class="sc">$</span>bin_val)</span>
<span id="cb9-87"><a href="related-individuals.html#cb9-87" aria-hidden="true" tabindex="-1"></a>    xend<span class="ot">=</span><span class="fu">max</span>(out1<span class="sc">$</span>bin_val,out2<span class="sc">$</span>bin_val)</span>
<span id="cb9-88"><a href="related-individuals.html#cb9-88" aria-hidden="true" tabindex="-1"></a>    ystart<span class="ot">=</span><span class="fu">min</span>(out1<span class="sc">$</span>chisq_ave,out2<span class="sc">$</span>chisq_ave)</span>
<span id="cb9-89"><a href="related-individuals.html#cb9-89" aria-hidden="true" tabindex="-1"></a>    yend<span class="ot">=</span><span class="fu">max</span>(out1<span class="sc">$</span>chisq_ave,out2<span class="sc">$</span>chisq_ave)</span>
<span id="cb9-90"><a href="related-individuals.html#cb9-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-91"><a href="related-individuals.html#cb9-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(out1<span class="sc">$</span>bin_val, out1<span class="sc">$</span>chisq_ave,</span>
<span id="cb9-92"><a href="related-individuals.html#cb9-92" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave chisq&quot;</span>,</span>
<span id="cb9-93"><a href="related-individuals.html#cb9-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlim=</span><span class="fu">c</span>(xstart,xend), <span class="at">ylim=</span><span class="fu">c</span>(ystart,yend),</span>
<span id="cb9-94"><a href="related-individuals.html#cb9-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="fu">paste0</span>(trait,<span class="st">&quot; &quot;</span>, cut), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb9-95"><a href="related-individuals.html#cb9-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span>mycol[<span class="dv">1</span>], <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb9-96"><a href="related-individuals.html#cb9-96" aria-hidden="true" tabindex="-1"></a>      <span class="fu">points</span>(out2<span class="sc">$</span>bin_val, out2<span class="sc">$</span>chisq_ave,</span>
<span id="cb9-97"><a href="related-individuals.html#cb9-97" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">bg=</span>mycol[<span class="dv">2</span>], <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb9-98"><a href="related-individuals.html#cb9-98" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(trait<span class="sc">==</span><span class="st">&quot;awake&quot;</span>){</span>
<span id="cb9-99"><a href="related-individuals.html#cb9-99" aria-hidden="true" tabindex="-1"></a>     <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;rel&quot;</span>,<span class="st">&quot;unrel&quot;</span>), </span>
<span id="cb9-100"><a href="related-individuals.html#cb9-100" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span>mycol, <span class="at">cex=</span><span class="fl">1.5</span>, <span class="at">box.lty=</span><span class="dv">0</span>)}</span>
<span id="cb9-101"><a href="related-individuals.html#cb9-101" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb9-102"><a href="related-individuals.html#cb9-102" aria-hidden="true" tabindex="-1"></a>} <span class="co"># end of function</span></span>
<span id="cb9-103"><a href="related-individuals.html#cb9-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-104"><a href="related-individuals.html#cb9-104" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot ------------------------------------------------------------------</span></span>
<span id="cb9-105"><a href="related-individuals.html#cb9-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-106"><a href="related-individuals.html#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb9-107"><a href="related-individuals.html#cb9-107" aria-hidden="true" tabindex="-1"></a><span class="co">#cuts=c(&quot;cut.125&quot;,&quot;cut.25&quot;,&quot;cut.5&quot;)</span></span>
<span id="cb9-108"><a href="related-individuals.html#cb9-108" aria-hidden="true" tabindex="-1"></a>cuts<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span></span>
<span id="cb9-109"><a href="related-individuals.html#cb9-109" aria-hidden="true" tabindex="-1"></a>related<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;rel&quot;</span>,<span class="st">&quot;unrel&quot;</span>)</span>
<span id="cb9-110"><a href="related-individuals.html#cb9-110" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb9-111"><a href="related-individuals.html#cb9-111" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb9-112"><a href="related-individuals.html#cb9-112" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb9-113"><a href="related-individuals.html#cb9-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-114"><a href="related-individuals.html#cb9-114" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cuts)){</span>
<span id="cb9-115"><a href="related-individuals.html#cb9-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-116"><a href="related-individuals.html#cb9-116" aria-hidden="true" tabindex="-1"></a>  cut<span class="ot">=</span>cuts[j]</span>
<span id="cb9-117"><a href="related-individuals.html#cb9-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot chisq ~ aver2 by rel for a given cutoff for relatedness</span></span>
<span id="cb9-118"><a href="related-individuals.html#cb9-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-related-gwas-&quot;</span>,cut,<span class="st">&quot;.png&quot;</span>),</span>
<span id="cb9-119"><a href="related-individuals.html#cb9-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb9-120"><a href="related-individuals.html#cb9-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb9-121"><a href="related-individuals.html#cb9-121" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb9-122"><a href="related-individuals.html#cb9-122" aria-hidden="true" tabindex="-1"></a>        trait<span class="ot">=</span>traits[i]</span>
<span id="cb9-123"><a href="related-individuals.html#cb9-123" aria-hidden="true" tabindex="-1"></a>        <span class="fu">make_plot</span>(trait, cut)</span>
<span id="cb9-124"><a href="related-individuals.html#cb9-124" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb9-125"><a href="related-individuals.html#cb9-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb9-126"><a href="related-individuals.html#cb9-126" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="inflation-aver2_j" class="section level3" number="14.2.6">
<h3><span class="header-section-number">14.2.6</span> inflation ~ aver2_j</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="related-individuals.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb10-2"><a href="related-individuals.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: inflation ~ aver2_j</span></span>
<span id="cb10-3"><a href="related-individuals.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb10-4"><a href="related-individuals.html#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="related-individuals.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb10-6"><a href="related-individuals.html#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="related-individuals.html#cb10-7" aria-hidden="true" tabindex="-1"></a>cuts<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span></span>
<span id="cb10-8"><a href="related-individuals.html#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="related-individuals.html#cb10-9" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb10-10"><a href="related-individuals.html#cb10-10" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb10-11"><a href="related-individuals.html#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb10-12"><a href="related-individuals.html#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="related-individuals.html#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cuts)){</span>
<span id="cb10-14"><a href="related-individuals.html#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb10-15"><a href="related-individuals.html#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="related-individuals.html#cb10-16" aria-hidden="true" tabindex="-1"></a>    cut<span class="ot">=</span>cuts[j]</span>
<span id="cb10-17"><a href="related-individuals.html#cb10-17" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[k]</span>
<span id="cb10-18"><a href="related-individuals.html#cb10-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-19"><a href="related-individuals.html#cb10-19" aria-hidden="true" tabindex="-1"></a>    f1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-rel.out&quot;</span>)</span>
<span id="cb10-20"><a href="related-individuals.html#cb10-20" aria-hidden="true" tabindex="-1"></a>    f2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-unrel.out&quot;</span>)</span>
<span id="cb10-21"><a href="related-individuals.html#cb10-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-22"><a href="related-individuals.html#cb10-22" aria-hidden="true" tabindex="-1"></a>    d1<span class="ot">=</span><span class="fu">vroom</span>(f1, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb10-23"><a href="related-individuals.html#cb10-23" aria-hidden="true" tabindex="-1"></a>    d2<span class="ot">=</span><span class="fu">vroom</span>(f2, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb10-24"><a href="related-individuals.html#cb10-24" aria-hidden="true" tabindex="-1"></a>    common<span class="ot">=</span><span class="fu">intersect</span>(d1<span class="sc">$</span>snp, d2<span class="sc">$</span>snp)</span>
<span id="cb10-25"><a href="related-individuals.html#cb10-25" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="fu">match</span>(common, d1<span class="sc">$</span>snp)</span>
<span id="cb10-26"><a href="related-individuals.html#cb10-26" aria-hidden="true" tabindex="-1"></a>    m2<span class="ot">=</span><span class="fu">match</span>(common, d2<span class="sc">$</span>snp)</span>
<span id="cb10-27"><a href="related-individuals.html#cb10-27" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>common,</span>
<span id="cb10-28"><a href="related-individuals.html#cb10-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inflation=</span>d1<span class="sc">$</span>chisq[m1]<span class="sc">-</span>d2<span class="sc">$</span>chisq[m2],</span>
<span id="cb10-29"><a href="related-individuals.html#cb10-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">aver2=</span>d1<span class="sc">$</span>aver2[m1])</span>
<span id="cb10-30"><a href="related-individuals.html#cb10-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-31"><a href="related-individuals.html#cb10-31" aria-hidden="true" tabindex="-1"></a>    mod<span class="ot">=</span><span class="fu">lm</span>(inflation <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb10-32"><a href="related-individuals.html#cb10-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-33"><a href="related-individuals.html#cb10-33" aria-hidden="true" tabindex="-1"></a>    slope0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb10-34"><a href="related-individuals.html#cb10-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cutoff=</span>cut,</span>
<span id="cb10-35"><a href="related-individuals.html#cb10-35" aria-hidden="true" tabindex="-1"></a>                      <span class="at">slope_aver2=</span><span class="fu">coef</span>(mod)[<span class="dv">2</span>],</span>
<span id="cb10-36"><a href="related-individuals.html#cb10-36" aria-hidden="true" tabindex="-1"></a>                      <span class="at">p_aver2=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>],</span>
<span id="cb10-37"><a href="related-individuals.html#cb10-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb10-38"><a href="related-individuals.html#cb10-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-39"><a href="related-individuals.html#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(j<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>){slope<span class="ot">=</span>slope0} <span class="cf">else</span> {slope<span class="ot">=</span><span class="fu">rbind</span>(slope,slope0)}</span>
<span id="cb10-40"><a href="related-individuals.html#cb10-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-41"><a href="related-individuals.html#cb10-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-42"><a href="related-individuals.html#cb10-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-43"><a href="related-individuals.html#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="related-individuals.html#cb10-44" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span>slope[<span class="fu">order</span>(slope<span class="sc">$</span>trait, slope<span class="sc">$</span>cutoff),]</span>
<span id="cb10-45"><a href="related-individuals.html#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#write.table(out,&quot;summary/chisq-aver2-slope-gwas-related.txt&quot;, </span></span>
<span id="cb10-46"><a href="related-individuals.html#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#            col.names=T, row.names=F, quote=F)</span></span>
<span id="cb10-47"><a href="related-individuals.html#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="related-individuals.html#cb10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-49"><a href="related-individuals.html#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb10-50"><a href="related-individuals.html#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co"># plot inflation ~ aver2_j  </span></span>
<span id="cb10-51"><a href="related-individuals.html#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb10-52"><a href="related-individuals.html#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot ------------------------------------------------------------------</span></span>
<span id="cb10-53"><a href="related-individuals.html#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb10-54"><a href="related-individuals.html#cb10-54" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb10-55"><a href="related-individuals.html#cb10-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb10-56"><a href="related-individuals.html#cb10-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb10-57"><a href="related-individuals.html#cb10-57" aria-hidden="true" tabindex="-1"></a>cut<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span>       </span>
<span id="cb10-58"><a href="related-individuals.html#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/inflation-by-aver2-bin-related-gwas.png&quot;</span>),</span>
<span id="cb10-59"><a href="related-individuals.html#cb10-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb10-60"><a href="related-individuals.html#cb10-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb10-61"><a href="related-individuals.html#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb10-62"><a href="related-individuals.html#cb10-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-63"><a href="related-individuals.html#cb10-63" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb10-64"><a href="related-individuals.html#cb10-64" aria-hidden="true" tabindex="-1"></a>    f1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-rel.out&quot;</span>)</span>
<span id="cb10-65"><a href="related-individuals.html#cb10-65" aria-hidden="true" tabindex="-1"></a>    f2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-unrel.out&quot;</span>)</span>
<span id="cb10-66"><a href="related-individuals.html#cb10-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-67"><a href="related-individuals.html#cb10-67" aria-hidden="true" tabindex="-1"></a>    d1<span class="ot">=</span><span class="fu">vroom</span>(f1, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb10-68"><a href="related-individuals.html#cb10-68" aria-hidden="true" tabindex="-1"></a>    d2<span class="ot">=</span><span class="fu">vroom</span>(f2, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb10-69"><a href="related-individuals.html#cb10-69" aria-hidden="true" tabindex="-1"></a>    common<span class="ot">=</span><span class="fu">intersect</span>(d1<span class="sc">$</span>snp, d2<span class="sc">$</span>snp)</span>
<span id="cb10-70"><a href="related-individuals.html#cb10-70" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="fu">match</span>(common, d1<span class="sc">$</span>snp)</span>
<span id="cb10-71"><a href="related-individuals.html#cb10-71" aria-hidden="true" tabindex="-1"></a>    m2<span class="ot">=</span><span class="fu">match</span>(common, d2<span class="sc">$</span>snp)</span>
<span id="cb10-72"><a href="related-individuals.html#cb10-72" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>common,</span>
<span id="cb10-73"><a href="related-individuals.html#cb10-73" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inflation=</span>d1<span class="sc">$</span>chisq[m1]<span class="sc">-</span>d2<span class="sc">$</span>chisq[m2],</span>
<span id="cb10-74"><a href="related-individuals.html#cb10-74" aria-hidden="true" tabindex="-1"></a>                   <span class="at">aver2=</span>d1<span class="sc">$</span>aver2[m1])    </span>
<span id="cb10-75"><a href="related-individuals.html#cb10-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-76"><a href="related-individuals.html#cb10-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb10-77"><a href="related-individuals.html#cb10-77" aria-hidden="true" tabindex="-1"></a>    cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb10-78"><a href="related-individuals.html#cb10-78" aria-hidden="true" tabindex="-1"></a>    dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb10-79"><a href="related-individuals.html#cb10-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average inflation by bin values</span></span>
<span id="cb10-80"><a href="related-individuals.html#cb10-80" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">inflation_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>inflation,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb10-81"><a href="related-individuals.html#cb10-81" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb10-82"><a href="related-individuals.html#cb10-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-83"><a href="related-individuals.html#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>inflation_ave,</span>
<span id="cb10-84"><a href="related-individuals.html#cb10-84" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave inflation&quot;</span>,</span>
<span id="cb10-85"><a href="related-individuals.html#cb10-85" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb10-86"><a href="related-individuals.html#cb10-86" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb10-87"><a href="related-individuals.html#cb10-87" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb10-88"><a href="related-individuals.html#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="chisq-test-statistics" class="section level3" number="14.2.7">
<h3><span class="header-section-number">14.2.7</span> chisq test statistics</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="related-individuals.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ plot--------------------------------------------------------------------------</span></span>
<span id="cb11-2"><a href="related-individuals.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb11-3"><a href="related-individuals.html#cb11-3" aria-hidden="true" tabindex="-1"></a>cut<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span></span>
<span id="cb11-4"><a href="related-individuals.html#cb11-4" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb11-5"><a href="related-individuals.html#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb11-6"><a href="related-individuals.html#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb11-7"><a href="related-individuals.html#cb11-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-8"><a href="related-individuals.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-related-vs-unrel-real-data.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb11-9"><a href="related-individuals.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>, <span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb11-10"><a href="related-individuals.html#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="related-individuals.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb11-12"><a href="related-individuals.html#cb11-12" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb11-13"><a href="related-individuals.html#cb11-13" aria-hidden="true" tabindex="-1"></a>  rel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-rel.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb11-14"><a href="related-individuals.html#cb11-14" aria-hidden="true" tabindex="-1"></a>  unrel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-unrel.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb11-15"><a href="related-individuals.html#cb11-15" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">match</span>(rel<span class="sc">$</span>snp, unrel<span class="sc">$</span>snp)</span>
<span id="cb11-16"><a href="related-individuals.html#cb11-16" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>rel<span class="sc">$</span>snp,</span>
<span id="cb11-17"><a href="related-individuals.html#cb11-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel=</span>rel<span class="sc">$</span>chisq,</span>
<span id="cb11-18"><a href="related-individuals.html#cb11-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span>unrel<span class="sc">$</span>chisq[m])</span>
<span id="cb11-19"><a href="related-individuals.html#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="related-individuals.html#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb11-21"><a href="related-individuals.html#cb11-21" aria-hidden="true" tabindex="-1"></a>  cutoff1<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>rel, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb11-22"><a href="related-individuals.html#cb11-22" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin_rel<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>rel, <span class="at">breaks=</span>cutoff1, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff1)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb11-23"><a href="related-individuals.html#cb11-23" aria-hidden="true" tabindex="-1"></a>  cutoff2<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>unrel, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb11-24"><a href="related-individuals.html#cb11-24" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin_unrel<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>unrel, <span class="at">breaks=</span>cutoff2, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff2)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb11-25"><a href="related-individuals.html#cb11-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-26"><a href="related-individuals.html#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb11-27"><a href="related-individuals.html#cb11-27" aria-hidden="true" tabindex="-1"></a>  ave<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">rel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>rel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_rel, mean),</span>
<span id="cb11-28"><a href="related-individuals.html#cb11-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>unrel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_unrel, mean))</span>
<span id="cb11-29"><a href="related-individuals.html#cb11-29" aria-hidden="true" tabindex="-1"></a>  sd<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">rel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>rel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_rel, sd),</span>
<span id="cb11-30"><a href="related-individuals.html#cb11-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>unrel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_unrel, sd))</span>
<span id="cb11-31"><a href="related-individuals.html#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x ylim</span></span>
<span id="cb11-32"><a href="related-individuals.html#cb11-32" aria-hidden="true" tabindex="-1"></a>  minimum<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(ave<span class="sc">$</span>rel,ave<span class="sc">$</span>unrel))</span>
<span id="cb11-33"><a href="related-individuals.html#cb11-33" aria-hidden="true" tabindex="-1"></a>  maximum<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(ave<span class="sc">$</span>rel,ave<span class="sc">$</span>unrel))</span>
<span id="cb11-34"><a href="related-individuals.html#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="related-individuals.html#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb11-36"><a href="related-individuals.html#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(cutoff1, cutoff2,</span>
<span id="cb11-37"><a href="related-individuals.html#cb11-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;rel&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;unrel&quot;</span>,</span>
<span id="cb11-38"><a href="related-individuals.html#cb11-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb11-39"><a href="related-individuals.html#cb11-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb11-40"><a href="related-individuals.html#cb11-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb11-41"><a href="related-individuals.html#cb11-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb11-42"><a href="related-individuals.html#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb11-43"><a href="related-individuals.html#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#points(ave$rel, ave$unrel, cex = 1.5, pch=21, </span></span>
<span id="cb11-44"><a href="related-individuals.html#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#       bg=&quot;powderblue&quot;, col=&quot;white&quot;, lwd=0.5)</span></span>
<span id="cb11-45"><a href="related-individuals.html#cb11-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-46"><a href="related-individuals.html#cb11-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-47"><a href="related-individuals.html#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="related-individuals.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># concordance between SNPs from related &amp; unrelated individuals </span></span>
<span id="cb12-2"><a href="related-individuals.html#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="related-individuals.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb12-4"><a href="related-individuals.html#cb12-4" aria-hidden="true" tabindex="-1"></a>cut<span class="ot">=</span><span class="st">&quot;cut.125&quot;</span></span>
<span id="cb12-5"><a href="related-individuals.html#cb12-5" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb12-6"><a href="related-individuals.html#cb12-6" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb12-7"><a href="related-individuals.html#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb12-8"><a href="related-individuals.html#cb12-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-9"><a href="related-individuals.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-related-vs-unrel-concordance.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb12-10"><a href="related-individuals.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>, <span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb12-11"><a href="related-individuals.html#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="related-individuals.html#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb12-13"><a href="related-individuals.html#cb12-13" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb12-14"><a href="related-individuals.html#cb12-14" aria-hidden="true" tabindex="-1"></a>  rel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-rel.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb12-15"><a href="related-individuals.html#cb12-15" aria-hidden="true" tabindex="-1"></a>  unrel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-related-all-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,cut,<span class="st">&quot;-unrel.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb12-16"><a href="related-individuals.html#cb12-16" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">match</span>(rel<span class="sc">$</span>snp, unrel<span class="sc">$</span>snp)</span>
<span id="cb12-17"><a href="related-individuals.html#cb12-17" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>rel<span class="sc">$</span>snp,</span>
<span id="cb12-18"><a href="related-individuals.html#cb12-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel=</span>rel<span class="sc">$</span>chisq,</span>
<span id="cb12-19"><a href="related-individuals.html#cb12-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span>unrel<span class="sc">$</span>chisq[m])</span>
<span id="cb12-20"><a href="related-individuals.html#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="related-individuals.html#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x ylim</span></span>
<span id="cb12-22"><a href="related-individuals.html#cb12-22" aria-hidden="true" tabindex="-1"></a>  minimum<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(dat<span class="sc">$</span>rel,dat<span class="sc">$</span>unrel), <span class="at">na.rm=</span>T)</span>
<span id="cb12-23"><a href="related-individuals.html#cb12-23" aria-hidden="true" tabindex="-1"></a>  maximum<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(dat<span class="sc">$</span>rel,dat<span class="sc">$</span>unrel), <span class="at">na.rm=</span>T)</span>
<span id="cb12-24"><a href="related-individuals.html#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="related-individuals.html#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb12-26"><a href="related-individuals.html#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(dat<span class="sc">$</span>rel, dat<span class="sc">$</span>unrel,</span>
<span id="cb12-27"><a href="related-individuals.html#cb12-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;rel&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;unrel&quot;</span>,</span>
<span id="cb12-28"><a href="related-individuals.html#cb12-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb12-29"><a href="related-individuals.html#cb12-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb12-30"><a href="related-individuals.html#cb12-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb12-31"><a href="related-individuals.html#cb12-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb12-32"><a href="related-individuals.html#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb12-33"><a href="related-individuals.html#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#points(ave$rel, ave$unrel, cex = 1.5, pch=21, </span></span>
<span id="cb12-34"><a href="related-individuals.html#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#       bg=&quot;powderblue&quot;, col=&quot;white&quot;, lwd=0.5)</span></span>
<span id="cb12-35"><a href="related-individuals.html#cb12-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-36"><a href="related-individuals.html#cb12-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-37"><a href="related-individuals.html#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="mix-unrel-rel" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> mix unrel &amp; rel</h2>
<div id="genotype" class="section level3" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> genotype</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="related-individuals.html#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="related-individuals.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># id list</span></span>
<span id="cb13-3"><a href="related-individuals.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $1, $2}&#39;</span> rand.100000 icd10/related.inds <span class="op">&gt;</span> rel-unrel-combo.id </span>
<span id="cb13-4"><a href="related-individuals.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># note: there are some overlap between the two id lists.</span></span>
<span id="cb13-5"><a href="related-individuals.html#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="related-individuals.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb13-7"><a href="related-individuals.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make bfiles by chromosome</span></span>
<span id="cb13-8"><a href="related-individuals.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#::::</span></span>
<span id="cb13-9"><a href="related-individuals.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb13-10"><a href="related-individuals.html#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb13-11"><a href="related-individuals.html#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb13-12"><a href="related-individuals.html#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb13-13"><a href="related-individuals.html#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb13-14"><a href="related-individuals.html#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb13-15"><a href="related-individuals.html#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb13-16"><a href="related-individuals.html#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="related-individuals.html#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb13-18"><a href="related-individuals.html#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../rel-unrel-combo.id </span><span class="dt">\</span></span>
<span id="cb13-19"><a href="related-individuals.html#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../doug/ukbb.ldsc </span><span class="dt">\</span></span>
<span id="cb13-20"><a href="related-individuals.html#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb13-21"><a href="related-individuals.html#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb13-22"><a href="related-individuals.html#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.8 2 </span><span class="dt">\</span></span>
<span id="cb13-23"><a href="related-individuals.html#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb13-24"><a href="related-individuals.html#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb13-25"><a href="related-individuals.html#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-combo </span><span class="dt">\</span></span>
<span id="cb13-26"><a href="related-individuals.html#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb13-27"><a href="related-individuals.html#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb13-28"><a href="related-individuals.html#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb13-29"><a href="related-individuals.html#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="related-individuals.html#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb13-31"><a href="related-individuals.html#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb13-32"><a href="related-individuals.html#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$i</span>.sh</span>
<span id="cb13-33"><a href="related-individuals.html#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/mkbfile-related-unrel-combo</span>
<span id="cb13-34"><a href="related-individuals.html#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="related-individuals.html#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion</span></span>
<span id="cb13-36"><a href="related-individuals.html#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/mkbfile-related-unrel-combo</span>
<span id="cb13-37"><a href="related-individuals.html#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb13-38"><a href="related-individuals.html#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb13-39"><a href="related-individuals.html#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb13-40"><a href="related-individuals.html#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb13-41"><a href="related-individuals.html#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb13-42"><a href="related-individuals.html#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb13-43"><a href="related-individuals.html#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb13-44"><a href="related-individuals.html#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb13-45"><a href="related-individuals.html#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb13-46"><a href="related-individuals.html#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb13-47"><a href="related-individuals.html#cb13-47" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb13-48"><a href="related-individuals.html#cb13-48" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb13-49"><a href="related-individuals.html#cb13-49" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb13-50"><a href="related-individuals.html#cb13-50" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb13-51"><a href="related-individuals.html#cb13-51" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb13-52"><a href="related-individuals.html#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb13-53"><a href="related-individuals.html#cb13-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-54"><a href="related-individuals.html#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::</span></span>
<span id="cb13-55"><a href="related-individuals.html#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="co"># merge bfiles </span></span>
<span id="cb13-56"><a href="related-individuals.html#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="co">#::::</span></span>
<span id="cb13-57"><a href="related-individuals.html#cb13-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-58"><a href="related-individuals.html#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile.list</span>
<span id="cb13-59"><a href="related-individuals.html#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb13-60"><a href="related-individuals.html#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-combo&quot;</span> <span class="op">&gt;&gt;</span>bfile.list</span>
<span id="cb13-61"><a href="related-individuals.html#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb13-62"><a href="related-individuals.html#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="related-individuals.html#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb13-64"><a href="related-individuals.html#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb13-65"><a href="related-individuals.html#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb13-66"><a href="related-individuals.html#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb13-67"><a href="related-individuals.html#cb13-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb13-68"><a href="related-individuals.html#cb13-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 40:0:0</span></span>
<span id="cb13-69"><a href="related-individuals.html#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-rel-unrel-combo </span><span class="dt">\</span></span>
<span id="cb13-70"><a href="related-individuals.html#cb13-70" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile.list </span><span class="dt">\</span></span>
<span id="cb13-71"><a href="related-individuals.html#cb13-71" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb13-72"><a href="related-individuals.html#cb13-72" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb13-73"><a href="related-individuals.html#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile.sh</span>
<span id="cb13-74"><a href="related-individuals.html#cb13-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-75"><a href="related-individuals.html#cb13-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-76"><a href="related-individuals.html#cb13-76" aria-hidden="true" tabindex="-1"></a><span class="co"># snp list --------------------------------------------------------------------</span></span>
<span id="cb13-77"><a href="related-individuals.html#cb13-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-78"><a href="related-individuals.html#cb13-78" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate </span></span>
<span id="cb13-79"><a href="related-individuals.html#cb13-79" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> gen/geno-rel-unrel-combo.stats <span class="st">&#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> gen/snps-rel-unrel-combo.use</span>
<span id="cb13-80"><a href="related-individuals.html#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 1,102,906 SNPs</span></span></code></pre></div>
</div>
<div id="gwas-4" class="section level3" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> gwas</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="related-individuals.html#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="related-individuals.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-rel-unrel-combo</span>
<span id="cb14-3"><a href="related-individuals.html#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="related-individuals.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># script ----------------------------------------------------------------------</span></span>
<span id="cb14-5"><a href="related-individuals.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb14-6"><a href="related-individuals.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chr <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb14-7"><a href="related-individuals.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>../gen/snps-rel-unrel-combo.use</span>
<span id="cb14-8"><a href="related-individuals.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-rel-unrel-combo</span>
<span id="cb14-9"><a href="related-individuals.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gwas-rel-unrel-combo/<span class="va">$i</span>-linear-<span class="va">$chr</span></span>
<span id="cb14-10"><a href="related-individuals.html#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="related-individuals.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb14-12"><a href="related-individuals.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb14-13"><a href="related-individuals.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb14-14"><a href="related-individuals.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb14-15"><a href="related-individuals.html#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb14-16"><a href="related-individuals.html#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 8:0:0</span></span>
<span id="cb14-17"><a href="related-individuals.html#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="related-individuals.html#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb14-19"><a href="related-individuals.html#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb14-20"><a href="related-individuals.html#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb14-21"><a href="related-individuals.html#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract </span><span class="va">$snp</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb14-22"><a href="related-individuals.html#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb14-23"><a href="related-individuals.html#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb14-24"><a href="related-individuals.html#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$chr</span></span>
<span id="cb14-25"><a href="related-individuals.html#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear-chr-<span class="va">$chr</span>.sh</span>
<span id="cb14-26"><a href="related-individuals.html#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb14-27"><a href="related-individuals.html#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb14-28"><a href="related-individuals.html#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#done</span></span>
<span id="cb14-29"><a href="related-individuals.html#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="related-individuals.html#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb14-31"><a href="related-individuals.html#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb14-32"><a href="related-individuals.html#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chr <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb14-33"><a href="related-individuals.html#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear-chr-<span class="va">$chr</span>.sh</span>
<span id="cb14-34"><a href="related-individuals.html#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb14-35"><a href="related-individuals.html#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-combo</span>
<span id="cb14-36"><a href="related-individuals.html#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="related-individuals.html#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files-------------------------------------------------------------------</span></span>
<span id="cb14-38"><a href="related-individuals.html#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="related-individuals.html#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co"># only do .summaries &amp; .pvalues</span></span>
<span id="cb14-40"><a href="related-individuals.html#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb14-41"><a href="related-individuals.html#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb14-42"><a href="related-individuals.html#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$j</span> <span class="ot">==</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb14-43"><a href="related-individuals.html#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.summaries <span class="op">&gt;</span> <span class="va">$i</span>-linear.summaries</span>
<span id="cb14-44"><a href="related-individuals.html#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.pvalues <span class="op">&gt;</span> <span class="va">$i</span>-linear.pvalues</span>
<span id="cb14-45"><a href="related-individuals.html#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb14-46"><a href="related-individuals.html#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.summaries <span class="op">&gt;&gt;</span> <span class="va">$i</span>-linear.summaries</span>
<span id="cb14-47"><a href="related-individuals.html#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$i</span>-linear-<span class="va">$j</span>.pvalues <span class="op">&gt;&gt;</span> <span class="va">$i</span>-linear.pvalues</span>
<span id="cb14-48"><a href="related-individuals.html#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb14-49"><a href="related-individuals.html#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb14-50"><a href="related-individuals.html#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="aver2_j-4" class="section level3" number="14.3.3">
<h3><span class="header-section-number">14.3.3</span> aver2_j</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="related-individuals.html#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="related-individuals.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb15-3"><a href="related-individuals.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  snp lists</span></span>
<span id="cb15-4"><a href="related-individuals.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb15-5"><a href="related-individuals.html#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="related-individuals.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># common snps of related &amp; unrelated</span></span>
<span id="cb15-7"><a href="related-individuals.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="va">unrel</span><span class="op">=</span>gen/snps-unrel-inds.use</span>
<span id="cb15-8"><a href="related-individuals.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="va">rel</span><span class="op">=</span>gen/snps-rel-unrel-combo.use</span>
<span id="cb15-9"><a href="related-individuals.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR{a[$1];next} </span></span>
<span id="cb15-10"><a href="related-individuals.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">    ($1 in a) {print $1}&#39;</span> <span class="va">$unrel</span> <span class="va">$rel</span> <span class="op">&gt;</span> gen/common-unrel-rel-combo-snps <span class="co"># 1,101,883</span></span>
<span id="cb15-11"><a href="related-individuals.html#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="related-individuals.html#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># lista &amp; listb</span></span>
<span id="cb15-13"><a href="related-individuals.html#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>10000</span>
<span id="cb15-14"><a href="related-individuals.html#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gen/common-unrel-rel-combo-snps</span>
<span id="cb15-15"><a href="related-individuals.html#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/combo/left-snps</span>
<span id="cb15-16"><a href="related-individuals.html#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/combo/right-snps</span>
<span id="cb15-17"><a href="related-individuals.html#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="related-individuals.html#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb15-19"><a href="related-individuals.html#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&lt;8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$left</span>  </span>
<span id="cb15-20"><a href="related-individuals.html#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb15-21"><a href="related-individuals.html#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&gt;=8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$right</span></span>
<span id="cb15-22"><a href="related-individuals.html#cb15-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-23"><a href="related-individuals.html#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb15-24"><a href="related-individuals.html#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r^2_j</span></span>
<span id="cb15-25"><a href="related-individuals.html#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb15-26"><a href="related-individuals.html#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="related-individuals.html#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># related</span></span>
<span id="cb15-28"><a href="related-individuals.html#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/combo/right-snps</span>
<span id="cb15-29"><a href="related-individuals.html#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/combo/left-snps</span>
<span id="cb15-30"><a href="related-individuals.html#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-rel-unrel-combo</span>
<span id="cb15-31"><a href="related-individuals.html#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/combo/out/10k-snps</span>
<span id="cb15-32"><a href="related-individuals.html#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="related-individuals.html#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb15-34"><a href="related-individuals.html#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb15-35"><a href="related-individuals.html#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb15-36"><a href="related-individuals.html#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb15-37"><a href="related-individuals.html#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb15-38"><a href="related-individuals.html#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb15-39"><a href="related-individuals.html#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb15-40"><a href="related-individuals.html#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb15-41"><a href="related-individuals.html#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb15-42"><a href="related-individuals.html#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb15-43"><a href="related-individuals.html#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb15-44"><a href="related-individuals.html#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps</span>
<span id="cb15-45"><a href="related-individuals.html#cb15-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-46"><a href="related-individuals.html#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the job</span></span>
<span id="cb15-47"><a href="related-individuals.html#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps <span class="op">&gt;</span>../job-records/calc-r-combo</span>
<span id="cb15-48"><a href="related-individuals.html#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="related-individuals.html#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="co"># unrelated</span></span>
<span id="cb15-50"><a href="related-individuals.html#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/combo/right-snps</span>
<span id="cb15-51"><a href="related-individuals.html#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/combo/left-snps</span>
<span id="cb15-52"><a href="related-individuals.html#cb15-52" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-unrel</span>
<span id="cb15-53"><a href="related-individuals.html#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../unrelated/rand.100000</span>
<span id="cb15-54"><a href="related-individuals.html#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/combo/out/10k-snps-unrel</span>
<span id="cb15-55"><a href="related-individuals.html#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="related-individuals.html#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb15-57"><a href="related-individuals.html#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb15-58"><a href="related-individuals.html#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb15-59"><a href="related-individuals.html#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb15-60"><a href="related-individuals.html#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb15-61"><a href="related-individuals.html#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:10:0</span></span>
<span id="cb15-62"><a href="related-individuals.html#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb15-63"><a href="related-individuals.html#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb15-64"><a href="related-individuals.html#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb15-65"><a href="related-individuals.html#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb15-66"><a href="related-individuals.html#cb15-66" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb15-67"><a href="related-individuals.html#cb15-67" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb15-68"><a href="related-individuals.html#cb15-68" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps-unrel</span>
<span id="cb15-69"><a href="related-individuals.html#cb15-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-70"><a href="related-individuals.html#cb15-70" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the job</span></span>
<span id="cb15-71"><a href="related-individuals.html#cb15-71" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps-unrel <span class="op">&gt;</span>../job-records/calc-r-combo-unrel</span>
<span id="cb15-72"><a href="related-individuals.html#cb15-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-73"><a href="related-individuals.html#cb15-73" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r_j^2 for each i-------------------------------------------------</span></span>
<span id="cb15-74"><a href="related-individuals.html#cb15-74" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb15-75"><a href="related-individuals.html#cb15-75" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb15-76"><a href="related-individuals.html#cb15-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-77"><a href="related-individuals.html#cb15-77" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span><span class="st">&quot;10k-snps&quot;</span></span>
<span id="cb15-78"><a href="related-individuals.html#cb15-78" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/combo/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.pairwise&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb15-79"><a href="related-individuals.html#cb15-79" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/combo/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsa&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb15-80"><a href="related-individuals.html#cb15-80" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb15-81"><a href="related-individuals.html#cb15-81" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/combo/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsb&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb15-82"><a href="related-individuals.html#cb15-82" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb15-83"><a href="related-individuals.html#cb15-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-84"><a href="related-individuals.html#cb15-84" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[,-c<span class="kw">(</span><span class="ex">10001</span><span class="kw">)</span><span class="ex">]^2</span></span>
<span id="cb15-85"><a href="related-individuals.html#cb15-85" aria-hidden="true" tabindex="-1"></a><span class="va">outb</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>listb<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,2,</span> mean<span class="kw">))</span></span>
<span id="cb15-86"><a href="related-individuals.html#cb15-86" aria-hidden="true" tabindex="-1"></a><span class="va">outa</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>lista<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,1,</span> mean<span class="kw">))</span></span>
<span id="cb15-87"><a href="related-individuals.html#cb15-87" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">outa,outb</span><span class="kw">)</span></span>
<span id="cb15-88"><a href="related-individuals.html#cb15-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-89"><a href="related-individuals.html#cb15-89" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,paste0</span><span class="er">(</span><span class="st">&quot;summary/ave-r2-&quot;</span><span class="ex">,nm,</span> <span class="st">&quot;-rel-unrel-combo&quot;</span><span class="kw">)</span><span class="ex">,</span> col.names=F, row.names=F, quote=F<span class="kw">)</span> </span>
<span id="cb15-90"><a href="related-individuals.html#cb15-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-91"><a href="related-individuals.html#cb15-91" aria-hidden="true" tabindex="-1"></a><span class="co"># for unrelated control rand.100000</span></span>
<span id="cb15-92"><a href="related-individuals.html#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb15-93"><a href="related-individuals.html#cb15-93" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb15-94"><a href="related-individuals.html#cb15-94" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span><span class="st">&quot;10k-snps-unrel&quot;</span></span>
<span id="cb15-95"><a href="related-individuals.html#cb15-95" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/combo/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.pairwise&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb15-96"><a href="related-individuals.html#cb15-96" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/combo/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsa&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb15-97"><a href="related-individuals.html#cb15-97" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb15-98"><a href="related-individuals.html#cb15-98" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/combo/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsb&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb15-99"><a href="related-individuals.html#cb15-99" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb15-100"><a href="related-individuals.html#cb15-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-101"><a href="related-individuals.html#cb15-101" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[,-c<span class="kw">(</span><span class="ex">10001</span><span class="kw">)</span><span class="ex">]^2</span></span>
<span id="cb15-102"><a href="related-individuals.html#cb15-102" aria-hidden="true" tabindex="-1"></a><span class="va">outb</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>listb<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,2,</span> mean<span class="kw">))</span></span>
<span id="cb15-103"><a href="related-individuals.html#cb15-103" aria-hidden="true" tabindex="-1"></a><span class="va">outa</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>lista<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,1,</span> mean<span class="kw">))</span></span>
<span id="cb15-104"><a href="related-individuals.html#cb15-104" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">outa,outb</span><span class="kw">)</span></span>
<span id="cb15-105"><a href="related-individuals.html#cb15-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-106"><a href="related-individuals.html#cb15-106" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span><span class="st">&quot;summary/ave-r2-10k-snps-rel-unrel-combo-ref&quot;</span><span class="ex">,</span> </span>
<span id="cb15-107"><a href="related-individuals.html#cb15-107" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=F,</span> row.names=F, quote=F<span class="kw">)</span> </span></code></pre></div>
</div>
<div id="organize-data-7" class="section level3" number="14.3.4">
<h3><span class="header-section-number">14.3.4</span> organize data</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="related-individuals.html#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="related-individuals.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># related------------------------------------------------------------------------</span></span>
<span id="cb16-3"><a href="related-individuals.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb16-4"><a href="related-individuals.html#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="related-individuals.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-rel-unrel-combo/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb16-6"><a href="related-individuals.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-rel-unrel-combo</span>
<span id="cb16-7"><a href="related-individuals.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-rel-unrel-combo-out/<span class="va">$trait</span>.out</span>
<span id="cb16-8"><a href="related-individuals.html#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="related-individuals.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp    </span>
<span id="cb16-10"><a href="related-individuals.html#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="related-individuals.html#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb16-12"><a href="related-individuals.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb16-13"><a href="related-individuals.html#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb16-14"><a href="related-individuals.html#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="related-individuals.html#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb16-16"><a href="related-individuals.html#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb16-17"><a href="related-individuals.html#cb16-17" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb16-18"><a href="related-individuals.html#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb16-19"><a href="related-individuals.html#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2&quot;}</span></span>
<span id="cb16-20"><a href="related-individuals.html#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb16-21"><a href="related-individuals.html#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb16-22"><a href="related-individuals.html#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="related-individuals.html#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># unrelated control-------------------------------------------------------------</span></span>
<span id="cb16-24"><a href="related-individuals.html#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb16-25"><a href="related-individuals.html#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="related-individuals.html#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>unrelated/gwas-good/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb16-27"><a href="related-individuals.html#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-rel-unrel-combo-ref</span>
<span id="cb16-28"><a href="related-individuals.html#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-rel-unrel-combo-out/<span class="va">$trait</span>-ref.out</span>
<span id="cb16-29"><a href="related-individuals.html#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="related-individuals.html#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp    </span>
<span id="cb16-31"><a href="related-individuals.html#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="related-individuals.html#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb16-33"><a href="related-individuals.html#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb16-34"><a href="related-individuals.html#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb16-35"><a href="related-individuals.html#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="related-individuals.html#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb16-37"><a href="related-individuals.html#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb16-38"><a href="related-individuals.html#cb16-38" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb16-39"><a href="related-individuals.html#cb16-39" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb16-40"><a href="related-individuals.html#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2&quot;}</span></span>
<span id="cb16-41"><a href="related-individuals.html#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb16-42"><a href="related-individuals.html#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="chisq-aver2_j-7" class="section level3" number="14.3.5">
<h3><span class="header-section-number">14.3.5</span> chisq ~ aver2_j</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="related-individuals.html#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="related-individuals.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb17-3"><a href="related-individuals.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j</span></span>
<span id="cb17-4"><a href="related-individuals.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb17-5"><a href="related-individuals.html#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="related-individuals.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb17-7"><a href="related-individuals.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="va">traits</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span></span>
<span id="cb17-8"><a href="related-individuals.html#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span> <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb17-9"><a href="related-individuals.html#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="kw">)</span></span>
<span id="cb17-10"><a href="related-individuals.html#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="related-individuals.html#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="ex">traits</span><span class="kw">)){</span></span>
<span id="cb17-12"><a href="related-individuals.html#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="related-individuals.html#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="va">trait</span><span class="op">=</span>traits[i]</span>
<span id="cb17-14"><a href="related-individuals.html#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="related-individuals.html#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;gwas-rel-unrel-combo-out/&quot;</span><span class="ex">,trait,</span><span class="st">&quot;.out&quot;</span><span class="kw">)</span></span>
<span id="cb17-16"><a href="related-individuals.html#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="related-individuals.html#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="fu">file</span>, col_names=T, delim=<span class="st">&quot;;&quot;</span><span class="kw">)</span></span>
<span id="cb17-18"><a href="related-individuals.html#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[complete.cases<span class="kw">(</span><span class="ex">dat</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb17-19"><a href="related-individuals.html#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="va">mod</span><span class="op">=</span>lm<span class="kw">(</span><span class="ex">chisq</span> ~ aver2,data=dat<span class="kw">)</span></span>
<span id="cb17-20"><a href="related-individuals.html#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="related-individuals.html#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="va">slope0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">trait</span><span class="op">=</span>trait,</span>
<span id="cb17-22"><a href="related-individuals.html#cb17-22" aria-hidden="true" tabindex="-1"></a>                  <span class="va">slope_aver2</span><span class="op">=</span>coef<span class="kw">(</span><span class="ex">mod</span><span class="kw">)</span><span class="ex">[2],</span></span>
<span id="cb17-23"><a href="related-individuals.html#cb17-23" aria-hidden="true" tabindex="-1"></a>                  <span class="va">p_aver2</span><span class="op">=</span>summary<span class="kw">(</span><span class="ex">mod</span><span class="kw">)</span><span class="va">$coefficients</span><span class="ex">[,4][2],</span></span>
<span id="cb17-24"><a href="related-individuals.html#cb17-24" aria-hidden="true" tabindex="-1"></a>                  <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb17-25"><a href="related-individuals.html#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="related-individuals.html#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{slope=slope0}</span> else <span class="dt">{slope=rbind(slope</span><span class="op">,</span><span class="dt">slope0)}</span></span>
<span id="cb17-27"><a href="related-individuals.html#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="related-individuals.html#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb17-29"><a href="related-individuals.html#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="related-individuals.html#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb17-31"><a href="related-individuals.html#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot chisq ~ aver2_j  </span></span>
<span id="cb17-32"><a href="related-individuals.html#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb17-33"><a href="related-individuals.html#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot ------------------------------------------------------------------</span></span>
<span id="cb17-34"><a href="related-individuals.html#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb17-35"><a href="related-individuals.html#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="va">traits</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span></span>
<span id="cb17-36"><a href="related-individuals.html#cb17-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span> <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb17-37"><a href="related-individuals.html#cb17-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="kw">)</span></span>
<span id="cb17-38"><a href="related-individuals.html#cb17-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-39"><a href="related-individuals.html#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="ex">png</span><span class="er">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;fig/chisq-by-aver2-bin-unrel-rel-combo-gwas.png&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb17-40"><a href="related-individuals.html#cb17-40" aria-hidden="true" tabindex="-1"></a>      <span class="ex">width</span> = 50, height = 30, units = <span class="st">&quot;cm&quot;</span>, res=600<span class="kw">)</span></span>
<span id="cb17-41"><a href="related-individuals.html#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="ex">par</span><span class="er">(</span><span class="va">mfrow</span><span class="op">=</span>c<span class="kw">(</span><span class="ex">3,5</span><span class="kw">))</span></span>
<span id="cb17-42"><a href="related-individuals.html#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="related-individuals.html#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="ex">traits</span><span class="kw">)){</span></span>
<span id="cb17-44"><a href="related-individuals.html#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="va">trait</span><span class="op">=</span>traits[i]</span>
<span id="cb17-45"><a href="related-individuals.html#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">file</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;gwas-rel-unrel-combo-out/&quot;</span><span class="ex">,trait,</span><span class="st">&quot;.out&quot;</span><span class="kw">)</span></span>
<span id="cb17-46"><a href="related-individuals.html#cb17-46" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="fu">file</span>, col_names=T, delim=<span class="st">&quot;;&quot;</span><span class="kw">)</span></span>
<span id="cb17-47"><a href="related-individuals.html#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb17-48"><a href="related-individuals.html#cb17-48" aria-hidden="true" tabindex="-1"></a>    <span class="va">cutoff</span><span class="op">=</span>quantile<span class="kw">(</span><span class="ex">dat</span><span class="va">$aver2</span><span class="ex">,</span> probs = seq<span class="er">(</span><span class="ex">0,</span> 1, 0.005<span class="kw">)</span><span class="ex">,</span> na.rm=T<span class="kw">)</span></span>
<span id="cb17-49"><a href="related-individuals.html#cb17-49" aria-hidden="true" tabindex="-1"></a>    <span class="ex">dat</span><span class="va">$bin</span><span class="ex">=cut</span><span class="er">(</span><span class="ex">dat</span><span class="va">$aver2</span><span class="ex">,</span> breaks=cutoff, labels=1:<span class="er">(</span><span class="ex">length</span><span class="er">(</span><span class="ex">cutoff</span><span class="kw">)</span><span class="ex">-1</span><span class="kw">))</span></span>
<span id="cb17-50"><a href="related-individuals.html#cb17-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average chisq by bin values</span></span>
<span id="cb17-51"><a href="related-individuals.html#cb17-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">chisq_ave</span><span class="op">=</span>tapply<span class="kw">(</span><span class="ex">dat</span><span class="va">$chisq</span><span class="ex">,INDEX=dat</span><span class="va">$bin</span><span class="ex">,</span> mean<span class="kw">))</span></span>
<span id="cb17-52"><a href="related-individuals.html#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="ex">out</span><span class="va">$bin_val</span><span class="ex">=tapply</span><span class="er">(</span><span class="ex">dat</span><span class="va">$aver2</span><span class="ex">,INDEX=dat</span><span class="va">$bin</span><span class="ex">,</span> mean<span class="kw">)</span></span>
<span id="cb17-53"><a href="related-individuals.html#cb17-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-54"><a href="related-individuals.html#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="ex">plot</span><span class="er">(</span><span class="ex">out</span><span class="va">$bin_val</span><span class="ex">,</span> out<span class="va">$chisq_ave</span>,</span>
<span id="cb17-55"><a href="related-individuals.html#cb17-55" aria-hidden="true" tabindex="-1"></a>         <span class="va">xlab</span><span class="op">=</span><span class="st">&quot;ave r2&quot;</span>, <span class="va">ylab</span><span class="op">=</span><span class="st">&quot;ave chisq&quot;</span>,</span>
<span id="cb17-56"><a href="related-individuals.html#cb17-56" aria-hidden="true" tabindex="-1"></a>         <span class="va">main</span><span class="op">=</span>trait, <span class="va">las</span><span class="op">=</span>1,</span>
<span id="cb17-57"><a href="related-individuals.html#cb17-57" aria-hidden="true" tabindex="-1"></a>         <span class="ex">cex</span> = 1.5, pch=21,  bg=<span class="st">&quot;orange&quot;</span>, col=<span class="st">&quot;white&quot;</span>, lwd=0.5<span class="kw">)</span></span>
<span id="cb17-58"><a href="related-individuals.html#cb17-58" aria-hidden="true" tabindex="-1"></a> <span class="kw">}</span></span>
<span id="cb17-59"><a href="related-individuals.html#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off()</span></span></code></pre></div>
</div>
<div id="inflation-aver2_j-1" class="section level3" number="14.3.6">
<h3><span class="header-section-number">14.3.6</span> inflation ~ aver2_j</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="related-individuals.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb18-2"><a href="related-individuals.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: inflation ~ aver2_j</span></span>
<span id="cb18-3"><a href="related-individuals.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb18-4"><a href="related-individuals.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="related-individuals.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb18-6"><a href="related-individuals.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="related-individuals.html#cb18-7" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb18-8"><a href="related-individuals.html#cb18-8" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb18-9"><a href="related-individuals.html#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb18-10"><a href="related-individuals.html#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="related-individuals.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb18-12"><a href="related-individuals.html#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="related-individuals.html#cb18-13" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb18-14"><a href="related-individuals.html#cb18-14" aria-hidden="true" tabindex="-1"></a>    f1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-rel-unrel-combo-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb18-15"><a href="related-individuals.html#cb18-15" aria-hidden="true" tabindex="-1"></a>    f2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-rel-unrel-combo-out/&quot;</span>,trait,<span class="st">&quot;-ref.out&quot;</span>)</span>
<span id="cb18-16"><a href="related-individuals.html#cb18-16" aria-hidden="true" tabindex="-1"></a>    d1<span class="ot">=</span><span class="fu">vroom</span>(f1, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb18-17"><a href="related-individuals.html#cb18-17" aria-hidden="true" tabindex="-1"></a>    d2<span class="ot">=</span><span class="fu">vroom</span>(f2, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb18-18"><a href="related-individuals.html#cb18-18" aria-hidden="true" tabindex="-1"></a>    common<span class="ot">=</span><span class="fu">intersect</span>(d1<span class="sc">$</span>snp, d2<span class="sc">$</span>snp)</span>
<span id="cb18-19"><a href="related-individuals.html#cb18-19" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="fu">match</span>(common, d1<span class="sc">$</span>snp)</span>
<span id="cb18-20"><a href="related-individuals.html#cb18-20" aria-hidden="true" tabindex="-1"></a>    m2<span class="ot">=</span><span class="fu">match</span>(common, d2<span class="sc">$</span>snp)</span>
<span id="cb18-21"><a href="related-individuals.html#cb18-21" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>common,</span>
<span id="cb18-22"><a href="related-individuals.html#cb18-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inflation=</span>d1<span class="sc">$</span>chisq[m1]<span class="sc">-</span>d2<span class="sc">$</span>chisq[m2],</span>
<span id="cb18-23"><a href="related-individuals.html#cb18-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">aver2=</span>d1<span class="sc">$</span>aver2[m1])</span>
<span id="cb18-24"><a href="related-individuals.html#cb18-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-25"><a href="related-individuals.html#cb18-25" aria-hidden="true" tabindex="-1"></a>    mod<span class="ot">=</span><span class="fu">lm</span>(inflation <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb18-26"><a href="related-individuals.html#cb18-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-27"><a href="related-individuals.html#cb18-27" aria-hidden="true" tabindex="-1"></a>    slope0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb18-28"><a href="related-individuals.html#cb18-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">slope_aver2=</span><span class="fu">coef</span>(mod)[<span class="dv">2</span>],</span>
<span id="cb18-29"><a href="related-individuals.html#cb18-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">p_aver2=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>],</span>
<span id="cb18-30"><a href="related-individuals.html#cb18-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb18-31"><a href="related-individuals.html#cb18-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-32"><a href="related-individuals.html#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){slope<span class="ot">=</span>slope0} <span class="cf">else</span> {slope<span class="ot">=</span><span class="fu">rbind</span>(slope,slope0)}</span>
<span id="cb18-33"><a href="related-individuals.html#cb18-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-34"><a href="related-individuals.html#cb18-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-35"><a href="related-individuals.html#cb18-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-36"><a href="related-individuals.html#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="related-individuals.html#cb18-37" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span>slope[<span class="fu">order</span>(slope<span class="sc">$</span>trait),]</span>
<span id="cb18-38"><a href="related-individuals.html#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="related-individuals.html#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb18-40"><a href="related-individuals.html#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plot inflation ~ aver2_j  </span></span>
<span id="cb18-41"><a href="related-individuals.html#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb18-42"><a href="related-individuals.html#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot ------------------------------------------------------------------</span></span>
<span id="cb18-43"><a href="related-individuals.html#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb18-44"><a href="related-individuals.html#cb18-44" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb18-45"><a href="related-individuals.html#cb18-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb18-46"><a href="related-individuals.html#cb18-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb18-47"><a href="related-individuals.html#cb18-47" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb18-48"><a href="related-individuals.html#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/inflation-by-aver2-bin-rel-unrel-combo.png&quot;</span>),</span>
<span id="cb18-49"><a href="related-individuals.html#cb18-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb18-50"><a href="related-individuals.html#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb18-51"><a href="related-individuals.html#cb18-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb18-52"><a href="related-individuals.html#cb18-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-53"><a href="related-individuals.html#cb18-53" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb18-54"><a href="related-individuals.html#cb18-54" aria-hidden="true" tabindex="-1"></a>    f1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-rel-unrel-combo-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb18-55"><a href="related-individuals.html#cb18-55" aria-hidden="true" tabindex="-1"></a>    f2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-rel-unrel-combo-out/&quot;</span>,trait,<span class="st">&quot;-ref.out&quot;</span>)</span>
<span id="cb18-56"><a href="related-individuals.html#cb18-56" aria-hidden="true" tabindex="-1"></a>    d1<span class="ot">=</span><span class="fu">vroom</span>(f1, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb18-57"><a href="related-individuals.html#cb18-57" aria-hidden="true" tabindex="-1"></a>    d2<span class="ot">=</span><span class="fu">vroom</span>(f2, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb18-58"><a href="related-individuals.html#cb18-58" aria-hidden="true" tabindex="-1"></a>    common<span class="ot">=</span><span class="fu">intersect</span>(d1<span class="sc">$</span>snp, d2<span class="sc">$</span>snp)</span>
<span id="cb18-59"><a href="related-individuals.html#cb18-59" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="fu">match</span>(common, d1<span class="sc">$</span>snp)</span>
<span id="cb18-60"><a href="related-individuals.html#cb18-60" aria-hidden="true" tabindex="-1"></a>    m2<span class="ot">=</span><span class="fu">match</span>(common, d2<span class="sc">$</span>snp)</span>
<span id="cb18-61"><a href="related-individuals.html#cb18-61" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>common,</span>
<span id="cb18-62"><a href="related-individuals.html#cb18-62" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inflation=</span>d1<span class="sc">$</span>chisq[m1]<span class="sc">-</span>d2<span class="sc">$</span>chisq[m2],</span>
<span id="cb18-63"><a href="related-individuals.html#cb18-63" aria-hidden="true" tabindex="-1"></a>                   <span class="at">aver2=</span>d1<span class="sc">$</span>aver2[m1])    </span>
<span id="cb18-64"><a href="related-individuals.html#cb18-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-65"><a href="related-individuals.html#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb18-66"><a href="related-individuals.html#cb18-66" aria-hidden="true" tabindex="-1"></a>    cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb18-67"><a href="related-individuals.html#cb18-67" aria-hidden="true" tabindex="-1"></a>    dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb18-68"><a href="related-individuals.html#cb18-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average inflation by bin values</span></span>
<span id="cb18-69"><a href="related-individuals.html#cb18-69" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">inflation_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>inflation,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb18-70"><a href="related-individuals.html#cb18-70" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb18-71"><a href="related-individuals.html#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="related-individuals.html#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>inflation_ave,</span>
<span id="cb18-73"><a href="related-individuals.html#cb18-73" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave inflation&quot;</span>,</span>
<span id="cb18-74"><a href="related-individuals.html#cb18-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb18-75"><a href="related-individuals.html#cb18-75" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb18-76"><a href="related-individuals.html#cb18-76" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb18-77"><a href="related-individuals.html#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="fake-quintuplets" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> fake quintuplets</h2>
<p>To introduce extremely high relatedness into the genotype data, we duplicate each of 20k unrelated white British five times. Note these 20k should be free from confounding by pop structure. So the 20k individuals are unrelated white British who are similar on PC1.</p>
<div id="id-lists" class="section level3" number="14.4.1">
<h3><span class="header-section-number">14.4.1</span> id lists</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="related-individuals.html#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="related-individuals.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets</span>
<span id="cb19-3"><a href="related-individuals.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="related-individuals.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># id list with completed data--------------------------------------------------- </span></span>
<span id="cb19-5"><a href="related-individuals.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ukbb-recommend.id fake-quintuplets/ukbb-recommend-overlap.ind <span class="co"># unrelated white British</span></span>
<span id="cb19-6"><a href="related-individuals.html#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="related-individuals.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>phen/continuous-traits/</span>
<span id="cb19-8"><a href="related-individuals.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="va">outdir</span><span class="op">=</span>fake-quintuplets</span>
<span id="cb19-9"><a href="related-individuals.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb19-10"><a href="related-individuals.html#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$outdir</span>/ukbb-recommend-overlap.ind <span class="va">$outdir</span>/temp</span>
<span id="cb19-11"><a href="related-individuals.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $1, $2}&#39;</span> <span class="va">$outdir</span>/temp <span class="va">$dir</span>/<span class="va">$tt</span>.raw.pheno <span class="op">&gt;</span> <span class="va">$outdir</span>/ukbb-recommend-overlap.ind</span>
<span id="cb19-12"><a href="related-individuals.html#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> <span class="va">$outdir</span>/ukbb-recommend-overlap.ind</span>
<span id="cb19-13"><a href="related-individuals.html#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$tt</span></span>
<span id="cb19-14"><a href="related-individuals.html#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb19-15"><a href="related-individuals.html#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$outdir</span>/temp</span>
<span id="cb19-16"><a href="related-individuals.html#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># overlapping + complete data for covariates + unrelated</span></span>
<span id="cb19-17"><a href="related-individuals.html#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR{a[$1]; next} ($1 in a) {print $1, $1}&#39;</span> <span class="va">$outdir</span>/ukbb-recommend-overlap.ind white-complete-cov.id <span class="op">&gt;</span> <span class="va">$outdir</span>/ukbb-recommend-overlap-complete-cov.id <span class="co"># N = 196,333</span></span>
<span id="cb19-18"><a href="related-individuals.html#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="related-individuals.html#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># homogenous in PC1 ------------------------------------------------------------ </span></span>
<span id="cb19-20"><a href="related-individuals.html#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb19-21"><a href="related-individuals.html#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb19-22"><a href="related-individuals.html#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;fake-quintuplets/ukbb-recommend-overlap-complete-cov.id&quot;</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb19-23"><a href="related-individuals.html#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="va">pc</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;gen/pca-337k-ukbb.eigenvec&quot;</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb19-24"><a href="related-individuals.html#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">pc</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span> <span class="st">&quot;eid&quot;</span>, paste0<span class="er">(</span><span class="st">&quot;PC&quot;</span><span class="ex">,</span> 1:10<span class="kw">))</span></span>
<span id="cb19-25"><a href="related-individuals.html#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">id</span><span class="va">$V1</span><span class="ex">,pc[,1]</span><span class="kw">)</span></span>
<span id="cb19-26"><a href="related-individuals.html#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="va">pc</span><span class="op">=</span>pc[m,]</span>
<span id="cb19-27"><a href="related-individuals.html#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="related-individuals.html#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>pc[order<span class="kw">(</span><span class="ex">pc</span><span class="va">$PC1</span><span class="ex">,</span> decreasing=T<span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb19-29"><a href="related-individuals.html#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="va">dat</span><span class="op">[</span><span class="dv">1</span>:20000,1:2<span class="op">]</span><span class="kw">)</span></span>
<span id="cb19-30"><a href="related-individuals.html#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="related-individuals.html#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="co"># final list</span></span>
<span id="cb19-32"><a href="related-individuals.html#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> <span class="st">&quot;fake-quintuplets/unrelated-white-homogenous-pc1-20k.id&quot;</span>, </span>
<span id="cb19-33"><a href="related-individuals.html#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="ex">col.names=F,</span> row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>
</div>
<div id="make-bfiles" class="section level3" number="14.4.2">
<h3><span class="header-section-number">14.4.2</span> make bfiles</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="related-individuals.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/gen</span>
<span id="cb20-2"><a href="related-individuals.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="related-individuals.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># make-bfiles of the 20k unrelated----------------------------------------------</span></span>
<span id="cb20-4"><a href="related-individuals.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb20-5"><a href="related-individuals.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb20-6"><a href="related-individuals.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb20-7"><a href="related-individuals.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb20-8"><a href="related-individuals.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb20-9"><a href="related-individuals.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb20-10"><a href="related-individuals.html#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="related-individuals.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --bfile ../gen/geno-norm </span><span class="dt">\</span></span>
<span id="cb20-12"><a href="related-individuals.html#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../fake-quintuplets/unrelated-white-homogenous-pc1-20k.id </span><span class="dt">\</span></span>
<span id="cb20-13"><a href="related-individuals.html#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../gen/snps-norm.use </span><span class="dt">\</span></span>
<span id="cb20-14"><a href="related-individuals.html#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb20-15"><a href="related-individuals.html#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb20-16"><a href="related-individuals.html#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../fake-quintuplets/gen/unrel-20k </span><span class="dt">\</span></span>
<span id="cb20-17"><a href="related-individuals.html#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb20-18"><a href="related-individuals.html#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/make-bed-unrel-20k.sh</span>
<span id="cb20-19"><a href="related-individuals.html#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="related-individuals.html#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb20-21"><a href="related-individuals.html#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/make-bed-unrel-20k.sh <span class="op">&gt;</span> ../job-records/make-bed-unrel-20k.sh</span>
<span id="cb20-22"><a href="related-individuals.html#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="related-individuals.html#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co"># make 5 copies of bfile of the 20k unrelated----------------------------------------------</span></span>
<span id="cb20-24"><a href="related-individuals.html#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>fake-quintuplets/gen</span>
<span id="cb20-25"><a href="related-individuals.html#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> copy <span class="kw">in</span> <span class="dt">{a</span><span class="op">,</span><span class="dt">b</span><span class="op">,</span><span class="dt">c</span><span class="op">,</span><span class="dt">d</span><span class="op">,</span><span class="dt">e}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb20-26"><a href="related-individuals.html#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> copy=<span class="va">$copy</span> <span class="st">&#39;{print copy$1, $2, $3, $4, $5, $6}&#39;</span> <span class="va">$dir</span>/unrel-20k.fam <span class="op">&gt;</span> <span class="va">$dir</span>/unrel-20k-<span class="va">$copy</span>.fam</span>
<span id="cb20-27"><a href="related-individuals.html#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-28"><a href="related-individuals.html#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="related-individuals.html#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="va">$dir</span></span>
<span id="cb20-30"><a href="related-individuals.html#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> copy <span class="kw">in</span> <span class="dt">{a</span><span class="op">,</span><span class="dt">b</span><span class="op">,</span><span class="dt">c</span><span class="op">,</span><span class="dt">d</span><span class="op">,</span><span class="dt">e}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb20-31"><a href="related-individuals.html#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> unrel-20k.bim unrel-20k-<span class="va">$copy</span>.bim</span>
<span id="cb20-32"><a href="related-individuals.html#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> unrel-20k.bed unrel-20k-<span class="va">$copy</span>.bed</span>
<span id="cb20-33"><a href="related-individuals.html#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-34"><a href="related-individuals.html#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="related-individuals.html#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co"># combine data----------------------------------------------------------------------</span></span>
<span id="cb20-36"><a href="related-individuals.html#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;../fake-quintuplets/gen/unrel-20k-a</span></span>
<span id="cb20-37"><a href="related-individuals.html#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="st">../fake-quintuplets/gen/unrel-20k-b</span></span>
<span id="cb20-38"><a href="related-individuals.html#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="st">../fake-quintuplets/gen/unrel-20k-c</span></span>
<span id="cb20-39"><a href="related-individuals.html#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="st">../fake-quintuplets/gen/unrel-20k-d</span></span>
<span id="cb20-40"><a href="related-individuals.html#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="st">../fake-quintuplets/gen/unrel-20k-e</span></span>
<span id="cb20-41"><a href="related-individuals.html#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> fake-quintuplets/gen/bmerge-list</span>
<span id="cb20-42"><a href="related-individuals.html#cb20-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-43"><a href="related-individuals.html#cb20-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-44"><a href="related-individuals.html#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb20-45"><a href="related-individuals.html#cb20-45" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb20-46"><a href="related-individuals.html#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb20-47"><a href="related-individuals.html#cb20-47" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 40G</span></span>
<span id="cb20-48"><a href="related-individuals.html#cb20-48" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb20-49"><a href="related-individuals.html#cb20-49" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb20-50"><a href="related-individuals.html#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="st">./plink1.9 --merge-list ../fake-quintuplets/gen/bmerge-list </span><span class="dt">\</span></span>
<span id="cb20-51"><a href="related-individuals.html#cb20-51" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb20-52"><a href="related-individuals.html#cb20-52" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../fake-quintuplets/gen/20k-quintuplets </span><span class="dt">\</span></span>
<span id="cb20-53"><a href="related-individuals.html#cb20-53" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb20-54"><a href="related-individuals.html#cb20-54" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/merge.sh</span>
<span id="cb20-55"><a href="related-individuals.html#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="related-individuals.html#cb20-56" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/merge.sh <span class="op">&gt;</span> ../job-records/merge.sh</span></code></pre></div>
</div>
<div id="simulate-phenotypes" class="section level3" number="14.4.3">
<h3><span class="header-section-number">14.4.3</span> simulate phenotypes</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="related-individuals.html#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="related-individuals.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5</span>
<span id="cb21-3"><a href="related-individuals.html#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="related-individuals.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/20k-quintuplets</span>
<span id="cb21-5"><a href="related-individuals.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="va">her</span><span class="op">=</span>0.5</span>
<span id="cb21-6"><a href="related-individuals.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5/sim</span>
<span id="cb21-7"><a href="related-individuals.html#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="related-individuals.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb21-9"><a href="related-individuals.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb21-10"><a href="related-individuals.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb21-11"><a href="related-individuals.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb21-12"><a href="related-individuals.html#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb21-13"><a href="related-individuals.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb21-14"><a href="related-individuals.html#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="related-individuals.html#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-phenos </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb21-16"><a href="related-individuals.html#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb21-17"><a href="related-individuals.html#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb21-18"><a href="related-individuals.html#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb21-19"><a href="related-individuals.html#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --her </span><span class="va">$her</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb21-20"><a href="related-individuals.html#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --num-phenos 100 </span><span class="dt">\</span></span>
<span id="cb21-21"><a href="related-individuals.html#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --num-causals 10000</span></span>
<span id="cb21-22"><a href="related-individuals.html#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/sim.sh</span>
<span id="cb21-23"><a href="related-individuals.html#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb21-24"><a href="related-individuals.html#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="related-individuals.html#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/sim.sh <span class="op">&gt;</span> ../job-records/sim.sh</span>
<span id="cb21-26"><a href="related-individuals.html#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="related-individuals.html#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co"># put simulated phenotypes into seperate files----------------------------------</span></span>
<span id="cb21-28"><a href="related-individuals.html#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5/phen</span>
<span id="cb21-29"><a href="related-individuals.html#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="related-individuals.html#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5</span>
<span id="cb21-31"><a href="related-individuals.html#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">100</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb21-32"><a href="related-individuals.html#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> col=<span class="va">$i</span> <span class="st">&#39;{print $1, $2, $(col+2)}&#39;</span> <span class="va">$dir</span>/sim.pheno <span class="op">&gt;</span> <span class="va">$dir</span>/phen/sim-<span class="va">$i</span>.pheno</span>
<span id="cb21-33"><a href="related-individuals.html#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="related-individuals.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the simulation is done correctly</span></span>
<span id="cb22-2"><a href="related-individuals.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="related-individuals.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we would expect breeding values are the same for the same individuals</span></span>
<span id="cb22-4"><a href="related-individuals.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Yes!</span></span>
<span id="cb22-5"><a href="related-individuals.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb22-6"><a href="related-individuals.html#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="related-individuals.html#cb22-7" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5/sim.breed&quot;</span>, <span class="at">col_names=</span>F)</span>
<span id="cb22-8"><a href="related-individuals.html#cb22-8" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>group<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">20000</span>),<span class="fu">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">20000</span>),<span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">20000</span>),</span>
<span id="cb22-9"><a href="related-individuals.html#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">&quot;d&quot;</span>, <span class="dv">20000</span>), <span class="fu">rep</span>(<span class="st">&quot;e&quot;</span>, <span class="dv">20000</span>))</span>
<span id="cb22-10"><a href="related-individuals.html#cb22-10" aria-hidden="true" tabindex="-1"></a>sel<span class="ot">=</span>dat[,<span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X3&quot;</span>, <span class="st">&quot;group&quot;</span>)]</span>
<span id="cb22-11"><a href="related-individuals.html#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;a&quot;</span>, <span class="st">&quot;X3&quot;</span>],sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;b&quot;</span>, <span class="st">&quot;X3&quot;</span>])</span>
<span id="cb22-12"><a href="related-individuals.html#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;a&quot;</span>, <span class="st">&quot;X3&quot;</span>],sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;c&quot;</span>, <span class="st">&quot;X3&quot;</span>])</span>
<span id="cb22-13"><a href="related-individuals.html#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="related-individuals.html#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># expect correlation between simulated phenotypes is 0.5</span></span>
<span id="cb22-15"><a href="related-individuals.html#cb22-15" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5/sim.pheno&quot;</span>, <span class="at">col_names=</span>F)</span>
<span id="cb22-16"><a href="related-individuals.html#cb22-16" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>group<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">20000</span>),<span class="fu">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">20000</span>),<span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">20000</span>),</span>
<span id="cb22-17"><a href="related-individuals.html#cb22-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">&quot;d&quot;</span>, <span class="dv">20000</span>), <span class="fu">rep</span>(<span class="st">&quot;e&quot;</span>, <span class="dv">20000</span>))</span>
<span id="cb22-18"><a href="related-individuals.html#cb22-18" aria-hidden="true" tabindex="-1"></a>sel<span class="ot">=</span>dat[,<span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X3&quot;</span>, <span class="st">&quot;group&quot;</span>)]</span>
<span id="cb22-19"><a href="related-individuals.html#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;a&quot;</span>, <span class="st">&quot;X3&quot;</span>],sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;b&quot;</span>, <span class="st">&quot;X3&quot;</span>])</span>
<span id="cb22-20"><a href="related-individuals.html#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;a&quot;</span>, <span class="st">&quot;X3&quot;</span>],sel[sel<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;c&quot;</span>, <span class="st">&quot;X3&quot;</span>])</span></code></pre></div>
</div>
<div id="gwas-5" class="section level3" number="14.4.4">
<h3><span class="header-section-number">14.4.4</span> gwas</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="related-individuals.html#cb23-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-2"><a href="related-individuals.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5/gwas</span>
<span id="cb23-3"><a href="related-individuals.html#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="related-individuals.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5</span>
<span id="cb23-5"><a href="related-individuals.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/20k-quintuplets</span>
<span id="cb23-6"><a href="related-individuals.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb23-7"><a href="related-individuals.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb23-8"><a href="related-individuals.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb23-9"><a href="related-individuals.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb23-10"><a href="related-individuals.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb23-11"><a href="related-individuals.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb23-12"><a href="related-individuals.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb23-13"><a href="related-individuals.html#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="related-individuals.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$dir</span><span class="st">/gwas/sim-</span><span class="va">$i</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb23-15"><a href="related-individuals.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno </span><span class="va">$dir</span><span class="st">/phen/sim-</span><span class="va">$i</span><span class="st">.pheno </span><span class="dt">\</span></span>
<span id="cb23-16"><a href="related-individuals.html#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb23-17"><a href="related-individuals.html#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb23-18"><a href="related-individuals.html#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/sim-<span class="va">$i</span>-gwas.sh</span>
<span id="cb23-19"><a href="related-individuals.html#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb23-20"><a href="related-individuals.html#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="related-individuals.html#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files</span></span>
<span id="cb23-22"><a href="related-individuals.html#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb23-23"><a href="related-individuals.html#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/sim-<span class="va">$i</span>-gwas.sh</span>
<span id="cb23-24"><a href="related-individuals.html#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-sim</span></code></pre></div>
</div>
<div id="compute-aver2-1" class="section level3" number="14.4.5">
<h3><span class="header-section-number">14.4.5</span> compute aver2</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="related-individuals.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new directory</span></span>
<span id="cb24-2"><a href="related-individuals.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5/</span>
<span id="cb24-3"><a href="related-individuals.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5/aver2</span>
<span id="cb24-4"><a href="related-individuals.html#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="related-individuals.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># to calc aver2 for lista-------------------------------------------------------</span></span>
<span id="cb24-6"><a href="related-individuals.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/related/right-snps</span>
<span id="cb24-7"><a href="related-individuals.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/related/left-snps</span>
<span id="cb24-8"><a href="related-individuals.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/20k-quintuplets</span>
<span id="cb24-9"><a href="related-individuals.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5/aver2/lista</span>
<span id="cb24-10"><a href="related-individuals.html#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="related-individuals.html#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb24-12"><a href="related-individuals.html#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb24-13"><a href="related-individuals.html#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb24-14"><a href="related-individuals.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb24-15"><a href="related-individuals.html#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb24-16"><a href="related-individuals.html#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:40:0</span></span>
<span id="cb24-17"><a href="related-individuals.html#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb24-18"><a href="related-individuals.html#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb24-19"><a href="related-individuals.html#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb24-20"><a href="related-individuals.html#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb24-21"><a href="related-individuals.html#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb24-22"><a href="related-individuals.html#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-aver2-lista</span>
<span id="cb24-23"><a href="related-individuals.html#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="related-individuals.html#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># job submission</span></span>
<span id="cb24-25"><a href="related-individuals.html#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-aver2-lista <span class="op">&gt;</span>../job-records/calc-aver2-sim</span>
<span id="cb24-26"><a href="related-individuals.html#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="related-individuals.html#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co"># to calc aver2 for listb-------------------------------------------------------</span></span>
<span id="cb24-28"><a href="related-individuals.html#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/related/right-snps</span>
<span id="cb24-29"><a href="related-individuals.html#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/related/left-snps</span>
<span id="cb24-30"><a href="related-individuals.html#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/20k-quintuplets</span>
<span id="cb24-31"><a href="related-individuals.html#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5/aver2/listb</span>
<span id="cb24-32"><a href="related-individuals.html#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="related-individuals.html#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb24-34"><a href="related-individuals.html#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb24-35"><a href="related-individuals.html#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb24-36"><a href="related-individuals.html#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb24-37"><a href="related-individuals.html#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb24-38"><a href="related-individuals.html#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:40:0</span></span>
<span id="cb24-39"><a href="related-individuals.html#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb24-40"><a href="related-individuals.html#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb24-41"><a href="related-individuals.html#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb24-42"><a href="related-individuals.html#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$listb</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb24-43"><a href="related-individuals.html#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$lista</span></span>
<span id="cb24-44"><a href="related-individuals.html#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-aver2-listb</span>
<span id="cb24-45"><a href="related-individuals.html#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="related-individuals.html#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="co"># job submission</span></span>
<span id="cb24-47"><a href="related-individuals.html#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-aver2-listb <span class="op">&gt;</span>../job-records/calc-aver2-sim</span>
<span id="cb24-48"><a href="related-individuals.html#cb24-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-49"><a href="related-individuals.html#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="co"># merge aver2 of the two lists--------------------------------------------------</span></span>
<span id="cb24-50"><a href="related-individuals.html#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5/aver2</span>
<span id="cb24-51"><a href="related-individuals.html#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="va">a</span><span class="op">=</span><span class="va">$dir</span>/lista.rjk2.average</span>
<span id="cb24-52"><a href="related-individuals.html#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="va">b</span><span class="op">=</span><span class="va">$dir</span>/listb.rjk2.average</span>
<span id="cb24-53"><a href="related-individuals.html#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span><span class="va">$dir</span>/all.aver2</span>
<span id="cb24-54"><a href="related-individuals.html#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;FNR &gt; 1 {print $1, $2}&#39;</span>  <span class="va">$a</span> <span class="va">$b</span> <span class="op">&gt;</span> <span class="va">$out</span></span></code></pre></div>
</div>
<div id="chisq-aver2-1" class="section level3" number="14.4.6">
<h3><span class="header-section-number">14.4.6</span> chisq ~ aver2</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="related-individuals.html#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="related-individuals.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># organize data ---------------------------------------------------------------</span></span>
<span id="cb25-3"><a href="related-individuals.html#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="related-individuals.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5/gwas-out</span>
<span id="cb25-5"><a href="related-individuals.html#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="related-individuals.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="va">outdir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5/gwas-out</span>
<span id="cb25-7"><a href="related-individuals.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="va">indir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5</span>
<span id="cb25-8"><a href="related-individuals.html#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="related-individuals.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-10"><a href="related-individuals.html#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="related-individuals.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span><span class="va">$indir</span>/gwas/sim-<span class="va">$i</span>.summaries</span>
<span id="cb25-12"><a href="related-individuals.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span><span class="va">$indir</span>/aver2/all.aver2</span>
<span id="cb25-13"><a href="related-individuals.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="va">ldsc</span><span class="op">=</span>snps-norm.ldscore</span>
<span id="cb25-14"><a href="related-individuals.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span><span class="va">$outdir</span>/sim-<span class="va">$i</span>.out</span>
<span id="cb25-15"><a href="related-individuals.html#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="related-individuals.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp</span>
<span id="cb25-17"><a href="related-individuals.html#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="related-individuals.html#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb25-19"><a href="related-individuals.html#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb25-20"><a href="related-individuals.html#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$ldsc</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/ldsc.tmp</span>
<span id="cb25-21"><a href="related-individuals.html#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="related-individuals.html#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb25-23"><a href="related-individuals.html#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb25-24"><a href="related-individuals.html#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb25-25"><a href="related-individuals.html#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="related-individuals.html#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb25-27"><a href="related-individuals.html#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb25-28"><a href="related-individuals.html#cb25-28" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb25-29"><a href="related-individuals.html#cb25-29" aria-hidden="true" tabindex="-1"></a>      tmp/ldsc.tmp <span class="dt">\</span></span>
<span id="cb25-30"><a href="related-individuals.html#cb25-30" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb25-31"><a href="related-individuals.html#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2;ldsc&quot;}</span></span>
<span id="cb25-32"><a href="related-individuals.html#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb25-33"><a href="related-individuals.html#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="related-individuals.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq ~ aver2 bin</span></span>
<span id="cb26-2"><a href="related-individuals.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="related-individuals.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb26-4"><a href="related-individuals.html#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="related-individuals.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-bin-rel-sim.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb26-6"><a href="related-individuals.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb26-7"><a href="related-individuals.html#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="related-individuals.html#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb26-9"><a href="related-individuals.html#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="related-individuals.html#cb26-10" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb26-11"><a href="related-individuals.html#cb26-11" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb26-12"><a href="related-individuals.html#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="related-individuals.html#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb26-14"><a href="related-individuals.html#cb26-14" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2 <span class="sc">+</span> ldsc,<span class="at">data=</span>dat)</span>
<span id="cb26-15"><a href="related-individuals.html#cb26-15" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb26-16"><a href="related-individuals.html#cb26-16" aria-hidden="true" tabindex="-1"></a>  p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb26-17"><a href="related-individuals.html#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="related-individuals.html#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb26-19"><a href="related-individuals.html#cb26-19" aria-hidden="true" tabindex="-1"></a>  cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb26-20"><a href="related-individuals.html#cb26-20" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb26-21"><a href="related-individuals.html#cb26-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-22"><a href="related-individuals.html#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb26-23"><a href="related-individuals.html#cb26-23" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb26-24"><a href="related-individuals.html#cb26-24" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb26-25"><a href="related-individuals.html#cb26-25" aria-hidden="true" tabindex="-1"></a>  px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb26-26"><a href="related-individuals.html#cb26-26" aria-hidden="true" tabindex="-1"></a>  py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb26-27"><a href="related-individuals.html#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="related-individuals.html#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb26-29"><a href="related-individuals.html#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb26-30"><a href="related-individuals.html#cb26-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb26-31"><a href="related-individuals.html#cb26-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;sim &quot;</span>,i), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb26-32"><a href="related-individuals.html#cb26-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb26-33"><a href="related-individuals.html#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(chisq <span class="sc">~</span> aver2, <span class="at">data=</span>dat),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb26-34"><a href="related-individuals.html#cb26-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb26-35"><a href="related-individuals.html#cb26-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb26-36"><a href="related-individuals.html#cb26-36" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb26-37"><a href="related-individuals.html#cb26-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb26-38"><a href="related-individuals.html#cb26-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-39"><a href="related-individuals.html#cb26-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-40"><a href="related-individuals.html#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="unrelated-controls" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> unrelated controls</h2>
<div id="id-lists-1" class="section level3" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> id lists</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="related-individuals.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">100</span>)</span>
<span id="cb27-2"><a href="related-individuals.html#cb27-2" aria-hidden="true" tabindex="-1"></a>id<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;fake-quintuplets/ukbb-recommend-overlap-complete-cov.id&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb27-3"><a href="related-individuals.html#cb27-3" aria-hidden="true" tabindex="-1"></a>pc<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;gen/pca-337k-ukbb.eigenvec&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb27-4"><a href="related-individuals.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pc)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;eid&quot;</span>, <span class="st">&quot;eid&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;PC&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb27-5"><a href="related-individuals.html#cb27-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">match</span>(id<span class="sc">$</span>V1,pc[,<span class="dv">1</span>])</span>
<span id="cb27-6"><a href="related-individuals.html#cb27-6" aria-hidden="true" tabindex="-1"></a>pc<span class="ot">=</span>pc[m,]</span>
<span id="cb27-7"><a href="related-individuals.html#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="related-individuals.html#cb27-8" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span>pc[<span class="fu">order</span>(pc<span class="sc">$</span>PC1, <span class="at">decreasing=</span>T),]</span>
<span id="cb27-9"><a href="related-individuals.html#cb27-9" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">rbind</span>(dat[<span class="dv">1</span><span class="sc">:</span><span class="dv">100000</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb27-10"><a href="related-individuals.html#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="related-individuals.html#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># final list</span></span>
<span id="cb27-12"><a href="related-individuals.html#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(out, <span class="st">&quot;fake-quintuplets/unrelated-white-homogenous-pc1-100k.id&quot;</span>, </span>
<span id="cb27-13"><a href="related-individuals.html#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="at">col.names=</span>F, <span class="at">row.names=</span>F, <span class="at">quote=</span>F)</span></code></pre></div>
</div>
<div id="make-bfiles-1" class="section level3" number="14.5.2">
<h3><span class="header-section-number">14.5.2</span> make bfiles</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="related-individuals.html#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="related-individuals.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make-bfiles of the 100k unrelated----------------------------------------------</span></span>
<span id="cb28-3"><a href="related-individuals.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb28-4"><a href="related-individuals.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb28-5"><a href="related-individuals.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb28-6"><a href="related-individuals.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb28-7"><a href="related-individuals.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb28-8"><a href="related-individuals.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb28-9"><a href="related-individuals.html#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="related-individuals.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --bfile ../gen/geno-norm </span><span class="dt">\</span></span>
<span id="cb28-11"><a href="related-individuals.html#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../fake-quintuplets/unrelated-white-homogenous-pc1-100k.id </span><span class="dt">\</span></span>
<span id="cb28-12"><a href="related-individuals.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../gen/snps-norm.use </span><span class="dt">\</span></span>
<span id="cb28-13"><a href="related-individuals.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb28-14"><a href="related-individuals.html#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb28-15"><a href="related-individuals.html#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../fake-quintuplets/gen/unrel-100k </span><span class="dt">\</span></span>
<span id="cb28-16"><a href="related-individuals.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb28-17"><a href="related-individuals.html#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/make-bed-unrel-100k.sh</span>
<span id="cb28-18"><a href="related-individuals.html#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="related-individuals.html#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb28-20"><a href="related-individuals.html#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/make-bed-unrel-100k.sh <span class="op">&gt;</span> ../job-records/make-bed-unrel-100k.sh</span></code></pre></div>
</div>
<div id="simulate-phenotypes-1" class="section level3" number="14.5.3">
<h3><span class="header-section-number">14.5.3</span> simulate phenotypes</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="related-individuals.html#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="related-individuals.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5-unrel</span>
<span id="cb29-3"><a href="related-individuals.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="related-individuals.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/unrel-100k</span>
<span id="cb29-5"><a href="related-individuals.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5-unrel/sim</span>
<span id="cb29-6"><a href="related-individuals.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="va">her</span><span class="op">=</span>0.5</span>
<span id="cb29-7"><a href="related-individuals.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb29-8"><a href="related-individuals.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb29-9"><a href="related-individuals.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb29-10"><a href="related-individuals.html#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb29-11"><a href="related-individuals.html#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb29-12"><a href="related-individuals.html#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb29-13"><a href="related-individuals.html#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="related-individuals.html#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-phenos </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb29-15"><a href="related-individuals.html#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb29-16"><a href="related-individuals.html#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb29-17"><a href="related-individuals.html#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb29-18"><a href="related-individuals.html#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --her </span><span class="va">$her</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb29-19"><a href="related-individuals.html#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --causals </span><span class="dt">\</span></span>
<span id="cb29-20"><a href="related-individuals.html#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --effects  </span><span class="dt">\</span></span>
<span id="cb29-21"><a href="related-individuals.html#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --num-phenos 100 </span><span class="dt">\</span></span>
<span id="cb29-22"><a href="related-individuals.html#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --num-causals 10000</span></span>
<span id="cb29-23"><a href="related-individuals.html#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/sim.sh</span>
<span id="cb29-24"><a href="related-individuals.html#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="related-individuals.html#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/sim.sh <span class="op">&gt;</span> ../job-records/sim.sh</span>
<span id="cb29-26"><a href="related-individuals.html#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="related-individuals.html#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co"># put simulated phenotypes into separate files----------------------------------</span></span>
<span id="cb29-28"><a href="related-individuals.html#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5-unrel/phen</span>
<span id="cb29-29"><a href="related-individuals.html#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="related-individuals.html#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5-unrel</span>
<span id="cb29-31"><a href="related-individuals.html#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">100</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb29-32"><a href="related-individuals.html#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> col=<span class="va">$i</span> <span class="st">&#39;{print $1, $2, $(col+2)}&#39;</span> <span class="va">$dir</span>/sim.pheno <span class="op">&gt;</span> <span class="va">$dir</span>/phen/sim-<span class="va">$i</span>.pheno</span>
<span id="cb29-33"><a href="related-individuals.html#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="gwas-6" class="section level3" number="14.5.4">
<h3><span class="header-section-number">14.5.4</span> gwas</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="related-individuals.html#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="related-individuals.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5-unrel/gwas</span>
<span id="cb30-3"><a href="related-individuals.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="related-individuals.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5-unrel</span>
<span id="cb30-5"><a href="related-individuals.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/unrel-100k</span>
<span id="cb30-6"><a href="related-individuals.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-7"><a href="related-individuals.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb30-8"><a href="related-individuals.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb30-9"><a href="related-individuals.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb30-10"><a href="related-individuals.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb30-11"><a href="related-individuals.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb30-12"><a href="related-individuals.html#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb30-13"><a href="related-individuals.html#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="related-individuals.html#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$dir</span><span class="st">/gwas/sim-</span><span class="va">$i</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb30-15"><a href="related-individuals.html#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno </span><span class="va">$dir</span><span class="st">/phen/sim-</span><span class="va">$i</span><span class="st">.pheno </span><span class="dt">\</span></span>
<span id="cb30-16"><a href="related-individuals.html#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb30-17"><a href="related-individuals.html#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb30-18"><a href="related-individuals.html#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/sim-<span class="va">$i</span>-gwas.sh</span>
<span id="cb30-19"><a href="related-individuals.html#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb30-20"><a href="related-individuals.html#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="related-individuals.html#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files</span></span>
<span id="cb30-22"><a href="related-individuals.html#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-23"><a href="related-individuals.html#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/sim-<span class="va">$i</span>-gwas.sh</span>
<span id="cb30-24"><a href="related-individuals.html#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-sim</span></code></pre></div>
</div>
<div id="compute-aver2-2" class="section level3" number="14.5.5">
<h3><span class="header-section-number">14.5.5</span> compute aver2</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="related-individuals.html#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="related-individuals.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5-unrel/aver2</span>
<span id="cb31-3"><a href="related-individuals.html#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="related-individuals.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># to calc aver2 for lista-------------------------------------------------------</span></span>
<span id="cb31-5"><a href="related-individuals.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/related/right-snps</span>
<span id="cb31-6"><a href="related-individuals.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/related/left-snps</span>
<span id="cb31-7"><a href="related-individuals.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/unrel-100k</span>
<span id="cb31-8"><a href="related-individuals.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5-unrel/aver2/lista</span>
<span id="cb31-9"><a href="related-individuals.html#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="related-individuals.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb31-11"><a href="related-individuals.html#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb31-12"><a href="related-individuals.html#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb31-13"><a href="related-individuals.html#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb31-14"><a href="related-individuals.html#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb31-15"><a href="related-individuals.html#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:40:0</span></span>
<span id="cb31-16"><a href="related-individuals.html#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb31-17"><a href="related-individuals.html#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-18"><a href="related-individuals.html#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-19"><a href="related-individuals.html#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-20"><a href="related-individuals.html#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb31-21"><a href="related-individuals.html#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-aver2-lista</span>
<span id="cb31-22"><a href="related-individuals.html#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="related-individuals.html#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># job submission</span></span>
<span id="cb31-24"><a href="related-individuals.html#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-aver2-lista <span class="op">&gt;</span>../job-records/calc-aver2-sim</span>
<span id="cb31-25"><a href="related-individuals.html#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="related-individuals.html#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co"># to calc aver2 for listb-------------------------------------------------------</span></span>
<span id="cb31-27"><a href="related-individuals.html#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/related/right-snps</span>
<span id="cb31-28"><a href="related-individuals.html#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/related/left-snps</span>
<span id="cb31-29"><a href="related-individuals.html#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../british-irish-gwas.id </span>
<span id="cb31-30"><a href="related-individuals.html#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../fake-quintuplets/gen/unrel-100k</span>
<span id="cb31-31"><a href="related-individuals.html#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../fake-quintuplets/sim-her-0.5-unrel/aver2/listb</span>
<span id="cb31-32"><a href="related-individuals.html#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="related-individuals.html#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb31-34"><a href="related-individuals.html#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb31-35"><a href="related-individuals.html#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb31-36"><a href="related-individuals.html#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb31-37"><a href="related-individuals.html#cb31-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb31-38"><a href="related-individuals.html#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:40:0</span></span>
<span id="cb31-39"><a href="related-individuals.html#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb31-40"><a href="related-individuals.html#cb31-40" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-41"><a href="related-individuals.html#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-42"><a href="related-individuals.html#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$listb</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-43"><a href="related-individuals.html#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$lista</span></span>
<span id="cb31-44"><a href="related-individuals.html#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-aver2-listb</span>
<span id="cb31-45"><a href="related-individuals.html#cb31-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-46"><a href="related-individuals.html#cb31-46" aria-hidden="true" tabindex="-1"></a><span class="co"># job submission</span></span>
<span id="cb31-47"><a href="related-individuals.html#cb31-47" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-aver2-listb <span class="op">&gt;</span>../job-records/calc-aver2-sim</span>
<span id="cb31-48"><a href="related-individuals.html#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="related-individuals.html#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="co"># merge aver2 of the two lists--------------------------------------------------</span></span>
<span id="cb31-50"><a href="related-individuals.html#cb31-50" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5-unrel/aver2</span>
<span id="cb31-51"><a href="related-individuals.html#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="va">a</span><span class="op">=</span><span class="va">$dir</span>/lista.rjk2.average</span>
<span id="cb31-52"><a href="related-individuals.html#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="va">b</span><span class="op">=</span><span class="va">$dir</span>/listb.rjk2.average</span>
<span id="cb31-53"><a href="related-individuals.html#cb31-53" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span><span class="va">$dir</span>/all.aver2</span>
<span id="cb31-54"><a href="related-individuals.html#cb31-54" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;FNR &gt; 1 {print $1, $2}&#39;</span>  <span class="va">$a</span> <span class="va">$b</span> <span class="op">&gt;</span> <span class="va">$out</span></span></code></pre></div>
</div>
<div id="chisq-aver2-2" class="section level3" number="14.5.6">
<h3><span class="header-section-number">14.5.6</span> chisq ~ aver2</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="related-individuals.html#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="related-individuals.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># organize data ---------------------------------------------------------------</span></span>
<span id="cb32-3"><a href="related-individuals.html#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="related-individuals.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> fake-quintuplets/sim-her-0.5-unrel/gwas-out</span>
<span id="cb32-5"><a href="related-individuals.html#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="related-individuals.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="va">outdir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5-unrel/gwas-out</span>
<span id="cb32-7"><a href="related-individuals.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="va">indir</span><span class="op">=</span>fake-quintuplets/sim-her-0.5-unrel</span>
<span id="cb32-8"><a href="related-individuals.html#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="related-individuals.html#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb32-10"><a href="related-individuals.html#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="related-individuals.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span><span class="va">$indir</span>/gwas/sim-<span class="va">$i</span>.summaries</span>
<span id="cb32-12"><a href="related-individuals.html#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span><span class="va">$indir</span>/aver2/all.aver2</span>
<span id="cb32-13"><a href="related-individuals.html#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="va">ldsc</span><span class="op">=</span>snps-norm.ldscore</span>
<span id="cb32-14"><a href="related-individuals.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span><span class="va">$outdir</span>/sim-<span class="va">$i</span>.out</span>
<span id="cb32-15"><a href="related-individuals.html#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="related-individuals.html#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp</span>
<span id="cb32-17"><a href="related-individuals.html#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="related-individuals.html#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb32-19"><a href="related-individuals.html#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb32-20"><a href="related-individuals.html#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$ldsc</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/ldsc.tmp</span>
<span id="cb32-21"><a href="related-individuals.html#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="related-individuals.html#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb32-23"><a href="related-individuals.html#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb32-24"><a href="related-individuals.html#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb32-25"><a href="related-individuals.html#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="related-individuals.html#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb32-27"><a href="related-individuals.html#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb32-28"><a href="related-individuals.html#cb32-28" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb32-29"><a href="related-individuals.html#cb32-29" aria-hidden="true" tabindex="-1"></a>      tmp/ldsc.tmp <span class="dt">\</span></span>
<span id="cb32-30"><a href="related-individuals.html#cb32-30" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb32-31"><a href="related-individuals.html#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2;ldsc&quot;}</span></span>
<span id="cb32-32"><a href="related-individuals.html#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb32-33"><a href="related-individuals.html#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="related-individuals.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq ~ aver2 bin</span></span>
<span id="cb33-2"><a href="related-individuals.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="related-individuals.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb33-4"><a href="related-individuals.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="related-individuals.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-bin-sim-unrel-control.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb33-6"><a href="related-individuals.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb33-7"><a href="related-individuals.html#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="related-individuals.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb33-9"><a href="related-individuals.html#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="related-individuals.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5-unrel/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb33-11"><a href="related-individuals.html#cb33-11" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb33-12"><a href="related-individuals.html#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="related-individuals.html#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb33-14"><a href="related-individuals.html#cb33-14" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2 <span class="sc">+</span> ldsc,<span class="at">data=</span>dat)</span>
<span id="cb33-15"><a href="related-individuals.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb33-16"><a href="related-individuals.html#cb33-16" aria-hidden="true" tabindex="-1"></a>  p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb33-17"><a href="related-individuals.html#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="related-individuals.html#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb33-19"><a href="related-individuals.html#cb33-19" aria-hidden="true" tabindex="-1"></a>  cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb33-20"><a href="related-individuals.html#cb33-20" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb33-21"><a href="related-individuals.html#cb33-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-22"><a href="related-individuals.html#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb33-23"><a href="related-individuals.html#cb33-23" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb33-24"><a href="related-individuals.html#cb33-24" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb33-25"><a href="related-individuals.html#cb33-25" aria-hidden="true" tabindex="-1"></a>  px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb33-26"><a href="related-individuals.html#cb33-26" aria-hidden="true" tabindex="-1"></a>  py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb33-27"><a href="related-individuals.html#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="related-individuals.html#cb33-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb33-29"><a href="related-individuals.html#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb33-30"><a href="related-individuals.html#cb33-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb33-31"><a href="related-individuals.html#cb33-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;sim &quot;</span>,i), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb33-32"><a href="related-individuals.html#cb33-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb33-33"><a href="related-individuals.html#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(chisq <span class="sc">~</span> aver2, <span class="at">data=</span>dat),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb33-34"><a href="related-individuals.html#cb33-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb33-35"><a href="related-individuals.html#cb33-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb33-36"><a href="related-individuals.html#cb33-36" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb33-37"><a href="related-individuals.html#cb33-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb33-38"><a href="related-individuals.html#cb33-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-39"><a href="related-individuals.html#cb33-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-40"><a href="related-individuals.html#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="related-vs.-unrelated" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> related vs. unrelated</h2>
<div id="chisq-test-statistics-1" class="section level3" number="14.6.1">
<h3><span class="header-section-number">14.6.1</span> chisq test statistics</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="related-individuals.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ plot--------------------------------------------------------------------------</span></span>
<span id="cb34-2"><a href="related-individuals.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb34-3"><a href="related-individuals.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="related-individuals.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-related-vs-unrel.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb34-5"><a href="related-individuals.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>, <span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb34-6"><a href="related-individuals.html#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="related-individuals.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb34-8"><a href="related-individuals.html#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="related-individuals.html#cb34-9" aria-hidden="true" tabindex="-1"></a>  rel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb34-10"><a href="related-individuals.html#cb34-10" aria-hidden="true" tabindex="-1"></a>  unrel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5-unrel/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb34-11"><a href="related-individuals.html#cb34-11" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">match</span>(rel<span class="sc">$</span>snp, unrel<span class="sc">$</span>snp)</span>
<span id="cb34-12"><a href="related-individuals.html#cb34-12" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>rel<span class="sc">$</span>snp,</span>
<span id="cb34-13"><a href="related-individuals.html#cb34-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel=</span>rel<span class="sc">$</span>chisq,</span>
<span id="cb34-14"><a href="related-individuals.html#cb34-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span>unrel<span class="sc">$</span>chisq[m])</span>
<span id="cb34-15"><a href="related-individuals.html#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="related-individuals.html#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb34-17"><a href="related-individuals.html#cb34-17" aria-hidden="true" tabindex="-1"></a>  cutoff1<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>rel, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb34-18"><a href="related-individuals.html#cb34-18" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin_rel<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>rel, <span class="at">breaks=</span>cutoff1, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff1)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb34-19"><a href="related-individuals.html#cb34-19" aria-hidden="true" tabindex="-1"></a>  cutoff2<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>unrel, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb34-20"><a href="related-individuals.html#cb34-20" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin_unrel<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>unrel, <span class="at">breaks=</span>cutoff2, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff2)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb34-21"><a href="related-individuals.html#cb34-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-22"><a href="related-individuals.html#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb34-23"><a href="related-individuals.html#cb34-23" aria-hidden="true" tabindex="-1"></a>  ave<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">rel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>rel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_rel, mean),</span>
<span id="cb34-24"><a href="related-individuals.html#cb34-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>unrel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_unrel, mean))</span>
<span id="cb34-25"><a href="related-individuals.html#cb34-25" aria-hidden="true" tabindex="-1"></a>  sd<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">rel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>rel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_rel, sd),</span>
<span id="cb34-26"><a href="related-individuals.html#cb34-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>unrel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_unrel, sd))</span>
<span id="cb34-27"><a href="related-individuals.html#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x ylimminimum=min(c(ave$rel,ave$unrel))</span></span>
<span id="cb34-28"><a href="related-individuals.html#cb34-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-29"><a href="related-individuals.html#cb34-29" aria-hidden="true" tabindex="-1"></a>  maximum<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(ave<span class="sc">$</span>rel,ave<span class="sc">$</span>unrel))</span>
<span id="cb34-30"><a href="related-individuals.html#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="related-individuals.html#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb34-32"><a href="related-individuals.html#cb34-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(cutoff1, cutoff2,</span>
<span id="cb34-33"><a href="related-individuals.html#cb34-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;rel&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;unrel&quot;</span>,</span>
<span id="cb34-34"><a href="related-individuals.html#cb34-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;sim &quot;</span>,i), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb34-35"><a href="related-individuals.html#cb34-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb34-36"><a href="related-individuals.html#cb34-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb34-37"><a href="related-individuals.html#cb34-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb34-38"><a href="related-individuals.html#cb34-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb34-39"><a href="related-individuals.html#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#points(ave$rel, ave$unrel, cex = 1.5, pch=21, </span></span>
<span id="cb34-40"><a href="related-individuals.html#cb34-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#       bg=&quot;powderblue&quot;, col=&quot;white&quot;, lwd=0.5)</span></span>
<span id="cb34-41"><a href="related-individuals.html#cb34-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-42"><a href="related-individuals.html#cb34-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-43"><a href="related-individuals.html#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="aver2" class="section level3" number="14.6.2">
<h3><span class="header-section-number">14.6.2</span> aver2</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="related-individuals.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb35-2"><a href="related-individuals.html#cb35-2" aria-hidden="true" tabindex="-1"></a>rel<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5/aver2/all.aver2&quot;</span>, <span class="at">col_names=</span>F)</span>
<span id="cb35-3"><a href="related-individuals.html#cb35-3" aria-hidden="true" tabindex="-1"></a>unrel<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5-unrel/aver2/all.aver2&quot;</span>, <span class="at">col_names=</span>F)</span>
<span id="cb35-4"><a href="related-individuals.html#cb35-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">match</span>(rel<span class="sc">$</span>X1, unrel<span class="sc">$</span>X1)</span>
<span id="cb35-5"><a href="related-individuals.html#cb35-5" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>rel<span class="sc">$</span>X1, </span>
<span id="cb35-6"><a href="related-individuals.html#cb35-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">rel=</span>rel<span class="sc">$</span>X2,</span>
<span id="cb35-7"><a href="related-individuals.html#cb35-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">unrel=</span>unrel<span class="sc">$</span>X2[m])</span>
<span id="cb35-8"><a href="related-individuals.html#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(dat[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>, mean)</span>
<span id="cb35-9"><a href="related-individuals.html#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="related-individuals.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles</span></span>
<span id="cb35-11"><a href="related-individuals.html#cb35-11" aria-hidden="true" tabindex="-1"></a>q_rel<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>rel, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb35-12"><a href="related-individuals.html#cb35-12" aria-hidden="true" tabindex="-1"></a>q_unrel<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>unrel, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb35-13"><a href="related-individuals.html#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="related-individuals.html#cb35-14" aria-hidden="true" tabindex="-1"></a>minimum<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(q_rel,q_unrel))</span>
<span id="cb35-15"><a href="related-individuals.html#cb35-15" aria-hidden="true" tabindex="-1"></a>maximum<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(q_rel,q_unrel))</span>
<span id="cb35-16"><a href="related-individuals.html#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="related-individuals.html#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/aver2-related-vs-unrel.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb35-18"><a href="related-individuals.html#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>, <span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb35-19"><a href="related-individuals.html#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(q_rel, q_unrel,</span>
<span id="cb35-20"><a href="related-individuals.html#cb35-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;rel&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;unrel&quot;</span>,</span>
<span id="cb35-21"><a href="related-individuals.html#cb35-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb35-22"><a href="related-individuals.html#cb35-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb35-23"><a href="related-individuals.html#cb35-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim=</span><span class="fu">c</span>(minimum, maximum),</span>
<span id="cb35-24"><a href="related-individuals.html#cb35-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">16</span>,  <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb35-25"><a href="related-individuals.html#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb35-26"><a href="related-individuals.html#cb35-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-27"><a href="related-individuals.html#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="inflation-aver2-1" class="section level3" number="14.6.3">
<h3><span class="header-section-number">14.6.3</span> inflation ~ aver2</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="related-individuals.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb36-2"><a href="related-individuals.html#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="related-individuals.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/inflation-aver2-bin-rel-sim.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb36-4"><a href="related-individuals.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb36-5"><a href="related-individuals.html#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="related-individuals.html#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb36-7"><a href="related-individuals.html#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="related-individuals.html#cb36-8" aria-hidden="true" tabindex="-1"></a>  rel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb36-9"><a href="related-individuals.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  unrel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5-unrel/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb36-10"><a href="related-individuals.html#cb36-10" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">match</span>(rel<span class="sc">$</span>snp,unrel<span class="sc">$</span>snp)</span>
<span id="cb36-11"><a href="related-individuals.html#cb36-11" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">data.frame</span>(rel<span class="sc">$</span>snp,</span>
<span id="cb36-12"><a href="related-individuals.html#cb36-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">inflation=</span>rel<span class="sc">$</span>chisq<span class="sc">-</span>unrel<span class="sc">$</span>chisq[m],</span>
<span id="cb36-13"><a href="related-individuals.html#cb36-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">aver2=</span>rel<span class="sc">$</span>aver2,</span>
<span id="cb36-14"><a href="related-individuals.html#cb36-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ldsc=</span>rel<span class="sc">$</span>ldsc)</span>
<span id="cb36-15"><a href="related-individuals.html#cb36-15" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb36-16"><a href="related-individuals.html#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="related-individuals.html#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb36-18"><a href="related-individuals.html#cb36-18" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">=</span><span class="fu">lm</span>(inflation <span class="sc">~</span> aver2 ,<span class="at">data=</span>dat)</span>
<span id="cb36-19"><a href="related-individuals.html#cb36-19" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb36-20"><a href="related-individuals.html#cb36-20" aria-hidden="true" tabindex="-1"></a>  p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb36-21"><a href="related-individuals.html#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="related-individuals.html#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb36-23"><a href="related-individuals.html#cb36-23" aria-hidden="true" tabindex="-1"></a>  cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb36-24"><a href="related-individuals.html#cb36-24" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb36-25"><a href="related-individuals.html#cb36-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-26"><a href="related-individuals.html#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb36-27"><a href="related-individuals.html#cb36-27" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">inflation_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>inflation,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb36-28"><a href="related-individuals.html#cb36-28" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb36-29"><a href="related-individuals.html#cb36-29" aria-hidden="true" tabindex="-1"></a>  px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb36-30"><a href="related-individuals.html#cb36-30" aria-hidden="true" tabindex="-1"></a>  py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>inflation_ave)</span>
<span id="cb36-31"><a href="related-individuals.html#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="related-individuals.html#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb36-33"><a href="related-individuals.html#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>inflation_ave,</span>
<span id="cb36-34"><a href="related-individuals.html#cb36-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean inflation&quot;</span>,</span>
<span id="cb36-35"><a href="related-individuals.html#cb36-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;sim &quot;</span>,i), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb36-36"><a href="related-individuals.html#cb36-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb36-37"><a href="related-individuals.html#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(mod,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb36-38"><a href="related-individuals.html#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb36-39"><a href="related-individuals.html#cb36-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb36-40"><a href="related-individuals.html#cb36-40" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb36-41"><a href="related-individuals.html#cb36-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb36-42"><a href="related-individuals.html#cb36-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-43"><a href="related-individuals.html#cb36-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-44"><a href="related-individuals.html#cb36-44" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="chisq-ldscore" class="section level3" number="14.6.4">
<h3><span class="header-section-number">14.6.4</span> chisq ~ ldscore</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="related-individuals.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb37-2"><a href="related-individuals.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="related-individuals.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-ldsc-bin-rel-sim.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb37-4"><a href="related-individuals.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb37-5"><a href="related-individuals.html#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="related-individuals.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb37-7"><a href="related-individuals.html#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="related-individuals.html#cb37-8" aria-hidden="true" tabindex="-1"></a>  rel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb37-9"><a href="related-individuals.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  unrel<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;fake-quintuplets/sim-her-0.5-unrel/gwas-out/sim-&quot;</span>,i,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb37-10"><a href="related-individuals.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">match</span>(rel<span class="sc">$</span>snp,unrel<span class="sc">$</span>snp)</span>
<span id="cb37-11"><a href="related-individuals.html#cb37-11" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>rel<span class="sc">$</span>snp,</span>
<span id="cb37-12"><a href="related-individuals.html#cb37-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel=</span>rel<span class="sc">$</span>chisq,</span>
<span id="cb37-13"><a href="related-individuals.html#cb37-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel=</span>unrel<span class="sc">$</span>chisq[m],</span>
<span id="cb37-14"><a href="related-individuals.html#cb37-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ldsc=</span>rel<span class="sc">$</span>ldsc)</span>
<span id="cb37-15"><a href="related-individuals.html#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="related-individuals.html#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb37-17"><a href="related-individuals.html#cb37-17" aria-hidden="true" tabindex="-1"></a>  cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>ldsc, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb37-18"><a href="related-individuals.html#cb37-18" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>ldsc, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb37-19"><a href="related-individuals.html#cb37-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-20"><a href="related-individuals.html#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb37-21"><a href="related-individuals.html#cb37-21" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">rel_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>rel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean),</span>
<span id="cb37-22"><a href="related-individuals.html#cb37-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">unrel_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>unrel,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb37-23"><a href="related-individuals.html#cb37-23" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>ldsc,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb37-24"><a href="related-individuals.html#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="related-individuals.html#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb37-26"><a href="related-individuals.html#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>rel_ave,</span>
<span id="cb37-27"><a href="related-individuals.html#cb37-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ldsc bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb37-28"><a href="related-individuals.html#cb37-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(out<span class="sc">$</span>bin_val), <span class="fu">max</span>(out<span class="sc">$</span>bin_val)),</span>
<span id="cb37-29"><a href="related-individuals.html#cb37-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(out<span class="sc">$</span>rel_ave,out<span class="sc">$</span>unrel_ave)),</span>
<span id="cb37-30"><a href="related-individuals.html#cb37-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;sim &quot;</span>,i), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb37-31"><a href="related-individuals.html#cb37-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb37-32"><a href="related-individuals.html#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>unrel_ave, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>, </span>
<span id="cb37-33"><a href="related-individuals.html#cb37-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">bg=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb37-34"><a href="related-individuals.html#cb37-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-35"><a href="related-individuals.html#cb37-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-36"><a href="related-individuals.html#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gwas-white-british-irish.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="compute-sum_ijm_1-m_2r2_ij.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05.1-related-individuals.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
