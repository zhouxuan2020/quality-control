<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Bad GWAS | GWAS Quality Control</title>
  <meta name="description" content="7 Bad GWAS | GWAS Quality Control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Bad GWAS | GWAS Quality Control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Bad GWAS | GWAS Quality Control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="good.html"/>
<link rel="next" href="ukbb.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>2</b> Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>2.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>2.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>2.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>2.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>2.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>2.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>2.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>2.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>2.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>2.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>2.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>2.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>3</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>3.1</b> test statistics ~ LD score</a></li>
<li class="chapter" data-level="3.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#new-models"><i class="fa fa-check"></i><b>3.2</b> New models?</a></li>
<li class="chapter" data-level="3.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ld-scores-based-on-individual-level-data"><i class="fa fa-check"></i><b>3.3</b> LD scores based on individual level data</a></li>
<li class="chapter" data-level="3.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-the-new-model"><i class="fa fa-check"></i><b>3.4</b> Test the new model</a></li>
<li class="chapter" data-level="3.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predictors-of-inflation"><i class="fa fa-check"></i><b>3.5</b> predictors of inflation?</a></li>
<li class="chapter" data-level="3.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#regress-chisq-mean-r2_j"><i class="fa fa-check"></i><b>3.6</b> regress chisq ~ mean r^2_j</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plots"><i class="fa fa-check"></i><b>3.6.1</b> plots</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predict-inflation-aver2_j"><i class="fa fa-check"></i><b>3.7</b> predict inflation | aver2_j ?</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good_chisq-vs.-adj_chisq"><i class="fa fa-check"></i><b>3.7.1</b> good_chisq vs. adj_chisq</a></li>
<li class="chapter" data-level="3.7.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>3.7.2</b> bad gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="3.7.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>3.7.3</b> bad gwas: inf. vs. inf._hat: ave</a></li>
<li class="chapter" data-level="3.7.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-from-full-model"><i class="fa fa-check"></i><b>3.7.4</b> bad gwas: inf. from full model</a></li>
<li class="chapter" data-level="3.7.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>3.7.5</b> good gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="3.7.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>3.7.6</b> good gwas: inf. vs. inf._hat: ave</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ukbb_337k_inflation"><i class="fa fa-check"></i><b>3.8</b> UKBB N = 337k</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#organize-data"><i class="fa fa-check"></i><b>3.8.1</b> organize data</a></li>
<li class="chapter" data-level="3.8.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plot"><i class="fa fa-check"></i><b>3.8.2</b> plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mathematical-details.html"><a href="mathematical-details.html"><i class="fa fa-check"></i><b>4</b> Mathematical Details</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mathematical-details.html"><a href="mathematical-details.html#trk_rightk_left"><i class="fa fa-check"></i><b>4.1</b> <span class="math inline">\(tr(K_{right}K_{left})\)</span></a></li>
<li class="chapter" data-level="4.2" data-path="mathematical-details.html"><a href="mathematical-details.html#verification"><i class="fa fa-check"></i><b>4.2</b> verification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html"><i class="fa fa-check"></i><b>5</b> chi square ~ <span class="math inline">\(\overline{r^2_j}\)</span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#overliner2_j-choice-of-snps"><i class="fa fa-check"></i><b>5.1</b> <span class="math inline">\(\overline{r^2_j}\)</span> &amp; choice of SNPs</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#number-of-snps"><i class="fa fa-check"></i><b>5.1.1</b> number of SNPs</a></li>
<li class="chapter" data-level="5.1.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#maf"><i class="fa fa-check"></i><b>5.1.2</b> maf</a></li>
<li class="chapter" data-level="5.1.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#summary"><i class="fa fa-check"></i><b>5.1.3</b> summary</a></li>
<li class="chapter" data-level="5.1.4" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#final-plots"><i class="fa fa-check"></i><b>5.1.4</b> Final plots</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#varying-levels-of-confouding"><i class="fa fa-check"></i><b>5.2</b> varying levels of confouding</a></li>
<li class="chapter" data-level="5.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#results-summary"><i class="fa fa-check"></i><b>5.3</b> results summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>6</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>6.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="6.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>6.2</b> extract covariates</a></li>
<li class="chapter" data-level="6.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>6.3</b> GWAS</a></li>
<li class="chapter" data-level="6.4" data-path="good.html"><a href="good.html#chisq-aver2_j"><i class="fa fa-check"></i><b>6.4</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="6.5" data-path="good.html"><a href="good.html#ldsc-interce"><i class="fa fa-check"></i><b>6.5</b> ldsc interce</a></li>
<li class="chapter" data-level="6.6" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>6.6</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>6.6.1</b> under gcta</a></li>
<li class="chapter" data-level="6.6.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>6.6.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="6.6.3" data-path="good.html"><a href="good.html#summary-1"><i class="fa fa-check"></i><b>6.6.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>6.7</b> REML</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>6.7.1</b> making grms</a></li>
<li class="chapter" data-level="6.7.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>6.7.2</b> fast-reml</a></li>
<li class="chapter" data-level="6.7.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>6.7.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>6.8</b> HE</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>6.8.1</b> estimation</a></li>
<li class="chapter" data-level="6.8.2" data-path="good.html"><a href="good.html#summary-2"><i class="fa fa-check"></i><b>6.8.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>7</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>7.1</b> ID list</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>7.1.1</b> initial selection</a></li>
<li class="chapter" data-level="7.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>7.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="7.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>7.1.3</b> final list</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="bad.html"><a href="bad.html#gwas-lm"><i class="fa fa-check"></i><b>7.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="bad.html"><a href="bad.html#basic-cov"><i class="fa fa-check"></i><b>7.2.1</b> basic cov</a></li>
<li class="chapter" data-level="7.2.2" data-path="bad.html"><a href="bad.html#basic-cov-pc"><i class="fa fa-check"></i><b>7.2.2</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="bad.html"><a href="bad.html#gwas-bolt-lmm"><i class="fa fa-check"></i><b>7.3</b> GWAS-bolt-lmm</a></li>
<li class="chapter" data-level="7.4" data-path="bad.html"><a href="bad.html#chisq-aver2_j-1"><i class="fa fa-check"></i><b>7.4</b> chisq ~ aver2_j</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="bad.html"><a href="bad.html#calc-aver2_j"><i class="fa fa-check"></i><b>7.4.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="7.4.2" data-path="bad.html"><a href="bad.html#bolt-lmm"><i class="fa fa-check"></i><b>7.4.2</b> bolt-lmm</a></li>
<li class="chapter" data-level="7.4.3" data-path="bad.html"><a href="bad.html#basic-cov-pc-1"><i class="fa fa-check"></i><b>7.4.3</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>7.5</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>7.5.1</b> under gcta</a></li>
<li class="chapter" data-level="7.5.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>7.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="7.5.3" data-path="bad.html"><a href="bad.html#summary-3"><i class="fa fa-check"></i><b>7.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>7.6</b> REML</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>7.6.1</b> making grms</a></li>
<li class="chapter" data-level="7.6.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>7.6.2</b> fast-reml</a></li>
<li class="chapter" data-level="7.6.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>7.6.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>7.7</b> HE</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>7.7.1</b> estimation</a></li>
<li class="chapter" data-level="7.7.2" data-path="bad.html"><a href="bad.html#summary-4"><i class="fa fa-check"></i><b>7.7.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>8</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>8.1</b> total N = 337k</a></li>
<li class="chapter" data-level="8.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>8.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="8.3" data-path="ukbb.html"><a href="ukbb.html#gwas-100k"><i class="fa fa-check"></i><b>8.3</b> GWAS-100k</a></li>
<li class="chapter" data-level="8.4" data-path="ukbb.html"><a href="ukbb.html#gwas-337k"><i class="fa fa-check"></i><b>8.4</b> GWAS-337k</a></li>
<li class="chapter" data-level="8.5" data-path="ukbb.html"><a href="ukbb.html#ldsc-100k"><i class="fa fa-check"></i><b>8.5</b> ldsc-100k</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>8.5.1</b> under gcta</a></li>
<li class="chapter" data-level="8.5.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>8.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="8.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-5"><i class="fa fa-check"></i><b>8.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="ukbb.html"><a href="ukbb.html#ldsc-337k"><i class="fa fa-check"></i><b>8.6</b> ldsc-337k</a></li>
<li class="chapter" data-level="8.7" data-path="ukbb.html"><a href="ukbb.html#aver2_j-337k"><i class="fa fa-check"></i><b>8.7</b> aver2_j-337k</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="ukbb.html"><a href="ukbb.html#calc"><i class="fa fa-check"></i><b>8.7.1</b> calc</a></li>
<li class="chapter" data-level="8.7.2" data-path="ukbb.html"><a href="ukbb.html#organize-data-1"><i class="fa fa-check"></i><b>8.7.2</b> organize data</a></li>
<li class="chapter" data-level="8.7.3" data-path="ukbb.html"><a href="ukbb.html#chisq-aver2_j-2"><i class="fa fa-check"></i><b>8.7.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>8.8</b> HE</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>8.8.1</b> making grms</a></li>
<li class="chapter" data-level="8.8.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>8.8.2</b> estimation</a></li>
<li class="chapter" data-level="8.8.3" data-path="ukbb.html"><a href="ukbb.html#summary-6"><i class="fa fa-check"></i><b>8.8.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>9</b> control GWAS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>9.1</b> ID list</a></li>
<li class="chapter" data-level="9.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>9.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="9.3" data-path="control.html"><a href="control.html#gwas-1"><i class="fa fa-check"></i><b>9.3</b> GWAS</a></li>
<li class="chapter" data-level="9.4" data-path="control.html"><a href="control.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>9.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>9.4.1</b> under gcta</a></li>
<li class="chapter" data-level="9.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>9.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="9.4.3" data-path="control.html"><a href="control.html#summary-7"><i class="fa fa-check"></i><b>9.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>9.5</b> HE</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>9.5.1</b> making grms</a></li>
<li class="chapter" data-level="9.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>9.5.2</b> estimation</a></li>
<li class="chapter" data-level="9.5.3" data-path="control.html"><a href="control.html#summary-8"><i class="fa fa-check"></i><b>9.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html"><i class="fa fa-check"></i><b>10</b> inclusive GWAS</a>
<ul>
<li class="chapter" data-level="10.1" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#qc"><i class="fa fa-check"></i><b>10.1</b> QC</a></li>
<li class="chapter" data-level="10.2" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#gwas-telomere-length"><i class="fa fa-check"></i><b>10.2</b> gwas-telomere length</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#aver2_j"><i class="fa fa-check"></i><b>10.2.1</b> aver2_j</a></li>
<li class="chapter" data-level="10.2.2" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#organize-data-2"><i class="fa fa-check"></i><b>10.2.2</b> organize data</a></li>
<li class="chapter" data-level="10.2.3" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#chisq-aver2_j-3"><i class="fa fa-check"></i><b>10.2.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#notesconcerns"><i class="fa fa-check"></i><b>10.3</b> notes/concerns</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html"><i class="fa fa-check"></i><b>11</b> GWAS: White British + Irish</a>
<ul>
<li class="chapter" data-level="11.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#id-list-1"><i class="fa fa-check"></i><b>11.1</b> ID list</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ids-who-have-no-missing-data"><i class="fa fa-check"></i><b>11.1.1</b> Ids who have no missing data</a></li>
<li class="chapter" data-level="11.1.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#relatedness-filtering-1"><i class="fa fa-check"></i><b>11.1.2</b> relatedness filtering</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ideas-to-explore"><i class="fa fa-check"></i><b>11.2</b> Ideas to explore:</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="related-individuals.html"><a href="related-individuals.html"><i class="fa fa-check"></i><b>12</b> related individuals</a>
<ul>
<li class="chapter" data-level="12.1" data-path="related-individuals.html"><a href="related-individuals.html#genotyped-snps"><i class="fa fa-check"></i><b>12.1</b> genotyped SNPs</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-1"><i class="fa fa-check"></i><b>12.1.1</b> aver2_j</a></li>
<li class="chapter" data-level="12.1.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-2"><i class="fa fa-check"></i><b>12.1.2</b> gwas</a></li>
<li class="chapter" data-level="12.1.3" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-3"><i class="fa fa-check"></i><b>12.1.3</b> organize data</a></li>
<li class="chapter" data-level="12.1.4" data-path="related-individuals.html"><a href="related-individuals.html#summary-9"><i class="fa fa-check"></i><b>12.1.4</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="related-individuals.html"><a href="related-individuals.html#hapmap3-snps"><i class="fa fa-check"></i><b>12.2</b> hapmap3 SNPs</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype-data"><i class="fa fa-check"></i><b>12.2.1</b> genotype data</a></li>
<li class="chapter" data-level="12.2.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-3"><i class="fa fa-check"></i><b>12.2.2</b> gwas</a></li>
<li class="chapter" data-level="12.2.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-2"><i class="fa fa-check"></i><b>12.2.3</b> aver2_j</a></li>
<li class="chapter" data-level="12.2.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-4"><i class="fa fa-check"></i><b>12.2.4</b> organize data</a></li>
<li class="chapter" data-level="12.2.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-4"><i class="fa fa-check"></i><b>12.2.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="12.2.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j"><i class="fa fa-check"></i><b>12.2.6</b> inflation ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="related-individuals.html"><a href="related-individuals.html#mix-unrel-rel"><i class="fa fa-check"></i><b>12.3</b> mix unrel &amp; rel</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype"><i class="fa fa-check"></i><b>12.3.1</b> genotype</a></li>
<li class="chapter" data-level="12.3.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-4"><i class="fa fa-check"></i><b>12.3.2</b> gwas</a></li>
<li class="chapter" data-level="12.3.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-3"><i class="fa fa-check"></i><b>12.3.3</b> aver2_j</a></li>
<li class="chapter" data-level="12.3.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-5"><i class="fa fa-check"></i><b>12.3.4</b> organize data</a></li>
<li class="chapter" data-level="12.3.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-5"><i class="fa fa-check"></i><b>12.3.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="12.3.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j-1"><i class="fa fa-check"></i><b>12.3.6</b> inflation ~ aver2_j</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html"><i class="fa fa-check"></i><b>13</b> compute <span class="math inline">\(\sum_{i,j}^{m_1, m_2}r^2_{i,j}\)</span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwas-all-qced-snps"><i class="fa fa-check"></i><b>13.1</b> good GWAS-all qced snps</a></li>
<li class="chapter" data-level="13.2" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwass--ldak-thin-snps"><i class="fa fa-check"></i><b>13.2</b> good GWASs- ldak-thin snps</a></li>
<li class="chapter" data-level="13.3" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#bad-gwass-all-qced-snps"><i class="fa fa-check"></i><b>13.3</b> bad GWASs-all qced snps</a></li>
<li class="chapter" data-level="13.4" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#summary-10"><i class="fa fa-check"></i><b>13.4</b> summary</a></li>
<li class="chapter" data-level="13.5" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#aver2j"><i class="fa fa-check"></i><b>13.5</b> compute aver2_j</a></li>
<li class="chapter" data-level="13.6" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#mixed-pop-gwas-with-pc-as-covariates"><i class="fa fa-check"></i><b>13.6</b> mixed pop GWAS with PC as covariates</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="assortative-mating.html"><a href="assortative-mating.html"><i class="fa fa-check"></i><b>14</b> Assortative mating</a>
<ul>
<li class="chapter" data-level="14.1" data-path="assortative-mating.html"><a href="assortative-mating.html#test-the-idea"><i class="fa fa-check"></i><b>14.1</b> Test the idea</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="assortative-mating.html"><a href="assortative-mating.html#st-try"><i class="fa fa-check"></i><b>14.1.1</b> 1st try</a></li>
<li class="chapter" data-level="14.1.2" data-path="assortative-mating.html"><a href="assortative-mating.html#nd-try"><i class="fa fa-check"></i><b>14.1.2</b> 2nd try</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html"><i class="fa fa-check"></i><b>15</b> Reference Panel: 1k Genome</a>
<ul>
<li class="chapter" data-level="15.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#common-snplist"><i class="fa fa-check"></i><b>15.1</b> common snplist</a></li>
<li class="chapter" data-level="15.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#compute-aver2"><i class="fa fa-check"></i><b>15.2</b> compute aver2</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-1"><i class="fa fa-check"></i><b>15.2.1</b> bad gwas</a></li>
<li class="chapter" data-level="15.2.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding"><i class="fa fa-check"></i><b>15.2.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="15.2.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-1"><i class="fa fa-check"></i><b>15.2.3</b> good gwas</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#results"><i class="fa fa-check"></i><b>15.3</b> results</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-2"><i class="fa fa-check"></i><b>15.3.1</b> bad gwas</a></li>
<li class="chapter" data-level="15.3.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding-1"><i class="fa fa-check"></i><b>15.3.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="15.3.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-2"><i class="fa fa-check"></i><b>15.3.3</b> good gwas</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GWAS Quality Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bad" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Bad GWAS</h1>
<div id="badid" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> ID list</h2>
<div id="initial-selection" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> initial selection</h3>
<p>Randomly select participants with complete data and use the SNP list as for unrelated.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="bad.html#cb44-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2"><a href="bad.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract white, asian &amp; black from ukbb----------------------------------------</span></span>
<span id="cb44-3"><a href="bad.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb44-4"><a href="bad.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;phen/covariates.phen&quot;</span><span class="ex">,</span> header=T, stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb44-5"><a href="bad.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># White: British(1001)  </span></span>
<span id="cb44-6"><a href="bad.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Asian or Asian British: Indian(3001)+Pakistani(3002)+Bangladeshi(3003)+other Asian backgroud(3004)</span></span>
<span id="cb44-7"><a href="bad.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Black: Caribbean(4001)+African(4002)+other Black Background(4003)</span></span>
<span id="cb44-8"><a href="bad.html#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[complete.cases<span class="kw">(</span><span class="ex">dat</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb44-9"><a href="bad.html#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="va">white</span><span class="op">=</span>1001</span>
<span id="cb44-10"><a href="bad.html#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="va">asian</span><span class="op">=</span>3001:3004</span>
<span id="cb44-11"><a href="bad.html#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="va">black</span><span class="op">=</span>4001:4003</span>
<span id="cb44-12"><a href="bad.html#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="va">out1</span><span class="op">=</span>dat[dat<span class="va">$ethnicity</span>%in%white,]</span>
<span id="cb44-13"><a href="bad.html#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="va">out2</span><span class="op">=</span>dat[dat<span class="va">$ethnicity</span>%in%asian,]</span>
<span id="cb44-14"><a href="bad.html#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="va">out3</span><span class="op">=</span>dat[dat<span class="va">$ethnicity</span>%in%black,]</span>
<span id="cb44-15"><a href="bad.html#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="va">out1</span><span class="op">[</span>,<span class="st">&quot;eid&quot;</span><span class="op">]</span><span class="ex">,</span> <span class="st">&quot;white-complete-cov.id&quot;</span>, col.names=F, row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb44-16"><a href="bad.html#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="va">out2</span><span class="op">[</span>,<span class="st">&quot;eid&quot;</span><span class="op">]</span><span class="ex">,</span> <span class="st">&quot;asian-complete-cov.id&quot;</span>, col.names=F, row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb44-17"><a href="bad.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="va">out3</span><span class="op">[</span>,<span class="st">&quot;eid&quot;</span><span class="op">]</span><span class="ex">,</span> <span class="st">&quot;black-complete-cov.id&quot;</span>, col.names=F, row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb44-18"><a href="bad.html#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co"># overlapping UNRELATED WHITE across 14 traits----------------------------------</span></span>
<span id="cb44-19"><a href="bad.html#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># overlapping = no missing data for the 14 traits</span></span>
<span id="cb44-20"><a href="bad.html#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="bad.html#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> icd10/unrelated.inds overlap.ind <span class="co"># unrelated white British</span></span>
<span id="cb44-22"><a href="bad.html#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="bad.html#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>phen/continuous-traits/</span>
<span id="cb44-24"><a href="bad.html#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb44-25"><a href="bad.html#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> overlap.ind temp</span>
<span id="cb44-26"><a href="bad.html#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $1, $2}&#39;</span> temp <span class="va">$dir</span>/<span class="va">$tt</span>.raw.pheno <span class="op">&gt;</span> overlap.ind</span>
<span id="cb44-27"><a href="bad.html#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> overlap.ind</span>
<span id="cb44-28"><a href="bad.html#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$tt</span></span>
<span id="cb44-29"><a href="bad.html#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb44-30"><a href="bad.html#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> temp</span>
<span id="cb44-31"><a href="bad.html#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="bad.html#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co"># overlapping + complete data for covariates + unrelated</span></span>
<span id="cb44-33"><a href="bad.html#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR{a[$1]; next} ($1 in a) {print $1, $1}&#39;</span> unrelated/overlap.ind white-complete-cov.id <span class="op">&gt;</span> overlap-white-complete-cov.id <span class="co"># N = 147,008</span></span>
<span id="cb44-34"><a href="bad.html#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="bad.html#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="co"># overlapping UNRELATED ASIAN across 14 traits----------------------------------</span></span>
<span id="cb44-36"><a href="bad.html#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> asian-complete-cov.id overlap-asian-complete-cov.id</span>
<span id="cb44-37"><a href="bad.html#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>phen/continuous-traits/</span>
<span id="cb44-38"><a href="bad.html#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb44-39"><a href="bad.html#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> overlap-asian-complete-cov.id temp</span>
<span id="cb44-40"><a href="bad.html#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $1, $2}&#39;</span> temp <span class="va">$dir</span>/<span class="va">$tt</span>.raw.pheno <span class="op">&gt;</span> overlap-asian-complete-cov.id</span>
<span id="cb44-41"><a href="bad.html#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> overlap-asian-complete-cov.id <span class="co"># N = 4,052</span></span>
<span id="cb44-42"><a href="bad.html#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$tt</span></span>
<span id="cb44-43"><a href="bad.html#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb44-44"><a href="bad.html#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> temp</span>
<span id="cb44-45"><a href="bad.html#cb44-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-46"><a href="bad.html#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="co"># relatedness filtering</span></span>
<span id="cb44-47"><a href="bad.html#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="co"># see below</span></span>
<span id="cb44-48"><a href="bad.html#cb44-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-49"><a href="bad.html#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="co"># overlapping UNRELATED BLACK across 14 traits----------------------------------</span></span>
<span id="cb44-50"><a href="bad.html#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> black-complete-cov.id overlap-black-complete-cov.id</span>
<span id="cb44-51"><a href="bad.html#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>phen/continuous-traits/</span>
<span id="cb44-52"><a href="bad.html#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb44-53"><a href="bad.html#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> overlap-black-complete-cov.id temp</span>
<span id="cb44-54"><a href="bad.html#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $1, $2}&#39;</span> temp <span class="va">$dir</span>/<span class="va">$tt</span>.raw.pheno <span class="op">&gt;</span> overlap-black-complete-cov.id</span>
<span id="cb44-55"><a href="bad.html#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> overlap-black-complete-cov.id <span class="co"># N = 3,583</span></span>
<span id="cb44-56"><a href="bad.html#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$tt</span></span>
<span id="cb44-57"><a href="bad.html#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb44-58"><a href="bad.html#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> temp</span>
<span id="cb44-59"><a href="bad.html#cb44-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-60"><a href="bad.html#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="co"># relatedness filtering</span></span>
<span id="cb44-61"><a href="bad.html#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="co"># see below</span></span></code></pre></div>
</div>
<div id="relatedness-filtering" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> relatedness filtering</h3>
<p>For black and Asian people only.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="bad.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------</span></span>
<span id="cb45-2"><a href="bad.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0. make bfiles</span></span>
<span id="cb45-3"><a href="bad.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------</span></span>
<span id="cb45-4"><a href="bad.html#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="bad.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># id lists</span></span>
<span id="cb45-6"><a href="bad.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="ex">overlap-white-complete-cov.id</span> <span class="co"># N=147,008</span></span>
<span id="cb45-7"><a href="bad.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="ex">overlap-black-complete-cov.id</span> <span class="co"># N=3,583</span></span>
<span id="cb45-8"><a href="bad.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="ex">overlap-asian-complete-cov.id</span> <span class="co"># N=4,052</span></span>
<span id="cb45-9"><a href="bad.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> overlap-white-complete-cov.id overlap-black-complete-cov.id overlap-asian-complete-cov.id <span class="op">&gt;</span> overlap-mixed-complete-cov.id <span class="co"># 154,643    </span></span>
<span id="cb45-10"><a href="bad.html#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="bad.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># bfiles by chr</span></span>
<span id="cb45-12"><a href="bad.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-13"><a href="bad.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-14"><a href="bad.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-15"><a href="bad.html#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-16"><a href="bad.html#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb45-17"><a href="bad.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb45-18"><a href="bad.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb45-19"><a href="bad.html#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="bad.html#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-21"><a href="bad.html#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../overlap-mixed-complete-cov.id </span><span class="dt">\</span></span>
<span id="cb45-22"><a href="bad.html#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../gen/snps-unrel-inds.use </span><span class="dt">\</span></span>
<span id="cb45-23"><a href="bad.html#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb45-24"><a href="bad.html#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb45-25"><a href="bad.html#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-mix </span><span class="dt">\</span></span>
<span id="cb45-26"><a href="bad.html#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb45-27"><a href="bad.html#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>-mix.sh</span>
<span id="cb45-28"><a href="bad.html#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-29"><a href="bad.html#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="bad.html#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb45-31"><a href="bad.html#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-32"><a href="bad.html#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$i</span>-mix.sh</span>
<span id="cb45-33"><a href="bad.html#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/mkbfile-mix-pop</span>
<span id="cb45-34"><a href="bad.html#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="bad.html#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="co"># merge bfiles</span></span>
<span id="cb45-36"><a href="bad.html#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile-mix.list</span>
<span id="cb45-37"><a href="bad.html#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-38"><a href="bad.html#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-mix&quot;</span> <span class="op">&gt;&gt;</span>bfile-mix.list</span>
<span id="cb45-39"><a href="bad.html#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-40"><a href="bad.html#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="bad.html#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-42"><a href="bad.html#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-43"><a href="bad.html#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-44"><a href="bad.html#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb45-45"><a href="bad.html#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb45-46"><a href="bad.html#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb45-47"><a href="bad.html#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb45-48"><a href="bad.html#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile-mix.list </span><span class="dt">\</span></span>
<span id="cb45-49"><a href="bad.html#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb45-50"><a href="bad.html#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb45-51"><a href="bad.html#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/merge-mbfiles-mix-pop.sh</span>
<span id="cb45-52"><a href="bad.html#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="bad.html#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb45-54"><a href="bad.html#cb45-54" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/merge-mbfiles-mix-pop.sh <span class="op">&gt;</span>../job-records/merge-mbfiles-mix</span>
<span id="cb45-55"><a href="bad.html#cb45-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-56"><a href="bad.html#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="co">#-------</span></span>
<span id="cb45-57"><a href="bad.html#cb45-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. prune SNPs</span></span>
<span id="cb45-58"><a href="bad.html#cb45-58" aria-hidden="true" tabindex="-1"></a><span class="co">#-------</span></span>
<span id="cb45-59"><a href="bad.html#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-60"><a href="bad.html#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-61"><a href="bad.html#cb45-61" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-62"><a href="bad.html#cb45-62" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb45-63"><a href="bad.html#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 4</span></span>
<span id="cb45-64"><a href="bad.html#cb45-64" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb45-65"><a href="bad.html#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-66"><a href="bad.html#cb45-66" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 4 </span><span class="dt">\</span></span>
<span id="cb45-67"><a href="bad.html#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-prune 0.05 </span><span class="dt">\</span></span>
<span id="cb45-68"><a href="bad.html#cb45-68" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-kb 1000 </span><span class="dt">\</span></span>
<span id="cb45-69"><a href="bad.html#cb45-69" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb45-70"><a href="bad.html#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-71"><a href="bad.html#cb45-71" aria-hidden="true" tabindex="-1"></a><span class="st">          --thin ../thin/thin-chr</span><span class="va">$j</span></span>
<span id="cb45-72"><a href="bad.html#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>  <span class="op">&gt;</span> sh_script/thin<span class="va">$j</span></span>
<span id="cb45-73"><a href="bad.html#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-74"><a href="bad.html#cb45-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-75"><a href="bad.html#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-76"><a href="bad.html#cb45-76" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/thin<span class="va">$j</span></span>
<span id="cb45-77"><a href="bad.html#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/thin-snps</span>
<span id="cb45-78"><a href="bad.html#cb45-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-79"><a href="bad.html#cb45-79" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------</span></span>
<span id="cb45-80"><a href="bad.html#cb45-80" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. kinship matrix under GCTA</span></span>
<span id="cb45-81"><a href="bad.html#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------</span></span>
<span id="cb45-82"><a href="bad.html#cb45-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-83"><a href="bad.html#cb45-83" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="dt">{black</span><span class="op">,</span><span class="dt">asian}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-84"><a href="bad.html#cb45-84" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-85"><a href="bad.html#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-86"><a href="bad.html#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-87"><a href="bad.html#cb45-87" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb45-88"><a href="bad.html#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb45-89"><a href="bad.html#cb45-89" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb45-90"><a href="bad.html#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-91"><a href="bad.html#cb45-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-92"><a href="bad.html#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb45-93"><a href="bad.html#cb45-93" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/</span><span class="va">$pop</span><span class="st">-gcta-thin</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-94"><a href="bad.html#cb45-94" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb45-95"><a href="bad.html#cb45-95" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../overlap-</span><span class="va">$pop</span><span class="st">-complete-cov.id</span><span class="dt">\</span></span>
<span id="cb45-96"><a href="bad.html#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../thin/thin-chr</span><span class="va">$j</span><span class="st">.in </span><span class="dt">\</span></span>
<span id="cb45-97"><a href="bad.html#cb45-97" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-98"><a href="bad.html#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb45-99"><a href="bad.html#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb45-100"><a href="bad.html#cb45-100" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb45-101"><a href="bad.html#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/<span class="va">$pop</span>-grm<span class="va">$j</span></span>
<span id="cb45-102"><a href="bad.html#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-103"><a href="bad.html#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-104"><a href="bad.html#cb45-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-105"><a href="bad.html#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files</span></span>
<span id="cb45-106"><a href="bad.html#cb45-106" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="dt">{black</span><span class="op">,</span><span class="dt">asian}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb45-107"><a href="bad.html#cb45-107" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-108"><a href="bad.html#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$pop</span>-grm<span class="va">$j</span></span>
<span id="cb45-109"><a href="bad.html#cb45-109" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-110"><a href="bad.html#cb45-110" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-pops</span>
<span id="cb45-111"><a href="bad.html#cb45-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-112"><a href="bad.html#cb45-112" aria-hidden="true" tabindex="-1"></a><span class="co"># merge grms</span></span>
<span id="cb45-113"><a href="bad.html#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="dt">{black</span><span class="op">,</span><span class="dt">asian}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-114"><a href="bad.html#cb45-114" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$pop</span>-grm.list</span>
<span id="cb45-115"><a href="bad.html#cb45-115" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span> </span>
<span id="cb45-116"><a href="bad.html#cb45-116" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> </span>
<span id="cb45-117"><a href="bad.html#cb45-117" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;../kinship/</span><span class="va">$pop</span><span class="st">-gcta-thin</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$pop</span>-grm.list</span>
<span id="cb45-118"><a href="bad.html#cb45-118" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-119"><a href="bad.html#cb45-119" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-120"><a href="bad.html#cb45-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-121"><a href="bad.html#cb45-121" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="dt">{black</span><span class="op">,</span><span class="dt">asian}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-122"><a href="bad.html#cb45-122" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-123"><a href="bad.html#cb45-123" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-124"><a href="bad.html#cb45-124" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-125"><a href="bad.html#cb45-125" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 80G</span></span>
<span id="cb45-126"><a href="bad.html#cb45-126" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb45-127"><a href="bad.html#cb45-127" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 12:0:0</span></span>
<span id="cb45-128"><a href="bad.html#cb45-128" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --add-grm ../kinship/</span><span class="va">$pop</span><span class="st">-gcta-thin --mgrm ../</span><span class="va">$pop</span><span class="st">-grm.list</span></span>
<span id="cb45-129"><a href="bad.html#cb45-129" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$pop</span>-grm.sh</span>
<span id="cb45-130"><a href="bad.html#cb45-130" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-131"><a href="bad.html#cb45-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-132"><a href="bad.html#cb45-132" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="dt">{black</span><span class="op">,</span><span class="dt">asian}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-133"><a href="bad.html#cb45-133" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$pop</span>-grm.sh </span>
<span id="cb45-134"><a href="bad.html#cb45-134" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-merge</span>
<span id="cb45-135"><a href="bad.html#cb45-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-136"><a href="bad.html#cb45-136" aria-hidden="true" tabindex="-1"></a><span class="co">#can now delete per-chr files</span></span>
<span id="cb45-137"><a href="bad.html#cb45-137" aria-hidden="true" tabindex="-1"></a><span class="co">#rm *gcta-thin{1..22}.*</span></span>
<span id="cb45-138"><a href="bad.html#cb45-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-139"><a href="bad.html#cb45-139" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------</span></span>
<span id="cb45-140"><a href="bad.html#cb45-140" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Relatedness filtering </span></span>
<span id="cb45-141"><a href="bad.html#cb45-141" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------</span></span>
<span id="cb45-142"><a href="bad.html#cb45-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-143"><a href="bad.html#cb45-143" aria-hidden="true" tabindex="-1"></a><span class="co"># relatedness filtering</span></span>
<span id="cb45-144"><a href="bad.html#cb45-144" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="dt">{asian</span><span class="op">,</span><span class="dt">black}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb45-145"><a href="bad.html#cb45-145" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-146"><a href="bad.html#cb45-146" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-147"><a href="bad.html#cb45-147" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-148"><a href="bad.html#cb45-148" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb45-149"><a href="bad.html#cb45-149" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb45-150"><a href="bad.html#cb45-150" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 2:0:0</span></span>
<span id="cb45-151"><a href="bad.html#cb45-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-152"><a href="bad.html#cb45-152" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --filter ../relatedness/</span><span class="va">$pop</span><span class="st">-cut.05 </span><span class="dt">\</span></span>
<span id="cb45-153"><a href="bad.html#cb45-153" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/</span><span class="va">$pop</span><span class="st">-gcta-thin </span><span class="dt">\</span></span>
<span id="cb45-154"><a href="bad.html#cb45-154" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-rel 0.05 </span><span class="dt">\</span></span>
<span id="cb45-155"><a href="bad.html#cb45-155" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3</span></span>
<span id="cb45-156"><a href="bad.html#cb45-156" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$pop</span>-rel-cut.05.sh</span>
<span id="cb45-157"><a href="bad.html#cb45-157" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-158"><a href="bad.html#cb45-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-159"><a href="bad.html#cb45-159" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb45-160"><a href="bad.html#cb45-160" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="dt">{asian</span><span class="op">,</span><span class="dt">black}</span><span class="kw">;</span><span class="cf">do</span></span>
<span id="cb45-161"><a href="bad.html#cb45-161" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$pop</span>-rel-cut.05.sh</span>
<span id="cb45-162"><a href="bad.html#cb45-162" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/relatedness-filtering</span>
<span id="cb45-163"><a href="bad.html#cb45-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-164"><a href="bad.html#cb45-164" aria-hidden="true" tabindex="-1"></a><span class="co"># remaining individuals</span></span>
<span id="cb45-165"><a href="bad.html#cb45-165" aria-hidden="true" tabindex="-1"></a><span class="co"># asian-cut.05.keep N = 3,448</span></span>
<span id="cb45-166"><a href="bad.html#cb45-166" aria-hidden="true" tabindex="-1"></a><span class="co"># black-cut.05.keep N = 3,024</span></span>
<span id="cb45-167"><a href="bad.html#cb45-167" aria-hidden="true" tabindex="-1"></a><span class="co"># sum = 6,472</span></span></code></pre></div>
</div>
<div id="final-list" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> final list</h3>
<p>To match the good GWAS, we will have N = 100k in total and replace 6,472 whites with Asians and Blacks.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="bad.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select  </span></span>
<span id="cb46-2"><a href="bad.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="ex">shuf</span> rand.100000 <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 93528 <span class="op">&gt;</span> white.rand.93528</span>
<span id="cb46-3"><a href="bad.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> white.rand.93528 relatedness/asian-cut.05.keep relatedness/black-cut.05.keep <span class="op">&gt;</span> mix-pop-gwas.id </span></code></pre></div>
</div>
</div>
<div id="gwas-lm" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> GWAS-lm</h2>
<div id="basic-cov" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> basic cov</h3>
<p>We use basic covariates only: age, sex and townsend.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="bad.html#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="bad.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># covariates--------------------------------------------------------------------</span></span>
<span id="cb47-3"><a href="bad.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $3, $4, $5}&#39;</span> covariates.use <span class="op">&gt;</span> basic-covariates.use</span>
<span id="cb47-4"><a href="bad.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&lt;=5{print $0}&#39;</span> covariates.use-names <span class="op">&gt;</span> basic-covariates.use</span>
<span id="cb47-5"><a href="bad.html#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="bad.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># gwas</span></span>
<span id="cb47-7"><a href="bad.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb47-8"><a href="bad.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb47-9"><a href="bad.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb47-10"><a href="bad.html#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb47-11"><a href="bad.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb47-12"><a href="bad.html#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb47-13"><a href="bad.html#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb47-14"><a href="bad.html#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb47-15"><a href="bad.html#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="bad.html#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear ../gwas-mix/</span><span class="va">$i</span><span class="st">-linear-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb47-17"><a href="bad.html#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb47-18"><a href="bad.html#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb47-19"><a href="bad.html#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb47-20"><a href="bad.html#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../mix-pop-gwas.id </span><span class="dt">\</span></span>
<span id="cb47-21"><a href="bad.html#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-unrel-inds.use </span><span class="dt">\</span></span>
<span id="cb47-22"><a href="bad.html#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb47-23"><a href="bad.html#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb47-24"><a href="bad.html#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear-chr-<span class="va">$j</span>.sh</span>
<span id="cb47-25"><a href="bad.html#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb47-26"><a href="bad.html#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb47-27"><a href="bad.html#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="bad.html#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co"># --covar ../phen/covariates.use</span></span>
<span id="cb47-29"><a href="bad.html#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="bad.html#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb47-31"><a href="bad.html#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb47-32"><a href="bad.html#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb47-33"><a href="bad.html#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear-chr-<span class="va">$j</span>.sh</span>
<span id="cb47-34"><a href="bad.html#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb47-35"><a href="bad.html#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-mix-pop</span>
<span id="cb47-36"><a href="bad.html#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="bad.html#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb47-38"><a href="bad.html#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-mix-pop</span>
<span id="cb47-39"><a href="bad.html#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb47-40"><a href="bad.html#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb47-41"><a href="bad.html#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb47-42"><a href="bad.html#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb47-43"><a href="bad.html#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb47-44"><a href="bad.html#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb47-45"><a href="bad.html#cb47-45" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb47-46"><a href="bad.html#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb47-47"><a href="bad.html#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb47-48"><a href="bad.html#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb47-49"><a href="bad.html#cb47-49" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb47-50"><a href="bad.html#cb47-50" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb47-51"><a href="bad.html#cb47-51" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb47-52"><a href="bad.html#cb47-52" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb47-53"><a href="bad.html#cb47-53" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb47-54"><a href="bad.html#cb47-54" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb47-55"><a href="bad.html#cb47-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-56"><a href="bad.html#cb47-56" aria-hidden="true" tabindex="-1"></a><span class="co"># combine results</span></span>
<span id="cb47-57"><a href="bad.html#cb47-57" aria-hidden="true" tabindex="-1"></a><span class="co"># only need .summaries &amp; .pvalues</span></span>
<span id="cb47-58"><a href="bad.html#cb47-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb47-59"><a href="bad.html#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb47-60"><a href="bad.html#cb47-60" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$j</span> <span class="ot">==</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb47-61"><a href="bad.html#cb47-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$i</span>-linear-chr-<span class="va">$j</span>.summaries <span class="op">&gt;</span> <span class="va">$i</span>-linear.summaries</span>
<span id="cb47-62"><a href="bad.html#cb47-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$i</span>-linear-chr-<span class="va">$j</span>.pvalues <span class="op">&gt;</span> <span class="va">$i</span>-linear.pvalues</span>
<span id="cb47-63"><a href="bad.html#cb47-63" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb47-64"><a href="bad.html#cb47-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$i</span>-linear-chr-<span class="va">$j</span>.summaries <span class="op">&gt;&gt;</span> <span class="va">$i</span>-linear.summaries</span>
<span id="cb47-65"><a href="bad.html#cb47-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $0}&#39;</span> <span class="va">$i</span>-linear-chr-<span class="va">$j</span>.pvalues <span class="op">&gt;&gt;</span> <span class="va">$i</span>-linear.pvalues</span>
<span id="cb47-66"><a href="bad.html#cb47-66" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb47-67"><a href="bad.html#cb47-67" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb47-68"><a href="bad.html#cb47-68" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="basic-cov-pc" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> basic cov + PC</h3>
<p>Here we add PC one at a time until the tenth as covariates and conduct GWAS</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="bad.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariates--------------------------------------------------------------------</span></span>
<span id="cb48-2"><a href="bad.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb48-3"><a href="bad.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 999<span class="kw">)</span></span>
<span id="cb48-4"><a href="bad.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb48-5"><a href="bad.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="va">cov</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;phen/covariates.phen&quot;</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb48-6"><a href="bad.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span><span class="st">&quot;age&quot;</span><span class="ex">,</span><span class="st">&quot;sex_gen&quot;</span><span class="ex">,</span> <span class="st">&quot;townsend&quot;</span>, paste0<span class="er">(</span><span class="st">&quot;pc&quot;</span><span class="ex">,1:40</span><span class="kw">))</span></span>
<span id="cb48-7"><a href="bad.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="va">cov</span><span class="op">=</span>cov[,nm]</span>
<span id="cb48-8"><a href="bad.html#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="bad.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:10<span class="kw">){</span></span>
<span id="cb48-10"><a href="bad.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="va">sel</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span><span class="st">&quot;eid&quot;</span><span class="ex">,</span><span class="st">&quot;age&quot;</span><span class="ex">,</span><span class="st">&quot;sex_gen&quot;</span><span class="ex">,</span> <span class="st">&quot;townsend&quot;</span>, paste0<span class="er">(</span><span class="st">&quot;pc&quot;</span><span class="ex">,</span> 1:i<span class="kw">))</span></span>
<span id="cb48-11"><a href="bad.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>cov[,sel]</span>
<span id="cb48-12"><a href="bad.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="va">file1</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;phen/covariates-basic-&quot;</span><span class="ex">,i,</span><span class="st">&quot;PC.use&quot;</span><span class="kw">)</span></span>
<span id="cb48-13"><a href="bad.html#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="va">file2</span><span class="op">=</span>paste0<span class="kw">(</span><span class="st">&quot;phen/covariates-basic-&quot;</span><span class="ex">,i,</span><span class="st">&quot;PC.use-names&quot;</span><span class="kw">)</span></span>
<span id="cb48-14"><a href="bad.html#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,file1,</span> col.names=F, row.names=F,quote=F<span class="kw">)</span></span>
<span id="cb48-15"><a href="bad.html#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="ex">write.table</span><span class="er">(</span><span class="ex">names</span><span class="er">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,file2,</span> col.names=F, row.names=F,quote=F<span class="kw">)</span></span>
<span id="cb48-16"><a href="bad.html#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb48-17"><a href="bad.html#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="bad.html#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># gwas--------------------------------------------------------------------------</span></span>
<span id="cb48-19"><a href="bad.html#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-20"><a href="bad.html#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-mix-<span class="va">$j</span><span class="st">&#39;PC&#39;</span></span>
<span id="cb48-21"><a href="bad.html#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-22"><a href="bad.html#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gwas-mix-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>/<span class="va">$i</span>-linear</span>
<span id="cb48-23"><a href="bad.html#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="va">cov</span><span class="op">=</span>../phen/covariates-basic-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.use</span>
<span id="cb48-24"><a href="bad.html#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb48-25"><a href="bad.html#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb48-26"><a href="bad.html#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb48-27"><a href="bad.html#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 6G</span></span>
<span id="cb48-28"><a href="bad.html#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb48-29"><a href="bad.html#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 6:0:0</span></span>
<span id="cb48-30"><a href="bad.html#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="bad.html#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb48-32"><a href="bad.html#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb48-33"><a href="bad.html#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb48-34"><a href="bad.html#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar </span><span class="va">$cov</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb48-35"><a href="bad.html#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../mix-pop-gwas.id </span><span class="dt">\</span></span>
<span id="cb48-36"><a href="bad.html#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-unrel-inds.use </span><span class="dt">\</span></span>
<span id="cb48-37"><a href="bad.html#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb48-38"><a href="bad.html#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.sh</span>
<span id="cb48-39"><a href="bad.html#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb48-40"><a href="bad.html#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb48-41"><a href="bad.html#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="bad.html#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb48-43"><a href="bad.html#cb48-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-44"><a href="bad.html#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-45"><a href="bad.html#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.sh</span>
<span id="cb48-46"><a href="bad.html#cb48-46" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb48-47"><a href="bad.html#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-mix-pc</span>
<span id="cb48-48"><a href="bad.html#cb48-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-49"><a href="bad.html#cb48-49" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb48-50"><a href="bad.html#cb48-50" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-mix-pc</span>
<span id="cb48-51"><a href="bad.html#cb48-51" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb48-52"><a href="bad.html#cb48-52" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb48-53"><a href="bad.html#cb48-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-54"><a href="bad.html#cb48-54" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb48-55"><a href="bad.html#cb48-55" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb48-56"><a href="bad.html#cb48-56" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb48-57"><a href="bad.html#cb48-57" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb48-58"><a href="bad.html#cb48-58" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb48-59"><a href="bad.html#cb48-59" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb48-60"><a href="bad.html#cb48-60" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb48-61"><a href="bad.html#cb48-61" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb48-62"><a href="bad.html#cb48-62" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb48-63"><a href="bad.html#cb48-63" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb48-64"><a href="bad.html#cb48-64" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb48-65"><a href="bad.html#cb48-65" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb48-66"><a href="bad.html#cb48-66" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
</div>
<div id="gwas-bolt-lmm" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> GWAS-bolt-lmm</h2>
<p>Here we used linear mixed-effects models to test the association between genetic variants and phenotypes. The argument for the use of linear mixed-effects models is that it can account for the confounding effects from population stratification (check the rationale behind BLOT-LMM). Here we check if there is evidence of inflation in the chi-square test statistics from BOLT-LMM.</p>
<p>As shown below, the slopes are sig. different from zero, but they are negative, indicating that chi-square test statistics decreases as aver2_j increases. Based on the plots (chisq ~ aver2_j), it seems that most large signals (i.e., large chisq test statistics) have an aver2_j close to zero, indicating that aver2_j (or fake tagging) does not drive the GWAS signals. However, how aver2_j relates to chisq of bolt-lmm seems different from how aver2_j relates to chisq of good gwas.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="bad.html#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="bad.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make filter files-------------------------------------------------------------</span></span>
<span id="cb49-3"><a href="bad.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="va">fam</span><span class="op">=</span>gen/geno-mix.fam</span>
<span id="cb49-4"><a href="bad.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="va">bim</span><span class="op">=</span>gen/geno-mix.bim</span>
<span id="cb49-5"><a href="bad.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>mix-pop-gwas.id</span>
<span id="cb49-6"><a href="bad.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="va">snp</span><span class="op">=</span>gen/snps-unrel-inds.use</span>
<span id="cb49-7"><a href="bad.html#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="va">id_remove</span><span class="op">=</span>BOLT-LMM_v2.3.5/mix-pop-gwas-id.exclude</span>
<span id="cb49-8"><a href="bad.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="va">snp_exclude</span><span class="op">=</span>BOLT-LMM_v2.3.5/snps-unrel-inds.remove</span>
<span id="cb49-9"><a href="bad.html#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="bad.html#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1];next} </span></span>
<span id="cb49-11"><a href="bad.html#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="st">     !($2 in a) {print $2}&#39;</span> <span class="va">$snp</span> <span class="va">$bim</span> <span class="op">&gt;</span> <span class="va">$snp_exclude</span></span>
<span id="cb49-12"><a href="bad.html#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># note the list is empty because $snp &amp; $bim contain the same list</span></span>
<span id="cb49-13"><a href="bad.html#cb49-13" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb49-14"><a href="bad.html#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1];next} </span></span>
<span id="cb49-15"><a href="bad.html#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="st">     !($1 in a) {print $0}&#39;</span> <span class="va">$id</span> <span class="va">$fam</span> <span class="op">&gt;</span> <span class="va">$id_remove</span></span>
<span id="cb49-16"><a href="bad.html#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="bad.html#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># organize phenotype files------------------------------------------------------</span></span>
<span id="cb49-18"><a href="bad.html#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb49-19"><a href="bad.html#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 999<span class="kw">)</span></span>
<span id="cb49-20"><a href="bad.html#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb49-21"><a href="bad.html#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="bad.html#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co"># covariate file</span></span>
<span id="cb49-23"><a href="bad.html#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="va">cov</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;phen/covariates.phen&quot;</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb49-24"><a href="bad.html#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;age&quot;</span><span class="ex">,</span><span class="st">&quot;sex_gen&quot;</span><span class="ex">,</span> <span class="st">&quot;townsend&quot;</span> ,paste0<span class="er">(</span><span class="st">&quot;pc&quot;</span><span class="ex">,1:40</span><span class="kw">))</span></span>
<span id="cb49-25"><a href="bad.html#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="bad.html#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="va">traits</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span></span>
<span id="cb49-27"><a href="bad.html#cb49-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span> <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb49-28"><a href="bad.html#cb49-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="kw">)</span></span>
<span id="cb49-29"><a href="bad.html#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="bad.html#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="ex">traits</span><span class="kw">)){</span></span>
<span id="cb49-31"><a href="bad.html#cb49-31" aria-hidden="true" tabindex="-1"></a>    <span class="va">trait</span><span class="op">=</span>traits[i]</span>
<span id="cb49-32"><a href="bad.html#cb49-32" aria-hidden="true" tabindex="-1"></a>    <span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;phen/continuous-traits/&quot;</span><span class="ex">,trait,</span><span class="st">&quot;.raw.pheno&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb49-33"><a href="bad.html#cb49-33" aria-hidden="true" tabindex="-1"></a>    <span class="va">m</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">dat</span><span class="va">$X1</span><span class="ex">,cov</span><span class="va">$eid</span><span class="kw">)</span></span>
<span id="cb49-34"><a href="bad.html#cb49-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-35"><a href="bad.html#cb49-35" aria-hidden="true" tabindex="-1"></a>    <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">FID</span><span class="op">=</span>dat<span class="va">$X1</span>,</span>
<span id="cb49-36"><a href="bad.html#cb49-36" aria-hidden="true" tabindex="-1"></a>                   <span class="va">IID</span><span class="op">=</span>dat<span class="va">$X2</span>,</span>
<span id="cb49-37"><a href="bad.html#cb49-37" aria-hidden="true" tabindex="-1"></a>                   <span class="va">PHENO</span><span class="op">=</span>dat<span class="va">$X3</span>,</span>
<span id="cb49-38"><a href="bad.html#cb49-38" aria-hidden="true" tabindex="-1"></a>                   <span class="va">cov</span><span class="op">[</span>m,nm<span class="op">]</span><span class="kw">)</span></span>
<span id="cb49-39"><a href="bad.html#cb49-39" aria-hidden="true" tabindex="-1"></a>    <span class="va">old</span><span class="op">=</span>names<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span></span>
<span id="cb49-40"><a href="bad.html#cb49-40" aria-hidden="true" tabindex="-1"></a>    <span class="va">new</span><span class="op">=</span>c<span class="kw">(</span><span class="ex">names</span><span class="er">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">[1:3],</span> paste0<span class="er">(</span><span class="st">&quot;COV&quot;</span><span class="ex">,1:43</span><span class="kw">))</span></span>
<span id="cb49-41"><a href="bad.html#cb49-41" aria-hidden="true" tabindex="-1"></a>    <span class="ex">names</span><span class="er">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">=new</span></span>
<span id="cb49-42"><a href="bad.html#cb49-42" aria-hidden="true" tabindex="-1"></a>    <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,paste0</span><span class="er">(</span><span class="st">&quot;BOLT-LMM_v2.3.5/dat/&quot;</span><span class="ex">,trait,</span><span class="st">&quot;.dat&quot;</span><span class="kw">)</span><span class="ex">,</span> col.names=T,</span>
<span id="cb49-43"><a href="bad.html#cb49-43" aria-hidden="true" tabindex="-1"></a>                <span class="ex">row.names=F,</span> quote=F<span class="kw">)</span></span>
<span id="cb49-44"><a href="bad.html#cb49-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">){</span></span>
<span id="cb49-45"><a href="bad.html#cb49-45" aria-hidden="true" tabindex="-1"></a>            <span class="ex">out.nm=data.frame</span><span class="er">(</span><span class="va">name</span><span class="op">=</span>new,true_name=old, <span class="va">stringsAsFactors</span><span class="op">=</span>F<span class="kw">)</span></span>
<span id="cb49-46"><a href="bad.html#cb49-46" aria-hidden="true" tabindex="-1"></a>            <span class="ex">write.table</span><span class="er">(</span><span class="ex">out.nm,</span><span class="st">&quot;BOLT-LMM_v2.3.5/dat/cov-names&quot;</span><span class="ex">,</span> </span>
<span id="cb49-47"><a href="bad.html#cb49-47" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb49-48"><a href="bad.html#cb49-48" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb49-49"><a href="bad.html#cb49-49" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb49-50"><a href="bad.html#cb49-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-51"><a href="bad.html#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="co"># model SNPs--------------------------------------------------------------------</span></span>
<span id="cb49-52"><a href="bad.html#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="co"># subset snps used in GRM for BOLT-LMM</span></span>
<span id="cb49-53"><a href="bad.html#cb49-53" aria-hidden="true" tabindex="-1"></a><span class="co"># we previously thinned SNPs: see &#39;relatedness filtering&#39; section of bad GWAS</span></span>
<span id="cb49-54"><a href="bad.html#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we just merge them across chromsomes</span></span>
<span id="cb49-55"><a href="bad.html#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>thin/geno-mix-thin-snps</span>
<span id="cb49-56"><a href="bad.html#cb49-56" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$out</span> </span>
<span id="cb49-57"><a href="bad.html#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-58"><a href="bad.html#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> thin/thin-chr<span class="va">$i</span>.in <span class="op">&gt;&gt;</span> <span class="va">$out</span></span>
<span id="cb49-59"><a href="bad.html#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb49-60"><a href="bad.html#cb49-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-61"><a href="bad.html#cb49-61" aria-hidden="true" tabindex="-1"></a><span class="co"># run BOLT-LMM------------------------------------------------------------------</span></span>
<span id="cb49-62"><a href="bad.html#cb49-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-63"><a href="bad.html#cb49-63" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>../gwas-bad</span>
<span id="cb49-64"><a href="bad.html#cb49-64" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb49-65"><a href="bad.html#cb49-65" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb49-66"><a href="bad.html#cb49-66" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb49-67"><a href="bad.html#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb49-68"><a href="bad.html#cb49-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb49-69"><a href="bad.html#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb49-70"><a href="bad.html#cb49-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-71"><a href="bad.html#cb49-71" aria-hidden="true" tabindex="-1"></a><span class="st">../bolt --bfile=../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb49-72"><a href="bad.html#cb49-72" aria-hidden="true" tabindex="-1"></a><span class="st">         --phenoFile=../dat/</span><span class="va">$i</span><span class="st">.dat </span><span class="dt">\</span></span>
<span id="cb49-73"><a href="bad.html#cb49-73" aria-hidden="true" tabindex="-1"></a><span class="st">         --phenoCol=PHENO </span><span class="dt">\</span></span>
<span id="cb49-74"><a href="bad.html#cb49-74" aria-hidden="true" tabindex="-1"></a><span class="st">         --remove=../mix-pop-gwas-id.exclude</span><span class="dt">\</span></span>
<span id="cb49-75"><a href="bad.html#cb49-75" aria-hidden="true" tabindex="-1"></a><span class="st">         --lmm </span><span class="dt">\</span></span>
<span id="cb49-76"><a href="bad.html#cb49-76" aria-hidden="true" tabindex="-1"></a><span class="st">         --LDscoresFile=../tables/LDSCORE.1000G_EUR.tab.gz </span><span class="dt">\</span></span>
<span id="cb49-77"><a href="bad.html#cb49-77" aria-hidden="true" tabindex="-1"></a><span class="st">         --LDscoresMatchBp </span><span class="dt">\</span></span>
<span id="cb49-78"><a href="bad.html#cb49-78" aria-hidden="true" tabindex="-1"></a><span class="st">         --covarFile=../dat/</span><span class="va">$i</span><span class="st">.dat </span><span class="dt">\</span></span>
<span id="cb49-79"><a href="bad.html#cb49-79" aria-hidden="true" tabindex="-1"></a><span class="st">         --qCovarCol=COV{1:3}</span><span class="dt">\</span></span>
<span id="cb49-80"><a href="bad.html#cb49-80" aria-hidden="true" tabindex="-1"></a><span class="st">         --modelSnps=../geno-mix-thin-snps </span><span class="dt">\</span></span>
<span id="cb49-81"><a href="bad.html#cb49-81" aria-hidden="true" tabindex="-1"></a><span class="st">         --maxMissingPerSnp=1 </span><span class="dt">\</span></span>
<span id="cb49-82"><a href="bad.html#cb49-82" aria-hidden="true" tabindex="-1"></a><span class="st">         --maxMissingPerIndiv=1 </span><span class="dt">\</span></span>
<span id="cb49-83"><a href="bad.html#cb49-83" aria-hidden="true" tabindex="-1"></a><span class="st">         --statsFile=</span><span class="va">$dir</span><span class="st">/</span><span class="va">$i</span><span class="st">.out </span><span class="dt">\</span></span>
<span id="cb49-84"><a href="bad.html#cb49-84" aria-hidden="true" tabindex="-1"></a><span class="st">         --numThreads=10 </span><span class="dt">\</span></span>
<span id="cb49-85"><a href="bad.html#cb49-85" aria-hidden="true" tabindex="-1"></a><span class="st">       2&gt;&amp;1 | tee </span><span class="va">$dir</span><span class="st">/</span><span class="va">$i</span><span class="st">.log</span></span>
<span id="cb49-86"><a href="bad.html#cb49-86" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-bolt-lmm.sh</span>
<span id="cb49-87"><a href="bad.html#cb49-87" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb49-88"><a href="bad.html#cb49-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-89"><a href="bad.html#cb49-89" aria-hidden="true" tabindex="-1"></a><span class="co"># submit scripts</span></span>
<span id="cb49-90"><a href="bad.html#cb49-90" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-91"><a href="bad.html#cb49-91" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-bolt-lmm.sh</span>
<span id="cb49-92"><a href="bad.html#cb49-92" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/bolt-lmm-bad</span>
<span id="cb49-93"><a href="bad.html#cb49-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-94"><a href="bad.html#cb49-94" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb49-95"><a href="bad.html#cb49-95" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/bolt-lmm-bad</span>
<span id="cb49-96"><a href="bad.html#cb49-96" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb49-97"><a href="bad.html#cb49-97" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb49-98"><a href="bad.html#cb49-98" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-99"><a href="bad.html#cb49-99" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb49-100"><a href="bad.html#cb49-100" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb49-101"><a href="bad.html#cb49-101" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb49-102"><a href="bad.html#cb49-102" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb49-103"><a href="bad.html#cb49-103" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb49-104"><a href="bad.html#cb49-104" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb49-105"><a href="bad.html#cb49-105" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb49-106"><a href="bad.html#cb49-106" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb49-107"><a href="bad.html#cb49-107" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb49-108"><a href="bad.html#cb49-108" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb49-109"><a href="bad.html#cb49-109" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb49-110"><a href="bad.html#cb49-110" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb49-111"><a href="bad.html#cb49-111" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb49-112"><a href="bad.html#cb49-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-113"><a href="bad.html#cb49-113" aria-hidden="true" tabindex="-1"></a><span class="co"># organize results -------------------------------------------------------------</span></span>
<span id="cb49-114"><a href="bad.html#cb49-114" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-norm-337k-out</span>
<span id="cb49-115"><a href="bad.html#cb49-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-116"><a href="bad.html#cb49-116" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb49-117"><a href="bad.html#cb49-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-118"><a href="bad.html#cb49-118" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-norm-337k/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb49-119"><a href="bad.html#cb49-119" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-ukbb-norm</span>
<span id="cb49-120"><a href="bad.html#cb49-120" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-norm-337k-out/<span class="va">$trait</span>.out</span>
<span id="cb49-121"><a href="bad.html#cb49-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-122"><a href="bad.html#cb49-122" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp    </span>
<span id="cb49-123"><a href="bad.html#cb49-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-124"><a href="bad.html#cb49-124" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb49-125"><a href="bad.html#cb49-125" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb49-126"><a href="bad.html#cb49-126" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb49-127"><a href="bad.html#cb49-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-128"><a href="bad.html#cb49-128" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb49-129"><a href="bad.html#cb49-129" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb49-130"><a href="bad.html#cb49-130" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb49-131"><a href="bad.html#cb49-131" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb49-132"><a href="bad.html#cb49-132" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2&quot;}</span></span>
<span id="cb49-133"><a href="bad.html#cb49-133" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb49-134"><a href="bad.html#cb49-134" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="chisq-aver2_j-1" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> chisq ~ aver2_j</h2>
<div id="calc-aver2_j" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> calc aver2_j</h3>
<p>Note we previously computed aver2_j based using <code>geno-mix</code> data. see <a href="compute-sum_ijm_1-m_2r2_ij.html#aver2j">13.5</a>.
Results are stored in <code>summary/ave-r2-by-snp-badgwas</code></p>
</div>
<div id="bolt-lmm" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> bolt-lmm</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="bad.html#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="bad.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># organize data ----------------------------------------------------------------</span></span>
<span id="cb50-3"><a href="bad.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-bolt-lmm-out</span>
<span id="cb50-4"><a href="bad.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="bad.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb50-6"><a href="bad.html#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="bad.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>BOLT-LMM_v2.3.5/gwas-bad/<span class="va">$trait</span>.out</span>
<span id="cb50-8"><a href="bad.html#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-by-snp-badgwas</span>
<span id="cb50-9"><a href="bad.html#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-bolt-lmm-out/<span class="va">$trait</span>.out</span>
<span id="cb50-10"><a href="bad.html#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="bad.html#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, ($9/$10)^2 }&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp    </span>
<span id="cb50-12"><a href="bad.html#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="bad.html#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb50-14"><a href="bad.html#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb50-15"><a href="bad.html#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb50-16"><a href="bad.html#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="bad.html#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb50-18"><a href="bad.html#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb50-19"><a href="bad.html#cb50-19" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb50-20"><a href="bad.html#cb50-20" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb50-21"><a href="bad.html#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2&quot;}</span></span>
<span id="cb50-22"><a href="bad.html#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb50-23"><a href="bad.html#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="bad.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-2"><a href="bad.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j</span></span>
<span id="cb51-3"><a href="bad.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-4"><a href="bad.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb51-5"><a href="bad.html#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="bad.html#cb51-6" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb51-7"><a href="bad.html#cb51-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb51-8"><a href="bad.html#cb51-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb51-9"><a href="bad.html#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="bad.html#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb51-11"><a href="bad.html#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="bad.html#cb51-12" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb51-13"><a href="bad.html#cb51-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-14"><a href="bad.html#cb51-14" aria-hidden="true" tabindex="-1"></a>    file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-bolt-lmm-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb51-15"><a href="bad.html#cb51-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-16"><a href="bad.html#cb51-16" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb51-17"><a href="bad.html#cb51-17" aria-hidden="true" tabindex="-1"></a>    mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb51-18"><a href="bad.html#cb51-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-19"><a href="bad.html#cb51-19" aria-hidden="true" tabindex="-1"></a>    slope0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb51-20"><a href="bad.html#cb51-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">slope_aver2=</span><span class="fu">coef</span>(mod)[<span class="dv">2</span>],</span>
<span id="cb51-21"><a href="bad.html#cb51-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">p_aver2=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>],</span>
<span id="cb51-22"><a href="bad.html#cb51-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb51-23"><a href="bad.html#cb51-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-24"><a href="bad.html#cb51-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){slope<span class="ot">=</span>slope0} <span class="cf">else</span> {slope<span class="ot">=</span><span class="fu">rbind</span>(slope,slope0)}</span>
<span id="cb51-25"><a href="bad.html#cb51-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-26"><a href="bad.html#cb51-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-27"><a href="bad.html#cb51-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-28"><a href="bad.html#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-29"><a href="bad.html#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot chisq ~ aver2_j  </span></span>
<span id="cb51-30"><a href="bad.html#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-31"><a href="bad.html#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="bad.html#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co"># aver2_j bin-------------------------------</span></span>
<span id="cb51-33"><a href="bad.html#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="bad.html#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb51-35"><a href="bad.html#cb51-35" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb51-36"><a href="bad.html#cb51-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb51-37"><a href="bad.html#cb51-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb51-38"><a href="bad.html#cb51-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-39"><a href="bad.html#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-bin-bad-gwas-bolt-lmm.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb51-40"><a href="bad.html#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb51-41"><a href="bad.html#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="bad.html#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb51-43"><a href="bad.html#cb51-43" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb51-44"><a href="bad.html#cb51-44" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-bolt-lmm-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb51-45"><a href="bad.html#cb51-45" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb51-46"><a href="bad.html#cb51-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-47"><a href="bad.html#cb51-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb51-48"><a href="bad.html#cb51-48" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb51-49"><a href="bad.html#cb51-49" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb51-50"><a href="bad.html#cb51-50" aria-hidden="true" tabindex="-1"></a>  p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb51-51"><a href="bad.html#cb51-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-52"><a href="bad.html#cb51-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb51-53"><a href="bad.html#cb51-53" aria-hidden="true" tabindex="-1"></a>  cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb51-54"><a href="bad.html#cb51-54" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb51-55"><a href="bad.html#cb51-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-56"><a href="bad.html#cb51-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb51-57"><a href="bad.html#cb51-57" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb51-58"><a href="bad.html#cb51-58" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb51-59"><a href="bad.html#cb51-59" aria-hidden="true" tabindex="-1"></a>  px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb51-60"><a href="bad.html#cb51-60" aria-hidden="true" tabindex="-1"></a>  py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb51-61"><a href="bad.html#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="bad.html#cb51-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb51-63"><a href="bad.html#cb51-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb51-64"><a href="bad.html#cb51-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb51-65"><a href="bad.html#cb51-65" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb51-66"><a href="bad.html#cb51-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb51-67"><a href="bad.html#cb51-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(mod,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb51-68"><a href="bad.html#cb51-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb51-69"><a href="bad.html#cb51-69" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb51-70"><a href="bad.html#cb51-70" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb51-71"><a href="bad.html#cb51-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb51-72"><a href="bad.html#cb51-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-73"><a href="bad.html#cb51-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-74"><a href="bad.html#cb51-74" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb51-75"><a href="bad.html#cb51-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-76"><a href="bad.html#cb51-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-77"><a href="bad.html#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="co"># raw aver2_j &amp; chisq-------------------------------</span></span>
<span id="cb51-78"><a href="bad.html#cb51-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-79"><a href="bad.html#cb51-79" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb51-80"><a href="bad.html#cb51-80" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb51-81"><a href="bad.html#cb51-81" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb51-82"><a href="bad.html#cb51-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb51-83"><a href="bad.html#cb51-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-84"><a href="bad.html#cb51-84" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-gwas-mix-bold-lmm-raw.png&quot;</span>),</span>
<span id="cb51-85"><a href="bad.html#cb51-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb51-86"><a href="bad.html#cb51-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb51-87"><a href="bad.html#cb51-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-88"><a href="bad.html#cb51-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb51-89"><a href="bad.html#cb51-89" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb51-90"><a href="bad.html#cb51-90" aria-hidden="true" tabindex="-1"></a>    file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-bolt-lmm-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb51-91"><a href="bad.html#cb51-91" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb51-92"><a href="bad.html#cb51-92" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb51-93"><a href="bad.html#cb51-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-94"><a href="bad.html#cb51-94" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>aver2, out<span class="sc">$</span>chisq,</span>
<span id="cb51-95"><a href="bad.html#cb51-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;chisq&quot;</span>,</span>
<span id="cb51-96"><a href="bad.html#cb51-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb51-97"><a href="bad.html#cb51-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;gray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb51-98"><a href="bad.html#cb51-98" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb51-99"><a href="bad.html#cb51-99" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="basic-cov-pc-1" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> basic cov + PC</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="bad.html#cb52-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2"><a href="bad.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-mix-pc-out</span>
<span id="cb52-3"><a href="bad.html#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="bad.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-5"><a href="bad.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-6"><a href="bad.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="bad.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-mix-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb52-8"><a href="bad.html#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-by-snp-badgwas</span>
<span id="cb52-9"><a href="bad.html#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-mix-pc-out/<span class="va">$trait</span>-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.out</span>
<span id="cb52-10"><a href="bad.html#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="bad.html#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp    </span>
<span id="cb52-12"><a href="bad.html#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="bad.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb52-14"><a href="bad.html#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb52-15"><a href="bad.html#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb52-16"><a href="bad.html#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="bad.html#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb52-18"><a href="bad.html#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb52-19"><a href="bad.html#cb52-19" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb52-20"><a href="bad.html#cb52-20" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb52-21"><a href="bad.html#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2&quot;}</span></span>
<span id="cb52-22"><a href="bad.html#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb52-23"><a href="bad.html#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-24"><a href="bad.html#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="bad.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb53-2"><a href="bad.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j</span></span>
<span id="cb53-3"><a href="bad.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb53-4"><a href="bad.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="bad.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb53-6"><a href="bad.html#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="bad.html#cb53-7" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb53-8"><a href="bad.html#cb53-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb53-9"><a href="bad.html#cb53-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb53-10"><a href="bad.html#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="bad.html#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb53-12"><a href="bad.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-13"><a href="bad.html#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb53-14"><a href="bad.html#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="bad.html#cb53-15" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb53-16"><a href="bad.html#cb53-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-17"><a href="bad.html#cb53-17" aria-hidden="true" tabindex="-1"></a>    file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-mix-pc-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,j,<span class="st">&quot;PC.out&quot;</span>)</span>
<span id="cb53-18"><a href="bad.html#cb53-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-19"><a href="bad.html#cb53-19" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb53-20"><a href="bad.html#cb53-20" aria-hidden="true" tabindex="-1"></a>    mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb53-21"><a href="bad.html#cb53-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-22"><a href="bad.html#cb53-22" aria-hidden="true" tabindex="-1"></a>    slope0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb53-23"><a href="bad.html#cb53-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">pc_up_to=</span>j,</span>
<span id="cb53-24"><a href="bad.html#cb53-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">slope_aver2=</span><span class="fu">coef</span>(mod)[<span class="dv">2</span>],</span>
<span id="cb53-25"><a href="bad.html#cb53-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">p_aver2=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>],</span>
<span id="cb53-26"><a href="bad.html#cb53-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb53-27"><a href="bad.html#cb53-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-28"><a href="bad.html#cb53-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> j<span class="sc">==</span><span class="dv">1</span>){slope<span class="ot">=</span>slope0} <span class="cf">else</span> {slope<span class="ot">=</span><span class="fu">rbind</span>(slope,slope0)}</span>
<span id="cb53-29"><a href="bad.html#cb53-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-30"><a href="bad.html#cb53-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-31"><a href="bad.html#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="bad.html#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb53-33"><a href="bad.html#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="co"># plot chisq ~ aver2_j  </span></span>
<span id="cb53-34"><a href="bad.html#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb53-35"><a href="bad.html#cb53-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-36"><a href="bad.html#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="co"># binned data -------------------------------------</span></span>
<span id="cb53-37"><a href="bad.html#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="bad.html#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb53-39"><a href="bad.html#cb53-39" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb53-40"><a href="bad.html#cb53-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb53-41"><a href="bad.html#cb53-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb53-42"><a href="bad.html#cb53-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-43"><a href="bad.html#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb53-44"><a href="bad.html#cb53-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-45"><a href="bad.html#cb53-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-bad-gwas-&quot;</span>,j,<span class="st">&quot;PC.png&quot;</span>), </span>
<span id="cb53-46"><a href="bad.html#cb53-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb53-47"><a href="bad.html#cb53-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-48"><a href="bad.html#cb53-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb53-49"><a href="bad.html#cb53-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-50"><a href="bad.html#cb53-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb53-51"><a href="bad.html#cb53-51" aria-hidden="true" tabindex="-1"></a>      trait<span class="ot">=</span>traits[i]</span>
<span id="cb53-52"><a href="bad.html#cb53-52" aria-hidden="true" tabindex="-1"></a>      file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-mix-pc-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,j,<span class="st">&quot;PC.out&quot;</span>)</span>
<span id="cb53-53"><a href="bad.html#cb53-53" aria-hidden="true" tabindex="-1"></a>      dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T)</span>
<span id="cb53-54"><a href="bad.html#cb53-54" aria-hidden="true" tabindex="-1"></a>      dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb53-55"><a href="bad.html#cb53-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-56"><a href="bad.html#cb53-56" aria-hidden="true" tabindex="-1"></a>      <span class="co"># linear model</span></span>
<span id="cb53-57"><a href="bad.html#cb53-57" aria-hidden="true" tabindex="-1"></a>      mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb53-58"><a href="bad.html#cb53-58" aria-hidden="true" tabindex="-1"></a>      p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb53-59"><a href="bad.html#cb53-59" aria-hidden="true" tabindex="-1"></a>      p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb53-60"><a href="bad.html#cb53-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-61"><a href="bad.html#cb53-61" aria-hidden="true" tabindex="-1"></a>      <span class="co"># bin a variable by quantile</span></span>
<span id="cb53-62"><a href="bad.html#cb53-62" aria-hidden="true" tabindex="-1"></a>      cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb53-63"><a href="bad.html#cb53-63" aria-hidden="true" tabindex="-1"></a>      dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb53-64"><a href="bad.html#cb53-64" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-65"><a href="bad.html#cb53-65" aria-hidden="true" tabindex="-1"></a>      <span class="co"># average chisq by bin values</span></span>
<span id="cb53-66"><a href="bad.html#cb53-66" aria-hidden="true" tabindex="-1"></a>      out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb53-67"><a href="bad.html#cb53-67" aria-hidden="true" tabindex="-1"></a>      out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb53-68"><a href="bad.html#cb53-68" aria-hidden="true" tabindex="-1"></a>      px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb53-69"><a href="bad.html#cb53-69" aria-hidden="true" tabindex="-1"></a>      py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb53-70"><a href="bad.html#cb53-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-71"><a href="bad.html#cb53-71" aria-hidden="true" tabindex="-1"></a>      <span class="co"># plot</span></span>
<span id="cb53-72"><a href="bad.html#cb53-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb53-73"><a href="bad.html#cb53-73" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb53-74"><a href="bad.html#cb53-74" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="fu">paste0</span>(trait, <span class="st">&quot; &quot;</span>, j, <span class="st">&quot; PC&quot;</span>), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb53-75"><a href="bad.html#cb53-75" aria-hidden="true" tabindex="-1"></a>               <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb53-76"><a href="bad.html#cb53-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abline</span>(mod,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb53-77"><a href="bad.html#cb53-77" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb53-78"><a href="bad.html#cb53-78" aria-hidden="true" tabindex="-1"></a>                      <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb53-79"><a href="bad.html#cb53-79" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb53-80"><a href="bad.html#cb53-80" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb53-81"><a href="bad.html#cb53-81" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-82"><a href="bad.html#cb53-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dev.off</span>()</span>
<span id="cb53-83"><a href="bad.html#cb53-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-84"><a href="bad.html#cb53-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-85"><a href="bad.html#cb53-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-86"><a href="bad.html#cb53-86" aria-hidden="true" tabindex="-1"></a><span class="co"># binned data. single trait varying # of PC ------------------------------------</span></span>
<span id="cb53-87"><a href="bad.html#cb53-87" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI</span></span>
<span id="cb53-88"><a href="bad.html#cb53-88" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb53-89"><a href="bad.html#cb53-89" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb53-90"><a href="bad.html#cb53-90" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb53-91"><a href="bad.html#cb53-91" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb53-92"><a href="bad.html#cb53-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-93"><a href="bad.html#cb53-93" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-bad-gwas-varying-PC-bmi.png&quot;</span>), </span>
<span id="cb53-94"><a href="bad.html#cb53-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">40</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb53-95"><a href="bad.html#cb53-95" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb53-96"><a href="bad.html#cb53-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-97"><a href="bad.html#cb53-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb53-98"><a href="bad.html#cb53-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-99"><a href="bad.html#cb53-99" aria-hidden="true" tabindex="-1"></a>      trait<span class="ot">=</span>traits[<span class="dv">2</span>]</span>
<span id="cb53-100"><a href="bad.html#cb53-100" aria-hidden="true" tabindex="-1"></a>      file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-mix-pc-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,j,<span class="st">&quot;PC.out&quot;</span>)</span>
<span id="cb53-101"><a href="bad.html#cb53-101" aria-hidden="true" tabindex="-1"></a>      dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T)</span>
<span id="cb53-102"><a href="bad.html#cb53-102" aria-hidden="true" tabindex="-1"></a>      dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb53-103"><a href="bad.html#cb53-103" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-104"><a href="bad.html#cb53-104" aria-hidden="true" tabindex="-1"></a>      <span class="co"># linear model</span></span>
<span id="cb53-105"><a href="bad.html#cb53-105" aria-hidden="true" tabindex="-1"></a>      mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb53-106"><a href="bad.html#cb53-106" aria-hidden="true" tabindex="-1"></a>      p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb53-107"><a href="bad.html#cb53-107" aria-hidden="true" tabindex="-1"></a>      p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb53-108"><a href="bad.html#cb53-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-109"><a href="bad.html#cb53-109" aria-hidden="true" tabindex="-1"></a>      <span class="co"># bin a variable by quantile</span></span>
<span id="cb53-110"><a href="bad.html#cb53-110" aria-hidden="true" tabindex="-1"></a>      cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb53-111"><a href="bad.html#cb53-111" aria-hidden="true" tabindex="-1"></a>      dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb53-112"><a href="bad.html#cb53-112" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-113"><a href="bad.html#cb53-113" aria-hidden="true" tabindex="-1"></a>      <span class="co"># average chisq by bin values</span></span>
<span id="cb53-114"><a href="bad.html#cb53-114" aria-hidden="true" tabindex="-1"></a>      out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb53-115"><a href="bad.html#cb53-115" aria-hidden="true" tabindex="-1"></a>      out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb53-116"><a href="bad.html#cb53-116" aria-hidden="true" tabindex="-1"></a>      px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb53-117"><a href="bad.html#cb53-117" aria-hidden="true" tabindex="-1"></a>      py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb53-118"><a href="bad.html#cb53-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-119"><a href="bad.html#cb53-119" aria-hidden="true" tabindex="-1"></a>      <span class="co"># plot</span></span>
<span id="cb53-120"><a href="bad.html#cb53-120" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb53-121"><a href="bad.html#cb53-121" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb53-122"><a href="bad.html#cb53-122" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="fu">paste0</span>(trait, <span class="st">&quot; &quot;</span>, j, <span class="st">&quot; PC&quot;</span>), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb53-123"><a href="bad.html#cb53-123" aria-hidden="true" tabindex="-1"></a>               <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb53-124"><a href="bad.html#cb53-124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abline</span>(mod,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb53-125"><a href="bad.html#cb53-125" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb53-126"><a href="bad.html#cb53-126" aria-hidden="true" tabindex="-1"></a>                      <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb53-127"><a href="bad.html#cb53-127" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb53-128"><a href="bad.html#cb53-128" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb53-129"><a href="bad.html#cb53-129" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-130"><a href="bad.html#cb53-130" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-131"><a href="bad.html#cb53-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-132"><a href="bad.html#cb53-132" aria-hidden="true" tabindex="-1"></a><span class="co"># reaction</span></span>
<span id="cb53-133"><a href="bad.html#cb53-133" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb53-134"><a href="bad.html#cb53-134" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb53-135"><a href="bad.html#cb53-135" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb53-136"><a href="bad.html#cb53-136" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb53-137"><a href="bad.html#cb53-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-138"><a href="bad.html#cb53-138" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-bad-gwas-varying-PC-reaction.png&quot;</span>), </span>
<span id="cb53-139"><a href="bad.html#cb53-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">40</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb53-140"><a href="bad.html#cb53-140" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb53-141"><a href="bad.html#cb53-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-142"><a href="bad.html#cb53-142" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb53-143"><a href="bad.html#cb53-143" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-144"><a href="bad.html#cb53-144" aria-hidden="true" tabindex="-1"></a>      trait<span class="ot">=</span>traits[<span class="dv">11</span>]</span>
<span id="cb53-145"><a href="bad.html#cb53-145" aria-hidden="true" tabindex="-1"></a>      file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-mix-pc-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,j,<span class="st">&quot;PC.out&quot;</span>)</span>
<span id="cb53-146"><a href="bad.html#cb53-146" aria-hidden="true" tabindex="-1"></a>      dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T)</span>
<span id="cb53-147"><a href="bad.html#cb53-147" aria-hidden="true" tabindex="-1"></a>      dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb53-148"><a href="bad.html#cb53-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-149"><a href="bad.html#cb53-149" aria-hidden="true" tabindex="-1"></a>      <span class="co"># linear model</span></span>
<span id="cb53-150"><a href="bad.html#cb53-150" aria-hidden="true" tabindex="-1"></a>      mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb53-151"><a href="bad.html#cb53-151" aria-hidden="true" tabindex="-1"></a>      p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb53-152"><a href="bad.html#cb53-152" aria-hidden="true" tabindex="-1"></a>      p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb53-153"><a href="bad.html#cb53-153" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-154"><a href="bad.html#cb53-154" aria-hidden="true" tabindex="-1"></a>      <span class="co"># bin a variable by quantile</span></span>
<span id="cb53-155"><a href="bad.html#cb53-155" aria-hidden="true" tabindex="-1"></a>      cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb53-156"><a href="bad.html#cb53-156" aria-hidden="true" tabindex="-1"></a>      dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb53-157"><a href="bad.html#cb53-157" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-158"><a href="bad.html#cb53-158" aria-hidden="true" tabindex="-1"></a>      <span class="co"># average chisq by bin values</span></span>
<span id="cb53-159"><a href="bad.html#cb53-159" aria-hidden="true" tabindex="-1"></a>      out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb53-160"><a href="bad.html#cb53-160" aria-hidden="true" tabindex="-1"></a>      out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb53-161"><a href="bad.html#cb53-161" aria-hidden="true" tabindex="-1"></a>      px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb53-162"><a href="bad.html#cb53-162" aria-hidden="true" tabindex="-1"></a>      py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb53-163"><a href="bad.html#cb53-163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-164"><a href="bad.html#cb53-164" aria-hidden="true" tabindex="-1"></a>      <span class="co"># plot</span></span>
<span id="cb53-165"><a href="bad.html#cb53-165" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb53-166"><a href="bad.html#cb53-166" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb53-167"><a href="bad.html#cb53-167" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="fu">paste0</span>(trait, <span class="st">&quot; &quot;</span>, j, <span class="st">&quot; PC&quot;</span>), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb53-168"><a href="bad.html#cb53-168" aria-hidden="true" tabindex="-1"></a>               <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb53-169"><a href="bad.html#cb53-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abline</span>(mod,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb53-170"><a href="bad.html#cb53-170" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb53-171"><a href="bad.html#cb53-171" aria-hidden="true" tabindex="-1"></a>                      <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb53-172"><a href="bad.html#cb53-172" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb53-173"><a href="bad.html#cb53-173" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb53-174"><a href="bad.html#cb53-174" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-175"><a href="bad.html#cb53-175" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-176"><a href="bad.html#cb53-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-177"><a href="bad.html#cb53-177" aria-hidden="true" tabindex="-1"></a><span class="co"># raw data-------------------------------------------------------------------</span></span>
<span id="cb53-178"><a href="bad.html#cb53-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-179"><a href="bad.html#cb53-179" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb53-180"><a href="bad.html#cb53-180" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb53-181"><a href="bad.html#cb53-181" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb53-182"><a href="bad.html#cb53-182" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb53-183"><a href="bad.html#cb53-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-184"><a href="bad.html#cb53-184" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb53-185"><a href="bad.html#cb53-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-186"><a href="bad.html#cb53-186" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-gwas-mix-&quot;</span>,j,<span class="st">&quot;PC-raw.png&quot;</span>),</span>
<span id="cb53-187"><a href="bad.html#cb53-187" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb53-188"><a href="bad.html#cb53-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb53-189"><a href="bad.html#cb53-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-190"><a href="bad.html#cb53-190" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb53-191"><a href="bad.html#cb53-191" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb53-192"><a href="bad.html#cb53-192" aria-hidden="true" tabindex="-1"></a>    file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-mix-pc-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,j,<span class="st">&quot;PC.out&quot;</span>)</span>
<span id="cb53-193"><a href="bad.html#cb53-193" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb53-194"><a href="bad.html#cb53-194" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb53-195"><a href="bad.html#cb53-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-196"><a href="bad.html#cb53-196" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>aver2, out<span class="sc">$</span>chisq,</span>
<span id="cb53-197"><a href="bad.html#cb53-197" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave chisq&quot;</span>,</span>
<span id="cb53-198"><a href="bad.html#cb53-198" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb53-199"><a href="bad.html#cb53-199" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb53-200"><a href="bad.html#cb53-200" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb53-201"><a href="bad.html#cb53-201" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-202"><a href="bad.html#cb53-202" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="ldsc-intercept-1" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> ldsc intercept</h2>
<div id="under-gcta-1" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> under gcta</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="bad.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb54-2"><a href="bad.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using original ldsc</span></span>
<span id="cb54-3"><a href="bad.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb54-4"><a href="bad.html#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="bad.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># format stats for ldsc--------------------------------------------------------- </span></span>
<span id="cb54-6"><a href="bad.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb54-7"><a href="bad.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb54-8"><a href="bad.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;doug/ukbb.ldsc&quot;</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb54-9"><a href="bad.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="va">phen</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span><span class="st">&quot;fvc&quot;</span><span class="ex">,</span></span>
<span id="cb54-10"><a href="bad.html#cb54-10" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;height&quot;</span><span class="ex">,</span><span class="st">&quot;imp&quot;</span><span class="ex">,</span><span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span></span>
<span id="cb54-11"><a href="bad.html#cb54-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="ex">,</span> <span class="st">&quot;quals&quot;</span><span class="kw">)</span></span>
<span id="cb54-12"><a href="bad.html#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="bad.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in phen<span class="kw">){</span></span>
<span id="cb54-14"><a href="bad.html#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="va">stat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-mix/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb54-15"><a href="bad.html#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="va">p</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-mix/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.pvalues&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb54-16"><a href="bad.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> stat<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb54-17"><a href="bad.html#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> p<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb54-18"><a href="bad.html#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">SNP</span><span class="op">=</span>rs<span class="va">$X2</span>,</span>
<span id="cb54-19"><a href="bad.html#cb54-19" aria-hidden="true" tabindex="-1"></a>                 <span class="va">N</span><span class="op">=</span>stat<span class="va">$n</span>[m1],</span>
<span id="cb54-20"><a href="bad.html#cb54-20" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Z</span><span class="op">=</span><span class="va">(</span>sqrt<span class="er">(</span>stat<span class="va">$Stat)</span><span class="pp">*</span>stat<span class="va">$Direction</span><span class="kw">)</span><span class="ex">[m1],</span></span>
<span id="cb54-21"><a href="bad.html#cb54-21" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A1</span><span class="op">=</span>stat<span class="va">$A1</span>[m1],</span>
<span id="cb54-22"><a href="bad.html#cb54-22" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A2</span><span class="op">=</span>stat<span class="va">$A2</span>[m1], </span>
<span id="cb54-23"><a href="bad.html#cb54-23" aria-hidden="true" tabindex="-1"></a>                 <span class="va">pval</span><span class="op">=</span>p<span class="va">$P</span>[m2], <span class="va">stringsAsFactors</span><span class="op">=</span>F<span class="er">)</span></span>
<span id="cb54-24"><a href="bad.html#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>out[complete.cases<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb54-25"><a href="bad.html#cb54-25" aria-hidden="true" tabindex="-1"></a>  <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;gwas-mix/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear-rs.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb54-26"><a href="bad.html#cb54-26" aria-hidden="true" tabindex="-1"></a>  <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb54-27"><a href="bad.html#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb54-28"><a href="bad.html#cb54-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-29"><a href="bad.html#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="co"># perform ldsc------------------------------------------------------------------</span></span>
<span id="cb54-30"><a href="bad.html#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> out-mix-pop</span>
<span id="cb54-31"><a href="bad.html#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-32"><a href="bad.html#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-33"><a href="bad.html#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-34"><a href="bad.html#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-35"><a href="bad.html#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb54-36"><a href="bad.html#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb54-37"><a href="bad.html#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:00:0</span></span>
<span id="cb54-38"><a href="bad.html#cb54-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-39"><a href="bad.html#cb54-39" aria-hidden="true" tabindex="-1"></a><span class="st">.././munge_sumstats.py </span><span class="dt">\</span></span>
<span id="cb54-40"><a href="bad.html#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="st">--sumstats ../../gwas-mix/</span><span class="va">$i</span><span class="st">-linear-rs.summaries </span><span class="dt">\</span></span>
<span id="cb54-41"><a href="bad.html#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-mix-pop/</span><span class="va">$i</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-42"><a href="bad.html#cb54-42" aria-hidden="true" tabindex="-1"></a><span class="st">--merge-alleles ../w_hm3.snplist</span></span>
<span id="cb54-43"><a href="bad.html#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="bad.html#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="st">.././ldsc.py </span><span class="dt">\</span></span>
<span id="cb54-45"><a href="bad.html#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="st">--h2 ../out-mix-pop/</span><span class="va">$i</span><span class="st">.sumstats.gz </span><span class="dt">\</span></span>
<span id="cb54-46"><a href="bad.html#cb54-46" aria-hidden="true" tabindex="-1"></a><span class="st">--ref-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb54-47"><a href="bad.html#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="st">--w-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb54-48"><a href="bad.html#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-mix-pop/</span><span class="va">$i</span><span class="st">-ldsc</span></span>
<span id="cb54-49"><a href="bad.html#cb54-49" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/ldsc-<span class="va">$i</span>-mix-pop.sh</span>
<span id="cb54-50"><a href="bad.html#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-51"><a href="bad.html#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="bad.html#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb54-53"><a href="bad.html#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper</span><span class="op">,</span><span class="dt">quals}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-54"><a href="bad.html#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldsc-<span class="va">$i</span>-mix-pop.sh</span>
<span id="cb54-55"><a href="bad.html#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../../job-records/ldsc-mix-pop</span>
<span id="cb54-56"><a href="bad.html#cb54-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-57"><a href="bad.html#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb54-58"><a href="bad.html#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/ldsc-mix-pop</span>
<span id="cb54-59"><a href="bad.html#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb54-60"><a href="bad.html#cb54-60" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb54-61"><a href="bad.html#cb54-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-62"><a href="bad.html#cb54-62" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb54-63"><a href="bad.html#cb54-63" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb54-64"><a href="bad.html#cb54-64" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb54-65"><a href="bad.html#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb54-66"><a href="bad.html#cb54-66" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb54-67"><a href="bad.html#cb54-67" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-68"><a href="bad.html#cb54-68" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb54-69"><a href="bad.html#cb54-69" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb54-70"><a href="bad.html#cb54-70" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb54-71"><a href="bad.html#cb54-71" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb54-72"><a href="bad.html#cb54-72" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb54-73"><a href="bad.html#cb54-73" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb54-74"><a href="bad.html#cb54-74" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb54-75"><a href="bad.html#cb54-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-76"><a href="bad.html#cb54-76" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb54-77"><a href="bad.html#cb54-77" aria-hidden="true" tabindex="-1"></a><span class="co"># using sumher</span></span>
<span id="cb54-78"><a href="bad.html#cb54-78" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb54-79"><a href="bad.html#cb54-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-80"><a href="bad.html#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="co"># insert genetic distance into bim file-----------------------------------------</span></span>
<span id="cb54-81"><a href="bad.html#cb54-81" aria-hidden="true" tabindex="-1"></a><span class="co"># here we want to use the same genetic distance as for unrelated individuals, i.e., good GWAS</span></span>
<span id="cb54-82"><a href="bad.html#cb54-82" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb54-83"><a href="bad.html#cb54-83" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;gen/geno-mix.bim&quot;</span><span class="ex">,</span> header=F, stringsAsFactors=F<span class="kw">)</span></span>
<span id="cb54-84"><a href="bad.html#cb54-84" aria-hidden="true" tabindex="-1"></a><span class="va">ref</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;gen/geno-unrel.bim&quot;</span><span class="ex">,</span> header=F, stringsAsFactors=F<span class="kw">)</span></span>
<span id="cb54-85"><a href="bad.html#cb54-85" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">dat</span><span class="va">$V2</span><span class="ex">,ref</span><span class="va">$V2</span><span class="kw">)</span></span>
<span id="cb54-86"><a href="bad.html#cb54-86" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="ex">dat</span><span class="va">$V1</span><span class="ex">,</span> dat<span class="va">$V2</span>, ref<span class="va">$V3</span>[m], dat<span class="va">$V4</span>, dat<span class="va">$V5</span>, dat<span class="va">$V6</span>, stringsAsFactors=F<span class="kw">)</span></span>
<span id="cb54-87"><a href="bad.html#cb54-87" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span><span class="st">&quot;gen/geno-mix.bim2&quot;</span><span class="ex">,</span> col.names=F, row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb54-88"><a href="bad.html#cb54-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-89"><a href="bad.html#cb54-89" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-mix.bim geno-mix.bim0</span>
<span id="cb54-90"><a href="bad.html#cb54-90" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-mix.bim2 geno-mix.bim</span>
<span id="cb54-91"><a href="bad.html#cb54-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-92"><a href="bad.html#cb54-92" aria-hidden="true" tabindex="-1"></a><span class="co"># compute tagging under gcta----------------------------------------------------</span></span>
<span id="cb54-93"><a href="bad.html#cb54-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-94"><a href="bad.html#cb54-94" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-95"><a href="bad.html#cb54-95" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-96"><a href="bad.html#cb54-96" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-97"><a href="bad.html#cb54-97" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb54-98"><a href="bad.html#cb54-98" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb54-99"><a href="bad.html#cb54-99" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb54-100"><a href="bad.html#cb54-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-101"><a href="bad.html#cb54-101" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../tagging-mix-pop/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb54-102"><a href="bad.html#cb54-102" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb54-103"><a href="bad.html#cb54-103" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb54-104"><a href="bad.html#cb54-104" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb54-105"><a href="bad.html#cb54-105" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb54-106"><a href="bad.html#cb54-106" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb54-107"><a href="bad.html#cb54-107" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span></span>
<span id="cb54-108"><a href="bad.html#cb54-108" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-109"><a href="bad.html#cb54-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-110"><a href="bad.html#cb54-110" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-111"><a href="bad.html#cb54-111" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span> </span>
<span id="cb54-112"><a href="bad.html#cb54-112" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-gcta-hadmap3-mix-pop</span>
<span id="cb54-113"><a href="bad.html#cb54-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-114"><a href="bad.html#cb54-114" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb54-115"><a href="bad.html#cb54-115" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-gcta-hadmap3-mix-pop</span>
<span id="cb54-116"><a href="bad.html#cb54-116" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb54-117"><a href="bad.html#cb54-117" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb54-118"><a href="bad.html#cb54-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-119"><a href="bad.html#cb54-119" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb54-120"><a href="bad.html#cb54-120" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb54-121"><a href="bad.html#cb54-121" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb54-122"><a href="bad.html#cb54-122" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb54-123"><a href="bad.html#cb54-123" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb54-124"><a href="bad.html#cb54-124" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-125"><a href="bad.html#cb54-125" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb54-126"><a href="bad.html#cb54-126" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb54-127"><a href="bad.html#cb54-127" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb54-128"><a href="bad.html#cb54-128" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb54-129"><a href="bad.html#cb54-129" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb54-130"><a href="bad.html#cb54-130" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb54-131"><a href="bad.html#cb54-131" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb54-132"><a href="bad.html#cb54-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-133"><a href="bad.html#cb54-133" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb54-134"><a href="bad.html#cb54-134" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb54-135"><a href="bad.html#cb54-135" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb54-136"><a href="bad.html#cb54-136" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-mix-pop/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb54-137"><a href="bad.html#cb54-137" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-138"><a href="bad.html#cb54-138" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> tagging-mix-pop/gcta-hapmap3 <span class="at">--taglist</span> list.txt</span>
<span id="cb54-139"><a href="bad.html#cb54-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-140"><a href="bad.html#cb54-140" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb54-141"><a href="bad.html#cb54-141" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> sumher-mix</span>
<span id="cb54-142"><a href="bad.html#cb54-142" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-143"><a href="bad.html#cb54-143" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb54-144"><a href="bad.html#cb54-144" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb54-145"><a href="bad.html#cb54-145" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb54-146"><a href="bad.html#cb54-146" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb54-147"><a href="bad.html#cb54-147" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb54-148"><a href="bad.html#cb54-148" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb54-149"><a href="bad.html#cb54-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-150"><a href="bad.html#cb54-150" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../sumher-mix/</span><span class="va">$i</span><span class="st">-sumher-gcta </span><span class="dt">\</span></span>
<span id="cb54-151"><a href="bad.html#cb54-151" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../tagging-mix-pop/gcta-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb54-152"><a href="bad.html#cb54-152" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../gwas-mix/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb54-153"><a href="bad.html#cb54-153" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb54-154"><a href="bad.html#cb54-154" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb54-155"><a href="bad.html#cb54-155" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-gcta-mix-pop</span>
<span id="cb54-156"><a href="bad.html#cb54-156" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-157"><a href="bad.html#cb54-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-158"><a href="bad.html#cb54-158" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-159"><a href="bad.html#cb54-159" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-gcta-mix-pop</span>
<span id="cb54-160"><a href="bad.html#cb54-160" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-gcta-mix-pop</span>
<span id="cb54-161"><a href="bad.html#cb54-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-162"><a href="bad.html#cb54-162" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb54-163"><a href="bad.html#cb54-163" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/sumher-gcta-mix-pop</span>
<span id="cb54-164"><a href="bad.html#cb54-164" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb54-165"><a href="bad.html#cb54-165" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb54-166"><a href="bad.html#cb54-166" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-167"><a href="bad.html#cb54-167" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb54-168"><a href="bad.html#cb54-168" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb54-169"><a href="bad.html#cb54-169" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb54-170"><a href="bad.html#cb54-170" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb54-171"><a href="bad.html#cb54-171" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb54-172"><a href="bad.html#cb54-172" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-173"><a href="bad.html#cb54-173" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb54-174"><a href="bad.html#cb54-174" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb54-175"><a href="bad.html#cb54-175" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb54-176"><a href="bad.html#cb54-176" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb54-177"><a href="bad.html#cb54-177" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb54-178"><a href="bad.html#cb54-178" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb54-179"><a href="bad.html#cb54-179" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="under-ldak-thin-1" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> under ldak-thin</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="bad.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get weights-------------------------------------------------------------------</span></span>
<span id="cb55-2"><a href="bad.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> ldak-thin/ldak-thin-hapmap3.in <span class="st">&#39;{print $1, 1}&#39;</span> <span class="op">&gt;</span> ldak-thin/weights.ldak-thin-hapmap3</span>
<span id="cb55-3"><a href="bad.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="bad.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate tagging under ldak-thin---------------------------------------------</span></span>
<span id="cb55-5"><a href="bad.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-6"><a href="bad.html#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb55-7"><a href="bad.html#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb55-8"><a href="bad.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 40G</span></span>
<span id="cb55-9"><a href="bad.html#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb55-10"><a href="bad.html#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb55-11"><a href="bad.html#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb55-12"><a href="bad.html#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../tagging-mix-pop/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb55-13"><a href="bad.html#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb55-14"><a href="bad.html#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="st">          --weights ../ldak-thin/weights.ldak-thin-hapmap3 </span><span class="dt">\</span></span>
<span id="cb55-15"><a href="bad.html#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -.25 </span><span class="dt">\</span></span>
<span id="cb55-16"><a href="bad.html#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb55-17"><a href="bad.html#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb55-18"><a href="bad.html#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --save-matrix YES </span><span class="dt">\</span></span>
<span id="cb55-19"><a href="bad.html#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb55-20"><a href="bad.html#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb55-21"><a href="bad.html#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-22"><a href="bad.html#cb55-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-23"><a href="bad.html#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="co"># submit scripts</span></span>
<span id="cb55-24"><a href="bad.html#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-25"><a href="bad.html#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb55-26"><a href="bad.html#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-ldak-thin-hapmap3</span>
<span id="cb55-27"><a href="bad.html#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="bad.html#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb55-29"><a href="bad.html#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-ldak-thin-hapmap3</span>
<span id="cb55-30"><a href="bad.html#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb55-31"><a href="bad.html#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb55-32"><a href="bad.html#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-33"><a href="bad.html#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb55-34"><a href="bad.html#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb55-35"><a href="bad.html#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb55-36"><a href="bad.html#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb55-37"><a href="bad.html#cb55-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb55-38"><a href="bad.html#cb55-38" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-39"><a href="bad.html#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb55-40"><a href="bad.html#cb55-40" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb55-41"><a href="bad.html#cb55-41" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb55-42"><a href="bad.html#cb55-42" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb55-43"><a href="bad.html#cb55-43" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb55-44"><a href="bad.html#cb55-44" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb55-45"><a href="bad.html#cb55-45" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb55-46"><a href="bad.html#cb55-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-47"><a href="bad.html#cb55-47" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb55-48"><a href="bad.html#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb55-49"><a href="bad.html#cb55-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> matlist.txt</span>
<span id="cb55-50"><a href="bad.html#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb55-51"><a href="bad.html#cb55-51" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-mix-pop/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb55-52"><a href="bad.html#cb55-52" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-mix-pop/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.matrix&quot;</span> <span class="op">&gt;&gt;</span> matlist.txt</span>
<span id="cb55-53"><a href="bad.html#cb55-53" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-54"><a href="bad.html#cb55-54" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> tagging-mix-pop/ldak-thin-hapmap3 <span class="at">--taglist</span> list.txt <span class="at">--matlist</span> matlist.txt</span>
<span id="cb55-55"><a href="bad.html#cb55-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-56"><a href="bad.html#cb55-56" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb55-57"><a href="bad.html#cb55-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-58"><a href="bad.html#cb55-58" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb55-59"><a href="bad.html#cb55-59" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb55-60"><a href="bad.html#cb55-60" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb55-61"><a href="bad.html#cb55-61" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb55-62"><a href="bad.html#cb55-62" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb55-63"><a href="bad.html#cb55-63" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb55-64"><a href="bad.html#cb55-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-65"><a href="bad.html#cb55-65" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../sumher-mix/</span><span class="va">$i</span><span class="st">-sumher-ldak-thin </span><span class="dt">\</span></span>
<span id="cb55-66"><a href="bad.html#cb55-66" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../tagging-mix-pop/ldak-thin-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb55-67"><a href="bad.html#cb55-67" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../gwas-mix/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb55-68"><a href="bad.html#cb55-68" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb55-69"><a href="bad.html#cb55-69" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb55-70"><a href="bad.html#cb55-70" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-ldak-thin-mix</span>
<span id="cb55-71"><a href="bad.html#cb55-71" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-72"><a href="bad.html#cb55-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-73"><a href="bad.html#cb55-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-74"><a href="bad.html#cb55-74" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-ldak-thin-mix</span>
<span id="cb55-75"><a href="bad.html#cb55-75" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-ldak-thin-mix</span>
<span id="cb55-76"><a href="bad.html#cb55-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-77"><a href="bad.html#cb55-77" aria-hidden="true" tabindex="-1"></a><span class="co"># check job-completion</span></span>
<span id="cb55-78"><a href="bad.html#cb55-78" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/sumher-ldak-thin-mix</span>
<span id="cb55-79"><a href="bad.html#cb55-79" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb55-80"><a href="bad.html#cb55-80" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb55-81"><a href="bad.html#cb55-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb55-82"><a href="bad.html#cb55-82" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb55-83"><a href="bad.html#cb55-83" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb55-84"><a href="bad.html#cb55-84" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb55-85"><a href="bad.html#cb55-85" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb55-86"><a href="bad.html#cb55-86" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb55-87"><a href="bad.html#cb55-87" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb55-88"><a href="bad.html#cb55-88" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb55-89"><a href="bad.html#cb55-89" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb55-90"><a href="bad.html#cb55-90" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb55-91"><a href="bad.html#cb55-91" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb55-92"><a href="bad.html#cb55-92" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb55-93"><a href="bad.html#cb55-93" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb55-94"><a href="bad.html#cb55-94" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="summary-3" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> summary</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="bad.html#cb56-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-2"><a href="bad.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># without 40 PCs----------------------------------------------------------------------</span></span>
<span id="cb56-3"><a href="bad.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># original ldsc</span></span>
<span id="cb56-4"><a href="bad.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept <span class="pp">*</span>ldsc.log <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[-]/); split($3, b, /[()]/); print a[1], $2, b[2]}&#39;</span> <span class="op">&gt;</span> ../../summary/ldsc-mix</span>
<span id="cb56-5"><a href="bad.html#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="bad.html#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sumher under gcta</span></span>
<span id="cb56-7"><a href="bad.html#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-mix-est</span>
<span id="cb56-8"><a href="bad.html#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-mix-sd</span>
<span id="cb56-9"><a href="bad.html#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb56-10"><a href="bad.html#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-gcta-mix-est sumher-gcta-mix-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-gcta-mix</span>
<span id="cb56-11"><a href="bad.html#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> sumher-gcta-mix-sd sumher-gcta-mix-est</span>
<span id="cb56-12"><a href="bad.html#cb56-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb56-13"><a href="bad.html#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># suhmer under ldak-thin</span></span>
<span id="cb56-14"><a href="bad.html#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-mix-est</span>
<span id="cb56-15"><a href="bad.html#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-mix-sd</span>
<span id="cb56-16"><a href="bad.html#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb56-17"><a href="bad.html#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-ldak-thin-mix-est sumher-ldak-thin-mix-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-ldak-thin-mix</span>
<span id="cb56-18"><a href="bad.html#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> sumher-ldak-thin-mix-sd sumher-ldak-thin-mix-est</span>
<span id="cb56-19"><a href="bad.html#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="bad.html#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co"># with covariates (i.e., including all 40 PCs)-------------------------------------------</span></span>
<span id="cb56-21"><a href="bad.html#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="bad.html#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="co"># original ldsc</span></span>
<span id="cb56-23"><a href="bad.html#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept <span class="pp">*</span>ldsc.log <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[-]/); split($3, b, /[()]/); print a[1], $2, b[2]}&#39;</span> <span class="op">&gt;</span> ../../summary/ldsc-mix-with-cov</span>
<span id="cb56-24"><a href="bad.html#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="bad.html#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="co"># sumher under gcta</span></span>
<span id="cb56-26"><a href="bad.html#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-mix-est</span>
<span id="cb56-27"><a href="bad.html#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-mix-sd</span>
<span id="cb56-28"><a href="bad.html#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb56-29"><a href="bad.html#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-gcta-mix-est sumher-gcta-mix-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-gcta-mix-with-cov</span>
<span id="cb56-30"><a href="bad.html#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> sumher-gcta-mix-sd sumher-gcta-mix-est</span>
<span id="cb56-31"><a href="bad.html#cb56-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb56-32"><a href="bad.html#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="co"># suhmer under ldak-thin</span></span>
<span id="cb56-33"><a href="bad.html#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-mix-est</span>
<span id="cb56-34"><a href="bad.html#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-mix-sd</span>
<span id="cb56-35"><a href="bad.html#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb56-36"><a href="bad.html#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-ldak-thin-mix-est sumher-ldak-thin-mix-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-ldak-thin-mix-with-cov</span>
<span id="cb56-37"><a href="bad.html#cb56-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> sumher-ldak-thin-mix-sd sumher-ldak-thin-mix-est</span></code></pre></div>
</div>
</div>
<div id="reml-1" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> REML</h2>
<div id="making-grms-1" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> making grms</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="bad.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making grm -------------------------------------------------------------------</span></span>
<span id="cb57-2"><a href="bad.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="bad.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb57-4"><a href="bad.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb57-5"><a href="bad.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb57-6"><a href="bad.html#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="bad.html#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># all snps</span></span>
<span id="cb57-8"><a href="bad.html#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb57-9"><a href="bad.html#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb57-10"><a href="bad.html#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 120G</span></span>
<span id="cb57-11"><a href="bad.html#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb57-12"><a href="bad.html#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb57-13"><a href="bad.html#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb57-14"><a href="bad.html#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="bad.html#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb57-16"><a href="bad.html#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/gcta-all-mix </span><span class="dt">\</span></span>
<span id="cb57-17"><a href="bad.html#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb57-18"><a href="bad.html#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../mix-pop-gwas.id </span><span class="dt">\</span></span>
<span id="cb57-19"><a href="bad.html#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb57-20"><a href="bad.html#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb57-21"><a href="bad.html#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb57-22"><a href="bad.html#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-all-snps-mix</span>
<span id="cb57-23"><a href="bad.html#cb57-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-24"><a href="bad.html#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-all-snps-mix <span class="op">&gt;</span> ../job-records/grm-all-snps-mix</span>
<span id="cb57-25"><a href="bad.html#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="bad.html#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb57-27"><a href="bad.html#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&lt;8 {print $2}&#39;</span> geno-mix.bim <span class="op">&gt;</span> left-mix-pop.snps </span>
<span id="cb57-28"><a href="bad.html#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&gt;=8 {print $2}&#39;</span> geno-mix.bim <span class="op">&gt;</span> right-mix-pop.snps</span>
<span id="cb57-29"><a href="bad.html#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="bad.html#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb57-31"><a href="bad.html#cb57-31" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb57-32"><a href="bad.html#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb57-33"><a href="bad.html#cb57-33" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 100G</span></span>
<span id="cb57-34"><a href="bad.html#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb57-35"><a href="bad.html#cb57-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb57-36"><a href="bad.html#cb57-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb57-37"><a href="bad.html#cb57-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-38"><a href="bad.html#cb57-38" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb57-39"><a href="bad.html#cb57-39" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/gcta-</span><span class="va">$i</span><span class="st">-mix </span><span class="dt">\</span></span>
<span id="cb57-40"><a href="bad.html#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb57-41"><a href="bad.html#cb57-41" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../mix-pop-gwas.id </span><span class="dt">\</span></span>
<span id="cb57-42"><a href="bad.html#cb57-42" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-mix-pop.snps </span><span class="dt">\</span></span>
<span id="cb57-43"><a href="bad.html#cb57-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb57-44"><a href="bad.html#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb57-45"><a href="bad.html#cb57-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb57-46"><a href="bad.html#cb57-46" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-gcta-<span class="va">$i</span>-mix</span>
<span id="cb57-47"><a href="bad.html#cb57-47" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb57-48"><a href="bad.html#cb57-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-49"><a href="bad.html#cb57-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb57-50"><a href="bad.html#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-gcta-<span class="va">$i</span>-mix </span>
<span id="cb57-51"><a href="bad.html#cb57-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-gcta-by-snps-mix</span>
<span id="cb57-52"><a href="bad.html#cb57-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-53"><a href="bad.html#cb57-53" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb57-54"><a href="bad.html#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/grm-gcta-by-snps-mix</span>
<span id="cb57-55"><a href="bad.html#cb57-55" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb57-56"><a href="bad.html#cb57-56" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb57-57"><a href="bad.html#cb57-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb57-58"><a href="bad.html#cb57-58" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb57-59"><a href="bad.html#cb57-59" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb57-60"><a href="bad.html#cb57-60" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb57-61"><a href="bad.html#cb57-61" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb57-62"><a href="bad.html#cb57-62" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb57-63"><a href="bad.html#cb57-63" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb57-64"><a href="bad.html#cb57-64" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb57-65"><a href="bad.html#cb57-65" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb57-66"><a href="bad.html#cb57-66" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb57-67"><a href="bad.html#cb57-67" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb57-68"><a href="bad.html#cb57-68" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb57-69"><a href="bad.html#cb57-69" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb57-70"><a href="bad.html#cb57-70" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb57-71"><a href="bad.html#cb57-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-72"><a href="bad.html#cb57-72" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb57-73"><a href="bad.html#cb57-73" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb57-74"><a href="bad.html#cb57-74" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb57-75"><a href="bad.html#cb57-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-76"><a href="bad.html#cb57-76" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb57-77"><a href="bad.html#cb57-77" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. thin snps</span></span>
<span id="cb57-78"><a href="bad.html#cb57-78" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb57-79"><a href="bad.html#cb57-79" aria-hidden="true" tabindex="-1"></a><span class="co"># we omit this step and use ldak-thin/ldak-thin-hapmap3.in, which was created previously</span></span>
<span id="cb57-80"><a href="bad.html#cb57-80" aria-hidden="true" tabindex="-1"></a><span class="co"># using geno-unrel bfiles. See above.</span></span>
<span id="cb57-81"><a href="bad.html#cb57-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-82"><a href="bad.html#cb57-82" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------</span></span>
<span id="cb57-83"><a href="bad.html#cb57-83" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. kinship matrix under ldak-thin</span></span>
<span id="cb57-84"><a href="bad.html#cb57-84" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------</span></span>
<span id="cb57-85"><a href="bad.html#cb57-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-86"><a href="bad.html#cb57-86" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb57-87"><a href="bad.html#cb57-87" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb57-88"><a href="bad.html#cb57-88" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 100G</span></span>
<span id="cb57-89"><a href="bad.html#cb57-89" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb57-90"><a href="bad.html#cb57-90" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb57-91"><a href="bad.html#cb57-91" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb57-92"><a href="bad.html#cb57-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-93"><a href="bad.html#cb57-93" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb57-94"><a href="bad.html#cb57-94" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/ldak-thin-all-mix </span><span class="dt">\</span></span>
<span id="cb57-95"><a href="bad.html#cb57-95" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb57-96"><a href="bad.html#cb57-96" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../mix-pop-gwas.id </span><span class="dt">\</span></span>
<span id="cb57-97"><a href="bad.html#cb57-97" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../ldak-thin/ldak-thin-hapmap3.in </span><span class="dt">\</span></span>
<span id="cb57-98"><a href="bad.html#cb57-98" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb57-99"><a href="bad.html#cb57-99" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb57-100"><a href="bad.html#cb57-100" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb57-101"><a href="bad.html#cb57-101" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-all-snps-mix</span>
<span id="cb57-102"><a href="bad.html#cb57-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-103"><a href="bad.html#cb57-103" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-all-snps-mix<span class="op">&gt;</span> ../job-records/ldak-thin-grm-all-snps-mix</span>
<span id="cb57-104"><a href="bad.html#cb57-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-105"><a href="bad.html#cb57-105" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb57-106"><a href="bad.html#cb57-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-107"><a href="bad.html#cb57-107" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&lt;8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb57-108"><a href="bad.html#cb57-108" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-hapmap3.in <span class="op">&gt;</span> gen/left-ldak-thin-hapmap3.snps </span>
<span id="cb57-109"><a href="bad.html#cb57-109" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&gt;=8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb57-110"><a href="bad.html#cb57-110" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-hapmap3.in <span class="op">&gt;</span> gen/right-ldak-thin-hapmap3.snps </span>
<span id="cb57-111"><a href="bad.html#cb57-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-112"><a href="bad.html#cb57-112" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb57-113"><a href="bad.html#cb57-113" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb57-114"><a href="bad.html#cb57-114" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb57-115"><a href="bad.html#cb57-115" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 100G</span></span>
<span id="cb57-116"><a href="bad.html#cb57-116" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb57-117"><a href="bad.html#cb57-117" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb57-118"><a href="bad.html#cb57-118" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb57-119"><a href="bad.html#cb57-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-120"><a href="bad.html#cb57-120" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb57-121"><a href="bad.html#cb57-121" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/ldak-thin-</span><span class="va">$i</span><span class="st">-mix </span><span class="dt">\</span></span>
<span id="cb57-122"><a href="bad.html#cb57-122" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-mix </span><span class="dt">\</span></span>
<span id="cb57-123"><a href="bad.html#cb57-123" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../mix-pop-gwas.id </span><span class="dt">\</span></span>
<span id="cb57-124"><a href="bad.html#cb57-124" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-ldak-thin-hapmap3.snps </span><span class="dt">\</span></span>
<span id="cb57-125"><a href="bad.html#cb57-125" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb57-126"><a href="bad.html#cb57-126" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb57-127"><a href="bad.html#cb57-127" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb57-128"><a href="bad.html#cb57-128" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-<span class="va">$i</span>-mix</span>
<span id="cb57-129"><a href="bad.html#cb57-129" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb57-130"><a href="bad.html#cb57-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-131"><a href="bad.html#cb57-131" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb57-132"><a href="bad.html#cb57-132" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-<span class="va">$i</span>-mix </span>
<span id="cb57-133"><a href="bad.html#cb57-133" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-ldak-thin-by-snps-mix</span>
<span id="cb57-134"><a href="bad.html#cb57-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-135"><a href="bad.html#cb57-135" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb57-136"><a href="bad.html#cb57-136" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/grm-ldak-thin-by-snps-mix</span>
<span id="cb57-137"><a href="bad.html#cb57-137" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb57-138"><a href="bad.html#cb57-138" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb57-139"><a href="bad.html#cb57-139" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb57-140"><a href="bad.html#cb57-140" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb57-141"><a href="bad.html#cb57-141" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb57-142"><a href="bad.html#cb57-142" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb57-143"><a href="bad.html#cb57-143" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb57-144"><a href="bad.html#cb57-144" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb57-145"><a href="bad.html#cb57-145" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb57-146"><a href="bad.html#cb57-146" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb57-147"><a href="bad.html#cb57-147" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb57-148"><a href="bad.html#cb57-148" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb57-149"><a href="bad.html#cb57-149" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb57-150"><a href="bad.html#cb57-150" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb57-151"><a href="bad.html#cb57-151" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb57-152"><a href="bad.html#cb57-152" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="fast-reml-1" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> fast-reml</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="bad.html#cb58-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-2"><a href="bad.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb58-3"><a href="bad.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb58-4"><a href="bad.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb58-5"><a href="bad.html#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="bad.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># make script files-------------------------------------------------------------</span></span>
<span id="cb58-7"><a href="bad.html#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> reml-mix</span>
<span id="cb58-8"><a href="bad.html#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-9"><a href="bad.html#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-10"><a href="bad.html#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb58-11"><a href="bad.html#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb58-12"><a href="bad.html#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb58-13"><a href="bad.html#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 100G</span></span>
<span id="cb58-14"><a href="bad.html#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb58-15"><a href="bad.html#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb58-16"><a href="bad.html#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="bad.html#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --fast-reml ../reml-mix/</span><span class="va">$i</span><span class="st">-gcta-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb58-18"><a href="bad.html#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --repetitions 20 </span><span class="dt">\</span></span>
<span id="cb58-19"><a href="bad.html#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb58-20"><a href="bad.html#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb58-21"><a href="bad.html#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/gcta-</span><span class="va">$k</span><span class="st">-mix </span><span class="dt">\</span></span>
<span id="cb58-22"><a href="bad.html#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb58-23"><a href="bad.html#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb58-24"><a href="bad.html#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-reml-mix-gcta-<span class="va">$k</span>-snps</span>
<span id="cb58-25"><a href="bad.html#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-26"><a href="bad.html#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-27"><a href="bad.html#cb58-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-28"><a href="bad.html#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script files-----------------------------------------------------------</span></span>
<span id="cb58-29"><a href="bad.html#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-30"><a href="bad.html#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-31"><a href="bad.html#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-reml-mix-gcta-<span class="va">$k</span>-snps</span>
<span id="cb58-32"><a href="bad.html#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-33"><a href="bad.html#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/reml-mix-gcta</span>
<span id="cb58-34"><a href="bad.html#cb58-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-35"><a href="bad.html#cb58-35" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb58-36"><a href="bad.html#cb58-36" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/reml-mix-gcta</span>
<span id="cb58-37"><a href="bad.html#cb58-37" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb58-38"><a href="bad.html#cb58-38" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb58-39"><a href="bad.html#cb58-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-40"><a href="bad.html#cb58-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb58-41"><a href="bad.html#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb58-42"><a href="bad.html#cb58-42" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb58-43"><a href="bad.html#cb58-43" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb58-44"><a href="bad.html#cb58-44" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb58-45"><a href="bad.html#cb58-45" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-46"><a href="bad.html#cb58-46" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb58-47"><a href="bad.html#cb58-47" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb58-48"><a href="bad.html#cb58-48" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb58-49"><a href="bad.html#cb58-49" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb58-50"><a href="bad.html#cb58-50" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb58-51"><a href="bad.html#cb58-51" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb58-52"><a href="bad.html#cb58-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb58-53"><a href="bad.html#cb58-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-54"><a href="bad.html#cb58-54" aria-hidden="true" tabindex="-1"></a><span class="co"># cancel jobs </span></span>
<span id="cb58-55"><a href="bad.html#cb58-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">14</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-56"><a href="bad.html#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="va">job</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;NR==i{print $0}&#39;</span> kill-jobs<span class="kw">`</span></span>
<span id="cb58-57"><a href="bad.html#cb58-57" aria-hidden="true" tabindex="-1"></a><span class="ex">scancel</span> <span class="va">$job</span></span>
<span id="cb58-58"><a href="bad.html#cb58-58" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-59"><a href="bad.html#cb58-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-60"><a href="bad.html#cb58-60" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb58-61"><a href="bad.html#cb58-61" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb58-62"><a href="bad.html#cb58-62" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb58-63"><a href="bad.html#cb58-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-64"><a href="bad.html#cb58-64" aria-hidden="true" tabindex="-1"></a><span class="co"># make script files-------------------------------------------------------------</span></span>
<span id="cb58-65"><a href="bad.html#cb58-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-66"><a href="bad.html#cb58-66" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-67"><a href="bad.html#cb58-67" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb58-68"><a href="bad.html#cb58-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb58-69"><a href="bad.html#cb58-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb58-70"><a href="bad.html#cb58-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 100G</span></span>
<span id="cb58-71"><a href="bad.html#cb58-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb58-72"><a href="bad.html#cb58-72" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb58-73"><a href="bad.html#cb58-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-74"><a href="bad.html#cb58-74" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --fast-reml ../reml-mix/</span><span class="va">$i</span><span class="st">-ldak-thin-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb58-75"><a href="bad.html#cb58-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --repetitions 20 </span><span class="dt">\</span></span>
<span id="cb58-76"><a href="bad.html#cb58-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb58-77"><a href="bad.html#cb58-77" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb58-78"><a href="bad.html#cb58-78" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/ldak-thin-</span><span class="va">$k</span><span class="st">-mix </span><span class="dt">\</span></span>
<span id="cb58-79"><a href="bad.html#cb58-79" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb58-80"><a href="bad.html#cb58-80" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb58-81"><a href="bad.html#cb58-81" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-reml-mix-ldak-thin-<span class="va">$k</span>-snps</span>
<span id="cb58-82"><a href="bad.html#cb58-82" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-83"><a href="bad.html#cb58-83" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-84"><a href="bad.html#cb58-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-85"><a href="bad.html#cb58-85" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script files-----------------------------------------------------------</span></span>
<span id="cb58-86"><a href="bad.html#cb58-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-87"><a href="bad.html#cb58-87" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-88"><a href="bad.html#cb58-88" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-reml-mix-ldak-thin-<span class="va">$k</span>-snps</span>
<span id="cb58-89"><a href="bad.html#cb58-89" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-90"><a href="bad.html#cb58-90" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span>../job-records/reml-mix-ldak-thin</span>
<span id="cb58-91"><a href="bad.html#cb58-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-92"><a href="bad.html#cb58-92" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb58-93"><a href="bad.html#cb58-93" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/reml-mix-ldak-thin</span>
<span id="cb58-94"><a href="bad.html#cb58-94" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb58-95"><a href="bad.html#cb58-95" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb58-96"><a href="bad.html#cb58-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb58-97"><a href="bad.html#cb58-97" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb58-98"><a href="bad.html#cb58-98" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb58-99"><a href="bad.html#cb58-99" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb58-100"><a href="bad.html#cb58-100" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb58-101"><a href="bad.html#cb58-101" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb58-102"><a href="bad.html#cb58-102" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb58-103"><a href="bad.html#cb58-103" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb58-104"><a href="bad.html#cb58-104" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb58-105"><a href="bad.html#cb58-105" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb58-106"><a href="bad.html#cb58-106" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb58-107"><a href="bad.html#cb58-107" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb58-108"><a href="bad.html#cb58-108" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb58-109"><a href="bad.html#cb58-109" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="inflation-test-1" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> inflation test</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="bad.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb59-2"><a href="bad.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb59-3"><a href="bad.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb59-4"><a href="bad.html#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="bad.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb59-6"><a href="bad.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb59-7"><a href="bad.html#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb59-8"><a href="bad.html#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>reml-mix/<span class="va">$i</span>-gcta-right.reml</span>
<span id="cb59-9"><a href="bad.html#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/est.tmp</span>
<span id="cb59-10"><a href="bad.html#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1==&quot;Converged&quot; {print$2}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/converge.tmp</span>
<span id="cb59-11"><a href="bad.html#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb59-12"><a href="bad.html#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span>  summary/est.tmp <span class="dt">\</span></span>
<span id="cb59-13"><a href="bad.html#cb59-13" aria-hidden="true" tabindex="-1"></a>       summary/converge.tmp <span class="dt">\</span></span>
<span id="cb59-14"><a href="bad.html#cb59-14" aria-hidden="true" tabindex="-1"></a>       <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;code h2 se converge&quot;}{print i, $0}&#39;</span> <span class="dt">\</span></span>
<span id="cb59-15"><a href="bad.html#cb59-15" aria-hidden="true" tabindex="-1"></a>       <span class="op">&gt;</span> summary/reml-gcta-mix.right</span>
<span id="cb59-16"><a href="bad.html#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/est.tmp summary/converge.tmp</span>
<span id="cb59-17"><a href="bad.html#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="bad.html#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb59-19"><a href="bad.html#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb59-20"><a href="bad.html#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>reml-mix/<span class="va">$i</span>-gcta-left.reml</span>
<span id="cb59-21"><a href="bad.html#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/est.tmp</span>
<span id="cb59-22"><a href="bad.html#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1==&quot;Converged&quot; {print$2}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/converge.tmp</span>
<span id="cb59-23"><a href="bad.html#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb59-24"><a href="bad.html#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span>  summary/est.tmp <span class="dt">\</span></span>
<span id="cb59-25"><a href="bad.html#cb59-25" aria-hidden="true" tabindex="-1"></a>       summary/converge.tmp <span class="dt">\</span></span>
<span id="cb59-26"><a href="bad.html#cb59-26" aria-hidden="true" tabindex="-1"></a>       <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;code h2 se converge&quot;}{print i, $0}&#39;</span> <span class="dt">\</span></span>
<span id="cb59-27"><a href="bad.html#cb59-27" aria-hidden="true" tabindex="-1"></a>       <span class="op">&gt;</span> summary/reml-gcta-mix.left</span>
<span id="cb59-28"><a href="bad.html#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/est.tmp summary/converge.tmp</span>
<span id="cb59-29"><a href="bad.html#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="bad.html#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb59-31"><a href="bad.html#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb59-32"><a href="bad.html#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>reml-mix/<span class="va">$i</span>-gcta-all.reml</span>
<span id="cb59-33"><a href="bad.html#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/est.tmp</span>
<span id="cb59-34"><a href="bad.html#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1==&quot;Converged&quot; {print$2}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/converge.tmp</span>
<span id="cb59-35"><a href="bad.html#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb59-36"><a href="bad.html#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span>  summary/est.tmp <span class="dt">\</span></span>
<span id="cb59-37"><a href="bad.html#cb59-37" aria-hidden="true" tabindex="-1"></a>       summary/converge.tmp <span class="dt">\</span></span>
<span id="cb59-38"><a href="bad.html#cb59-38" aria-hidden="true" tabindex="-1"></a>       <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;code h2 se converge&quot;}{print i, $0}&#39;</span> <span class="dt">\</span></span>
<span id="cb59-39"><a href="bad.html#cb59-39" aria-hidden="true" tabindex="-1"></a>       <span class="op">&gt;</span> summary/reml-gcta-mix.all</span>
<span id="cb59-40"><a href="bad.html#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/est.tmp summary/converge.tmp</span>
<span id="cb59-41"><a href="bad.html#cb59-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-42"><a href="bad.html#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb59-43"><a href="bad.html#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb59-44"><a href="bad.html#cb59-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-45"><a href="bad.html#cb59-45" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/reml-gcta-mix.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=T<span class="kw">)</span></span>
<span id="cb59-46"><a href="bad.html#cb59-46" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/reml-gcta-mix.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=T<span class="kw">)</span></span>
<span id="cb59-47"><a href="bad.html#cb59-47" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/reml-gcta-mix.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=T<span class="kw">)</span></span>
<span id="cb59-48"><a href="bad.html#cb59-48" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb59-49"><a href="bad.html#cb59-49" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb59-50"><a href="bad.html#cb59-50" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-51"><a href="bad.html#cb59-51" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-52"><a href="bad.html#cb59-52" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-53"><a href="bad.html#cb59-53" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-54"><a href="bad.html#cb59-54" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-55"><a href="bad.html#cb59-55" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb59-56"><a href="bad.html#cb59-56" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb59-57"><a href="bad.html#cb59-57" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb59-58"><a href="bad.html#cb59-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-59"><a href="bad.html#cb59-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb59-60"><a href="bad.html#cb59-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-61"><a href="bad.html#cb59-61" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb59-62"><a href="bad.html#cb59-62" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb59-63"><a href="bad.html#cb59-63" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb59-64"><a href="bad.html#cb59-64" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb59-65"><a href="bad.html#cb59-65" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb59-66"><a href="bad.html#cb59-66" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb59-67"><a href="bad.html#cb59-67" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb59-68"><a href="bad.html#cb59-68" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb59-69"><a href="bad.html#cb59-69" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb59-70"><a href="bad.html#cb59-70" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb59-71"><a href="bad.html#cb59-71" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb59-72"><a href="bad.html#cb59-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-73"><a href="bad.html#cb59-73" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb59-74"><a href="bad.html#cb59-74" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb59-75"><a href="bad.html#cb59-75" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb59-76"><a href="bad.html#cb59-76" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb59-77"><a href="bad.html#cb59-77" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb59-78"><a href="bad.html#cb59-78" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb59-79"><a href="bad.html#cb59-79" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb59-80"><a href="bad.html#cb59-80" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb59-81"><a href="bad.html#cb59-81" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb59-82"><a href="bad.html#cb59-82" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb59-83"><a href="bad.html#cb59-83" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/reml-gcta-inflation-mix-gwas.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb59-84"><a href="bad.html#cb59-84" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb59-85"><a href="bad.html#cb59-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-86"><a href="bad.html#cb59-86" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb59-87"><a href="bad.html#cb59-87" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb59-88"><a href="bad.html#cb59-88" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb59-89"><a href="bad.html#cb59-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-90"><a href="bad.html#cb59-90" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb59-91"><a href="bad.html#cb59-91" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb59-92"><a href="bad.html#cb59-92" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb59-93"><a href="bad.html#cb59-93" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>reml-mix/<span class="va">$i</span>-ldak-thin-right.reml</span>
<span id="cb59-94"><a href="bad.html#cb59-94" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/est.tmp</span>
<span id="cb59-95"><a href="bad.html#cb59-95" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1==&quot;Converged&quot; {print$2}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/converge.tmp</span>
<span id="cb59-96"><a href="bad.html#cb59-96" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb59-97"><a href="bad.html#cb59-97" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span>  summary/est.tmp <span class="dt">\</span></span>
<span id="cb59-98"><a href="bad.html#cb59-98" aria-hidden="true" tabindex="-1"></a>       summary/converge.tmp <span class="dt">\</span></span>
<span id="cb59-99"><a href="bad.html#cb59-99" aria-hidden="true" tabindex="-1"></a>       <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;code h2 se converge&quot;}{print i, $0}&#39;</span> <span class="dt">\</span></span>
<span id="cb59-100"><a href="bad.html#cb59-100" aria-hidden="true" tabindex="-1"></a>       <span class="op">&gt;</span> summary/reml-ldak-thin-mix.right</span>
<span id="cb59-101"><a href="bad.html#cb59-101" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/est.tmp summary/converge.tmp</span>
<span id="cb59-102"><a href="bad.html#cb59-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-103"><a href="bad.html#cb59-103" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb59-104"><a href="bad.html#cb59-104" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb59-105"><a href="bad.html#cb59-105" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>reml-mix/<span class="va">$i</span>-ldak-thin-left.reml</span>
<span id="cb59-106"><a href="bad.html#cb59-106" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/est.tmp</span>
<span id="cb59-107"><a href="bad.html#cb59-107" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1==&quot;Converged&quot; {print$2}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/converge.tmp</span>
<span id="cb59-108"><a href="bad.html#cb59-108" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb59-109"><a href="bad.html#cb59-109" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span>  summary/est.tmp <span class="dt">\</span></span>
<span id="cb59-110"><a href="bad.html#cb59-110" aria-hidden="true" tabindex="-1"></a>       summary/converge.tmp <span class="dt">\</span></span>
<span id="cb59-111"><a href="bad.html#cb59-111" aria-hidden="true" tabindex="-1"></a>       <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;code h2 se converge&quot;}{print i, $0}&#39;</span> <span class="dt">\</span></span>
<span id="cb59-112"><a href="bad.html#cb59-112" aria-hidden="true" tabindex="-1"></a>       <span class="op">&gt;</span> summary/reml-ldak-thin-mix.left</span>
<span id="cb59-113"><a href="bad.html#cb59-113" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/est.tmp summary/converge.tmp</span>
<span id="cb59-114"><a href="bad.html#cb59-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-115"><a href="bad.html#cb59-115" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb59-116"><a href="bad.html#cb59-116" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb59-117"><a href="bad.html#cb59-117" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>reml-mix/<span class="va">$i</span>-ldak-thin-all.reml</span>
<span id="cb59-118"><a href="bad.html#cb59-118" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/est.tmp</span>
<span id="cb59-119"><a href="bad.html#cb59-119" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1==&quot;Converged&quot; {print$2}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/converge.tmp</span>
<span id="cb59-120"><a href="bad.html#cb59-120" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb59-121"><a href="bad.html#cb59-121" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span>  summary/est.tmp <span class="dt">\</span></span>
<span id="cb59-122"><a href="bad.html#cb59-122" aria-hidden="true" tabindex="-1"></a>       summary/converge.tmp <span class="dt">\</span></span>
<span id="cb59-123"><a href="bad.html#cb59-123" aria-hidden="true" tabindex="-1"></a>       <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;code h2 se converge&quot;}{print i, $0}&#39;</span> <span class="dt">\</span></span>
<span id="cb59-124"><a href="bad.html#cb59-124" aria-hidden="true" tabindex="-1"></a>       <span class="op">&gt;</span> summary/reml-ldak-thin-mix.all</span>
<span id="cb59-125"><a href="bad.html#cb59-125" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/est.tmp summary/converge.tmp</span>
<span id="cb59-126"><a href="bad.html#cb59-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-127"><a href="bad.html#cb59-127" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb59-128"><a href="bad.html#cb59-128" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb59-129"><a href="bad.html#cb59-129" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/reml-ldak-thin-mix.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=T<span class="kw">)</span></span>
<span id="cb59-130"><a href="bad.html#cb59-130" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/reml-ldak-thin-mix.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=T<span class="kw">)</span></span>
<span id="cb59-131"><a href="bad.html#cb59-131" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/reml-ldak-thin-mix.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=T<span class="kw">)</span></span>
<span id="cb59-132"><a href="bad.html#cb59-132" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb59-133"><a href="bad.html#cb59-133" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb59-134"><a href="bad.html#cb59-134" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-135"><a href="bad.html#cb59-135" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-136"><a href="bad.html#cb59-136" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-137"><a href="bad.html#cb59-137" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-138"><a href="bad.html#cb59-138" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb59-139"><a href="bad.html#cb59-139" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb59-140"><a href="bad.html#cb59-140" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb59-141"><a href="bad.html#cb59-141" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb59-142"><a href="bad.html#cb59-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-143"><a href="bad.html#cb59-143" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb59-144"><a href="bad.html#cb59-144" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-145"><a href="bad.html#cb59-145" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb59-146"><a href="bad.html#cb59-146" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb59-147"><a href="bad.html#cb59-147" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb59-148"><a href="bad.html#cb59-148" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb59-149"><a href="bad.html#cb59-149" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb59-150"><a href="bad.html#cb59-150" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb59-151"><a href="bad.html#cb59-151" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb59-152"><a href="bad.html#cb59-152" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb59-153"><a href="bad.html#cb59-153" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb59-154"><a href="bad.html#cb59-154" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb59-155"><a href="bad.html#cb59-155" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb59-156"><a href="bad.html#cb59-156" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-157"><a href="bad.html#cb59-157" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb59-158"><a href="bad.html#cb59-158" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb59-159"><a href="bad.html#cb59-159" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb59-160"><a href="bad.html#cb59-160" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb59-161"><a href="bad.html#cb59-161" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb59-162"><a href="bad.html#cb59-162" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb59-163"><a href="bad.html#cb59-163" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb59-164"><a href="bad.html#cb59-164" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb59-165"><a href="bad.html#cb59-165" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb59-166"><a href="bad.html#cb59-166" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb59-167"><a href="bad.html#cb59-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-168"><a href="bad.html#cb59-168" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/reml-ldak-thin-inflation-mix-gwas.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb59-169"><a href="bad.html#cb59-169" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>
</div>
</div>
<div id="he-1" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> HE</h2>
<div id="estimation-1" class="section level3" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> estimation</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb60-1"><a href="bad.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regress grm on covariates-----------------------------------------------------</span></span>
<span id="cb60-2"><a href="bad.html#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="bad.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-mix gcta-left-mix gcta-right-mix ldak-thin-all-mix ldak-thin-left-mix ldak-thin-right-mix<span class="kw">;</span> <span class="cf">do</span>  </span>
<span id="cb60-4"><a href="bad.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb60-5"><a href="bad.html#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb60-6"><a href="bad.html#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb60-7"><a href="bad.html#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 50G</span></span>
<span id="cb60-8"><a href="bad.html#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb60-9"><a href="bad.html#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb60-10"><a href="bad.html#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --adjust-grm ../kinship/</span><span class="va">$grm</span><span class="st">.covar </span><span class="dt">\</span></span>
<span id="cb60-11"><a href="bad.html#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/</span><span class="va">$grm</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb60-12"><a href="bad.html#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb60-13"><a href="bad.html#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb60-14"><a href="bad.html#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb60-15"><a href="bad.html#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-16"><a href="bad.html#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="bad.html#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb60-18"><a href="bad.html#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-mix gcta-left-mix gcta-right-mix ldak-thin-all-mix ldak-thin-left-mix ldak-thin-right-mix<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-19"><a href="bad.html#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb60-20"><a href="bad.html#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-adjust-for-HE</span>
<span id="cb60-21"><a href="bad.html#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="bad.html#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb60-23"><a href="bad.html#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/grm-adjust-for-HE</span>
<span id="cb60-24"><a href="bad.html#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb60-25"><a href="bad.html#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb60-26"><a href="bad.html#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-27"><a href="bad.html#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb60-28"><a href="bad.html#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb60-29"><a href="bad.html#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb60-30"><a href="bad.html#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb60-31"><a href="bad.html#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb60-32"><a href="bad.html#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-33"><a href="bad.html#cb60-33" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb60-34"><a href="bad.html#cb60-34" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb60-35"><a href="bad.html#cb60-35" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb60-36"><a href="bad.html#cb60-36" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb60-37"><a href="bad.html#cb60-37" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb60-38"><a href="bad.html#cb60-38" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb60-39"><a href="bad.html#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb60-40"><a href="bad.html#cb60-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-41"><a href="bad.html#cb60-41" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under gcta-----------------------------------------------------------------</span></span>
<span id="cb60-42"><a href="bad.html#cb60-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-43"><a href="bad.html#cb60-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-44"><a href="bad.html#cb60-44" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb60-45"><a href="bad.html#cb60-45" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb60-46"><a href="bad.html#cb60-46" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb60-47"><a href="bad.html#cb60-47" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb60-48"><a href="bad.html#cb60-48" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb60-49"><a href="bad.html#cb60-49" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb60-50"><a href="bad.html#cb60-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-51"><a href="bad.html#cb60-51" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../he-mix/</span><span class="va">$i</span><span class="st">-he-gcta-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb60-52"><a href="bad.html#cb60-52" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb60-53"><a href="bad.html#cb60-53" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/gcta-</span><span class="va">$k</span><span class="st">-mix.covar </span><span class="dt">\</span></span>
<span id="cb60-54"><a href="bad.html#cb60-54" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb60-55"><a href="bad.html#cb60-55" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb60-56"><a href="bad.html#cb60-56" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb60-57"><a href="bad.html#cb60-57" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb60-58"><a href="bad.html#cb60-58" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb60-59"><a href="bad.html#cb60-59" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps.sh</span>
<span id="cb60-60"><a href="bad.html#cb60-60" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-61"><a href="bad.html#cb60-61" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-62"><a href="bad.html#cb60-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-63"><a href="bad.html#cb60-63" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb60-64"><a href="bad.html#cb60-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-65"><a href="bad.html#cb60-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-66"><a href="bad.html#cb60-66" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps.sh</span>
<span id="cb60-67"><a href="bad.html#cb60-67" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-68"><a href="bad.html#cb60-68" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-gcta</span>
<span id="cb60-69"><a href="bad.html#cb60-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-70"><a href="bad.html#cb60-70" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under ldak-thin------------------------------------------------------------</span></span>
<span id="cb60-71"><a href="bad.html#cb60-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-72"><a href="bad.html#cb60-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-73"><a href="bad.html#cb60-73" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb60-74"><a href="bad.html#cb60-74" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb60-75"><a href="bad.html#cb60-75" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb60-76"><a href="bad.html#cb60-76" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb60-77"><a href="bad.html#cb60-77" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb60-78"><a href="bad.html#cb60-78" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 0:30:0</span></span>
<span id="cb60-79"><a href="bad.html#cb60-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-80"><a href="bad.html#cb60-80" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../he-mix/</span><span class="va">$i</span><span class="st">-he-ldak-thin-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb60-81"><a href="bad.html#cb60-81" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb60-82"><a href="bad.html#cb60-82" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/ldak-thin-</span><span class="va">$k</span><span class="st">-mix.covar </span><span class="dt">\</span></span>
<span id="cb60-83"><a href="bad.html#cb60-83" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb60-84"><a href="bad.html#cb60-84" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb60-85"><a href="bad.html#cb60-85" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb60-86"><a href="bad.html#cb60-86" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb60-87"><a href="bad.html#cb60-87" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb60-88"><a href="bad.html#cb60-88" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-snps.sh</span>
<span id="cb60-89"><a href="bad.html#cb60-89" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-90"><a href="bad.html#cb60-90" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-91"><a href="bad.html#cb60-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-92"><a href="bad.html#cb60-92" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb60-93"><a href="bad.html#cb60-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-94"><a href="bad.html#cb60-94" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-95"><a href="bad.html#cb60-95" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-snps.sh</span>
<span id="cb60-96"><a href="bad.html#cb60-96" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb60-97"><a href="bad.html#cb60-97" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-ldak-thin</span></code></pre></div>
</div>
<div id="summary-4" class="section level3" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> summary</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="bad.html#cb61-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-2"><a href="bad.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb61-3"><a href="bad.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb61-4"><a href="bad.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb61-5"><a href="bad.html#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="bad.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb61-7"><a href="bad.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb61-8"><a href="bad.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-mix.right </span>
<span id="cb61-9"><a href="bad.html#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb61-10"><a href="bad.html#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-mix/<span class="va">$i</span>-he-gcta-right.he</span>
<span id="cb61-11"><a href="bad.html#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-mix.right</span>
<span id="cb61-12"><a href="bad.html#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb61-13"><a href="bad.html#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="bad.html#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb61-15"><a href="bad.html#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-mix.left</span>
<span id="cb61-16"><a href="bad.html#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb61-17"><a href="bad.html#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-mix/<span class="va">$i</span>-he-gcta-left.he</span>
<span id="cb61-18"><a href="bad.html#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-mix.left</span>
<span id="cb61-19"><a href="bad.html#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb61-20"><a href="bad.html#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="bad.html#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb61-22"><a href="bad.html#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-mix.all</span>
<span id="cb61-23"><a href="bad.html#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb61-24"><a href="bad.html#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-mix/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb61-25"><a href="bad.html#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-mix.all</span>
<span id="cb61-26"><a href="bad.html#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb61-27"><a href="bad.html#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="bad.html#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb61-29"><a href="bad.html#cb61-29" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb61-30"><a href="bad.html#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="bad.html#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-mix.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb61-32"><a href="bad.html#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-mix.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb61-33"><a href="bad.html#cb61-33" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-mix.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb61-34"><a href="bad.html#cb61-34" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb61-35"><a href="bad.html#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb61-36"><a href="bad.html#cb61-36" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb61-37"><a href="bad.html#cb61-37" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-38"><a href="bad.html#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-39"><a href="bad.html#cb61-39" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-40"><a href="bad.html#cb61-40" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-41"><a href="bad.html#cb61-41" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-42"><a href="bad.html#cb61-42" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb61-43"><a href="bad.html#cb61-43" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb61-44"><a href="bad.html#cb61-44" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb61-45"><a href="bad.html#cb61-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-46"><a href="bad.html#cb61-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb61-47"><a href="bad.html#cb61-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-48"><a href="bad.html#cb61-48" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb61-49"><a href="bad.html#cb61-49" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb61-50"><a href="bad.html#cb61-50" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb61-51"><a href="bad.html#cb61-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb61-52"><a href="bad.html#cb61-52" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb61-53"><a href="bad.html#cb61-53" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb61-54"><a href="bad.html#cb61-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb61-55"><a href="bad.html#cb61-55" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb61-56"><a href="bad.html#cb61-56" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb61-57"><a href="bad.html#cb61-57" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb61-58"><a href="bad.html#cb61-58" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb61-59"><a href="bad.html#cb61-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-60"><a href="bad.html#cb61-60" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb61-61"><a href="bad.html#cb61-61" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb61-62"><a href="bad.html#cb61-62" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb61-63"><a href="bad.html#cb61-63" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb61-64"><a href="bad.html#cb61-64" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb61-65"><a href="bad.html#cb61-65" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb61-66"><a href="bad.html#cb61-66" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb61-67"><a href="bad.html#cb61-67" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb61-68"><a href="bad.html#cb61-68" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb61-69"><a href="bad.html#cb61-69" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb61-70"><a href="bad.html#cb61-70" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-gcta-inflation-mix-gwas.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb61-71"><a href="bad.html#cb61-71" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb61-72"><a href="bad.html#cb61-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-73"><a href="bad.html#cb61-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-74"><a href="bad.html#cb61-74" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb61-75"><a href="bad.html#cb61-75" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb61-76"><a href="bad.html#cb61-76" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb61-77"><a href="bad.html#cb61-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-78"><a href="bad.html#cb61-78" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb61-79"><a href="bad.html#cb61-79" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb61-80"><a href="bad.html#cb61-80" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-mix.right </span>
<span id="cb61-81"><a href="bad.html#cb61-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb61-82"><a href="bad.html#cb61-82" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-mix/<span class="va">$i</span>-he-ldak-thin-right.he</span>
<span id="cb61-83"><a href="bad.html#cb61-83" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-mix.right</span>
<span id="cb61-84"><a href="bad.html#cb61-84" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb61-85"><a href="bad.html#cb61-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-86"><a href="bad.html#cb61-86" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb61-87"><a href="bad.html#cb61-87" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-mix.left</span>
<span id="cb61-88"><a href="bad.html#cb61-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb61-89"><a href="bad.html#cb61-89" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-mix/<span class="va">$i</span>-he-ldak-thin-left.he</span>
<span id="cb61-90"><a href="bad.html#cb61-90" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-mix.left</span>
<span id="cb61-91"><a href="bad.html#cb61-91" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb61-92"><a href="bad.html#cb61-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-93"><a href="bad.html#cb61-93" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb61-94"><a href="bad.html#cb61-94" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-mix.all</span>
<span id="cb61-95"><a href="bad.html#cb61-95" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb61-96"><a href="bad.html#cb61-96" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-mix/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb61-97"><a href="bad.html#cb61-97" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-mix.all</span>
<span id="cb61-98"><a href="bad.html#cb61-98" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb61-99"><a href="bad.html#cb61-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-100"><a href="bad.html#cb61-100" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb61-101"><a href="bad.html#cb61-101" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb61-102"><a href="bad.html#cb61-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-103"><a href="bad.html#cb61-103" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-mix.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb61-104"><a href="bad.html#cb61-104" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-mix.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb61-105"><a href="bad.html#cb61-105" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-mix.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb61-106"><a href="bad.html#cb61-106" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb61-107"><a href="bad.html#cb61-107" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb61-108"><a href="bad.html#cb61-108" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb61-109"><a href="bad.html#cb61-109" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-110"><a href="bad.html#cb61-110" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-111"><a href="bad.html#cb61-111" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-112"><a href="bad.html#cb61-112" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-113"><a href="bad.html#cb61-113" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb61-114"><a href="bad.html#cb61-114" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb61-115"><a href="bad.html#cb61-115" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb61-116"><a href="bad.html#cb61-116" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb61-117"><a href="bad.html#cb61-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-118"><a href="bad.html#cb61-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb61-119"><a href="bad.html#cb61-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-120"><a href="bad.html#cb61-120" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb61-121"><a href="bad.html#cb61-121" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb61-122"><a href="bad.html#cb61-122" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb61-123"><a href="bad.html#cb61-123" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb61-124"><a href="bad.html#cb61-124" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb61-125"><a href="bad.html#cb61-125" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb61-126"><a href="bad.html#cb61-126" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb61-127"><a href="bad.html#cb61-127" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb61-128"><a href="bad.html#cb61-128" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb61-129"><a href="bad.html#cb61-129" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb61-130"><a href="bad.html#cb61-130" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb61-131"><a href="bad.html#cb61-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-132"><a href="bad.html#cb61-132" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb61-133"><a href="bad.html#cb61-133" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb61-134"><a href="bad.html#cb61-134" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb61-135"><a href="bad.html#cb61-135" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb61-136"><a href="bad.html#cb61-136" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb61-137"><a href="bad.html#cb61-137" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb61-138"><a href="bad.html#cb61-138" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb61-139"><a href="bad.html#cb61-139" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb61-140"><a href="bad.html#cb61-140" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb61-141"><a href="bad.html#cb61-141" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb61-142"><a href="bad.html#cb61-142" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-inflation-mix-gwas.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb61-143"><a href="bad.html#cb61-143" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="good.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ukbb.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04.2-bad-gwas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
