<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 UKBB recommended | Quality control</title>
  <meta name="description" content="6 UKBB recommended | Quality control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6 UKBB recommended | Quality control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 UKBB recommended | Quality control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bad.html"/>
<link rel="next" href="control.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>2</b> Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>2.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>2.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>2.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>2.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>2.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>2.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>2.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>2.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>2.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>2.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>2.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>2.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>3</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>3.1</b> test statistics ~ LD score</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>4</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="4.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>4.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="4.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>4.2</b> extract covariates</a></li>
<li class="chapter" data-level="4.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>4.3</b> GWAS</a></li>
<li class="chapter" data-level="4.4" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>4.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>4.4.1</b> under gcta</a></li>
<li class="chapter" data-level="4.4.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>4.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="4.4.3" data-path="good.html"><a href="good.html#summary"><i class="fa fa-check"></i><b>4.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>4.5</b> REML</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>4.5.1</b> making grms</a></li>
<li class="chapter" data-level="4.5.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>4.5.2</b> fast-reml</a></li>
<li class="chapter" data-level="4.5.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>4.5.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>4.6</b> HE</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>4.6.1</b> estimation</a></li>
<li class="chapter" data-level="4.6.2" data-path="good.html"><a href="good.html#summary-1"><i class="fa fa-check"></i><b>4.6.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>5</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>5.1</b> ID list</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>5.1.1</b> initial selection</a></li>
<li class="chapter" data-level="5.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>5.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="5.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>5.1.3</b> final list</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bad.html"><a href="bad.html#gwas-1"><i class="fa fa-check"></i><b>5.2</b> GWAS</a></li>
<li class="chapter" data-level="5.3" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>5.3</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>5.3.1</b> under gcta</a></li>
<li class="chapter" data-level="5.3.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>5.3.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="5.3.3" data-path="bad.html"><a href="bad.html#summary-2"><i class="fa fa-check"></i><b>5.3.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>5.4</b> REML</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>5.4.1</b> making grms</a></li>
<li class="chapter" data-level="5.4.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>5.4.2</b> fast-reml</a></li>
<li class="chapter" data-level="5.4.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>5.4.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>5.5</b> HE</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>5.5.1</b> estimation</a></li>
<li class="chapter" data-level="5.5.2" data-path="bad.html"><a href="bad.html#summary-3"><i class="fa fa-check"></i><b>5.5.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>6</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>6.1</b> total N = 337k</a></li>
<li class="chapter" data-level="6.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>6.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="6.3" data-path="ukbb.html"><a href="ukbb.html#gwas-2"><i class="fa fa-check"></i><b>6.3</b> GWAS</a></li>
<li class="chapter" data-level="6.4" data-path="ukbb.html"><a href="ukbb.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>6.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>6.4.1</b> under gcta</a></li>
<li class="chapter" data-level="6.4.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>6.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="6.4.3" data-path="ukbb.html"><a href="ukbb.html#summary-4"><i class="fa fa-check"></i><b>6.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>6.5</b> HE</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>6.5.1</b> making grms</a></li>
<li class="chapter" data-level="6.5.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>6.5.2</b> estimation</a></li>
<li class="chapter" data-level="6.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-5"><i class="fa fa-check"></i><b>6.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>7</b> control GWAS</a>
<ul>
<li class="chapter" data-level="7.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>7.1</b> ID list</a></li>
<li class="chapter" data-level="7.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>7.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="7.3" data-path="control.html"><a href="control.html#gwas-3"><i class="fa fa-check"></i><b>7.3</b> GWAS</a></li>
<li class="chapter" data-level="7.4" data-path="control.html"><a href="control.html#ldsc-intercept-3"><i class="fa fa-check"></i><b>7.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>7.4.1</b> under gcta</a></li>
<li class="chapter" data-level="7.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>7.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="7.4.3" data-path="control.html"><a href="control.html#summary-6"><i class="fa fa-check"></i><b>7.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>7.5</b> HE</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>7.5.1</b> making grms</a></li>
<li class="chapter" data-level="7.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>7.5.2</b> estimation</a></li>
<li class="chapter" data-level="7.5.3" data-path="control.html"><a href="control.html#summary-7"><i class="fa fa-check"></i><b>7.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quality control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ukbb" class="section level1" number="6">
<h1><span class="header-section-number">6</span> UKBB recommended</h1>
<div id="total-n-337k" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> total N = 337k</h2>
<p>Here we want to identify the unrelated white individuals recommended by the UKBB.</p>
<p>Email from Florian:
“We restrict individuals to the ones used for computing the principal components (PCs) in the UK Biobank (Field 22020). These individuals are unrelated and have passed some quality control including removing samples with a missing rate on autosomes larger than 0.02, having a mismatch between inferred sex and self-reported sex, and outliers based on heterozygosity (more details can be found in section S3 of Bycroft et al. (2018)).”
And the White British are from this: <a href="https://biobank.ctsu.ox.ac.uk/crystal/field.cgi?id=22006" class="uri">https://biobank.ctsu.ox.ac.uk/crystal/field.cgi?id=22006</a></p>
<p>So required data fields:
PC: 22020
White british: 22006</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="ukbb.html#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="ukbb.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb24-3"><a href="ukbb.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data</span></span>
<span id="cb24-4"><a href="ukbb.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="va">head</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;phen/ukb45861.header&quot;</span><span class="ex">,</span> sep=<span class="st">&quot;,&quot;</span>, header=F, stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb24-5"><a href="ukbb.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># function to get the variables</span></span>
<span id="cb24-6"><a href="ukbb.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="va">get</span><span class="op">=</span>function<span class="kw">(</span><span class="fu">nm</span><span class="kw">){</span></span>
<span id="cb24-7"><a href="ukbb.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="va">colnum</span><span class="op">=</span>grep<span class="kw">(</span><span class="fu">nm</span>,head,fixed=TRUE<span class="kw">)</span></span>
<span id="cb24-8"><a href="ukbb.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="ex">t</span><span class="er">(</span><span class="ex">rbind</span><span class="er">(</span><span class="ex">colnum,</span> head[,colnum]<span class="kw">)))</span></span>
<span id="cb24-9"><a href="ukbb.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="ex">names</span><span class="er">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;column&quot;</span><span class="ex">,</span> <span class="st">&quot;field&quot;</span><span class="kw">)</span></span>
<span id="cb24-10"><a href="ukbb.html#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">(</span><span class="ex">out</span><span class="kw">)</span></span>
<span id="cb24-11"><a href="ukbb.html#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb24-12"><a href="ukbb.html#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="ukbb.html#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># get the variables</span></span>
<span id="cb24-14"><a href="ukbb.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">get</span><span class="er">(</span><span class="st">&#39;22020-0&#39;</span><span class="kw">)</span><span class="ex">,</span> <span class="co"># PC</span></span>
<span id="cb24-15"><a href="ukbb.html#cb24-15" aria-hidden="true" tabindex="-1"></a>      <span class="ex">get</span><span class="er">(</span><span class="st">&#39;22006-0&#39;</span><span class="kw">))</span> <span class="co"># white british</span></span>
<span id="cb24-16"><a href="ukbb.html#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="ukbb.html#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span><span class="st">&quot;phen/vars.colnum&quot;</span><span class="ex">,</span> col.names=F, row.names=F, sep=<span class="st">&quot;\t&quot;</span>, quote=F<span class="kw">)</span></span>
<span id="cb24-18"><a href="ukbb.html#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="ukbb.html#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># extract dat</span></span>
<span id="cb24-20"><a href="ukbb.html#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-F</span> <span class="st">&#39;&quot;,&quot;&#39;</span> <span class="st">&#39;(NR==FNR){a[$1];next}{printf &quot;%s\&quot;&quot;, $1;for(i in a){printf &quot; \&quot;%s\&quot;&quot;, $i};printf &quot;\n&quot;}&#39;</span> phen/vars.colnum phen/ukb45861.csv <span class="op">&gt;</span> phen/ukbb-recommended.dat</span>
<span id="cb24-21"><a href="ukbb.html#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="ukbb.html#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># get the id list of the intersect of the two data fields</span></span>
<span id="cb24-23"><a href="ukbb.html#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;phen/ukbb-recommended.dat&quot;</span><span class="ex">,</span> header=T, stringsAsFactors=F<span class="kw">)</span></span>
<span id="cb24-24"><a href="ukbb.html#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="va">id1</span><span class="op">=</span>dat<span class="va">$eid</span>[dat<span class="va">$X22020</span>.0.0==1 <span class="kw">&amp;</span> <span class="ex">!is.na</span><span class="er">(</span><span class="ex">dat</span><span class="va">$X22020</span><span class="ex">.0.0</span><span class="kw">)</span><span class="ex">]</span></span>
<span id="cb24-25"><a href="ukbb.html#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="va">id2</span><span class="op">=</span>dat<span class="va">$eid</span>[dat<span class="va">$X22006</span>.0.0==1 <span class="kw">&amp;</span> <span class="ex">!is.na</span><span class="er">(</span><span class="ex">dat</span><span class="va">$X22006</span><span class="ex">.0.0</span><span class="kw">)</span><span class="ex">]</span></span>
<span id="cb24-26"><a href="ukbb.html#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">id1,id2</span><span class="kw">)</span> <span class="co"># N = 337,462</span></span>
<span id="cb24-27"><a href="ukbb.html#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> <span class="st">&quot;ukbb-recommend.id&quot;</span>, col.names=F, row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>
</div>
<div id="qc-of-hp3-snps" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> QC of hp3 SNPs</h2>
<p>Here we do QC to 1.2M hapmap3 SNPs for the UKBB recommended individuals.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="ukbb.html#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="ukbb.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QC SNPs-----------------------------------------------------------------------</span></span>
<span id="cb25-3"><a href="ukbb.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stating number of SNPs= 1,184,423</span></span>
<span id="cb25-4"><a href="ukbb.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># note: at this stage, we use all UKBB recommended IDs </span></span>
<span id="cb25-5"><a href="ukbb.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we will do a random selection of IDs later.</span></span>
<span id="cb25-6"><a href="ukbb.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-7"><a href="ukbb.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb25-8"><a href="ukbb.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb25-9"><a href="ukbb.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb25-10"><a href="ukbb.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb25-11"><a href="ukbb.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb25-12"><a href="ukbb.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb25-13"><a href="ukbb.html#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="ukbb.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb25-15"><a href="ukbb.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../ukbb-recommend.id </span><span class="dt">\</span></span>
<span id="cb25-16"><a href="ukbb.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../doug/ukbb.ldsc </span><span class="dt">\</span></span>
<span id="cb25-17"><a href="ukbb.html#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb25-18"><a href="ukbb.html#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb25-19"><a href="ukbb.html#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.8 2 </span><span class="dt">\</span></span>
<span id="cb25-20"><a href="ukbb.html#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb25-21"><a href="ukbb.html#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb25-22"><a href="ukbb.html#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb25-23"><a href="ukbb.html#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb25-24"><a href="ukbb.html#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb25-25"><a href="ukbb.html#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb25-26"><a href="ukbb.html#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="ukbb.html#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb25-28"><a href="ukbb.html#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-29"><a href="ukbb.html#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb25-30"><a href="ukbb.html#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/qc-norm</span>
<span id="cb25-31"><a href="ukbb.html#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="ukbb.html#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files</span></span>
<span id="cb25-33"><a href="ukbb.html#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile-norm.list</span>
<span id="cb25-34"><a href="ukbb.html#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-35"><a href="ukbb.html#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-norm&quot;</span> <span class="op">&gt;&gt;</span>bfile-norm.list</span>
<span id="cb25-36"><a href="ukbb.html#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb25-37"><a href="ukbb.html#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="ukbb.html#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb25-39"><a href="ukbb.html#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb25-40"><a href="ukbb.html#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb25-41"><a href="ukbb.html#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb25-42"><a href="ukbb.html#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb25-43"><a href="ukbb.html#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb25-44"><a href="ukbb.html#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-norm </span><span class="dt">\</span></span>
<span id="cb25-45"><a href="ukbb.html#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile-norm.list </span><span class="dt">\</span></span>
<span id="cb25-46"><a href="ukbb.html#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb25-47"><a href="ukbb.html#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb25-48"><a href="ukbb.html#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-norm.sh</span>
<span id="cb25-49"><a href="ukbb.html#cb25-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-50"><a href="ukbb.html#cb25-50" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb25-51"><a href="ukbb.html#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-norm.sh <span class="op">&gt;</span>../job-records/mbfiles-norm</span>
<span id="cb25-52"><a href="ukbb.html#cb25-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-53"><a href="ukbb.html#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly select 100k individuals </span></span>
<span id="cb25-54"><a href="ukbb.html#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="ex">shuf</span> ukbb-recommend.id <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 100000 <span class="op">&gt;</span> ukbb-recommned-rand.100000</span>
<span id="cb25-55"><a href="ukbb.html#cb25-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-56"><a href="ukbb.html#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="co"># make bfile for these individuals</span></span>
<span id="cb25-57"><a href="ukbb.html#cb25-57" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb25-58"><a href="ukbb.html#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb25-59"><a href="ukbb.html#cb25-59" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb25-60"><a href="ukbb.html#cb25-60" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb25-61"><a href="ukbb.html#cb25-61" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb25-62"><a href="ukbb.html#cb25-62" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb25-63"><a href="ukbb.html#cb25-63" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb25-64"><a href="ukbb.html#cb25-64" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm </span><span class="dt">\</span></span>
<span id="cb25-65"><a href="ukbb.html#cb25-65" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../ukbb-recommned-rand.100000 </span><span class="dt">\</span></span>
<span id="cb25-66"><a href="ukbb.html#cb25-66" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb25-67"><a href="ukbb.html#cb25-67" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb25-68"><a href="ukbb.html#cb25-68" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-norm-100k.sh</span>
<span id="cb25-69"><a href="ukbb.html#cb25-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-70"><a href="ukbb.html#cb25-70" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb25-71"><a href="ukbb.html#cb25-71" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-norm-100k.sh <span class="op">&gt;</span>../job-records/mbfiles-norm-100k</span>
<span id="cb25-72"><a href="ukbb.html#cb25-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-73"><a href="ukbb.html#cb25-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-74"><a href="ukbb.html#cb25-74" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate </span></span>
<span id="cb25-75"><a href="ukbb.html#cb25-75" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> geno-norm-100k.stats <span class="st">&#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> snps-norm-100k.use</span>
<span id="cb25-76"><a href="ukbb.html#cb25-76" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 1,100,799 SNPs</span></span>
<span id="cb25-77"><a href="ukbb.html#cb25-77" aria-hidden="true" tabindex="-1"></a> </span></code></pre></div>
</div>
<div id="gwas-2" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> GWAS</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="ukbb.html#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="ukbb.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression-------------------------------------------------------------</span></span>
<span id="cb26-3"><a href="ukbb.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-norm</span>
<span id="cb26-4"><a href="ukbb.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb26-5"><a href="ukbb.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb26-6"><a href="ukbb.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb26-7"><a href="ukbb.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb26-8"><a href="ukbb.html#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb26-9"><a href="ukbb.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb26-10"><a href="ukbb.html#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb26-11"><a href="ukbb.html#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="ukbb.html#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear ../gwas-norm/</span><span class="va">$i</span><span class="st">-linear </span><span class="dt">\</span></span>
<span id="cb26-13"><a href="ukbb.html#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb26-14"><a href="ukbb.html#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb26-15"><a href="ukbb.html#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../ukbb-recommned-rand.100000 </span><span class="dt">\</span></span>
<span id="cb26-16"><a href="ukbb.html#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb26-17"><a href="ukbb.html#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb26-18"><a href="ukbb.html#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb26-19"><a href="ukbb.html#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb26-20"><a href="ukbb.html#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb26-21"><a href="ukbb.html#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="ukbb.html#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb26-23"><a href="ukbb.html#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb26-24"><a href="ukbb.html#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb26-25"><a href="ukbb.html#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-norm</span>
<span id="cb26-26"><a href="ukbb.html#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="ukbb.html#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb26-28"><a href="ukbb.html#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-norm</span>
<span id="cb26-29"><a href="ukbb.html#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb26-30"><a href="ukbb.html#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb26-31"><a href="ukbb.html#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb26-32"><a href="ukbb.html#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb26-33"><a href="ukbb.html#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb26-34"><a href="ukbb.html#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb26-35"><a href="ukbb.html#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb26-36"><a href="ukbb.html#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb26-37"><a href="ukbb.html#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb26-38"><a href="ukbb.html#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb26-39"><a href="ukbb.html#cb26-39" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb26-40"><a href="ukbb.html#cb26-40" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb26-41"><a href="ukbb.html#cb26-41" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb26-42"><a href="ukbb.html#cb26-42" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb26-43"><a href="ukbb.html#cb26-43" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb26-44"><a href="ukbb.html#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="ldsc-intercept-2" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> ldsc intercept</h2>
<div id="under-gcta-2" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> under gcta</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="ukbb.html#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="ukbb.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb27-3"><a href="ukbb.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># using original ldsc</span></span>
<span id="cb27-4"><a href="ukbb.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb27-5"><a href="ukbb.html#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="ukbb.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># format stats for ldsc--------------------------------------------------------- </span></span>
<span id="cb27-7"><a href="ukbb.html#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb27-8"><a href="ukbb.html#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb27-9"><a href="ukbb.html#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;doug/ukbb.ldsc&quot;</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb27-10"><a href="ukbb.html#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="va">phen</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span><span class="st">&quot;fvc&quot;</span><span class="ex">,</span></span>
<span id="cb27-11"><a href="ukbb.html#cb27-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;height&quot;</span><span class="ex">,</span><span class="st">&quot;imp&quot;</span><span class="ex">,</span><span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span></span>
<span id="cb27-12"><a href="ukbb.html#cb27-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="ex">,</span> <span class="st">&quot;quals&quot;</span><span class="kw">)</span></span>
<span id="cb27-13"><a href="ukbb.html#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="ukbb.html#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in phen<span class="kw">){</span></span>
<span id="cb27-15"><a href="ukbb.html#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="va">stat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-norm/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb27-16"><a href="ukbb.html#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="va">p</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-norm/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.pvalues&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb27-17"><a href="ukbb.html#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> stat<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb27-18"><a href="ukbb.html#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> p<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb27-19"><a href="ukbb.html#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">SNP</span><span class="op">=</span>rs<span class="va">$X2</span>,</span>
<span id="cb27-20"><a href="ukbb.html#cb27-20" aria-hidden="true" tabindex="-1"></a>                 <span class="va">N</span><span class="op">=</span>stat<span class="va">$n</span>[m1],</span>
<span id="cb27-21"><a href="ukbb.html#cb27-21" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Z</span><span class="op">=</span><span class="va">(</span>sqrt<span class="er">(</span>stat<span class="va">$Stat)</span><span class="pp">*</span>stat<span class="va">$Direction</span><span class="kw">)</span><span class="ex">[m1],</span></span>
<span id="cb27-22"><a href="ukbb.html#cb27-22" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A1</span><span class="op">=</span>stat<span class="va">$A1</span>[m1],</span>
<span id="cb27-23"><a href="ukbb.html#cb27-23" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A2</span><span class="op">=</span>stat<span class="va">$A2</span>[m1], </span>
<span id="cb27-24"><a href="ukbb.html#cb27-24" aria-hidden="true" tabindex="-1"></a>                 <span class="va">pval</span><span class="op">=</span>p<span class="va">$P</span>[m2], <span class="va">stringsAsFactors</span><span class="op">=</span>F<span class="er">)</span></span>
<span id="cb27-25"><a href="ukbb.html#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>out[complete.cases<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb27-26"><a href="ukbb.html#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;gwas-norm/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear-rs.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb27-27"><a href="ukbb.html#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb27-28"><a href="ukbb.html#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb27-29"><a href="ukbb.html#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="ukbb.html#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="co"># perform ldsc------------------------------------------------------------------</span></span>
<span id="cb27-31"><a href="ukbb.html#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> out-norm-100k</span>
<span id="cb27-32"><a href="ukbb.html#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-33"><a href="ukbb.html#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb27-34"><a href="ukbb.html#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb27-35"><a href="ukbb.html#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb27-36"><a href="ukbb.html#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb27-37"><a href="ukbb.html#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb27-38"><a href="ukbb.html#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 24:00:0</span></span>
<span id="cb27-39"><a href="ukbb.html#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="ukbb.html#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="st">.././munge_sumstats.py </span><span class="dt">\</span></span>
<span id="cb27-41"><a href="ukbb.html#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="st">--sumstats ../../gwas-norm/</span><span class="va">$i</span><span class="st">-linear-rs.summaries </span><span class="dt">\</span></span>
<span id="cb27-42"><a href="ukbb.html#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-norm-100k/</span><span class="va">$i</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb27-43"><a href="ukbb.html#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="st">--merge-alleles ../w_hm3.snplist</span></span>
<span id="cb27-44"><a href="ukbb.html#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="ukbb.html#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="st">.././ldsc.py </span><span class="dt">\</span></span>
<span id="cb27-46"><a href="ukbb.html#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="st">--h2 ../out-norm-100k/</span><span class="va">$i</span><span class="st">.sumstats.gz </span><span class="dt">\</span></span>
<span id="cb27-47"><a href="ukbb.html#cb27-47" aria-hidden="true" tabindex="-1"></a><span class="st">--ref-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb27-48"><a href="ukbb.html#cb27-48" aria-hidden="true" tabindex="-1"></a><span class="st">--w-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb27-49"><a href="ukbb.html#cb27-49" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-norm-100k/</span><span class="va">$i</span><span class="st">-ldsc</span></span>
<span id="cb27-50"><a href="ukbb.html#cb27-50" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/ldsc-<span class="va">$i</span>-norm-100k.sh</span>
<span id="cb27-51"><a href="ukbb.html#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb27-52"><a href="ukbb.html#cb27-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-53"><a href="ukbb.html#cb27-53" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb27-54"><a href="ukbb.html#cb27-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper</span><span class="op">,</span><span class="dt">quals}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-55"><a href="ukbb.html#cb27-55" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldsc-<span class="va">$i</span>-norm-100k.sh</span>
<span id="cb27-56"><a href="ukbb.html#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../../job-records/ldsc-norm-100k</span>
<span id="cb27-57"><a href="ukbb.html#cb27-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-58"><a href="ukbb.html#cb27-58" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb27-59"><a href="ukbb.html#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="co"># using sumher</span></span>
<span id="cb27-60"><a href="ukbb.html#cb27-60" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb27-61"><a href="ukbb.html#cb27-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-62"><a href="ukbb.html#cb27-62" aria-hidden="true" tabindex="-1"></a><span class="co"># insert genetic distance into bim file-----------------------------------------</span></span>
<span id="cb27-63"><a href="ukbb.html#cb27-63" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> geno-norm-100k.fam <span class="op">&gt;</span> small-norm</span>
<span id="cb27-64"><a href="ukbb.html#cb27-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-65"><a href="ukbb.html#cb27-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-66"><a href="ukbb.html#cb27-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb27-67"><a href="ukbb.html#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb27-68"><a href="ukbb.html#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb27-69"><a href="ukbb.html#cb27-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 3:00:0</span></span>
<span id="cb27-70"><a href="ukbb.html#cb27-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb27-71"><a href="ukbb.html#cb27-71" aria-hidden="true" tabindex="-1"></a><span class="st">./plink1.9 --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb27-72"><a href="ukbb.html#cb27-72" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb27-73"><a href="ukbb.html#cb27-73" aria-hidden="true" tabindex="-1"></a><span class="st">          --cm-map /home/zhoux/snpher/faststorage/genetic_maps/genetic_map_chr@_combined_b37.txt </span><span class="dt">\</span></span>
<span id="cb27-74"><a href="ukbb.html#cb27-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --make-bed </span><span class="dt">\</span></span>
<span id="cb27-75"><a href="ukbb.html#cb27-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --out new</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb27-76"><a href="ukbb.html#cb27-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../gen/small-norm</span></span>
<span id="cb27-77"><a href="ukbb.html#cb27-77" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/map<span class="va">$j</span></span>
<span id="cb27-78"><a href="ukbb.html#cb27-78" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb27-79"><a href="ukbb.html#cb27-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-80"><a href="ukbb.html#cb27-80" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-81"><a href="ukbb.html#cb27-81" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/map<span class="va">$j</span></span>
<span id="cb27-82"><a href="ukbb.html#cb27-82" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> genetic-distance-hapmap3</span>
<span id="cb27-83"><a href="ukbb.html#cb27-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-84"><a href="ukbb.html#cb27-84" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /home/zhoux/dsmwpred/xuan/quality-control/qc-10oct/gen</span>
<span id="cb27-85"><a href="ukbb.html#cb27-85" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> new<span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span>.bim <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $2, $3}&#39;</span> <span class="op">&gt;</span> maps-hapmap3-norm-100k.txt</span>
<span id="cb27-86"><a href="ukbb.html#cb27-86" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> new<span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span>.<span class="dt">{bim</span><span class="op">,</span><span class="dt">bed</span><span class="op">,</span><span class="dt">fam</span><span class="op">,</span><span class="dt">log}</span></span>
<span id="cb27-87"><a href="ukbb.html#cb27-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-88"><a href="ukbb.html#cb27-88" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){arr[$1]=$2;next}{print $1, $2, arr[$2], $4, $5, $6}&#39;</span> <span class="op">&gt;</span> geno-norm-100k.bim2 maps-hapmap3-norm-100k.txt geno-norm-100k.bim</span>
<span id="cb27-89"><a href="ukbb.html#cb27-89" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-norm-100k.bim geno-norm-100k.bim0</span>
<span id="cb27-90"><a href="ukbb.html#cb27-90" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-norm-100k.bim2 geno-norm-100k.bim</span>
<span id="cb27-91"><a href="ukbb.html#cb27-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-92"><a href="ukbb.html#cb27-92" aria-hidden="true" tabindex="-1"></a><span class="co"># compute tagging under gcta----------------------------------------------------</span></span>
<span id="cb27-93"><a href="ukbb.html#cb27-93" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> tagging-norm-100k</span>
<span id="cb27-94"><a href="ukbb.html#cb27-94" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-95"><a href="ukbb.html#cb27-95" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb27-96"><a href="ukbb.html#cb27-96" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb27-97"><a href="ukbb.html#cb27-97" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb27-98"><a href="ukbb.html#cb27-98" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb27-99"><a href="ukbb.html#cb27-99" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb27-100"><a href="ukbb.html#cb27-100" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb27-101"><a href="ukbb.html#cb27-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-102"><a href="ukbb.html#cb27-102" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../tagging-norm-100k/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb27-103"><a href="ukbb.html#cb27-103" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb27-104"><a href="ukbb.html#cb27-104" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb27-105"><a href="ukbb.html#cb27-105" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb27-106"><a href="ukbb.html#cb27-106" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb27-107"><a href="ukbb.html#cb27-107" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb27-108"><a href="ukbb.html#cb27-108" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span></span>
<span id="cb27-109"><a href="ukbb.html#cb27-109" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb27-110"><a href="ukbb.html#cb27-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-111"><a href="ukbb.html#cb27-111" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-112"><a href="ukbb.html#cb27-112" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span> </span>
<span id="cb27-113"><a href="ukbb.html#cb27-113" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-gcta-hapmap3-norm-100k</span>
<span id="cb27-114"><a href="ukbb.html#cb27-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-115"><a href="ukbb.html#cb27-115" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb27-116"><a href="ukbb.html#cb27-116" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-gcta-hapmap3-norm-100k</span>
<span id="cb27-117"><a href="ukbb.html#cb27-117" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb27-118"><a href="ukbb.html#cb27-118" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb27-119"><a href="ukbb.html#cb27-119" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-120"><a href="ukbb.html#cb27-120" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb27-121"><a href="ukbb.html#cb27-121" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb27-122"><a href="ukbb.html#cb27-122" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb27-123"><a href="ukbb.html#cb27-123" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb27-124"><a href="ukbb.html#cb27-124" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb27-125"><a href="ukbb.html#cb27-125" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb27-126"><a href="ukbb.html#cb27-126" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb27-127"><a href="ukbb.html#cb27-127" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb27-128"><a href="ukbb.html#cb27-128" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb27-129"><a href="ukbb.html#cb27-129" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb27-130"><a href="ukbb.html#cb27-130" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb27-131"><a href="ukbb.html#cb27-131" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb27-132"><a href="ukbb.html#cb27-132" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb27-133"><a href="ukbb.html#cb27-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-134"><a href="ukbb.html#cb27-134" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb27-135"><a href="ukbb.html#cb27-135" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb27-136"><a href="ukbb.html#cb27-136" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb27-137"><a href="ukbb.html#cb27-137" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-norm-100k/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb27-138"><a href="ukbb.html#cb27-138" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb27-139"><a href="ukbb.html#cb27-139" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> tagging-norm-100k/gcta-hapmap3 <span class="at">--taglist</span> list.txt</span>
<span id="cb27-140"><a href="ukbb.html#cb27-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-141"><a href="ukbb.html#cb27-141" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb27-142"><a href="ukbb.html#cb27-142" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> sumher-norm-100k</span>
<span id="cb27-143"><a href="ukbb.html#cb27-143" aria-hidden="true" tabindex="-1"></a><span class="va">dirin1</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb27-144"><a href="ukbb.html#cb27-144" aria-hidden="true" tabindex="-1"></a><span class="va">dirin2</span><span class="op">=</span>gwas-norm</span>
<span id="cb27-145"><a href="ukbb.html#cb27-145" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>sumher-norm-100k</span>
<span id="cb27-146"><a href="ukbb.html#cb27-146" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-147"><a href="ukbb.html#cb27-147" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb27-148"><a href="ukbb.html#cb27-148" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb27-149"><a href="ukbb.html#cb27-149" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb27-150"><a href="ukbb.html#cb27-150" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb27-151"><a href="ukbb.html#cb27-151" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb27-152"><a href="ukbb.html#cb27-152" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb27-153"><a href="ukbb.html#cb27-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-154"><a href="ukbb.html#cb27-154" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-sumher-gcta </span><span class="dt">\</span></span>
<span id="cb27-155"><a href="ukbb.html#cb27-155" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../</span><span class="va">$dirin1</span><span class="st">/gcta-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb27-156"><a href="ukbb.html#cb27-156" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../</span><span class="va">$dirin2</span><span class="st">/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb27-157"><a href="ukbb.html#cb27-157" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb27-158"><a href="ukbb.html#cb27-158" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb27-159"><a href="ukbb.html#cb27-159" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-gcta</span>
<span id="cb27-160"><a href="ukbb.html#cb27-160" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb27-161"><a href="ukbb.html#cb27-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-162"><a href="ukbb.html#cb27-162" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-163"><a href="ukbb.html#cb27-163" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-gcta</span>
<span id="cb27-164"><a href="ukbb.html#cb27-164" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-gcta-norm-100k</span></code></pre></div>
</div>
<div id="under-ldak-thin-2" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> under ldak-thin</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="ukbb.html#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="ukbb.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get weights-------------------------------------------------------------------</span></span>
<span id="cb28-3"><a href="ukbb.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> ldak-thin/ldak-thin-norm.in <span class="st">&#39;{print $1, 1}&#39;</span> <span class="op">&gt;</span> ldak-thin/weights.ldak-thin-norm</span>
<span id="cb28-4"><a href="ukbb.html#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="ukbb.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate tagging under ldak-thin---------------------------------------------</span></span>
<span id="cb28-6"><a href="ukbb.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb28-7"><a href="ukbb.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="va">filein1</span><span class="op">=</span>geno-norm-100k</span>
<span id="cb28-8"><a href="ukbb.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="va">filein2</span><span class="op">=</span>weights.ldak-thin-norm</span>
<span id="cb28-9"><a href="ukbb.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb28-10"><a href="ukbb.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb28-11"><a href="ukbb.html#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb28-12"><a href="ukbb.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 40G</span></span>
<span id="cb28-13"><a href="ukbb.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb28-14"><a href="ukbb.html#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb28-15"><a href="ukbb.html#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb28-16"><a href="ukbb.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../</span><span class="va">$dirout</span><span class="st">/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb28-17"><a href="ukbb.html#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein1</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb28-18"><a href="ukbb.html#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --weights ../ldak-thin/</span><span class="va">$filein2</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb28-19"><a href="ukbb.html#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -.25 </span><span class="dt">\</span></span>
<span id="cb28-20"><a href="ukbb.html#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb28-21"><a href="ukbb.html#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb28-22"><a href="ukbb.html#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --save-matrix YES </span><span class="dt">\</span></span>
<span id="cb28-23"><a href="ukbb.html#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb28-24"><a href="ukbb.html#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb28-25"><a href="ukbb.html#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb28-26"><a href="ukbb.html#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="ukbb.html#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co"># submit scripts</span></span>
<span id="cb28-28"><a href="ukbb.html#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb28-29"><a href="ukbb.html#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb28-30"><a href="ukbb.html#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-ldak-thin-norm-100k</span>
<span id="cb28-31"><a href="ukbb.html#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="ukbb.html#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb28-33"><a href="ukbb.html#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-ldak-thin-norm-100k</span>
<span id="cb28-34"><a href="ukbb.html#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb28-35"><a href="ukbb.html#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb28-36"><a href="ukbb.html#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb28-37"><a href="ukbb.html#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb28-38"><a href="ukbb.html#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb28-39"><a href="ukbb.html#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb28-40"><a href="ukbb.html#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb28-41"><a href="ukbb.html#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb28-42"><a href="ukbb.html#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb28-43"><a href="ukbb.html#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb28-44"><a href="ukbb.html#cb28-44" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb28-45"><a href="ukbb.html#cb28-45" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb28-46"><a href="ukbb.html#cb28-46" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb28-47"><a href="ukbb.html#cb28-47" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb28-48"><a href="ukbb.html#cb28-48" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb28-49"><a href="ukbb.html#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb28-50"><a href="ukbb.html#cb28-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-51"><a href="ukbb.html#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb28-52"><a href="ukbb.html#cb28-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb28-53"><a href="ukbb.html#cb28-53" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> matlist.txt</span>
<span id="cb28-54"><a href="ukbb.html#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb28-55"><a href="ukbb.html#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-norm-100k/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb28-56"><a href="ukbb.html#cb28-56" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-norm-100k/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.matrix&quot;</span> <span class="op">&gt;&gt;</span> matlist.txt</span>
<span id="cb28-57"><a href="ukbb.html#cb28-57" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb28-58"><a href="ukbb.html#cb28-58" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb28-59"><a href="ukbb.html#cb28-59" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> <span class="va">$dirout</span>/ldak-thin-hapmap3 <span class="at">--taglist</span> list.txt <span class="at">--matlist</span> matlist.txt</span>
<span id="cb28-60"><a href="ukbb.html#cb28-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-61"><a href="ukbb.html#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb28-62"><a href="ukbb.html#cb28-62" aria-hidden="true" tabindex="-1"></a><span class="va">dirin1</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb28-63"><a href="ukbb.html#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="va">dirin2</span><span class="op">=</span>gwas-norm</span>
<span id="cb28-64"><a href="ukbb.html#cb28-64" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>sumher-norm-100k</span>
<span id="cb28-65"><a href="ukbb.html#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb28-66"><a href="ukbb.html#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb28-67"><a href="ukbb.html#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb28-68"><a href="ukbb.html#cb28-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb28-69"><a href="ukbb.html#cb28-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb28-70"><a href="ukbb.html#cb28-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb28-71"><a href="ukbb.html#cb28-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb28-72"><a href="ukbb.html#cb28-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-73"><a href="ukbb.html#cb28-73" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-sumher-ldak-thin </span><span class="dt">\</span></span>
<span id="cb28-74"><a href="ukbb.html#cb28-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../</span><span class="va">$dirin1</span><span class="st">/ldak-thin-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb28-75"><a href="ukbb.html#cb28-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../</span><span class="va">$dirin2</span><span class="st">/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb28-76"><a href="ukbb.html#cb28-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb28-77"><a href="ukbb.html#cb28-77" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb28-78"><a href="ukbb.html#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-ldak-thin</span>
<span id="cb28-79"><a href="ukbb.html#cb28-79" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb28-80"><a href="ukbb.html#cb28-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-81"><a href="ukbb.html#cb28-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb28-82"><a href="ukbb.html#cb28-82" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-ldak-thin</span>
<span id="cb28-83"><a href="ukbb.html#cb28-83" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-ldak-thin-norm-100k</span></code></pre></div>
</div>
<div id="summary-4" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> summary</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="ukbb.html#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="ukbb.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># original ldsc</span></span>
<span id="cb29-3"><a href="ukbb.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept <span class="pp">*</span>ldsc.log <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[-]/); split($3, b, /[()]/); print a[1], $2, b[2]}&#39;</span> <span class="op">&gt;</span> ../../summary/ldsc-norm-100k</span>
<span id="cb29-4"><a href="ukbb.html#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="ukbb.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sumher under gcta</span></span>
<span id="cb29-6"><a href="ukbb.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-norm-100k-est</span>
<span id="cb29-7"><a href="ukbb.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-norm-100k-sd</span>
<span id="cb29-8"><a href="ukbb.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb29-9"><a href="ukbb.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-gcta-norm-100k-est sumher-gcta-norm-100k-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-gcta-norm-100k</span>
<span id="cb29-10"><a href="ukbb.html#cb29-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-11"><a href="ukbb.html#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># suhmer under ldak-thin</span></span>
<span id="cb29-12"><a href="ukbb.html#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-norm-100k-est</span>
<span id="cb29-13"><a href="ukbb.html#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-norm-100k-sd</span>
<span id="cb29-14"><a href="ukbb.html#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb29-15"><a href="ukbb.html#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-ldak-thin-norm-100k-est sumher-ldak-thin-norm-100k-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-ldak-thin-norm-100k</span></code></pre></div>
</div>
</div>
<div id="he-2" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> HE</h2>
<div id="making-grms-2" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> making grms</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="ukbb.html#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="ukbb.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># making grm -------------------------------------------------------------------</span></span>
<span id="cb30-3"><a href="ukbb.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="ukbb.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb30-5"><a href="ukbb.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb30-6"><a href="ukbb.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb30-7"><a href="ukbb.html#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="ukbb.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># all snps</span></span>
<span id="cb30-9"><a href="ukbb.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb30-10"><a href="ukbb.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb30-11"><a href="ukbb.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb30-12"><a href="ukbb.html#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb30-13"><a href="ukbb.html#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb30-14"><a href="ukbb.html#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb30-15"><a href="ukbb.html#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="ukbb.html#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb30-17"><a href="ukbb.html#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/gcta-all-norm </span><span class="dt">\</span></span>
<span id="cb30-18"><a href="ukbb.html#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb30-19"><a href="ukbb.html#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb30-20"><a href="ukbb.html#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb30-21"><a href="ukbb.html#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb30-22"><a href="ukbb.html#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb30-23"><a href="ukbb.html#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-all-snps-norm</span>
<span id="cb30-24"><a href="ukbb.html#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="ukbb.html#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-all-snps-norm <span class="op">&gt;</span> ../job-records/grm-all-snps-norm</span>
<span id="cb30-26"><a href="ukbb.html#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="ukbb.html#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb30-28"><a href="ukbb.html#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&lt;8 {print $2}&#39;</span> geno-norm-100k.bim <span class="op">&gt;</span> left-snps-norm-100k.use </span>
<span id="cb30-29"><a href="ukbb.html#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&gt;=8 {print $2}&#39;</span> geno-norm-100k.bim <span class="op">&gt;</span> right-snps-norm-100k.use</span>
<span id="cb30-30"><a href="ukbb.html#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="ukbb.html#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-32"><a href="ukbb.html#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb30-33"><a href="ukbb.html#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb30-34"><a href="ukbb.html#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb30-35"><a href="ukbb.html#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb30-36"><a href="ukbb.html#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb30-37"><a href="ukbb.html#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb30-38"><a href="ukbb.html#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="ukbb.html#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb30-40"><a href="ukbb.html#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/gcta-</span><span class="va">$i</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb30-41"><a href="ukbb.html#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb30-42"><a href="ukbb.html#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb30-43"><a href="ukbb.html#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb30-44"><a href="ukbb.html#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb30-45"><a href="ukbb.html#cb30-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb30-46"><a href="ukbb.html#cb30-46" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-gcta-<span class="va">$i</span>-norm</span>
<span id="cb30-47"><a href="ukbb.html#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb30-48"><a href="ukbb.html#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="ukbb.html#cb30-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-50"><a href="ukbb.html#cb30-50" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-gcta-<span class="va">$i</span>-norm </span>
<span id="cb30-51"><a href="ukbb.html#cb30-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-gcta-by-snps-norm </span>
<span id="cb30-52"><a href="ukbb.html#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="ukbb.html#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb30-54"><a href="ukbb.html#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb30-55"><a href="ukbb.html#cb30-55" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb30-56"><a href="ukbb.html#cb30-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-57"><a href="ukbb.html#cb30-57" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb30-58"><a href="ukbb.html#cb30-58" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. thin snps</span></span>
<span id="cb30-59"><a href="ukbb.html#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb30-60"><a href="ukbb.html#cb30-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-61"><a href="ukbb.html#cb30-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-62"><a href="ukbb.html#cb30-62" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb30-63"><a href="ukbb.html#cb30-63" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb30-64"><a href="ukbb.html#cb30-64" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb30-65"><a href="ukbb.html#cb30-65" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 4</span></span>
<span id="cb30-66"><a href="ukbb.html#cb30-66" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 4:0:0</span></span>
<span id="cb30-67"><a href="ukbb.html#cb30-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb30-68"><a href="ukbb.html#cb30-68" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 4 </span><span class="dt">\</span></span>
<span id="cb30-69"><a href="ukbb.html#cb30-69" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-prune 0.98 </span><span class="dt">\</span></span>
<span id="cb30-70"><a href="ukbb.html#cb30-70" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-kb 100 </span><span class="dt">\</span></span>
<span id="cb30-71"><a href="ukbb.html#cb30-71" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb30-72"><a href="ukbb.html#cb30-72" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb30-73"><a href="ukbb.html#cb30-73" aria-hidden="true" tabindex="-1"></a><span class="st">          --thin ../ldak-thin/chr</span><span class="va">$j</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb30-74"><a href="ukbb.html#cb30-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb30-75"><a href="ukbb.html#cb30-75" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin<span class="va">$j</span>-norm</span>
<span id="cb30-76"><a href="ukbb.html#cb30-76" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb30-77"><a href="ukbb.html#cb30-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-78"><a href="ukbb.html#cb30-78" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb30-79"><a href="ukbb.html#cb30-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-80"><a href="ukbb.html#cb30-80" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin<span class="va">$j</span>-norm</span>
<span id="cb30-81"><a href="ukbb.html#cb30-81" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/ldak-thin-norm</span>
<span id="cb30-82"><a href="ukbb.html#cb30-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-83"><a href="ukbb.html#cb30-83" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion---</span></span>
<span id="cb30-84"><a href="ukbb.html#cb30-84" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/ldak-thin-norm</span>
<span id="cb30-85"><a href="ukbb.html#cb30-85" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb30-86"><a href="ukbb.html#cb30-86" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb30-87"><a href="ukbb.html#cb30-87" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-88"><a href="ukbb.html#cb30-88" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb30-89"><a href="ukbb.html#cb30-89" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb30-90"><a href="ukbb.html#cb30-90" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb30-91"><a href="ukbb.html#cb30-91" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb30-92"><a href="ukbb.html#cb30-92" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb30-93"><a href="ukbb.html#cb30-93" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb30-94"><a href="ukbb.html#cb30-94" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb30-95"><a href="ukbb.html#cb30-95" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb30-96"><a href="ukbb.html#cb30-96" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb30-97"><a href="ukbb.html#cb30-97" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb30-98"><a href="ukbb.html#cb30-98" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb30-99"><a href="ukbb.html#cb30-99" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb30-100"><a href="ukbb.html#cb30-100" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb30-101"><a href="ukbb.html#cb30-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-102"><a href="ukbb.html#cb30-102" aria-hidden="true" tabindex="-1"></a><span class="co"># combine snp list</span></span>
<span id="cb30-103"><a href="ukbb.html#cb30-103" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> ldak-thin/chr{1..22}-norm.in <span class="op">&gt;</span> ldak-thin/ldak-thin-norm.in</span>
<span id="cb30-104"><a href="ukbb.html#cb30-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-105"><a href="ukbb.html#cb30-105" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------</span></span>
<span id="cb30-106"><a href="ukbb.html#cb30-106" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. kinship matrix under ldak-thin</span></span>
<span id="cb30-107"><a href="ukbb.html#cb30-107" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------</span></span>
<span id="cb30-108"><a href="ukbb.html#cb30-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-109"><a href="ukbb.html#cb30-109" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb30-110"><a href="ukbb.html#cb30-110" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb30-111"><a href="ukbb.html#cb30-111" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb30-112"><a href="ukbb.html#cb30-112" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb30-113"><a href="ukbb.html#cb30-113" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb30-114"><a href="ukbb.html#cb30-114" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb30-115"><a href="ukbb.html#cb30-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-116"><a href="ukbb.html#cb30-116" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb30-117"><a href="ukbb.html#cb30-117" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/ldak-thin-all-norm </span><span class="dt">\</span></span>
<span id="cb30-118"><a href="ukbb.html#cb30-118" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb30-119"><a href="ukbb.html#cb30-119" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../ldak-thin/ldak-thin-norm.in </span><span class="dt">\</span></span>
<span id="cb30-120"><a href="ukbb.html#cb30-120" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb30-121"><a href="ukbb.html#cb30-121" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb30-122"><a href="ukbb.html#cb30-122" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb30-123"><a href="ukbb.html#cb30-123" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-all-snps-norm</span>
<span id="cb30-124"><a href="ukbb.html#cb30-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-125"><a href="ukbb.html#cb30-125" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-all-snps-norm <span class="op">&gt;</span> ../job-records/ldak-thin-grm-all-snps-norm</span>
<span id="cb30-126"><a href="ukbb.html#cb30-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-127"><a href="ukbb.html#cb30-127" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb30-128"><a href="ukbb.html#cb30-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-129"><a href="ukbb.html#cb30-129" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&lt;8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb30-130"><a href="ukbb.html#cb30-130" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-norm.in <span class="op">&gt;</span> gen/left-ldak-thin-norm.snps </span>
<span id="cb30-131"><a href="ukbb.html#cb30-131" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&gt;=8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb30-132"><a href="ukbb.html#cb30-132" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-norm.in <span class="op">&gt;</span> gen/right-ldak-thin-norm.snps </span>
<span id="cb30-133"><a href="ukbb.html#cb30-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-134"><a href="ukbb.html#cb30-134" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-135"><a href="ukbb.html#cb30-135" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb30-136"><a href="ukbb.html#cb30-136" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb30-137"><a href="ukbb.html#cb30-137" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb30-138"><a href="ukbb.html#cb30-138" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb30-139"><a href="ukbb.html#cb30-139" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb30-140"><a href="ukbb.html#cb30-140" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb30-141"><a href="ukbb.html#cb30-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-142"><a href="ukbb.html#cb30-142" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb30-143"><a href="ukbb.html#cb30-143" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/ldak-thin-</span><span class="va">$i</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb30-144"><a href="ukbb.html#cb30-144" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb30-145"><a href="ukbb.html#cb30-145" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-ldak-thin-norm.snps </span><span class="dt">\</span></span>
<span id="cb30-146"><a href="ukbb.html#cb30-146" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb30-147"><a href="ukbb.html#cb30-147" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb30-148"><a href="ukbb.html#cb30-148" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb30-149"><a href="ukbb.html#cb30-149" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-<span class="va">$i</span>-norm</span>
<span id="cb30-150"><a href="ukbb.html#cb30-150" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb30-151"><a href="ukbb.html#cb30-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-152"><a href="ukbb.html#cb30-152" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb30-153"><a href="ukbb.html#cb30-153" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-<span class="va">$i</span>-norm </span>
<span id="cb30-154"><a href="ukbb.html#cb30-154" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-ldak-thin-by-snps-norm </span></code></pre></div>
</div>
<div id="estimation-2" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> estimation</h3>
<p>NEED To check what covariates to adjust for HE
basic.covariates.use or covariates.use?</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="ukbb.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regress grm on covariates-----------------------------------------------------</span></span>
<span id="cb31-2"><a href="ukbb.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="ukbb.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-norm gcta-left-norm gcta-right-norm ldak-thin-all-norm ldak-thin-left-norm ldak-thin-right-norm<span class="kw">;</span> <span class="cf">do</span>  </span>
<span id="cb31-4"><a href="ukbb.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb31-5"><a href="ukbb.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb31-6"><a href="ukbb.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb31-7"><a href="ukbb.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 50G</span></span>
<span id="cb31-8"><a href="ukbb.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb31-9"><a href="ukbb.html#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb31-10"><a href="ukbb.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --adjust-grm ../kinship/</span><span class="va">$grm</span><span class="st">.covar </span><span class="dt">\</span></span>
<span id="cb31-11"><a href="ukbb.html#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/</span><span class="va">$grm</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-12"><a href="ukbb.html#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb31-13"><a href="ukbb.html#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb31-14"><a href="ukbb.html#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb31-15"><a href="ukbb.html#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-16"><a href="ukbb.html#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="ukbb.html#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb31-18"><a href="ukbb.html#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-norm gcta-left-norm gcta-right-norm ldak-thin-all-norm ldak-thin-left-norm ldak-thin-right-norm<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-19"><a href="ukbb.html#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb31-20"><a href="ukbb.html#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-adjust-for-HE</span>
<span id="cb31-21"><a href="ukbb.html#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="ukbb.html#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb31-23"><a href="ukbb.html#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/grm-adjust-for-HE</span>
<span id="cb31-24"><a href="ukbb.html#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb31-25"><a href="ukbb.html#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb31-26"><a href="ukbb.html#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-27"><a href="ukbb.html#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb31-28"><a href="ukbb.html#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb31-29"><a href="ukbb.html#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb31-30"><a href="ukbb.html#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb31-31"><a href="ukbb.html#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb31-32"><a href="ukbb.html#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-33"><a href="ukbb.html#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb31-34"><a href="ukbb.html#cb31-34" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb31-35"><a href="ukbb.html#cb31-35" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb31-36"><a href="ukbb.html#cb31-36" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb31-37"><a href="ukbb.html#cb31-37" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb31-38"><a href="ukbb.html#cb31-38" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb31-39"><a href="ukbb.html#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb31-40"><a href="ukbb.html#cb31-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-41"><a href="ukbb.html#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under gcta-----------------------------------------------------------------</span></span>
<span id="cb31-42"><a href="ukbb.html#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-43"><a href="ukbb.html#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-44"><a href="ukbb.html#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb31-45"><a href="ukbb.html#cb31-45" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb31-46"><a href="ukbb.html#cb31-46" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb31-47"><a href="ukbb.html#cb31-47" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb31-48"><a href="ukbb.html#cb31-48" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb31-49"><a href="ukbb.html#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb31-50"><a href="ukbb.html#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="ukbb.html#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../he-norm/</span><span class="va">$i</span><span class="st">-he-gcta-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-52"><a href="ukbb.html#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb31-53"><a href="ukbb.html#cb31-53" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/gcta-</span><span class="va">$k</span><span class="st">-norm.covar </span><span class="dt">\</span></span>
<span id="cb31-54"><a href="ukbb.html#cb31-54" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb31-55"><a href="ukbb.html#cb31-55" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb31-56"><a href="ukbb.html#cb31-56" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb31-57"><a href="ukbb.html#cb31-57" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb31-58"><a href="ukbb.html#cb31-58" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb31-59"><a href="ukbb.html#cb31-59" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps-norm.sh</span>
<span id="cb31-60"><a href="ukbb.html#cb31-60" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-61"><a href="ukbb.html#cb31-61" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-62"><a href="ukbb.html#cb31-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-63"><a href="ukbb.html#cb31-63" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb31-64"><a href="ukbb.html#cb31-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-65"><a href="ukbb.html#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-66"><a href="ukbb.html#cb31-66" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps-norm.sh</span>
<span id="cb31-67"><a href="ukbb.html#cb31-67" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-68"><a href="ukbb.html#cb31-68" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-gcta</span>
<span id="cb31-69"><a href="ukbb.html#cb31-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-70"><a href="ukbb.html#cb31-70" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under ldak-thin------------------------------------------------------------</span></span>
<span id="cb31-71"><a href="ukbb.html#cb31-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-72"><a href="ukbb.html#cb31-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-73"><a href="ukbb.html#cb31-73" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb31-74"><a href="ukbb.html#cb31-74" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb31-75"><a href="ukbb.html#cb31-75" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb31-76"><a href="ukbb.html#cb31-76" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb31-77"><a href="ukbb.html#cb31-77" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb31-78"><a href="ukbb.html#cb31-78" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 0:30:0</span></span>
<span id="cb31-79"><a href="ukbb.html#cb31-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-80"><a href="ukbb.html#cb31-80" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../he-norm/</span><span class="va">$i</span><span class="st">-he-ldak-thin-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb31-81"><a href="ukbb.html#cb31-81" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb31-82"><a href="ukbb.html#cb31-82" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/ldak-thin-</span><span class="va">$k</span><span class="st">-norm.covar </span><span class="dt">\</span></span>
<span id="cb31-83"><a href="ukbb.html#cb31-83" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb31-84"><a href="ukbb.html#cb31-84" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb31-85"><a href="ukbb.html#cb31-85" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb31-86"><a href="ukbb.html#cb31-86" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb31-87"><a href="ukbb.html#cb31-87" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb31-88"><a href="ukbb.html#cb31-88" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-norm.sh</span>
<span id="cb31-89"><a href="ukbb.html#cb31-89" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-90"><a href="ukbb.html#cb31-90" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-91"><a href="ukbb.html#cb31-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-92"><a href="ukbb.html#cb31-92" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb31-93"><a href="ukbb.html#cb31-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-94"><a href="ukbb.html#cb31-94" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb31-95"><a href="ukbb.html#cb31-95" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-norm.sh</span>
<span id="cb31-96"><a href="ukbb.html#cb31-96" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb31-97"><a href="ukbb.html#cb31-97" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-ldak-thin</span></code></pre></div>
</div>
<div id="summary-5" class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> summary</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="ukbb.html#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="ukbb.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb32-3"><a href="ukbb.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb32-4"><a href="ukbb.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb32-5"><a href="ukbb.html#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="ukbb.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb32-7"><a href="ukbb.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb32-8"><a href="ukbb.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-norm.right </span>
<span id="cb32-9"><a href="ukbb.html#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb32-10"><a href="ukbb.html#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-right.he</span>
<span id="cb32-11"><a href="ukbb.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-norm.right</span>
<span id="cb32-12"><a href="ukbb.html#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb32-13"><a href="ukbb.html#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="ukbb.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb32-15"><a href="ukbb.html#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-norm.left</span>
<span id="cb32-16"><a href="ukbb.html#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb32-17"><a href="ukbb.html#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-left.he</span>
<span id="cb32-18"><a href="ukbb.html#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-norm.left</span>
<span id="cb32-19"><a href="ukbb.html#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb32-20"><a href="ukbb.html#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="ukbb.html#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb32-22"><a href="ukbb.html#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-norm.all</span>
<span id="cb32-23"><a href="ukbb.html#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb32-24"><a href="ukbb.html#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb32-25"><a href="ukbb.html#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-norm.all</span>
<span id="cb32-26"><a href="ukbb.html#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb32-27"><a href="ukbb.html#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="ukbb.html#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb32-29"><a href="ukbb.html#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb32-30"><a href="ukbb.html#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="ukbb.html#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-norm.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb32-32"><a href="ukbb.html#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-norm.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb32-33"><a href="ukbb.html#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-norm.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb32-34"><a href="ukbb.html#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb32-35"><a href="ukbb.html#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb32-36"><a href="ukbb.html#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb32-37"><a href="ukbb.html#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-38"><a href="ukbb.html#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-39"><a href="ukbb.html#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-40"><a href="ukbb.html#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-41"><a href="ukbb.html#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-42"><a href="ukbb.html#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb32-43"><a href="ukbb.html#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb32-44"><a href="ukbb.html#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb32-45"><a href="ukbb.html#cb32-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-46"><a href="ukbb.html#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb32-47"><a href="ukbb.html#cb32-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-48"><a href="ukbb.html#cb32-48" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb32-49"><a href="ukbb.html#cb32-49" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb32-50"><a href="ukbb.html#cb32-50" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb32-51"><a href="ukbb.html#cb32-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb32-52"><a href="ukbb.html#cb32-52" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb32-53"><a href="ukbb.html#cb32-53" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb32-54"><a href="ukbb.html#cb32-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb32-55"><a href="ukbb.html#cb32-55" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb32-56"><a href="ukbb.html#cb32-56" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb32-57"><a href="ukbb.html#cb32-57" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb32-58"><a href="ukbb.html#cb32-58" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb32-59"><a href="ukbb.html#cb32-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-60"><a href="ukbb.html#cb32-60" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb32-61"><a href="ukbb.html#cb32-61" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb32-62"><a href="ukbb.html#cb32-62" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb32-63"><a href="ukbb.html#cb32-63" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb32-64"><a href="ukbb.html#cb32-64" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb32-65"><a href="ukbb.html#cb32-65" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb32-66"><a href="ukbb.html#cb32-66" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb32-67"><a href="ukbb.html#cb32-67" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb32-68"><a href="ukbb.html#cb32-68" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb32-69"><a href="ukbb.html#cb32-69" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb32-70"><a href="ukbb.html#cb32-70" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-gcta-inflation-norm.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb32-71"><a href="ukbb.html#cb32-71" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb32-72"><a href="ukbb.html#cb32-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-73"><a href="ukbb.html#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="ukbb.html#cb32-74" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb32-75"><a href="ukbb.html#cb32-75" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb32-76"><a href="ukbb.html#cb32-76" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb32-77"><a href="ukbb.html#cb32-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-78"><a href="ukbb.html#cb32-78" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb32-79"><a href="ukbb.html#cb32-79" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb32-80"><a href="ukbb.html#cb32-80" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-norm.right </span>
<span id="cb32-81"><a href="ukbb.html#cb32-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb32-82"><a href="ukbb.html#cb32-82" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-ldak-thin-right.he</span>
<span id="cb32-83"><a href="ukbb.html#cb32-83" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-norm.right</span>
<span id="cb32-84"><a href="ukbb.html#cb32-84" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb32-85"><a href="ukbb.html#cb32-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-86"><a href="ukbb.html#cb32-86" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb32-87"><a href="ukbb.html#cb32-87" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-norm.left</span>
<span id="cb32-88"><a href="ukbb.html#cb32-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb32-89"><a href="ukbb.html#cb32-89" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-ldak-thin-left.he</span>
<span id="cb32-90"><a href="ukbb.html#cb32-90" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-norm.left</span>
<span id="cb32-91"><a href="ukbb.html#cb32-91" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb32-92"><a href="ukbb.html#cb32-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-93"><a href="ukbb.html#cb32-93" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb32-94"><a href="ukbb.html#cb32-94" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-norm.all</span>
<span id="cb32-95"><a href="ukbb.html#cb32-95" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb32-96"><a href="ukbb.html#cb32-96" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb32-97"><a href="ukbb.html#cb32-97" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-norm.all</span>
<span id="cb32-98"><a href="ukbb.html#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb32-99"><a href="ukbb.html#cb32-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-100"><a href="ukbb.html#cb32-100" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb32-101"><a href="ukbb.html#cb32-101" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb32-102"><a href="ukbb.html#cb32-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-103"><a href="ukbb.html#cb32-103" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-norm.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb32-104"><a href="ukbb.html#cb32-104" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-norm.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb32-105"><a href="ukbb.html#cb32-105" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-norm.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb32-106"><a href="ukbb.html#cb32-106" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb32-107"><a href="ukbb.html#cb32-107" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb32-108"><a href="ukbb.html#cb32-108" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb32-109"><a href="ukbb.html#cb32-109" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-110"><a href="ukbb.html#cb32-110" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-111"><a href="ukbb.html#cb32-111" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-112"><a href="ukbb.html#cb32-112" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-113"><a href="ukbb.html#cb32-113" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb32-114"><a href="ukbb.html#cb32-114" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb32-115"><a href="ukbb.html#cb32-115" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb32-116"><a href="ukbb.html#cb32-116" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb32-117"><a href="ukbb.html#cb32-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-118"><a href="ukbb.html#cb32-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb32-119"><a href="ukbb.html#cb32-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-120"><a href="ukbb.html#cb32-120" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb32-121"><a href="ukbb.html#cb32-121" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb32-122"><a href="ukbb.html#cb32-122" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb32-123"><a href="ukbb.html#cb32-123" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb32-124"><a href="ukbb.html#cb32-124" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb32-125"><a href="ukbb.html#cb32-125" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb32-126"><a href="ukbb.html#cb32-126" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb32-127"><a href="ukbb.html#cb32-127" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb32-128"><a href="ukbb.html#cb32-128" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb32-129"><a href="ukbb.html#cb32-129" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb32-130"><a href="ukbb.html#cb32-130" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb32-131"><a href="ukbb.html#cb32-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-132"><a href="ukbb.html#cb32-132" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb32-133"><a href="ukbb.html#cb32-133" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb32-134"><a href="ukbb.html#cb32-134" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb32-135"><a href="ukbb.html#cb32-135" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb32-136"><a href="ukbb.html#cb32-136" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb32-137"><a href="ukbb.html#cb32-137" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb32-138"><a href="ukbb.html#cb32-138" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb32-139"><a href="ukbb.html#cb32-139" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb32-140"><a href="ukbb.html#cb32-140" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb32-141"><a href="ukbb.html#cb32-141" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb32-142"><a href="ukbb.html#cb32-142" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-inflation-norm.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb32-143"><a href="ukbb.html#cb32-143" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bad.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="control.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03.3-ukbb-recommended.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
