<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 UKBB recommended | GWAS Quality Control</title>
  <meta name="description" content="8 UKBB recommended | GWAS Quality Control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8 UKBB recommended | GWAS Quality Control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 UKBB recommended | GWAS Quality Control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bad.html"/>
<link rel="next" href="control.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>2</b> Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>2.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>2.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>2.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>2.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>2.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>2.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>2.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>2.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>2.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>2.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>2.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>2.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>3</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>3.1</b> test statistics ~ LD score</a></li>
<li class="chapter" data-level="3.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#new-models"><i class="fa fa-check"></i><b>3.2</b> New models?</a></li>
<li class="chapter" data-level="3.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ld-scores-based-on-individual-level-data"><i class="fa fa-check"></i><b>3.3</b> LD scores based on individual level data</a></li>
<li class="chapter" data-level="3.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-the-new-model"><i class="fa fa-check"></i><b>3.4</b> Test the new model</a></li>
<li class="chapter" data-level="3.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predictors-of-inflation"><i class="fa fa-check"></i><b>3.5</b> predictors of inflation?</a></li>
<li class="chapter" data-level="3.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#regress-bad-chisq-mean-r2_j"><i class="fa fa-check"></i><b>3.6</b> regress bad chisq ~ mean r^2_j</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mathematical-details.html"><a href="mathematical-details.html"><i class="fa fa-check"></i><b>4</b> Mathematical Details</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mathematical-details.html"><a href="mathematical-details.html#trk_rightk_left"><i class="fa fa-check"></i><b>4.1</b> <span class="math inline">\(tr(K_{right}K_{left})\)</span></a></li>
<li class="chapter" data-level="4.2" data-path="mathematical-details.html"><a href="mathematical-details.html#verification"><i class="fa fa-check"></i><b>4.2</b> verification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html"><i class="fa fa-check"></i><b>5</b> chi square ~ <span class="math inline">\(\overline{r^2_j}\)</span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#overliner2_j-choice-of-snps"><i class="fa fa-check"></i><b>5.1</b> <span class="math inline">\(\overline{r^2_j}\)</span> &amp; choice of SNPs</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#number-of-snps"><i class="fa fa-check"></i><b>5.1.1</b> number of SNPs</a></li>
<li class="chapter" data-level="5.1.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#maf"><i class="fa fa-check"></i><b>5.1.2</b> maf</a></li>
<li class="chapter" data-level="5.1.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#summary"><i class="fa fa-check"></i><b>5.1.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#varying-levels-of-confouding"><i class="fa fa-check"></i><b>5.2</b> varying levels of confouding</a></li>
<li class="chapter" data-level="5.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#results-summary"><i class="fa fa-check"></i><b>5.3</b> results summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>6</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>6.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="6.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>6.2</b> extract covariates</a></li>
<li class="chapter" data-level="6.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>6.3</b> GWAS</a></li>
<li class="chapter" data-level="6.4" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>6.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>6.4.1</b> under gcta</a></li>
<li class="chapter" data-level="6.4.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>6.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="6.4.3" data-path="good.html"><a href="good.html#summary-1"><i class="fa fa-check"></i><b>6.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>6.5</b> REML</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>6.5.1</b> making grms</a></li>
<li class="chapter" data-level="6.5.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>6.5.2</b> fast-reml</a></li>
<li class="chapter" data-level="6.5.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>6.5.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>6.6</b> HE</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>6.6.1</b> estimation</a></li>
<li class="chapter" data-level="6.6.2" data-path="good.html"><a href="good.html#summary-2"><i class="fa fa-check"></i><b>6.6.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>7</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>7.1</b> ID list</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>7.1.1</b> initial selection</a></li>
<li class="chapter" data-level="7.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>7.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="7.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>7.1.3</b> final list</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="bad.html"><a href="bad.html#gwas-lm"><i class="fa fa-check"></i><b>7.2</b> GWAS-lm</a></li>
<li class="chapter" data-level="7.3" data-path="bad.html"><a href="bad.html#gwas-bolt-lmm"><i class="fa fa-check"></i><b>7.3</b> GWAS-bolt-lmm</a></li>
<li class="chapter" data-level="7.4" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>7.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>7.4.1</b> under gcta</a></li>
<li class="chapter" data-level="7.4.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>7.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="7.4.3" data-path="bad.html"><a href="bad.html#summary-3"><i class="fa fa-check"></i><b>7.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>7.5</b> REML</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>7.5.1</b> making grms</a></li>
<li class="chapter" data-level="7.5.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>7.5.2</b> fast-reml</a></li>
<li class="chapter" data-level="7.5.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>7.5.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>7.6</b> HE</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>7.6.1</b> estimation</a></li>
<li class="chapter" data-level="7.6.2" data-path="bad.html"><a href="bad.html#summary-4"><i class="fa fa-check"></i><b>7.6.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>8</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>8.1</b> total N = 337k</a></li>
<li class="chapter" data-level="8.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>8.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="8.3" data-path="ukbb.html"><a href="ukbb.html#gwas-100k"><i class="fa fa-check"></i><b>8.3</b> GWAS-100k</a></li>
<li class="chapter" data-level="8.4" data-path="ukbb.html"><a href="ukbb.html#gwas-337k"><i class="fa fa-check"></i><b>8.4</b> GWAS-337k</a></li>
<li class="chapter" data-level="8.5" data-path="ukbb.html"><a href="ukbb.html#ldsc-100k"><i class="fa fa-check"></i><b>8.5</b> ldsc-100k</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>8.5.1</b> under gcta</a></li>
<li class="chapter" data-level="8.5.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>8.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="8.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-5"><i class="fa fa-check"></i><b>8.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="ukbb.html"><a href="ukbb.html#ldsc-337k"><i class="fa fa-check"></i><b>8.6</b> ldsc-337k</a></li>
<li class="chapter" data-level="8.7" data-path="ukbb.html"><a href="ukbb.html#aver2_j-337k"><i class="fa fa-check"></i><b>8.7</b> aver2_j-337k</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="ukbb.html"><a href="ukbb.html#calc"><i class="fa fa-check"></i><b>8.7.1</b> calc</a></li>
<li class="chapter" data-level="8.7.2" data-path="ukbb.html"><a href="ukbb.html#organize-data"><i class="fa fa-check"></i><b>8.7.2</b> organize data</a></li>
<li class="chapter" data-level="8.7.3" data-path="ukbb.html"><a href="ukbb.html#chisq-aver2_j"><i class="fa fa-check"></i><b>8.7.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>8.8</b> HE</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>8.8.1</b> making grms</a></li>
<li class="chapter" data-level="8.8.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>8.8.2</b> estimation</a></li>
<li class="chapter" data-level="8.8.3" data-path="ukbb.html"><a href="ukbb.html#summary-6"><i class="fa fa-check"></i><b>8.8.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>9</b> control GWAS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>9.1</b> ID list</a></li>
<li class="chapter" data-level="9.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>9.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="9.3" data-path="control.html"><a href="control.html#gwas-1"><i class="fa fa-check"></i><b>9.3</b> GWAS</a></li>
<li class="chapter" data-level="9.4" data-path="control.html"><a href="control.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>9.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>9.4.1</b> under gcta</a></li>
<li class="chapter" data-level="9.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>9.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="9.4.3" data-path="control.html"><a href="control.html#summary-7"><i class="fa fa-check"></i><b>9.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>9.5</b> HE</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>9.5.1</b> making grms</a></li>
<li class="chapter" data-level="9.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>9.5.2</b> estimation</a></li>
<li class="chapter" data-level="9.5.3" data-path="control.html"><a href="control.html#summary-8"><i class="fa fa-check"></i><b>9.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html"><i class="fa fa-check"></i><b>10</b> inclusive GWAS</a>
<ul>
<li class="chapter" data-level="10.1" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#qc"><i class="fa fa-check"></i><b>10.1</b> QC</a></li>
<li class="chapter" data-level="10.2" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#gwas-telomere-length"><i class="fa fa-check"></i><b>10.2</b> gwas-telomere length</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#aver2_j"><i class="fa fa-check"></i><b>10.2.1</b> aver2_j</a></li>
<li class="chapter" data-level="10.2.2" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#organize-data-1"><i class="fa fa-check"></i><b>10.2.2</b> organize data</a></li>
<li class="chapter" data-level="10.2.3" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#chisq-aver2_j-1"><i class="fa fa-check"></i><b>10.2.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="inclusive-gwas.html"><a href="inclusive-gwas.html#notesconcerns"><i class="fa fa-check"></i><b>10.3</b> notes/concerns</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="related-individuals.html"><a href="related-individuals.html"><i class="fa fa-check"></i><b>11</b> related individuals</a>
<ul>
<li class="chapter" data-level="11.1" data-path="related-individuals.html"><a href="related-individuals.html#genotyped-snps"><i class="fa fa-check"></i><b>11.1</b> genotyped SNPs</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-1"><i class="fa fa-check"></i><b>11.1.1</b> aver2_j</a></li>
<li class="chapter" data-level="11.1.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-2"><i class="fa fa-check"></i><b>11.1.2</b> gwas</a></li>
<li class="chapter" data-level="11.1.3" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-2"><i class="fa fa-check"></i><b>11.1.3</b> organize data</a></li>
<li class="chapter" data-level="11.1.4" data-path="related-individuals.html"><a href="related-individuals.html#summary-9"><i class="fa fa-check"></i><b>11.1.4</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="related-individuals.html"><a href="related-individuals.html#hapmap3-snps"><i class="fa fa-check"></i><b>11.2</b> hapmap3 SNPs</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype-data"><i class="fa fa-check"></i><b>11.2.1</b> genotype data</a></li>
<li class="chapter" data-level="11.2.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-3"><i class="fa fa-check"></i><b>11.2.2</b> gwas</a></li>
<li class="chapter" data-level="11.2.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-2"><i class="fa fa-check"></i><b>11.2.3</b> aver2_j</a></li>
<li class="chapter" data-level="11.2.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-3"><i class="fa fa-check"></i><b>11.2.4</b> organize data</a></li>
<li class="chapter" data-level="11.2.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-2"><i class="fa fa-check"></i><b>11.2.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="11.2.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j"><i class="fa fa-check"></i><b>11.2.6</b> inflation ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="related-individuals.html"><a href="related-individuals.html#mix-unrel-rel"><i class="fa fa-check"></i><b>11.3</b> mix unrel &amp; rel</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype"><i class="fa fa-check"></i><b>11.3.1</b> genotype</a></li>
<li class="chapter" data-level="11.3.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-4"><i class="fa fa-check"></i><b>11.3.2</b> gwas</a></li>
<li class="chapter" data-level="11.3.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-3"><i class="fa fa-check"></i><b>11.3.3</b> aver2_j</a></li>
<li class="chapter" data-level="11.3.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-4"><i class="fa fa-check"></i><b>11.3.4</b> organize data</a></li>
<li class="chapter" data-level="11.3.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-3"><i class="fa fa-check"></i><b>11.3.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="11.3.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j-1"><i class="fa fa-check"></i><b>11.3.6</b> inflation ~ aver2_j</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html"><i class="fa fa-check"></i><b>12</b> compute <span class="math inline">\(\sum_{i,j}^{m_1, m_2}r^2_{i,j}\)</span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwas-all-qced-snps"><i class="fa fa-check"></i><b>12.1</b> good GWAS-all qced snps</a></li>
<li class="chapter" data-level="12.2" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwass--ldak-thin-snps"><i class="fa fa-check"></i><b>12.2</b> good GWASs- ldak-thin snps</a></li>
<li class="chapter" data-level="12.3" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#bad-gwass-all-qced-snps"><i class="fa fa-check"></i><b>12.3</b> bad GWASs-all qced snps</a></li>
<li class="chapter" data-level="12.4" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#summary-10"><i class="fa fa-check"></i><b>12.4</b> summary</a></li>
<li class="chapter" data-level="12.5" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#compute-overliner2_j"><i class="fa fa-check"></i><b>12.5</b> compute <span class="math inline">\(\overline{r^2_j}\)</span></a></li>
<li class="chapter" data-level="12.6" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#mixed-pop-gwas-with-pc-as-covariates"><i class="fa fa-check"></i><b>12.6</b> mixed pop GWAS with PC as covariates</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GWAS Quality Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ukbb" class="section level1" number="8">
<h1><span class="header-section-number">8</span> UKBB recommended</h1>
<div id="total-n-337k" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> total N = 337k</h2>
<p>Here we want to identify the unrelated white individuals recommended by the UKBB.</p>
<p>Email from Florian:
“We restrict individuals to the ones used for computing the principal components (PCs) in the UK Biobank (Field 22020). These individuals are unrelated and have passed some quality control including removing samples with a missing rate on autosomes larger than 0.02, having a mismatch between inferred sex and self-reported sex, and outliers based on heterozygosity (more details can be found in section S3 of Bycroft et al. (2018)).”
And the White British are from this: <a href="https://biobank.ctsu.ox.ac.uk/crystal/field.cgi?id=22006" class="uri">https://biobank.ctsu.ox.ac.uk/crystal/field.cgi?id=22006</a></p>
<p>So required data fields:
PC: 22020
White british: 22006</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="ukbb.html#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="ukbb.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb41-3"><a href="ukbb.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data</span></span>
<span id="cb41-4"><a href="ukbb.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="va">head</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;phen/ukb45861.header&quot;</span><span class="ex">,</span> sep=<span class="st">&quot;,&quot;</span>, header=F, stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb41-5"><a href="ukbb.html#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># function to get the variables</span></span>
<span id="cb41-6"><a href="ukbb.html#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="va">get</span><span class="op">=</span>function<span class="kw">(</span><span class="fu">nm</span><span class="kw">){</span></span>
<span id="cb41-7"><a href="ukbb.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="va">colnum</span><span class="op">=</span>grep<span class="kw">(</span><span class="fu">nm</span>,head,fixed=TRUE<span class="kw">)</span></span>
<span id="cb41-8"><a href="ukbb.html#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="ex">t</span><span class="er">(</span><span class="ex">rbind</span><span class="er">(</span><span class="ex">colnum,</span> head[,colnum]<span class="kw">)))</span></span>
<span id="cb41-9"><a href="ukbb.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="ex">names</span><span class="er">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;column&quot;</span><span class="ex">,</span> <span class="st">&quot;field&quot;</span><span class="kw">)</span></span>
<span id="cb41-10"><a href="ukbb.html#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">(</span><span class="ex">out</span><span class="kw">)</span></span>
<span id="cb41-11"><a href="ukbb.html#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb41-12"><a href="ukbb.html#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="ukbb.html#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># get the variables</span></span>
<span id="cb41-14"><a href="ukbb.html#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">get</span><span class="er">(</span><span class="st">&#39;22020-0&#39;</span><span class="kw">)</span><span class="ex">,</span> <span class="co"># PC</span></span>
<span id="cb41-15"><a href="ukbb.html#cb41-15" aria-hidden="true" tabindex="-1"></a>      <span class="ex">get</span><span class="er">(</span><span class="st">&#39;22006-0&#39;</span><span class="kw">))</span> <span class="co"># white british</span></span>
<span id="cb41-16"><a href="ukbb.html#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="ukbb.html#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span><span class="st">&quot;phen/vars.colnum&quot;</span><span class="ex">,</span> col.names=F, row.names=F, sep=<span class="st">&quot;\t&quot;</span>, quote=F<span class="kw">)</span></span>
<span id="cb41-18"><a href="ukbb.html#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="ukbb.html#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># extract dat</span></span>
<span id="cb41-20"><a href="ukbb.html#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-F</span> <span class="st">&#39;&quot;,&quot;&#39;</span> <span class="st">&#39;(NR==FNR){a[$1];next}{printf &quot;%s\&quot;&quot;, $1;for(i in a){printf &quot; \&quot;%s\&quot;&quot;, $i};printf &quot;\n&quot;}&#39;</span> phen/vars.colnum phen/ukb45861.csv <span class="op">&gt;</span> phen/ukbb-recommended.dat</span>
<span id="cb41-21"><a href="ukbb.html#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="ukbb.html#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co"># get the id list of the intersect of the two data fields</span></span>
<span id="cb41-23"><a href="ukbb.html#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;phen/ukbb-recommended.dat&quot;</span><span class="ex">,</span> header=T, stringsAsFactors=F<span class="kw">)</span></span>
<span id="cb41-24"><a href="ukbb.html#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="va">id1</span><span class="op">=</span>dat<span class="va">$eid</span>[dat<span class="va">$X22020</span>.0.0==1 <span class="kw">&amp;</span> <span class="ex">!is.na</span><span class="er">(</span><span class="ex">dat</span><span class="va">$X22020</span><span class="ex">.0.0</span><span class="kw">)</span><span class="ex">]</span></span>
<span id="cb41-25"><a href="ukbb.html#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="va">id2</span><span class="op">=</span>dat<span class="va">$eid</span>[dat<span class="va">$X22006</span>.0.0==1 <span class="kw">&amp;</span> <span class="ex">!is.na</span><span class="er">(</span><span class="ex">dat</span><span class="va">$X22006</span><span class="ex">.0.0</span><span class="kw">)</span><span class="ex">]</span></span>
<span id="cb41-26"><a href="ukbb.html#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">id1,id2</span><span class="kw">)</span> <span class="co"># N = 337,462</span></span>
<span id="cb41-27"><a href="ukbb.html#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> <span class="st">&quot;ukbb-recommend.id&quot;</span>, col.names=F, row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>
</div>
<div id="qc-of-hp3-snps" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> QC of hp3 SNPs</h2>
<p>Here we do QC to 1.2M hapmap3 SNPs for the UKBB recommended individuals.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="ukbb.html#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="ukbb.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QC SNPs-----------------------------------------------------------------------</span></span>
<span id="cb42-3"><a href="ukbb.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stating number of SNPs= 1,184,423</span></span>
<span id="cb42-4"><a href="ukbb.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># note: at this stage, we use all UKBB recommended IDs </span></span>
<span id="cb42-5"><a href="ukbb.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we will do a random selection of IDs later.</span></span>
<span id="cb42-6"><a href="ukbb.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb42-7"><a href="ukbb.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb42-8"><a href="ukbb.html#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb42-9"><a href="ukbb.html#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb42-10"><a href="ukbb.html#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb42-11"><a href="ukbb.html#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb42-12"><a href="ukbb.html#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb42-13"><a href="ukbb.html#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="ukbb.html#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb42-15"><a href="ukbb.html#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../ukbb-recommend.id </span><span class="dt">\</span></span>
<span id="cb42-16"><a href="ukbb.html#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../doug/ukbb.ldsc </span><span class="dt">\</span></span>
<span id="cb42-17"><a href="ukbb.html#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb42-18"><a href="ukbb.html#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb42-19"><a href="ukbb.html#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.8 2 </span><span class="dt">\</span></span>
<span id="cb42-20"><a href="ukbb.html#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb42-21"><a href="ukbb.html#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb42-22"><a href="ukbb.html#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb42-23"><a href="ukbb.html#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb42-24"><a href="ukbb.html#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb42-25"><a href="ukbb.html#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb42-26"><a href="ukbb.html#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="ukbb.html#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb42-28"><a href="ukbb.html#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb42-29"><a href="ukbb.html#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb42-30"><a href="ukbb.html#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/qc-norm</span>
<span id="cb42-31"><a href="ukbb.html#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="ukbb.html#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files</span></span>
<span id="cb42-33"><a href="ukbb.html#cb42-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile-norm.list</span>
<span id="cb42-34"><a href="ukbb.html#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb42-35"><a href="ukbb.html#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">-norm&quot;</span> <span class="op">&gt;&gt;</span>bfile-norm.list</span>
<span id="cb42-36"><a href="ukbb.html#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb42-37"><a href="ukbb.html#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="ukbb.html#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb42-39"><a href="ukbb.html#cb42-39" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb42-40"><a href="ukbb.html#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb42-41"><a href="ukbb.html#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb42-42"><a href="ukbb.html#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb42-43"><a href="ukbb.html#cb42-43" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb42-44"><a href="ukbb.html#cb42-44" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-norm </span><span class="dt">\</span></span>
<span id="cb42-45"><a href="ukbb.html#cb42-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile-norm.list </span><span class="dt">\</span></span>
<span id="cb42-46"><a href="ukbb.html#cb42-46" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb42-47"><a href="ukbb.html#cb42-47" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb42-48"><a href="ukbb.html#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-norm.sh</span>
<span id="cb42-49"><a href="ukbb.html#cb42-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-50"><a href="ukbb.html#cb42-50" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb42-51"><a href="ukbb.html#cb42-51" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-norm.sh <span class="op">&gt;</span>../job-records/mbfiles-norm</span>
<span id="cb42-52"><a href="ukbb.html#cb42-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-53"><a href="ukbb.html#cb42-53" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly select 100k individuals </span></span>
<span id="cb42-54"><a href="ukbb.html#cb42-54" aria-hidden="true" tabindex="-1"></a><span class="ex">shuf</span> ukbb-recommend.id <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 100000 <span class="op">&gt;</span> ukbb-recommned-rand.100000</span>
<span id="cb42-55"><a href="ukbb.html#cb42-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-56"><a href="ukbb.html#cb42-56" aria-hidden="true" tabindex="-1"></a><span class="co"># make bfile for these individuals</span></span>
<span id="cb42-57"><a href="ukbb.html#cb42-57" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb42-58"><a href="ukbb.html#cb42-58" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb42-59"><a href="ukbb.html#cb42-59" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb42-60"><a href="ukbb.html#cb42-60" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb42-61"><a href="ukbb.html#cb42-61" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb42-62"><a href="ukbb.html#cb42-62" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb42-63"><a href="ukbb.html#cb42-63" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb42-64"><a href="ukbb.html#cb42-64" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm </span><span class="dt">\</span></span>
<span id="cb42-65"><a href="ukbb.html#cb42-65" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../ukbb-recommned-rand.100000 </span><span class="dt">\</span></span>
<span id="cb42-66"><a href="ukbb.html#cb42-66" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb42-67"><a href="ukbb.html#cb42-67" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb42-68"><a href="ukbb.html#cb42-68" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-norm-100k.sh</span>
<span id="cb42-69"><a href="ukbb.html#cb42-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-70"><a href="ukbb.html#cb42-70" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb42-71"><a href="ukbb.html#cb42-71" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-norm-100k.sh <span class="op">&gt;</span>../job-records/mbfiles-norm-100k</span>
<span id="cb42-72"><a href="ukbb.html#cb42-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-73"><a href="ukbb.html#cb42-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-74"><a href="ukbb.html#cb42-74" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate </span></span>
<span id="cb42-75"><a href="ukbb.html#cb42-75" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> geno-norm-100k.stats <span class="st">&#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> snps-norm-100k.use</span>
<span id="cb42-76"><a href="ukbb.html#cb42-76" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 1,100,799 SNPs</span></span>
<span id="cb42-77"><a href="ukbb.html#cb42-77" aria-hidden="true" tabindex="-1"></a> </span></code></pre></div>
</div>
<div id="gwas-100k" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> GWAS-100k</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb43-1"><a href="ukbb.html#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="ukbb.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression-------------------------------------------------------------</span></span>
<span id="cb43-3"><a href="ukbb.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-norm</span>
<span id="cb43-4"><a href="ukbb.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb43-5"><a href="ukbb.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb43-6"><a href="ukbb.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb43-7"><a href="ukbb.html#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb43-8"><a href="ukbb.html#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb43-9"><a href="ukbb.html#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb43-10"><a href="ukbb.html#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb43-11"><a href="ukbb.html#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="ukbb.html#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear ../gwas-norm/</span><span class="va">$i</span><span class="st">-linear </span><span class="dt">\</span></span>
<span id="cb43-13"><a href="ukbb.html#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb43-14"><a href="ukbb.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb43-15"><a href="ukbb.html#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../ukbb-recommned-rand.100000 </span><span class="dt">\</span></span>
<span id="cb43-16"><a href="ukbb.html#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb43-17"><a href="ukbb.html#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb43-18"><a href="ukbb.html#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb43-19"><a href="ukbb.html#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb43-20"><a href="ukbb.html#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb43-21"><a href="ukbb.html#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="ukbb.html#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb43-23"><a href="ukbb.html#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb43-24"><a href="ukbb.html#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb43-25"><a href="ukbb.html#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-norm</span>
<span id="cb43-26"><a href="ukbb.html#cb43-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-27"><a href="ukbb.html#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb43-28"><a href="ukbb.html#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-norm</span>
<span id="cb43-29"><a href="ukbb.html#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb43-30"><a href="ukbb.html#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb43-31"><a href="ukbb.html#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb43-32"><a href="ukbb.html#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb43-33"><a href="ukbb.html#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb43-34"><a href="ukbb.html#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb43-35"><a href="ukbb.html#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb43-36"><a href="ukbb.html#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb43-37"><a href="ukbb.html#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb43-38"><a href="ukbb.html#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb43-39"><a href="ukbb.html#cb43-39" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb43-40"><a href="ukbb.html#cb43-40" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb43-41"><a href="ukbb.html#cb43-41" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb43-42"><a href="ukbb.html#cb43-42" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb43-43"><a href="ukbb.html#cb43-43" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb43-44"><a href="ukbb.html#cb43-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="gwas-337k" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> GWAS-337k</h2>
<p>Here we do gwas for all recommended individuals. Previously we made a bfile for all these individuals.</p>
<ul>
<li><strong>bfile</strong> (after QC) gen/geno-norm</li>
<li><strong>id list</strong> ukbb-recommend.id</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="ukbb.html#cb44-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2"><a href="ukbb.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># snp list----------------------------------------------------------------------</span></span>
<span id="cb44-3"><a href="ukbb.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call rate filtering</span></span>
<span id="cb44-4"><a href="ukbb.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> gen/geno-norm.stats <span class="st">&#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> gen/snps-norm.use <span class="co">#1,100,715 snps</span></span>
<span id="cb44-5"><a href="ukbb.html#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="ukbb.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># GWAS -------------------------------------------------------------------------</span></span>
<span id="cb44-7"><a href="ukbb.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-norm-337k</span>
<span id="cb44-8"><a href="ukbb.html#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb44-9"><a href="ukbb.html#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb44-10"><a href="ukbb.html#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb44-11"><a href="ukbb.html#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb44-12"><a href="ukbb.html#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb44-13"><a href="ukbb.html#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb44-14"><a href="ukbb.html#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb44-15"><a href="ukbb.html#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="ukbb.html#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear ../gwas-norm-337k/</span><span class="va">$i</span><span class="st">-linear </span><span class="dt">\</span></span>
<span id="cb44-17"><a href="ukbb.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb44-18"><a href="ukbb.html#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm </span><span class="dt">\</span></span>
<span id="cb44-19"><a href="ukbb.html#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../ukbb-recommend.id </span><span class="dt">\</span></span>
<span id="cb44-20"><a href="ukbb.html#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-norm.use </span><span class="dt">\</span></span>
<span id="cb44-21"><a href="ukbb.html#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb44-22"><a href="ukbb.html#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb44-23"><a href="ukbb.html#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb44-24"><a href="ukbb.html#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb44-25"><a href="ukbb.html#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="ukbb.html#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb44-27"><a href="ukbb.html#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb44-28"><a href="ukbb.html#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb44-29"><a href="ukbb.html#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-norm-337k</span>
<span id="cb44-30"><a href="ukbb.html#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="ukbb.html#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb44-32"><a href="ukbb.html#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/gwas-norm-337k</span>
<span id="cb44-33"><a href="ukbb.html#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb44-34"><a href="ukbb.html#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb44-35"><a href="ukbb.html#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb44-36"><a href="ukbb.html#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb44-37"><a href="ukbb.html#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb44-38"><a href="ukbb.html#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb44-39"><a href="ukbb.html#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb44-40"><a href="ukbb.html#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb44-41"><a href="ukbb.html#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb44-42"><a href="ukbb.html#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb44-43"><a href="ukbb.html#cb44-43" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb44-44"><a href="ukbb.html#cb44-44" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb44-45"><a href="ukbb.html#cb44-45" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb44-46"><a href="ukbb.html#cb44-46" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb44-47"><a href="ukbb.html#cb44-47" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb44-48"><a href="ukbb.html#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span></code></pre></div>
</div>
<div id="ldsc-100k" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> ldsc-100k</h2>
<div id="under-gcta-2" class="section level3" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> under gcta</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="ukbb.html#cb45-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-2"><a href="ukbb.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb45-3"><a href="ukbb.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># using original ldsc</span></span>
<span id="cb45-4"><a href="ukbb.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb45-5"><a href="ukbb.html#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="ukbb.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># format stats for ldsc--------------------------------------------------------- </span></span>
<span id="cb45-7"><a href="ukbb.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb45-8"><a href="ukbb.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb45-9"><a href="ukbb.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;doug/ukbb.ldsc&quot;</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb45-10"><a href="ukbb.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="va">phen</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span><span class="st">&quot;fvc&quot;</span><span class="ex">,</span></span>
<span id="cb45-11"><a href="ukbb.html#cb45-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;height&quot;</span><span class="ex">,</span><span class="st">&quot;imp&quot;</span><span class="ex">,</span><span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span></span>
<span id="cb45-12"><a href="ukbb.html#cb45-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="ex">,</span> <span class="st">&quot;quals&quot;</span><span class="kw">)</span></span>
<span id="cb45-13"><a href="ukbb.html#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="ukbb.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in phen<span class="kw">){</span></span>
<span id="cb45-15"><a href="ukbb.html#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="va">stat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-norm/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb45-16"><a href="ukbb.html#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="va">p</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-norm/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.pvalues&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb45-17"><a href="ukbb.html#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> stat<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb45-18"><a href="ukbb.html#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> p<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb45-19"><a href="ukbb.html#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">SNP</span><span class="op">=</span>rs<span class="va">$X2</span>,</span>
<span id="cb45-20"><a href="ukbb.html#cb45-20" aria-hidden="true" tabindex="-1"></a>                 <span class="va">N</span><span class="op">=</span>stat<span class="va">$n</span>[m1],</span>
<span id="cb45-21"><a href="ukbb.html#cb45-21" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Z</span><span class="op">=</span><span class="va">(</span>sqrt<span class="er">(</span>stat<span class="va">$Stat)</span><span class="pp">*</span>stat<span class="va">$Direction</span><span class="kw">)</span><span class="ex">[m1],</span></span>
<span id="cb45-22"><a href="ukbb.html#cb45-22" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A1</span><span class="op">=</span>stat<span class="va">$A1</span>[m1],</span>
<span id="cb45-23"><a href="ukbb.html#cb45-23" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A2</span><span class="op">=</span>stat<span class="va">$A2</span>[m1], </span>
<span id="cb45-24"><a href="ukbb.html#cb45-24" aria-hidden="true" tabindex="-1"></a>                 <span class="va">pval</span><span class="op">=</span>p<span class="va">$P</span>[m2], <span class="va">stringsAsFactors</span><span class="op">=</span>F<span class="er">)</span></span>
<span id="cb45-25"><a href="ukbb.html#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>out[complete.cases<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb45-26"><a href="ukbb.html#cb45-26" aria-hidden="true" tabindex="-1"></a>  <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;gwas-norm/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear-rs.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb45-27"><a href="ukbb.html#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb45-28"><a href="ukbb.html#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb45-29"><a href="ukbb.html#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="ukbb.html#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co"># perform ldsc------------------------------------------------------------------</span></span>
<span id="cb45-31"><a href="ukbb.html#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> out-norm-100k</span>
<span id="cb45-32"><a href="ukbb.html#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-33"><a href="ukbb.html#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-34"><a href="ukbb.html#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-35"><a href="ukbb.html#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-36"><a href="ukbb.html#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb45-37"><a href="ukbb.html#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb45-38"><a href="ukbb.html#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 24:00:0</span></span>
<span id="cb45-39"><a href="ukbb.html#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="ukbb.html#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="st">.././munge_sumstats.py </span><span class="dt">\</span></span>
<span id="cb45-41"><a href="ukbb.html#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="st">--sumstats ../../gwas-norm/</span><span class="va">$i</span><span class="st">-linear-rs.summaries </span><span class="dt">\</span></span>
<span id="cb45-42"><a href="ukbb.html#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-norm-100k/</span><span class="va">$i</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-43"><a href="ukbb.html#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="st">--merge-alleles ../w_hm3.snplist</span></span>
<span id="cb45-44"><a href="ukbb.html#cb45-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-45"><a href="ukbb.html#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="st">.././ldsc.py </span><span class="dt">\</span></span>
<span id="cb45-46"><a href="ukbb.html#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="st">--h2 ../out-norm-100k/</span><span class="va">$i</span><span class="st">.sumstats.gz </span><span class="dt">\</span></span>
<span id="cb45-47"><a href="ukbb.html#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="st">--ref-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb45-48"><a href="ukbb.html#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="st">--w-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb45-49"><a href="ukbb.html#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-norm-100k/</span><span class="va">$i</span><span class="st">-ldsc</span></span>
<span id="cb45-50"><a href="ukbb.html#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/ldsc-<span class="va">$i</span>-norm-100k.sh</span>
<span id="cb45-51"><a href="ukbb.html#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-52"><a href="ukbb.html#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="ukbb.html#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb45-54"><a href="ukbb.html#cb45-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper</span><span class="op">,</span><span class="dt">quals}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-55"><a href="ukbb.html#cb45-55" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldsc-<span class="va">$i</span>-norm-100k.sh</span>
<span id="cb45-56"><a href="ukbb.html#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../../job-records/ldsc-norm-100k</span>
<span id="cb45-57"><a href="ukbb.html#cb45-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-58"><a href="ukbb.html#cb45-58" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb45-59"><a href="ukbb.html#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="co"># using sumher</span></span>
<span id="cb45-60"><a href="ukbb.html#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb45-61"><a href="ukbb.html#cb45-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-62"><a href="ukbb.html#cb45-62" aria-hidden="true" tabindex="-1"></a><span class="co"># insert genetic distance into bim file-----------------------------------------</span></span>
<span id="cb45-63"><a href="ukbb.html#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> geno-norm-100k.fam <span class="op">&gt;</span> small-norm</span>
<span id="cb45-64"><a href="ukbb.html#cb45-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-65"><a href="ukbb.html#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-66"><a href="ukbb.html#cb45-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-67"><a href="ukbb.html#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb45-68"><a href="ukbb.html#cb45-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb45-69"><a href="ukbb.html#cb45-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 3:00:0</span></span>
<span id="cb45-70"><a href="ukbb.html#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-71"><a href="ukbb.html#cb45-71" aria-hidden="true" tabindex="-1"></a><span class="st">./plink1.9 --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb45-72"><a href="ukbb.html#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-73"><a href="ukbb.html#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="st">          --cm-map /home/zhoux/snpher/faststorage/genetic_maps/genetic_map_chr@_combined_b37.txt </span><span class="dt">\</span></span>
<span id="cb45-74"><a href="ukbb.html#cb45-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --make-bed </span><span class="dt">\</span></span>
<span id="cb45-75"><a href="ukbb.html#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --out new</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-76"><a href="ukbb.html#cb45-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../gen/small-norm</span></span>
<span id="cb45-77"><a href="ukbb.html#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/map<span class="va">$j</span></span>
<span id="cb45-78"><a href="ukbb.html#cb45-78" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-79"><a href="ukbb.html#cb45-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-80"><a href="ukbb.html#cb45-80" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-81"><a href="ukbb.html#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/map<span class="va">$j</span></span>
<span id="cb45-82"><a href="ukbb.html#cb45-82" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> genetic-distance-hapmap3</span>
<span id="cb45-83"><a href="ukbb.html#cb45-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-84"><a href="ukbb.html#cb45-84" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /home/zhoux/dsmwpred/xuan/quality-control/qc-10oct/gen</span>
<span id="cb45-85"><a href="ukbb.html#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> new<span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span>.bim <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $2, $3}&#39;</span> <span class="op">&gt;</span> maps-hapmap3-norm-100k.txt</span>
<span id="cb45-86"><a href="ukbb.html#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> new<span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span>.<span class="dt">{bim</span><span class="op">,</span><span class="dt">bed</span><span class="op">,</span><span class="dt">fam</span><span class="op">,</span><span class="dt">log}</span></span>
<span id="cb45-87"><a href="ukbb.html#cb45-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-88"><a href="ukbb.html#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){arr[$1]=$2;next}{print $1, $2, arr[$2], $4, $5, $6}&#39;</span> <span class="op">&gt;</span> geno-norm-100k.bim2 maps-hapmap3-norm-100k.txt geno-norm-100k.bim</span>
<span id="cb45-89"><a href="ukbb.html#cb45-89" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-norm-100k.bim geno-norm-100k.bim0</span>
<span id="cb45-90"><a href="ukbb.html#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> geno-norm-100k.bim2 geno-norm-100k.bim</span>
<span id="cb45-91"><a href="ukbb.html#cb45-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-92"><a href="ukbb.html#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="co"># compute tagging under gcta----------------------------------------------------</span></span>
<span id="cb45-93"><a href="ukbb.html#cb45-93" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> tagging-norm-100k</span>
<span id="cb45-94"><a href="ukbb.html#cb45-94" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-95"><a href="ukbb.html#cb45-95" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-96"><a href="ukbb.html#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-97"><a href="ukbb.html#cb45-97" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-98"><a href="ukbb.html#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb45-99"><a href="ukbb.html#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb45-100"><a href="ukbb.html#cb45-100" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb45-101"><a href="ukbb.html#cb45-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-102"><a href="ukbb.html#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../tagging-norm-100k/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb45-103"><a href="ukbb.html#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb45-104"><a href="ukbb.html#cb45-104" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb45-105"><a href="ukbb.html#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb45-106"><a href="ukbb.html#cb45-106" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb45-107"><a href="ukbb.html#cb45-107" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb45-108"><a href="ukbb.html#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span></span>
<span id="cb45-109"><a href="ukbb.html#cb45-109" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-110"><a href="ukbb.html#cb45-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-111"><a href="ukbb.html#cb45-111" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-112"><a href="ukbb.html#cb45-112" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-gcta-hapmap3-chr<span class="va">$j</span> </span>
<span id="cb45-113"><a href="ukbb.html#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-gcta-hapmap3-norm-100k</span>
<span id="cb45-114"><a href="ukbb.html#cb45-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-115"><a href="ukbb.html#cb45-115" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb45-116"><a href="ukbb.html#cb45-116" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-gcta-hapmap3-norm-100k</span>
<span id="cb45-117"><a href="ukbb.html#cb45-117" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb45-118"><a href="ukbb.html#cb45-118" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb45-119"><a href="ukbb.html#cb45-119" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-120"><a href="ukbb.html#cb45-120" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb45-121"><a href="ukbb.html#cb45-121" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb45-122"><a href="ukbb.html#cb45-122" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb45-123"><a href="ukbb.html#cb45-123" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb45-124"><a href="ukbb.html#cb45-124" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb45-125"><a href="ukbb.html#cb45-125" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-126"><a href="ukbb.html#cb45-126" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb45-127"><a href="ukbb.html#cb45-127" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb45-128"><a href="ukbb.html#cb45-128" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb45-129"><a href="ukbb.html#cb45-129" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb45-130"><a href="ukbb.html#cb45-130" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb45-131"><a href="ukbb.html#cb45-131" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb45-132"><a href="ukbb.html#cb45-132" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb45-133"><a href="ukbb.html#cb45-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-134"><a href="ukbb.html#cb45-134" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb45-135"><a href="ukbb.html#cb45-135" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb45-136"><a href="ukbb.html#cb45-136" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb45-137"><a href="ukbb.html#cb45-137" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-norm-100k/gcta-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb45-138"><a href="ukbb.html#cb45-138" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-139"><a href="ukbb.html#cb45-139" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> tagging-norm-100k/gcta-hapmap3 <span class="at">--taglist</span> list.txt</span>
<span id="cb45-140"><a href="ukbb.html#cb45-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-141"><a href="ukbb.html#cb45-141" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb45-142"><a href="ukbb.html#cb45-142" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> sumher-norm-100k</span>
<span id="cb45-143"><a href="ukbb.html#cb45-143" aria-hidden="true" tabindex="-1"></a><span class="va">dirin1</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb45-144"><a href="ukbb.html#cb45-144" aria-hidden="true" tabindex="-1"></a><span class="va">dirin2</span><span class="op">=</span>gwas-norm</span>
<span id="cb45-145"><a href="ukbb.html#cb45-145" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>sumher-norm-100k</span>
<span id="cb45-146"><a href="ukbb.html#cb45-146" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-147"><a href="ukbb.html#cb45-147" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb45-148"><a href="ukbb.html#cb45-148" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb45-149"><a href="ukbb.html#cb45-149" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb45-150"><a href="ukbb.html#cb45-150" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb45-151"><a href="ukbb.html#cb45-151" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb45-152"><a href="ukbb.html#cb45-152" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb45-153"><a href="ukbb.html#cb45-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-154"><a href="ukbb.html#cb45-154" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-sumher-gcta </span><span class="dt">\</span></span>
<span id="cb45-155"><a href="ukbb.html#cb45-155" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../</span><span class="va">$dirin1</span><span class="st">/gcta-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb45-156"><a href="ukbb.html#cb45-156" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../</span><span class="va">$dirin2</span><span class="st">/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb45-157"><a href="ukbb.html#cb45-157" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb45-158"><a href="ukbb.html#cb45-158" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb45-159"><a href="ukbb.html#cb45-159" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-gcta</span>
<span id="cb45-160"><a href="ukbb.html#cb45-160" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-161"><a href="ukbb.html#cb45-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-162"><a href="ukbb.html#cb45-162" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb45-163"><a href="ukbb.html#cb45-163" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-gcta</span>
<span id="cb45-164"><a href="ukbb.html#cb45-164" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-gcta-norm-100k</span></code></pre></div>
</div>
<div id="under-ldak-thin-2" class="section level3" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> under ldak-thin</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="ukbb.html#cb46-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2"><a href="ukbb.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get weights-------------------------------------------------------------------</span></span>
<span id="cb46-3"><a href="ukbb.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> ldak-thin/ldak-thin-norm.in <span class="st">&#39;{print $1, 1}&#39;</span> <span class="op">&gt;</span> ldak-thin/weights.ldak-thin-norm</span>
<span id="cb46-4"><a href="ukbb.html#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="ukbb.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate tagging under ldak-thin---------------------------------------------</span></span>
<span id="cb46-6"><a href="ukbb.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb46-7"><a href="ukbb.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="va">filein1</span><span class="op">=</span>geno-norm-100k</span>
<span id="cb46-8"><a href="ukbb.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="va">filein2</span><span class="op">=</span>weights.ldak-thin-norm</span>
<span id="cb46-9"><a href="ukbb.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb46-10"><a href="ukbb.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb46-11"><a href="ukbb.html#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb46-12"><a href="ukbb.html#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 40G</span></span>
<span id="cb46-13"><a href="ukbb.html#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb46-14"><a href="ukbb.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb46-15"><a href="ukbb.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb46-16"><a href="ukbb.html#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --calc-tagging ../</span><span class="va">$dirout</span><span class="st">/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb46-17"><a href="ukbb.html#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/</span><span class="va">$filein1</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb46-18"><a href="ukbb.html#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --weights ../ldak-thin/</span><span class="va">$filein2</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb46-19"><a href="ukbb.html#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -.25 </span><span class="dt">\</span></span>
<span id="cb46-20"><a href="ukbb.html#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-cm 1 </span><span class="dt">\</span></span>
<span id="cb46-21"><a href="ukbb.html#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb46-22"><a href="ukbb.html#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --save-matrix YES </span><span class="dt">\</span></span>
<span id="cb46-23"><a href="ukbb.html#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb46-24"><a href="ukbb.html#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb46-25"><a href="ukbb.html#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb46-26"><a href="ukbb.html#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="ukbb.html#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co"># submit scripts</span></span>
<span id="cb46-28"><a href="ukbb.html#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb46-29"><a href="ukbb.html#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/tagging-ldak-thin-hapmap3-chr<span class="va">$j</span>.sh</span>
<span id="cb46-30"><a href="ukbb.html#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/tagging-ldak-thin-norm-100k</span>
<span id="cb46-31"><a href="ukbb.html#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="ukbb.html#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb46-33"><a href="ukbb.html#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/tagging-ldak-thin-norm-100k</span>
<span id="cb46-34"><a href="ukbb.html#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb46-35"><a href="ukbb.html#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb46-36"><a href="ukbb.html#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb46-37"><a href="ukbb.html#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb46-38"><a href="ukbb.html#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb46-39"><a href="ukbb.html#cb46-39" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb46-40"><a href="ukbb.html#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb46-41"><a href="ukbb.html#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb46-42"><a href="ukbb.html#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb46-43"><a href="ukbb.html#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb46-44"><a href="ukbb.html#cb46-44" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb46-45"><a href="ukbb.html#cb46-45" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb46-46"><a href="ukbb.html#cb46-46" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb46-47"><a href="ukbb.html#cb46-47" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb46-48"><a href="ukbb.html#cb46-48" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb46-49"><a href="ukbb.html#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb46-50"><a href="ukbb.html#cb46-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-51"><a href="ukbb.html#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="co"># merge tagging files-----------------------------------------------------------</span></span>
<span id="cb46-52"><a href="ukbb.html#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> list.txt</span>
<span id="cb46-53"><a href="ukbb.html#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> matlist.txt</span>
<span id="cb46-54"><a href="ukbb.html#cb46-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb46-55"><a href="ukbb.html#cb46-55" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-norm-100k/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.tagging&quot;</span> <span class="op">&gt;&gt;</span> list.txt</span>
<span id="cb46-56"><a href="ukbb.html#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;tagging-norm-100k/ldak-thin-hapmap3-chr-</span><span class="va">$j</span><span class="st">.matrix&quot;</span> <span class="op">&gt;&gt;</span> matlist.txt</span>
<span id="cb46-57"><a href="ukbb.html#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb46-58"><a href="ukbb.html#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb46-59"><a href="ukbb.html#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="ex">./ldak5.1</span> <span class="at">--join-tagging</span> <span class="va">$dirout</span>/ldak-thin-hapmap3 <span class="at">--taglist</span> list.txt <span class="at">--matlist</span> matlist.txt</span>
<span id="cb46-60"><a href="ukbb.html#cb46-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-61"><a href="ukbb.html#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="co"># ldsc intercept----------------------------------------------------------------</span></span>
<span id="cb46-62"><a href="ukbb.html#cb46-62" aria-hidden="true" tabindex="-1"></a><span class="va">dirin1</span><span class="op">=</span>tagging-norm-100k</span>
<span id="cb46-63"><a href="ukbb.html#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="va">dirin2</span><span class="op">=</span>gwas-norm</span>
<span id="cb46-64"><a href="ukbb.html#cb46-64" aria-hidden="true" tabindex="-1"></a><span class="va">dirout</span><span class="op">=</span>sumher-norm-100k</span>
<span id="cb46-65"><a href="ukbb.html#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb46-66"><a href="ukbb.html#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb46-67"><a href="ukbb.html#cb46-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb46-68"><a href="ukbb.html#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb46-69"><a href="ukbb.html#cb46-69" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 5G</span></span>
<span id="cb46-70"><a href="ukbb.html#cb46-70" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb46-71"><a href="ukbb.html#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb46-72"><a href="ukbb.html#cb46-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-73"><a href="ukbb.html#cb46-73" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --sum-hers ../</span><span class="va">$dirout</span><span class="st">/</span><span class="va">$i</span><span class="st">-sumher-ldak-thin </span><span class="dt">\</span></span>
<span id="cb46-74"><a href="ukbb.html#cb46-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --tagfile ../</span><span class="va">$dirin1</span><span class="st">/ldak-thin-hapmap3.tagging </span><span class="dt">\</span></span>
<span id="cb46-75"><a href="ukbb.html#cb46-75" aria-hidden="true" tabindex="-1"></a><span class="st">          --summary ../</span><span class="va">$dirin2</span><span class="st">/</span><span class="va">$i</span><span class="st">-linear.summaries </span><span class="dt">\</span></span>
<span id="cb46-76"><a href="ukbb.html#cb46-76" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-sums NO </span><span class="dt">\</span></span>
<span id="cb46-77"><a href="ukbb.html#cb46-77" aria-hidden="true" tabindex="-1"></a><span class="st">          --intercept YES</span></span>
<span id="cb46-78"><a href="ukbb.html#cb46-78" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-sumher-ldak-thin</span>
<span id="cb46-79"><a href="ukbb.html#cb46-79" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb46-80"><a href="ukbb.html#cb46-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-81"><a href="ukbb.html#cb46-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb46-82"><a href="ukbb.html#cb46-82" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-sumher-ldak-thin</span>
<span id="cb46-83"><a href="ukbb.html#cb46-83" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/sumher-ldak-thin-norm-100k</span></code></pre></div>
</div>
<div id="summary-5" class="section level3" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> summary</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="ukbb.html#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="ukbb.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># original ldsc</span></span>
<span id="cb47-3"><a href="ukbb.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept <span class="pp">*</span>ldsc.log <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[-]/); split($3, b, /[()]/); print a[1], $2, b[2]}&#39;</span> <span class="op">&gt;</span> ../../summary/ldsc-norm-100k</span>
<span id="cb47-4"><a href="ukbb.html#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="ukbb.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sumher under gcta</span></span>
<span id="cb47-6"><a href="ukbb.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-norm-100k-est</span>
<span id="cb47-7"><a href="ukbb.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>gcta.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-gcta-norm-100k-sd</span>
<span id="cb47-8"><a href="ukbb.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb47-9"><a href="ukbb.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-gcta-norm-100k-est sumher-gcta-norm-100k-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-gcta-norm-100k</span>
<span id="cb47-10"><a href="ukbb.html#cb47-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb47-11"><a href="ukbb.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># suhmer under ldak-thin</span></span>
<span id="cb47-12"><a href="ukbb.html#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_Estimate <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-norm-100k-est</span>
<span id="cb47-13"><a href="ukbb.html#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept_SD <span class="pp">*</span>ldak-thin.extra <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ split($1, a, /[-]/); print a[1], $2}&#39;</span> <span class="op">&gt;</span>../summary/sumher-ldak-thin-norm-100k-sd</span>
<span id="cb47-14"><a href="ukbb.html#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../summary/</span>
<span id="cb47-15"><a href="ukbb.html#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> sumher-ldak-thin-norm-100k-est sumher-ldak-thin-norm-100k-sd <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1, $2, $4}&#39;</span> <span class="op">&gt;</span> sumher-ldak-thin-norm-100k</span></code></pre></div>
</div>
</div>
<div id="ldsc-337k" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> ldsc-337k</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="ukbb.html#cb48-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#:::::::::::::</span></span>
<span id="cb48-2"><a href="ukbb.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using original ldsc</span></span>
<span id="cb48-3"><a href="ukbb.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::</span></span>
<span id="cb48-4"><a href="ukbb.html#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="ukbb.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># format stats for ldsc--------------------------------------------------------- </span></span>
<span id="cb48-6"><a href="ukbb.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb48-7"><a href="ukbb.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="ex">scipen</span> = 100<span class="kw">)</span></span>
<span id="cb48-8"><a href="ukbb.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="va">rs</span><span class="op">=</span>vroom<span class="kw">(</span><span class="st">&quot;doug/ukbb.ldsc&quot;</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb48-9"><a href="ukbb.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="va">phen</span><span class="op">=</span>c<span class="kw">(</span><span class="st">&quot;awake&quot;</span><span class="ex">,</span><span class="st">&quot;bmi&quot;</span><span class="ex">,</span><span class="st">&quot;chron&quot;</span><span class="ex">,</span><span class="st">&quot;ever&quot;</span><span class="ex">,</span><span class="st">&quot;fvc&quot;</span><span class="ex">,</span></span>
<span id="cb48-10"><a href="ukbb.html#cb48-10" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;height&quot;</span><span class="ex">,</span><span class="st">&quot;imp&quot;</span><span class="ex">,</span><span class="st">&quot;neur&quot;</span><span class="ex">,</span><span class="st">&quot;pulse&quot;</span><span class="ex">,</span><span class="st">&quot;quals&quot;</span><span class="ex">,</span></span>
<span id="cb48-11"><a href="ukbb.html#cb48-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;reaction&quot;</span><span class="ex">,</span><span class="st">&quot;sbp&quot;</span><span class="ex">,</span><span class="st">&quot;snoring&quot;</span><span class="ex">,</span><span class="st">&quot;hyper&quot;</span><span class="ex">,</span> <span class="st">&quot;quals&quot;</span><span class="kw">)</span></span>
<span id="cb48-12"><a href="ukbb.html#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="ukbb.html#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in phen<span class="kw">){</span></span>
<span id="cb48-14"><a href="ukbb.html#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="va">stat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-norm-337k/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb48-15"><a href="ukbb.html#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="va">p</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;gwas-norm-337k/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear.pvalues&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=T<span class="kw">)</span></span>
<span id="cb48-16"><a href="ukbb.html#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> stat<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb48-17"><a href="ukbb.html#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">rs</span><span class="va">$X1</span><span class="ex">,</span> p<span class="va">$Predictor</span><span class="kw">)</span></span>
<span id="cb48-18"><a href="ukbb.html#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">SNP</span><span class="op">=</span>rs<span class="va">$X2</span>,</span>
<span id="cb48-19"><a href="ukbb.html#cb48-19" aria-hidden="true" tabindex="-1"></a>                 <span class="va">N</span><span class="op">=</span>stat<span class="va">$n</span>[m1],</span>
<span id="cb48-20"><a href="ukbb.html#cb48-20" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Z</span><span class="op">=</span><span class="va">(</span>sqrt<span class="er">(</span>stat<span class="va">$Stat)</span><span class="pp">*</span>stat<span class="va">$Direction</span><span class="kw">)</span><span class="ex">[m1],</span></span>
<span id="cb48-21"><a href="ukbb.html#cb48-21" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A1</span><span class="op">=</span>stat<span class="va">$A1</span>[m1],</span>
<span id="cb48-22"><a href="ukbb.html#cb48-22" aria-hidden="true" tabindex="-1"></a>                 <span class="va">A2</span><span class="op">=</span>stat<span class="va">$A2</span>[m1], </span>
<span id="cb48-23"><a href="ukbb.html#cb48-23" aria-hidden="true" tabindex="-1"></a>                 <span class="va">pval</span><span class="op">=</span>p<span class="va">$P</span>[m2], <span class="va">stringsAsFactors</span><span class="op">=</span>F<span class="er">)</span></span>
<span id="cb48-24"><a href="ukbb.html#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="va">out</span><span class="op">=</span>out[complete.cases<span class="kw">(</span><span class="ex">out</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb48-25"><a href="ukbb.html#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;gwas-norm-337k/&quot;</span><span class="ex">,i,</span><span class="st">&quot;-linear-rs.summaries&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb48-26"><a href="ukbb.html#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb48-27"><a href="ukbb.html#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb48-28"><a href="ukbb.html#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="ukbb.html#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="co"># perform ldsc------------------------------------------------------------------</span></span>
<span id="cb48-30"><a href="ukbb.html#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> out-norm-337k</span>
<span id="cb48-31"><a href="ukbb.html#cb48-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-32"><a href="ukbb.html#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-33"><a href="ukbb.html#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb48-34"><a href="ukbb.html#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb48-35"><a href="ukbb.html#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb48-36"><a href="ukbb.html#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb48-37"><a href="ukbb.html#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb48-38"><a href="ukbb.html#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 24:00:0</span></span>
<span id="cb48-39"><a href="ukbb.html#cb48-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-40"><a href="ukbb.html#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="st">.././munge_sumstats.py </span><span class="dt">\</span></span>
<span id="cb48-41"><a href="ukbb.html#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="st">--sumstats ../../gwas-norm-337k/</span><span class="va">$i</span><span class="st">-linear-rs.summaries </span><span class="dt">\</span></span>
<span id="cb48-42"><a href="ukbb.html#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-norm-337k/</span><span class="va">$i</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb48-43"><a href="ukbb.html#cb48-43" aria-hidden="true" tabindex="-1"></a><span class="st">--merge-alleles ../w_hm3.snplist</span></span>
<span id="cb48-44"><a href="ukbb.html#cb48-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-45"><a href="ukbb.html#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="st">.././ldsc.py </span><span class="dt">\</span></span>
<span id="cb48-46"><a href="ukbb.html#cb48-46" aria-hidden="true" tabindex="-1"></a><span class="st">--h2 ../out-norm-337k/</span><span class="va">$i</span><span class="st">.sumstats.gz </span><span class="dt">\</span></span>
<span id="cb48-47"><a href="ukbb.html#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="st">--ref-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb48-48"><a href="ukbb.html#cb48-48" aria-hidden="true" tabindex="-1"></a><span class="st">--w-ld-chr ../eur_w_ld_chr/ </span><span class="dt">\</span></span>
<span id="cb48-49"><a href="ukbb.html#cb48-49" aria-hidden="true" tabindex="-1"></a><span class="st">--out ../out-norm-337k/</span><span class="va">$i</span><span class="st">-ldsc</span></span>
<span id="cb48-50"><a href="ukbb.html#cb48-50" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/ldsc-<span class="va">$i</span>-norm-337k.sh</span>
<span id="cb48-51"><a href="ukbb.html#cb48-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb48-52"><a href="ukbb.html#cb48-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-53"><a href="ukbb.html#cb48-53" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs-------------------------------------------------------------------</span></span>
<span id="cb48-54"><a href="ukbb.html#cb48-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper</span><span class="op">,</span><span class="dt">quals}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-55"><a href="ukbb.html#cb48-55" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldsc-<span class="va">$i</span>-norm-337k.sh</span>
<span id="cb48-56"><a href="ukbb.html#cb48-56" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../../job-records/ldsc-norm-337k</span>
<span id="cb48-57"><a href="ukbb.html#cb48-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-58"><a href="ukbb.html#cb48-58" aria-hidden="true" tabindex="-1"></a><span class="co"># summary ----------------------------------------------------------------------</span></span>
<span id="cb48-59"><a href="ukbb.html#cb48-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-60"><a href="ukbb.html#cb48-60" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Intercept <span class="pp">*</span>ldsc.log <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[-]/); split($3, b, /[()]/); print a[1], $2, b[2]}&#39;</span> <span class="op">&gt;</span> ../../summary/ldsc-norm-337k</span>
<span id="cb48-61"><a href="ukbb.html#cb48-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-62"><a href="ukbb.html#cb48-62" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb48-63"><a href="ukbb.html#cb48-63" aria-hidden="true" tabindex="-1"></a><span class="va">ldsc</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;summary/ldsc-norm-337k&quot;</span><span class="ex">,</span> header=F, stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb48-64"><a href="ukbb.html#cb48-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-65"><a href="ukbb.html#cb48-65" aria-hidden="true" tabindex="-1"></a><span class="co"># get p-values for Wald tests</span></span>
<span id="cb48-66"><a href="ukbb.html#cb48-66" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: intercept = 1</span></span>
<span id="cb48-67"><a href="ukbb.html#cb48-67" aria-hidden="true" tabindex="-1"></a><span class="va">alpha</span><span class="op">=</span>0.05/14 <span class="co"># Bonferroni corrected alpha</span></span>
<span id="cb48-68"><a href="ukbb.html#cb48-68" aria-hidden="true" tabindex="-1"></a><span class="va">ldsc</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">trait</span><span class="op">=</span>ldsc<span class="va">$V1</span>, <span class="va">est</span><span class="op">=</span>ldsc<span class="va">$V2</span>, <span class="va">se</span><span class="op">=</span>ldsc<span class="va">$V3</span>,</span>
<span id="cb48-69"><a href="ukbb.html#cb48-69" aria-hidden="true" tabindex="-1"></a>                <span class="va">wald_p</span><span class="op">=</span>pchisq<span class="kw">((</span>(<span class="va">ldsc$V2</span><span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="va">ldsc$V3</span>)<span class="op">^</span><span class="dv">2</span><span class="kw">,</span> <span class="va">df</span><span class="op">=</span><span class="dv">1</span><span class="kw">,</span> <span class="va">lower</span>.<span class="va">tail</span><span class="op">=</span><span class="va">F</span>)<span class="kw">,</span></span>
<span id="cb48-70"><a href="ukbb.html#cb48-70" aria-hidden="true" tabindex="-1"></a>                <span class="va">sig</span><span class="op">=</span><span class="va">pchisq</span>(((<span class="va">ldsc$V2</span><span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="va">ldsc$V3</span>)<span class="op">^</span><span class="dv">2</span><span class="kw">,</span> <span class="va">df</span><span class="op">=</span><span class="dv">1</span><span class="kw">,</span> <span class="va">lower</span>.<span class="va">tail</span><span class="op">=</span><span class="va">F</span>) <span class="op">&lt;</span> <span class="va">alpha</span><span class="kw">,</span></span>
<span id="cb48-71"><a href="ukbb.html#cb48-71" aria-hidden="true" tabindex="-1"></a>                <span class="va">stringsAsFactors</span> <span class="op">=</span> <span class="va">F</span>)</span></code></pre></div>
</div>
<div id="aver2_j-337k" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> aver2_j-337k</h2>
<div id="calc" class="section level3" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> calc</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="ukbb.html#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="ukbb.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb49-3"><a href="ukbb.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  snp lists</span></span>
<span id="cb49-4"><a href="ukbb.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb49-5"><a href="ukbb.html#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="ukbb.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># new directory</span></span>
<span id="cb49-7"><a href="ukbb.html#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> inflation/norm</span>
<span id="cb49-8"><a href="ukbb.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> inflation/norm/out</span>
<span id="cb49-9"><a href="ukbb.html#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="ukbb.html#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># lista &amp; listb</span></span>
<span id="cb49-11"><a href="ukbb.html#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="va">m</span><span class="op">=</span>10000</span>
<span id="cb49-12"><a href="ukbb.html#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gen/snps-norm.use</span>
<span id="cb49-13"><a href="ukbb.html#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>inflation/norm/left-snps</span>
<span id="cb49-14"><a href="ukbb.html#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>inflation/norm/right-snps</span>
<span id="cb49-15"><a href="ukbb.html#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="ukbb.html#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb49-17"><a href="ukbb.html#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&lt;8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$left</span>  </span>
<span id="cb49-18"><a href="ukbb.html#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, &quot;:&quot;);</span></span>
<span id="cb49-19"><a href="ukbb.html#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="st">    if (a[1]&gt;=8) print $1 }&#39;</span> <span class="va">$infile</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="va">$m</span> <span class="op">&gt;</span><span class="va">$right</span></span>
<span id="cb49-20"><a href="ukbb.html#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="ukbb.html#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb49-22"><a href="ukbb.html#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r^2_j</span></span>
<span id="cb49-23"><a href="ukbb.html#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb49-24"><a href="ukbb.html#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="ukbb.html#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/norm/right-snps</span>
<span id="cb49-26"><a href="ukbb.html#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/norm/left-snps</span>
<span id="cb49-27"><a href="ukbb.html#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-norm</span>
<span id="cb49-28"><a href="ukbb.html#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/norm/out/10k-snps</span>
<span id="cb49-29"><a href="ukbb.html#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="ukbb.html#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb49-31"><a href="ukbb.html#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb49-32"><a href="ukbb.html#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb49-33"><a href="ukbb.html#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb49-34"><a href="ukbb.html#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb49-35"><a href="ukbb.html#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:10:0</span></span>
<span id="cb49-36"><a href="ukbb.html#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb49-37"><a href="ukbb.html#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb49-38"><a href="ukbb.html#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb49-39"><a href="ukbb.html#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb49-40"><a href="ukbb.html#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb49-41"><a href="ukbb.html#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-r-10k-snps</span>
<span id="cb49-42"><a href="ukbb.html#cb49-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-43"><a href="ukbb.html#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the job</span></span>
<span id="cb49-44"><a href="ukbb.html#cb49-44" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-r-10k-snps <span class="op">&gt;</span>../job-records/calc-r-norm</span>
<span id="cb49-45"><a href="ukbb.html#cb49-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-46"><a href="ukbb.html#cb49-46" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute ave r_j^2 for each i-------------------------------------------------</span></span>
<span id="cb49-47"><a href="ukbb.html#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb49-48"><a href="ukbb.html#cb49-48" aria-hidden="true" tabindex="-1"></a><span class="ex">require</span><span class="er">(</span><span class="ex">vroom</span><span class="kw">)</span></span>
<span id="cb49-49"><a href="ukbb.html#cb49-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-50"><a href="ukbb.html#cb49-50" aria-hidden="true" tabindex="-1"></a><span class="va">nm</span><span class="op">=</span><span class="st">&quot;10k-snps&quot;</span></span>
<span id="cb49-51"><a href="ukbb.html#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>vroom<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/norm/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.pairwise&quot;</span><span class="kw">)</span><span class="ex">,</span> col_names=F<span class="kw">)</span></span>
<span id="cb49-52"><a href="ukbb.html#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/norm/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsa&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb49-53"><a href="ukbb.html#cb49-53" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb49-54"><a href="ukbb.html#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;inflation/norm/out/&quot;</span><span class="ex">,nm,</span><span class="st">&quot;.predictorsb&quot;</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb49-55"><a href="ukbb.html#cb49-55" aria-hidden="true" tabindex="-1"></a>                <span class="ex">stringsAsFactors</span> = F<span class="kw">)</span></span>
<span id="cb49-56"><a href="ukbb.html#cb49-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-57"><a href="ukbb.html#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[,-c<span class="kw">(</span><span class="ex">10001</span><span class="kw">)</span><span class="ex">]^2</span></span>
<span id="cb49-58"><a href="ukbb.html#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="va">outb</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>listb<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,2,</span> mean<span class="kw">))</span></span>
<span id="cb49-59"><a href="ukbb.html#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="va">outa</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">predictor</span><span class="op">=</span>lista<span class="va">$V1</span>, <span class="va">ave_r2</span><span class="op">=</span>apply<span class="kw">(</span><span class="ex">dat,1,</span> mean<span class="kw">))</span></span>
<span id="cb49-60"><a href="ukbb.html#cb49-60" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>rbind<span class="kw">(</span><span class="ex">outa,outb</span><span class="kw">)</span></span>
<span id="cb49-61"><a href="ukbb.html#cb49-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-62"><a href="ukbb.html#cb49-62" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,paste0</span><span class="er">(</span><span class="st">&quot;summary/ave-r2-&quot;</span><span class="ex">,nm,</span> <span class="st">&quot;-ukbb-norm&quot;</span><span class="kw">)</span><span class="ex">,</span> col.names=F, row.names=F, quote=F<span class="kw">)</span>  </span></code></pre></div>
</div>
<div id="organize-data" class="section level3" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> organize data</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="ukbb.html#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="ukbb.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-norm-337k-out</span>
<span id="cb50-3"><a href="ukbb.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="ukbb.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb50-5"><a href="ukbb.html#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="ukbb.html#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-norm-337k/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb50-7"><a href="ukbb.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>summary/ave-r2-10k-snps-ukbb-norm</span>
<span id="cb50-8"><a href="ukbb.html#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-norm-337k-out/<span class="va">$trait</span>.out</span>
<span id="cb50-9"><a href="ukbb.html#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="ukbb.html#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp    </span>
<span id="cb50-11"><a href="ukbb.html#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="ukbb.html#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb50-13"><a href="ukbb.html#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb50-14"><a href="ukbb.html#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb50-15"><a href="ukbb.html#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="ukbb.html#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb50-17"><a href="ukbb.html#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb50-18"><a href="ukbb.html#cb50-18" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb50-19"><a href="ukbb.html#cb50-19" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb50-20"><a href="ukbb.html#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2&quot;}</span></span>
<span id="cb50-21"><a href="ukbb.html#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb50-22"><a href="ukbb.html#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="chisq-aver2_j" class="section level3" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> chisq ~ aver2_j</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ukbb.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-2"><a href="ukbb.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate slope: chisq ~ aver2_j</span></span>
<span id="cb51-3"><a href="ukbb.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-4"><a href="ukbb.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="ukbb.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb51-6"><a href="ukbb.html#cb51-6" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb51-7"><a href="ukbb.html#cb51-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb51-8"><a href="ukbb.html#cb51-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb51-9"><a href="ukbb.html#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="ukbb.html#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb51-11"><a href="ukbb.html#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="ukbb.html#cb51-12" aria-hidden="true" tabindex="-1"></a>trait<span class="ot">=</span>traits[i]</span>
<span id="cb51-13"><a href="ukbb.html#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="ukbb.html#cb51-14" aria-hidden="true" tabindex="-1"></a>file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-norm-337k-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb51-15"><a href="ukbb.html#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="ukbb.html#cb51-16" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb51-17"><a href="ukbb.html#cb51-17" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb51-18"><a href="ukbb.html#cb51-18" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat)</span>
<span id="cb51-19"><a href="ukbb.html#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="ukbb.html#cb51-20" aria-hidden="true" tabindex="-1"></a>slope0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb51-21"><a href="ukbb.html#cb51-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope_aver2=</span><span class="fu">coef</span>(mod)[<span class="dv">2</span>],</span>
<span id="cb51-22"><a href="ukbb.html#cb51-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p_aver2=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>],</span>
<span id="cb51-23"><a href="ukbb.html#cb51-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb51-24"><a href="ukbb.html#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="ukbb.html#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){slope<span class="ot">=</span>slope0} <span class="cf">else</span> {slope<span class="ot">=</span><span class="fu">rbind</span>(slope,slope0)}</span>
<span id="cb51-26"><a href="ukbb.html#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="ukbb.html#cb51-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-28"><a href="ukbb.html#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="ukbb.html#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-30"><a href="ukbb.html#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co"># plot chisq ~ aver2_j  </span></span>
<span id="cb51-31"><a href="ukbb.html#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb51-32"><a href="ukbb.html#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot ------------------------------------------------------------------</span></span>
<span id="cb51-33"><a href="ukbb.html#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb51-34"><a href="ukbb.html#cb51-34" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb51-35"><a href="ukbb.html#cb51-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb51-36"><a href="ukbb.html#cb51-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb51-37"><a href="ukbb.html#cb51-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-38"><a href="ukbb.html#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/chisq-by-aver2-bin-ukbb-recommend-337k.png&quot;</span>),</span>
<span id="cb51-39"><a href="ukbb.html#cb51-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb51-40"><a href="ukbb.html#cb51-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb51-41"><a href="ukbb.html#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="ukbb.html#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb51-43"><a href="ukbb.html#cb51-43" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb51-44"><a href="ukbb.html#cb51-44" aria-hidden="true" tabindex="-1"></a>    file<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;gwas-norm-337k-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>)</span>
<span id="cb51-45"><a href="ukbb.html#cb51-45" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(file, <span class="at">col_names=</span>T, <span class="at">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb51-46"><a href="ukbb.html#cb51-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin a variable by quantile</span></span>
<span id="cb51-47"><a href="ukbb.html#cb51-47" aria-hidden="true" tabindex="-1"></a>    cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb51-48"><a href="ukbb.html#cb51-48" aria-hidden="true" tabindex="-1"></a>    dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb51-49"><a href="ukbb.html#cb51-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average chisq by bin values</span></span>
<span id="cb51-50"><a href="ukbb.html#cb51-50" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb51-51"><a href="ukbb.html#cb51-51" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb51-52"><a href="ukbb.html#cb51-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-53"><a href="ukbb.html#cb51-53" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb51-54"><a href="ukbb.html#cb51-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;ave r2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ave chisq&quot;</span>,</span>
<span id="cb51-55"><a href="ukbb.html#cb51-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb51-56"><a href="ukbb.html#cb51-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb51-57"><a href="ukbb.html#cb51-57" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb51-58"><a href="ukbb.html#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="he-2" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> HE</h2>
<div id="making-grms-2" class="section level3" number="8.8.1">
<h3><span class="header-section-number">8.8.1</span> making grms</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="ukbb.html#cb52-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2"><a href="ukbb.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># making grm -------------------------------------------------------------------</span></span>
<span id="cb52-3"><a href="ukbb.html#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="ukbb.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb52-5"><a href="ukbb.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb52-6"><a href="ukbb.html#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb52-7"><a href="ukbb.html#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="ukbb.html#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># all snps</span></span>
<span id="cb52-9"><a href="ukbb.html#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb52-10"><a href="ukbb.html#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb52-11"><a href="ukbb.html#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb52-12"><a href="ukbb.html#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb52-13"><a href="ukbb.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb52-14"><a href="ukbb.html#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb52-15"><a href="ukbb.html#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="ukbb.html#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb52-17"><a href="ukbb.html#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/gcta-all-norm </span><span class="dt">\</span></span>
<span id="cb52-18"><a href="ukbb.html#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb52-19"><a href="ukbb.html#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb52-20"><a href="ukbb.html#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb52-21"><a href="ukbb.html#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb52-22"><a href="ukbb.html#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb52-23"><a href="ukbb.html#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-all-snps-norm</span>
<span id="cb52-24"><a href="ukbb.html#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="ukbb.html#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-all-snps-norm <span class="op">&gt;</span> ../job-records/grm-all-snps-norm</span>
<span id="cb52-26"><a href="ukbb.html#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="ukbb.html#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb52-28"><a href="ukbb.html#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&lt;8 {print $2}&#39;</span> geno-norm-100k.bim <span class="op">&gt;</span> left-snps-norm-100k.use </span>
<span id="cb52-29"><a href="ukbb.html#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;$1&gt;=8 {print $2}&#39;</span> geno-norm-100k.bim <span class="op">&gt;</span> right-snps-norm-100k.use</span>
<span id="cb52-30"><a href="ukbb.html#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="ukbb.html#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-32"><a href="ukbb.html#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb52-33"><a href="ukbb.html#cb52-33" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb52-34"><a href="ukbb.html#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb52-35"><a href="ukbb.html#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb52-36"><a href="ukbb.html#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 20:0:0</span></span>
<span id="cb52-37"><a href="ukbb.html#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb52-38"><a href="ukbb.html#cb52-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-39"><a href="ukbb.html#cb52-39" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb52-40"><a href="ukbb.html#cb52-40" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/gcta-</span><span class="va">$i</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb52-41"><a href="ukbb.html#cb52-41" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb52-42"><a href="ukbb.html#cb52-42" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb52-43"><a href="ukbb.html#cb52-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb52-44"><a href="ukbb.html#cb52-44" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb52-45"><a href="ukbb.html#cb52-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb52-46"><a href="ukbb.html#cb52-46" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/grm-gcta-<span class="va">$i</span>-norm</span>
<span id="cb52-47"><a href="ukbb.html#cb52-47" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-48"><a href="ukbb.html#cb52-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-49"><a href="ukbb.html#cb52-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-50"><a href="ukbb.html#cb52-50" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/grm-gcta-<span class="va">$i</span>-norm </span>
<span id="cb52-51"><a href="ukbb.html#cb52-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-gcta-by-snps-norm </span>
<span id="cb52-52"><a href="ukbb.html#cb52-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-53"><a href="ukbb.html#cb52-53" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb52-54"><a href="ukbb.html#cb52-54" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb52-55"><a href="ukbb.html#cb52-55" aria-hidden="true" tabindex="-1"></a><span class="co">#:::</span></span>
<span id="cb52-56"><a href="ukbb.html#cb52-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-57"><a href="ukbb.html#cb52-57" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb52-58"><a href="ukbb.html#cb52-58" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. thin snps</span></span>
<span id="cb52-59"><a href="ukbb.html#cb52-59" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb52-60"><a href="ukbb.html#cb52-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-61"><a href="ukbb.html#cb52-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-62"><a href="ukbb.html#cb52-62" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb52-63"><a href="ukbb.html#cb52-63" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb52-64"><a href="ukbb.html#cb52-64" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb52-65"><a href="ukbb.html#cb52-65" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 4</span></span>
<span id="cb52-66"><a href="ukbb.html#cb52-66" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 4:0:0</span></span>
<span id="cb52-67"><a href="ukbb.html#cb52-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb52-68"><a href="ukbb.html#cb52-68" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 4 </span><span class="dt">\</span></span>
<span id="cb52-69"><a href="ukbb.html#cb52-69" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-prune 0.98 </span><span class="dt">\</span></span>
<span id="cb52-70"><a href="ukbb.html#cb52-70" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-kb 100 </span><span class="dt">\</span></span>
<span id="cb52-71"><a href="ukbb.html#cb52-71" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-norm-100k.use </span><span class="dt">\</span></span>
<span id="cb52-72"><a href="ukbb.html#cb52-72" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb52-73"><a href="ukbb.html#cb52-73" aria-hidden="true" tabindex="-1"></a><span class="st">          --thin ../ldak-thin/chr</span><span class="va">$j</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb52-74"><a href="ukbb.html#cb52-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span></span>
<span id="cb52-75"><a href="ukbb.html#cb52-75" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin<span class="va">$j</span>-norm</span>
<span id="cb52-76"><a href="ukbb.html#cb52-76" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-77"><a href="ukbb.html#cb52-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-78"><a href="ukbb.html#cb52-78" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb52-79"><a href="ukbb.html#cb52-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-80"><a href="ukbb.html#cb52-80" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin<span class="va">$j</span>-norm</span>
<span id="cb52-81"><a href="ukbb.html#cb52-81" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/ldak-thin-norm</span>
<span id="cb52-82"><a href="ukbb.html#cb52-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-83"><a href="ukbb.html#cb52-83" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion---</span></span>
<span id="cb52-84"><a href="ukbb.html#cb52-84" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/ldak-thin-norm</span>
<span id="cb52-85"><a href="ukbb.html#cb52-85" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb52-86"><a href="ukbb.html#cb52-86" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb52-87"><a href="ukbb.html#cb52-87" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-88"><a href="ukbb.html#cb52-88" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb52-89"><a href="ukbb.html#cb52-89" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb52-90"><a href="ukbb.html#cb52-90" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb52-91"><a href="ukbb.html#cb52-91" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb52-92"><a href="ukbb.html#cb52-92" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb52-93"><a href="ukbb.html#cb52-93" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-94"><a href="ukbb.html#cb52-94" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb52-95"><a href="ukbb.html#cb52-95" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb52-96"><a href="ukbb.html#cb52-96" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb52-97"><a href="ukbb.html#cb52-97" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb52-98"><a href="ukbb.html#cb52-98" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb52-99"><a href="ukbb.html#cb52-99" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb52-100"><a href="ukbb.html#cb52-100" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb52-101"><a href="ukbb.html#cb52-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-102"><a href="ukbb.html#cb52-102" aria-hidden="true" tabindex="-1"></a><span class="co"># combine snp list</span></span>
<span id="cb52-103"><a href="ukbb.html#cb52-103" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> ldak-thin/chr{1..22}-norm.in <span class="op">&gt;</span> ldak-thin/ldak-thin-norm.in</span>
<span id="cb52-104"><a href="ukbb.html#cb52-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-105"><a href="ukbb.html#cb52-105" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------</span></span>
<span id="cb52-106"><a href="ukbb.html#cb52-106" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. kinship matrix under ldak-thin</span></span>
<span id="cb52-107"><a href="ukbb.html#cb52-107" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------</span></span>
<span id="cb52-108"><a href="ukbb.html#cb52-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-109"><a href="ukbb.html#cb52-109" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb52-110"><a href="ukbb.html#cb52-110" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb52-111"><a href="ukbb.html#cb52-111" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb52-112"><a href="ukbb.html#cb52-112" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb52-113"><a href="ukbb.html#cb52-113" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb52-114"><a href="ukbb.html#cb52-114" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb52-115"><a href="ukbb.html#cb52-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-116"><a href="ukbb.html#cb52-116" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb52-117"><a href="ukbb.html#cb52-117" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/ldak-thin-all-norm </span><span class="dt">\</span></span>
<span id="cb52-118"><a href="ukbb.html#cb52-118" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb52-119"><a href="ukbb.html#cb52-119" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../ldak-thin/ldak-thin-norm.in </span><span class="dt">\</span></span>
<span id="cb52-120"><a href="ukbb.html#cb52-120" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb52-121"><a href="ukbb.html#cb52-121" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb52-122"><a href="ukbb.html#cb52-122" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb52-123"><a href="ukbb.html#cb52-123" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-all-snps-norm</span>
<span id="cb52-124"><a href="ukbb.html#cb52-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-125"><a href="ukbb.html#cb52-125" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-all-snps-norm <span class="op">&gt;</span> ../job-records/ldak-thin-grm-all-snps-norm</span>
<span id="cb52-126"><a href="ukbb.html#cb52-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-127"><a href="ukbb.html#cb52-127" aria-hidden="true" tabindex="-1"></a><span class="co"># grm by snp blocks: right vs. left</span></span>
<span id="cb52-128"><a href="ukbb.html#cb52-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-129"><a href="ukbb.html#cb52-129" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&lt;8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb52-130"><a href="ukbb.html#cb52-130" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-norm.in <span class="op">&gt;</span> gen/left-ldak-thin-norm.snps </span>
<span id="cb52-131"><a href="ukbb.html#cb52-131" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{split($1, a, /[:]/); if (a[1]&gt;=8) print $1}&#39;</span> <span class="dt">\</span></span>
<span id="cb52-132"><a href="ukbb.html#cb52-132" aria-hidden="true" tabindex="-1"></a> ldak-thin/ldak-thin-norm.in <span class="op">&gt;</span> gen/right-ldak-thin-norm.snps </span>
<span id="cb52-133"><a href="ukbb.html#cb52-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-134"><a href="ukbb.html#cb52-134" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-135"><a href="ukbb.html#cb52-135" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb52-136"><a href="ukbb.html#cb52-136" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb52-137"><a href="ukbb.html#cb52-137" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 60G</span></span>
<span id="cb52-138"><a href="ukbb.html#cb52-138" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb52-139"><a href="ukbb.html#cb52-139" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 08:0:0</span></span>
<span id="cb52-140"><a href="ukbb.html#cb52-140" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb52-141"><a href="ukbb.html#cb52-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-142"><a href="ukbb.html#cb52-142" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 10 </span><span class="dt">\</span></span>
<span id="cb52-143"><a href="ukbb.html#cb52-143" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship/ldak-thin-</span><span class="va">$i</span><span class="st">-norm </span><span class="dt">\</span></span>
<span id="cb52-144"><a href="ukbb.html#cb52-144" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-norm-100k </span><span class="dt">\</span></span>
<span id="cb52-145"><a href="ukbb.html#cb52-145" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/</span><span class="va">$i</span><span class="st">-ldak-thin-norm.snps </span><span class="dt">\</span></span>
<span id="cb52-146"><a href="ukbb.html#cb52-146" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -0.25 </span><span class="dt">\</span></span>
<span id="cb52-147"><a href="ukbb.html#cb52-147" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb52-148"><a href="ukbb.html#cb52-148" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb52-149"><a href="ukbb.html#cb52-149" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/ldak-thin-grm-<span class="va">$i</span>-norm</span>
<span id="cb52-150"><a href="ukbb.html#cb52-150" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb52-151"><a href="ukbb.html#cb52-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-152"><a href="ukbb.html#cb52-152" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-153"><a href="ukbb.html#cb52-153" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/ldak-thin-grm-<span class="va">$i</span>-norm </span>
<span id="cb52-154"><a href="ukbb.html#cb52-154" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-ldak-thin-by-snps-norm </span></code></pre></div>
</div>
<div id="estimation-2" class="section level3" number="8.8.2">
<h3><span class="header-section-number">8.8.2</span> estimation</h3>
<p>NEED To check what covariates to adjust for HE
basic.covariates.use or covariates.use?</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="ukbb.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regress grm on covariates-----------------------------------------------------</span></span>
<span id="cb53-2"><a href="ukbb.html#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="ukbb.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-norm gcta-left-norm gcta-right-norm ldak-thin-all-norm ldak-thin-left-norm ldak-thin-right-norm<span class="kw">;</span> <span class="cf">do</span>  </span>
<span id="cb53-4"><a href="ukbb.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb53-5"><a href="ukbb.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb53-6"><a href="ukbb.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb53-7"><a href="ukbb.html#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 50G</span></span>
<span id="cb53-8"><a href="ukbb.html#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 5</span></span>
<span id="cb53-9"><a href="ukbb.html#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb53-10"><a href="ukbb.html#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --adjust-grm ../kinship/</span><span class="va">$grm</span><span class="st">.covar </span><span class="dt">\</span></span>
<span id="cb53-11"><a href="ukbb.html#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/</span><span class="va">$grm</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb53-12"><a href="ukbb.html#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb53-13"><a href="ukbb.html#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 5</span></span>
<span id="cb53-14"><a href="ukbb.html#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb53-15"><a href="ukbb.html#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-16"><a href="ukbb.html#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="ukbb.html#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb53-18"><a href="ukbb.html#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> grm <span class="kw">in</span> gcta-all-norm gcta-left-norm gcta-right-norm ldak-thin-all-norm ldak-thin-left-norm ldak-thin-right-norm<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-19"><a href="ukbb.html#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$grm</span>-adjust.sh</span>
<span id="cb53-20"><a href="ukbb.html#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-adjust-for-HE</span>
<span id="cb53-21"><a href="ukbb.html#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="ukbb.html#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check job completion----------------------------------------------------------</span></span>
<span id="cb53-23"><a href="ukbb.html#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="va">file</span><span class="op">=</span>job-records/grm-adjust-for-HE</span>
<span id="cb53-24"><a href="ukbb.html#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="va">jobs</span><span class="op">=</span><span class="kw">`</span><span class="fu">awk</span> <span class="st">&#39;{print $4}&#39;</span> <span class="va">$file</span><span class="kw">`</span></span>
<span id="cb53-25"><a href="ukbb.html#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">$file</span>-tmp</span>
<span id="cb53-26"><a href="ukbb.html#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$jobs</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-27"><a href="ukbb.html#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1~/Name/ {print i, $2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/name.tmp </span>
<span id="cb53-28"><a href="ukbb.html#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/State/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/state.tmp</span>
<span id="cb53-29"><a href="ukbb.html#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Cores/ {print$2}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/cores.tmp</span>
<span id="cb53-30"><a href="ukbb.html#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Used walltime/ {print $2 &quot;:&quot; $3 &quot;:&quot; $4}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/time.tmp</span>
<span id="cb53-31"><a href="ukbb.html#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="ex">jobinfo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F</span> <span class="st">&quot;:&quot;</span> <span class="st">&#39;$1~/Max Mem/ {split($2,a,/[(]/ ); print a[1]}&#39;</span> <span class="op">&gt;&gt;</span> <span class="va">$file</span>-tmp/mem.tmp</span>
<span id="cb53-32"><a href="ukbb.html#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-33"><a href="ukbb.html#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="va">$file</span>-tmp/name.tmp <span class="dt">\</span></span>
<span id="cb53-34"><a href="ukbb.html#cb53-34" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/state.tmp <span class="dt">\</span></span>
<span id="cb53-35"><a href="ukbb.html#cb53-35" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/cores.tmp <span class="dt">\</span></span>
<span id="cb53-36"><a href="ukbb.html#cb53-36" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/time.tmp <span class="dt">\</span></span>
<span id="cb53-37"><a href="ukbb.html#cb53-37" aria-hidden="true" tabindex="-1"></a>      <span class="va">$file</span>-tmp/mem.tmp <span class="dt">\</span></span>
<span id="cb53-38"><a href="ukbb.html#cb53-38" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{print &quot;ID name state cores time mem&quot;}{print $0}&#39;</span> <span class="op">&gt;</span> <span class="va">$file</span>.out</span>
<span id="cb53-39"><a href="ukbb.html#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> <span class="va">$file</span>-tmp</span>
<span id="cb53-40"><a href="ukbb.html#cb53-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-41"><a href="ukbb.html#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under gcta-----------------------------------------------------------------</span></span>
<span id="cb53-42"><a href="ukbb.html#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-43"><a href="ukbb.html#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-44"><a href="ukbb.html#cb53-44" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb53-45"><a href="ukbb.html#cb53-45" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb53-46"><a href="ukbb.html#cb53-46" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb53-47"><a href="ukbb.html#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb53-48"><a href="ukbb.html#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb53-49"><a href="ukbb.html#cb53-49" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:30:0</span></span>
<span id="cb53-50"><a href="ukbb.html#cb53-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-51"><a href="ukbb.html#cb53-51" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../he-norm/</span><span class="va">$i</span><span class="st">-he-gcta-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb53-52"><a href="ukbb.html#cb53-52" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb53-53"><a href="ukbb.html#cb53-53" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/gcta-</span><span class="va">$k</span><span class="st">-norm.covar </span><span class="dt">\</span></span>
<span id="cb53-54"><a href="ukbb.html#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb53-55"><a href="ukbb.html#cb53-55" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb53-56"><a href="ukbb.html#cb53-56" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb53-57"><a href="ukbb.html#cb53-57" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb53-58"><a href="ukbb.html#cb53-58" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb53-59"><a href="ukbb.html#cb53-59" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps-norm.sh</span>
<span id="cb53-60"><a href="ukbb.html#cb53-60" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-61"><a href="ukbb.html#cb53-61" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-62"><a href="ukbb.html#cb53-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-63"><a href="ukbb.html#cb53-63" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb53-64"><a href="ukbb.html#cb53-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-65"><a href="ukbb.html#cb53-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-66"><a href="ukbb.html#cb53-66" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-gcta-<span class="va">$k</span>-snps-norm.sh</span>
<span id="cb53-67"><a href="ukbb.html#cb53-67" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-68"><a href="ukbb.html#cb53-68" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-gcta</span>
<span id="cb53-69"><a href="ukbb.html#cb53-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-70"><a href="ukbb.html#cb53-70" aria-hidden="true" tabindex="-1"></a><span class="co"># HE under ldak-thin------------------------------------------------------------</span></span>
<span id="cb53-71"><a href="ukbb.html#cb53-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-72"><a href="ukbb.html#cb53-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-73"><a href="ukbb.html#cb53-73" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb53-74"><a href="ukbb.html#cb53-74" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb53-75"><a href="ukbb.html#cb53-75" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb53-76"><a href="ukbb.html#cb53-76" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 2G</span></span>
<span id="cb53-77"><a href="ukbb.html#cb53-77" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 1</span></span>
<span id="cb53-78"><a href="ukbb.html#cb53-78" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 0:30:0</span></span>
<span id="cb53-79"><a href="ukbb.html#cb53-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-80"><a href="ukbb.html#cb53-80" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --he ../he-norm/</span><span class="va">$i</span><span class="st">-he-ldak-thin-</span><span class="va">$k</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb53-81"><a href="ukbb.html#cb53-81" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb53-82"><a href="ukbb.html#cb53-82" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship/ldak-thin-</span><span class="va">$k</span><span class="st">-norm.covar </span><span class="dt">\</span></span>
<span id="cb53-83"><a href="ukbb.html#cb53-83" aria-hidden="true" tabindex="-1"></a><span class="st">          --kinship-details NO </span><span class="dt">\</span></span>
<span id="cb53-84"><a href="ukbb.html#cb53-84" aria-hidden="true" tabindex="-1"></a><span class="st">          --check-root NO </span><span class="dt">\</span></span>
<span id="cb53-85"><a href="ukbb.html#cb53-85" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/covariates.use </span><span class="dt">\</span></span>
<span id="cb53-86"><a href="ukbb.html#cb53-86" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 1 </span><span class="dt">\</span></span>
<span id="cb53-87"><a href="ukbb.html#cb53-87" aria-hidden="true" tabindex="-1"></a><span class="st">          --memory-save YES</span></span>
<span id="cb53-88"><a href="ukbb.html#cb53-88" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-norm.sh</span>
<span id="cb53-89"><a href="ukbb.html#cb53-89" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-90"><a href="ukbb.html#cb53-90" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-91"><a href="ukbb.html#cb53-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-92"><a href="ukbb.html#cb53-92" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb53-93"><a href="ukbb.html#cb53-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-94"><a href="ukbb.html#cb53-94" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> all left right<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb53-95"><a href="ukbb.html#cb53-95" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-he-ldak-thin-<span class="va">$k</span>-norm.sh</span>
<span id="cb53-96"><a href="ukbb.html#cb53-96" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb53-97"><a href="ukbb.html#cb53-97" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/he-ldak-thin</span></code></pre></div>
</div>
<div id="summary-6" class="section level3" number="8.8.3">
<h3><span class="header-section-number">8.8.3</span> summary</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="ukbb.html#cb54-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-2"><a href="ukbb.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb54-3"><a href="ukbb.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># under gcta</span></span>
<span id="cb54-4"><a href="ukbb.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb54-5"><a href="ukbb.html#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="ukbb.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb54-7"><a href="ukbb.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb54-8"><a href="ukbb.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-norm.right </span>
<span id="cb54-9"><a href="ukbb.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-10"><a href="ukbb.html#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-right.he</span>
<span id="cb54-11"><a href="ukbb.html#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-norm.right</span>
<span id="cb54-12"><a href="ukbb.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-13"><a href="ukbb.html#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="ukbb.html#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb54-15"><a href="ukbb.html#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-norm.left</span>
<span id="cb54-16"><a href="ukbb.html#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-17"><a href="ukbb.html#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-left.he</span>
<span id="cb54-18"><a href="ukbb.html#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-norm.left</span>
<span id="cb54-19"><a href="ukbb.html#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-20"><a href="ukbb.html#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="ukbb.html#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb54-22"><a href="ukbb.html#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-gcta-norm.all</span>
<span id="cb54-23"><a href="ukbb.html#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-24"><a href="ukbb.html#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb54-25"><a href="ukbb.html#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-gcta-norm.all</span>
<span id="cb54-26"><a href="ukbb.html#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-27"><a href="ukbb.html#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="ukbb.html#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb54-29"><a href="ukbb.html#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb54-30"><a href="ukbb.html#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="ukbb.html#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-norm.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb54-32"><a href="ukbb.html#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-norm.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb54-33"><a href="ukbb.html#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-gcta-norm.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb54-34"><a href="ukbb.html#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb54-35"><a href="ukbb.html#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb54-36"><a href="ukbb.html#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb54-37"><a href="ukbb.html#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-38"><a href="ukbb.html#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-39"><a href="ukbb.html#cb54-39" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-40"><a href="ukbb.html#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-41"><a href="ukbb.html#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-42"><a href="ukbb.html#cb54-42" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb54-43"><a href="ukbb.html#cb54-43" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb54-44"><a href="ukbb.html#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb54-45"><a href="ukbb.html#cb54-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-46"><a href="ukbb.html#cb54-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb54-47"><a href="ukbb.html#cb54-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-48"><a href="ukbb.html#cb54-48" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb54-49"><a href="ukbb.html#cb54-49" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb54-50"><a href="ukbb.html#cb54-50" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb54-51"><a href="ukbb.html#cb54-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb54-52"><a href="ukbb.html#cb54-52" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb54-53"><a href="ukbb.html#cb54-53" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb54-54"><a href="ukbb.html#cb54-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb54-55"><a href="ukbb.html#cb54-55" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb54-56"><a href="ukbb.html#cb54-56" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb54-57"><a href="ukbb.html#cb54-57" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb54-58"><a href="ukbb.html#cb54-58" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb54-59"><a href="ukbb.html#cb54-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-60"><a href="ukbb.html#cb54-60" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb54-61"><a href="ukbb.html#cb54-61" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb54-62"><a href="ukbb.html#cb54-62" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb54-63"><a href="ukbb.html#cb54-63" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb54-64"><a href="ukbb.html#cb54-64" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb54-65"><a href="ukbb.html#cb54-65" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb54-66"><a href="ukbb.html#cb54-66" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb54-67"><a href="ukbb.html#cb54-67" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb54-68"><a href="ukbb.html#cb54-68" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb54-69"><a href="ukbb.html#cb54-69" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb54-70"><a href="ukbb.html#cb54-70" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-gcta-inflation-norm.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb54-71"><a href="ukbb.html#cb54-71" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb54-72"><a href="ukbb.html#cb54-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-73"><a href="ukbb.html#cb54-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-74"><a href="ukbb.html#cb54-74" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb54-75"><a href="ukbb.html#cb54-75" aria-hidden="true" tabindex="-1"></a><span class="co"># under ldak-thin</span></span>
<span id="cb54-76"><a href="ukbb.html#cb54-76" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::</span></span>
<span id="cb54-77"><a href="ukbb.html#cb54-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-78"><a href="ukbb.html#cb54-78" aria-hidden="true" tabindex="-1"></a><span class="co"># extract h2 estimates ---------------------------------------------------------</span></span>
<span id="cb54-79"><a href="ukbb.html#cb54-79" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb54-80"><a href="ukbb.html#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-norm.right </span>
<span id="cb54-81"><a href="ukbb.html#cb54-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-82"><a href="ukbb.html#cb54-82" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-ldak-thin-right.he</span>
<span id="cb54-83"><a href="ukbb.html#cb54-83" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-norm.right</span>
<span id="cb54-84"><a href="ukbb.html#cb54-84" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-85"><a href="ukbb.html#cb54-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-86"><a href="ukbb.html#cb54-86" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb54-87"><a href="ukbb.html#cb54-87" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-norm.left</span>
<span id="cb54-88"><a href="ukbb.html#cb54-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-89"><a href="ukbb.html#cb54-89" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-ldak-thin-left.he</span>
<span id="cb54-90"><a href="ukbb.html#cb54-90" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-norm.left</span>
<span id="cb54-91"><a href="ukbb.html#cb54-91" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-92"><a href="ukbb.html#cb54-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-93"><a href="ukbb.html#cb54-93" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb54-94"><a href="ukbb.html#cb54-94" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> summary/he-ldak-thin-norm.all</span>
<span id="cb54-95"><a href="ukbb.html#cb54-95" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb54-96"><a href="ukbb.html#cb54-96" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>he-norm/<span class="va">$i</span>-he-gcta-all.he</span>
<span id="cb54-97"><a href="ukbb.html#cb54-97" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-v</span> i=<span class="va">$i</span> <span class="st">&#39;$1==&quot;Her_All&quot; {print i, $2, $3}&#39;</span> <span class="va">$outfile</span> <span class="op">&gt;&gt;</span> summary/he-ldak-thin-norm.all</span>
<span id="cb54-98"><a href="ukbb.html#cb54-98" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb54-99"><a href="ukbb.html#cb54-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-100"><a href="ukbb.html#cb54-100" aria-hidden="true" tabindex="-1"></a><span class="co"># inflation test----------------------------------------------------------------</span></span>
<span id="cb54-101"><a href="ukbb.html#cb54-101" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb54-102"><a href="ukbb.html#cb54-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-103"><a href="ukbb.html#cb54-103" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-norm.all&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb54-104"><a href="ukbb.html#cb54-104" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-norm.left&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb54-105"><a href="ukbb.html#cb54-105" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>read.table<span class="kw">(</span><span class="ex">paste0</span><span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-norm.right&quot;</span><span class="kw">)</span><span class="ex">,</span> header=F<span class="kw">)</span></span>
<span id="cb54-106"><a href="ukbb.html#cb54-106" aria-hidden="true" tabindex="-1"></a><span class="ex">names</span><span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">left</span><span class="kw">)</span><span class="ex">=names</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span><span class="ex">=c</span><span class="er">(</span><span class="st">&quot;code&quot;</span><span class="ex">,</span><span class="st">&quot;h2&quot;</span><span class="ex">,</span><span class="st">&quot;se&quot;</span><span class="kw">)</span></span>
<span id="cb54-107"><a href="ukbb.html#cb54-107" aria-hidden="true" tabindex="-1"></a><span class="co"># some analyses did not complete --&gt; match dataframes</span></span>
<span id="cb54-108"><a href="ukbb.html#cb54-108" aria-hidden="true" tabindex="-1"></a><span class="ex">dim</span><span class="er">(</span><span class="ex">full</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">left</span><span class="kw">);</span><span class="ex">dim</span><span class="er">(</span><span class="ex">right</span><span class="kw">)</span></span>
<span id="cb54-109"><a href="ukbb.html#cb54-109" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">full</span><span class="va">$code</span><span class="ex">,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-110"><a href="ukbb.html#cb54-110" aria-hidden="true" tabindex="-1"></a><span class="va">common</span><span class="op">=</span>intersect<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-111"><a href="ukbb.html#cb54-111" aria-hidden="true" tabindex="-1"></a><span class="va">m1</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> right<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-112"><a href="ukbb.html#cb54-112" aria-hidden="true" tabindex="-1"></a><span class="va">m2</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> full<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-113"><a href="ukbb.html#cb54-113" aria-hidden="true" tabindex="-1"></a><span class="va">m3</span><span class="op">=</span>match<span class="kw">(</span><span class="ex">common,</span> left<span class="va">$code</span><span class="kw">)</span></span>
<span id="cb54-114"><a href="ukbb.html#cb54-114" aria-hidden="true" tabindex="-1"></a><span class="va">right</span><span class="op">=</span>right[m1,]</span>
<span id="cb54-115"><a href="ukbb.html#cb54-115" aria-hidden="true" tabindex="-1"></a><span class="va">full</span><span class="op">=</span>full[m2,]</span>
<span id="cb54-116"><a href="ukbb.html#cb54-116" aria-hidden="true" tabindex="-1"></a><span class="va">left</span><span class="op">=</span>left[m3,]</span>
<span id="cb54-117"><a href="ukbb.html#cb54-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-118"><a href="ukbb.html#cb54-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="kw">(</span><span class="ex">i</span> in 1:dim<span class="er">(</span><span class="ex">full</span><span class="kw">)</span><span class="ex">[1]</span><span class="kw">){</span></span>
<span id="cb54-119"><a href="ukbb.html#cb54-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-120"><a href="ukbb.html#cb54-120" aria-hidden="true" tabindex="-1"></a>    <span class="va">est1</span><span class="op">=</span>left<span class="va">$h2</span>[i]</span>
<span id="cb54-121"><a href="ukbb.html#cb54-121" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd1</span><span class="op">=</span>left<span class="va">$se</span>[i]</span>
<span id="cb54-122"><a href="ukbb.html#cb54-122" aria-hidden="true" tabindex="-1"></a>    <span class="va">est2</span><span class="op">=</span>right<span class="va">$h2</span>[i]</span>
<span id="cb54-123"><a href="ukbb.html#cb54-123" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd2</span><span class="op">=</span>right<span class="va">$se</span>[i]</span>
<span id="cb54-124"><a href="ukbb.html#cb54-124" aria-hidden="true" tabindex="-1"></a>    <span class="va">est</span><span class="op">=</span>full<span class="va">$h2</span>[i]</span>
<span id="cb54-125"><a href="ukbb.html#cb54-125" aria-hidden="true" tabindex="-1"></a>    <span class="va">sd</span><span class="op">=</span>full<span class="va">$se</span>[i]</span>
<span id="cb54-126"><a href="ukbb.html#cb54-126" aria-hidden="true" tabindex="-1"></a>    <span class="va">N</span><span class="op">=</span>100000</span>
<span id="cb54-127"><a href="ukbb.html#cb54-127" aria-hidden="true" tabindex="-1"></a>    <span class="va">d1</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est1,sd1</span><span class="kw">)</span></span>
<span id="cb54-128"><a href="ukbb.html#cb54-128" aria-hidden="true" tabindex="-1"></a>    <span class="va">d2</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est2,sd2</span><span class="kw">)</span></span>
<span id="cb54-129"><a href="ukbb.html#cb54-129" aria-hidden="true" tabindex="-1"></a>    <span class="va">d</span><span class="op">=</span>rnorm<span class="kw">(</span><span class="ex">N,est,sd</span><span class="kw">)</span></span>
<span id="cb54-130"><a href="ukbb.html#cb54-130" aria-hidden="true" tabindex="-1"></a>    <span class="va">p</span><span class="op">=</span>1-mean<span class="kw">(</span><span class="ex">d1+d2-d</span><span class="op">&gt;</span>=0<span class="kw">)</span></span>
<span id="cb54-131"><a href="ukbb.html#cb54-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-132"><a href="ukbb.html#cb54-132" aria-hidden="true" tabindex="-1"></a>    <span class="va">out0</span><span class="op">=</span>data.frame<span class="kw">(</span><span class="va">code</span><span class="op">=</span>full<span class="va">$code</span>[i],</span>
<span id="cb54-133"><a href="ukbb.html#cb54-133" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_est</span><span class="op">=</span>est2,</span>
<span id="cb54-134"><a href="ukbb.html#cb54-134" aria-hidden="true" tabindex="-1"></a>                    <span class="va">right_sd</span><span class="op">=</span>sd2,</span>
<span id="cb54-135"><a href="ukbb.html#cb54-135" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_est</span><span class="op">=</span>est1,</span>
<span id="cb54-136"><a href="ukbb.html#cb54-136" aria-hidden="true" tabindex="-1"></a>                    <span class="va">left_sd</span><span class="op">=</span>sd1,</span>
<span id="cb54-137"><a href="ukbb.html#cb54-137" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_est</span><span class="op">=</span>est,</span>
<span id="cb54-138"><a href="ukbb.html#cb54-138" aria-hidden="true" tabindex="-1"></a>                    <span class="va">all_sd</span><span class="op">=</span>sd,</span>
<span id="cb54-139"><a href="ukbb.html#cb54-139" aria-hidden="true" tabindex="-1"></a>                    <span class="va">p_inflation</span><span class="op">=</span>p<span class="kw">)</span></span>
<span id="cb54-140"><a href="ukbb.html#cb54-140" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span><span class="kw">(</span><span class="va">i</span><span class="op">=</span>=1<span class="kw">)</span><span class="ex">{out=out0}else</span><span class="dt">{out=rbind(out</span><span class="op">,</span><span class="dt">out0)}</span></span>
<span id="cb54-141"><a href="ukbb.html#cb54-141" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb54-142"><a href="ukbb.html#cb54-142" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="ex">out,</span> paste0<span class="er">(</span><span class="st">&quot;summary/he-ldak-thin-inflation-norm.txt&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb54-143"><a href="ukbb.html#cb54-143" aria-hidden="true" tabindex="-1"></a>            <span class="ex">col.names=T,</span> row.names=F, quote=F<span class="kw">)</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bad.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="control.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04.3-ukbb-recommended.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
