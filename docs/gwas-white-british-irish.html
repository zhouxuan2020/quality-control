<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 GWAS: White British + Irish | GWAS Quality Control</title>
  <meta name="description" content="13 GWAS: White British + Irish | GWAS Quality Control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="13 GWAS: White British + Irish | GWAS Quality Control" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 GWAS: White British + Irish | GWAS Quality Control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="previous-gwas.html"/>
<link rel="next" href="related-individuals.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>2</b> summary</a></li>
<li class="chapter" data-level="3" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>3</b> Summaries</a>
<ul>
<li class="chapter" data-level="3.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>3.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>3.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>3.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>3.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>3.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>3.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>3.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>3.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>3.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="summaries.html"><a href="summaries.html#control-gwas"><i class="fa fa-check"></i><b>3.4</b> Control GWAS</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-3"><i class="fa fa-check"></i><b>3.4.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="3.4.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-3"><i class="fa fa-check"></i><b>3.4.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>4</b> summary</a></li>
<li class="chapter" data-level="5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html"><i class="fa fa-check"></i><b>5</b> Good VS Bad GWAS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-statistics-ld-score"><i class="fa fa-check"></i><b>5.1</b> test statistics ~ LD score</a></li>
<li class="chapter" data-level="5.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#new-models"><i class="fa fa-check"></i><b>5.2</b> New models?</a></li>
<li class="chapter" data-level="5.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ld-scores-based-on-individual-level-data"><i class="fa fa-check"></i><b>5.3</b> LD scores based on individual level data</a></li>
<li class="chapter" data-level="5.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#test-the-new-model"><i class="fa fa-check"></i><b>5.4</b> Test the new model</a></li>
<li class="chapter" data-level="5.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predictors-of-inflation"><i class="fa fa-check"></i><b>5.5</b> predictors of inflation?</a></li>
<li class="chapter" data-level="5.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#regress-chisq-mean-r2_j"><i class="fa fa-check"></i><b>5.6</b> regress chisq ~ mean r^2_j</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plots"><i class="fa fa-check"></i><b>5.6.1</b> plots</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#predict-inflation-aver2_j"><i class="fa fa-check"></i><b>5.7</b> predict inflation | aver2_j ?</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good_chisq-vs.-adj_chisq"><i class="fa fa-check"></i><b>5.7.1</b> good_chisq vs. adj_chisq</a></li>
<li class="chapter" data-level="5.7.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>5.7.2</b> bad gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="5.7.3" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>5.7.3</b> bad gwas: inf. vs. inf._hat: ave</a></li>
<li class="chapter" data-level="5.7.4" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#bad-gwas-inf.-from-full-model"><i class="fa fa-check"></i><b>5.7.4</b> bad gwas: inf. from full model</a></li>
<li class="chapter" data-level="5.7.5" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#to-explore-change"><i class="fa fa-check"></i><b>5.7.5</b> To Explore: change??</a></li>
<li class="chapter" data-level="5.7.6" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-raw"><i class="fa fa-check"></i><b>5.7.6</b> good gwas: inf. vs. inf._hat: raw</a></li>
<li class="chapter" data-level="5.7.7" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#good-gwas-inf.-vs.-inf._hat-ave"><i class="fa fa-check"></i><b>5.7.7</b> good gwas: inf. vs. inf._hat: ave</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#ukbb_337k_inflation"><i class="fa fa-check"></i><b>5.8</b> UKBB N = 337k</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#organize-data"><i class="fa fa-check"></i><b>5.8.1</b> organize data</a></li>
<li class="chapter" data-level="5.8.2" data-path="good-vs-bad-gwas.html"><a href="good-vs-bad-gwas.html#plot"><i class="fa fa-check"></i><b>5.8.2</b> plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mathematical-details.html"><a href="mathematical-details.html"><i class="fa fa-check"></i><b>6</b> Mathematical Details</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mathematical-details.html"><a href="mathematical-details.html#trk_rightk_left"><i class="fa fa-check"></i><b>6.1</b> <span class="math inline">\(tr(K_{right}K_{left})\)</span></a></li>
<li class="chapter" data-level="6.2" data-path="mathematical-details.html"><a href="mathematical-details.html#verification"><i class="fa fa-check"></i><b>6.2</b> verification</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html"><i class="fa fa-check"></i><b>7</b> chi square ~ <span class="math inline">\(\overline{r^2_j}\)</span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#overliner2_j-choice-of-snps"><i class="fa fa-check"></i><b>7.1</b> <span class="math inline">\(\overline{r^2_j}\)</span> &amp; choice of SNPs</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#number-of-snps"><i class="fa fa-check"></i><b>7.1.1</b> number of SNPs</a></li>
<li class="chapter" data-level="7.1.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#maf"><i class="fa fa-check"></i><b>7.1.2</b> maf</a></li>
<li class="chapter" data-level="7.1.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#summary-2"><i class="fa fa-check"></i><b>7.1.3</b> summary</a></li>
<li class="chapter" data-level="7.1.4" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#final-plots"><i class="fa fa-check"></i><b>7.1.4</b> Final plots</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#varying-levels-of-confouding"><i class="fa fa-check"></i><b>7.2</b> varying levels of confouding</a></li>
<li class="chapter" data-level="7.3" data-path="chi-square-overliner2_j.html"><a href="chi-square-overliner2_j.html#results-summary"><i class="fa fa-check"></i><b>7.3</b> results summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>8</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>8.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="8.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>8.2</b> extract covariates</a></li>
<li class="chapter" data-level="8.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>8.3</b> GWAS</a></li>
<li class="chapter" data-level="8.4" data-path="good.html"><a href="good.html#chisq-aver2_j"><i class="fa fa-check"></i><b>8.4</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="8.5" data-path="good.html"><a href="good.html#ldsc-interce"><i class="fa fa-check"></i><b>8.5</b> ldsc interce</a></li>
<li class="chapter" data-level="8.6" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>8.6</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>8.6.1</b> under gcta</a></li>
<li class="chapter" data-level="8.6.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>8.6.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="8.6.3" data-path="good.html"><a href="good.html#summary-3"><i class="fa fa-check"></i><b>8.6.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>8.7</b> REML</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>8.7.1</b> making grms</a></li>
<li class="chapter" data-level="8.7.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>8.7.2</b> fast-reml</a></li>
<li class="chapter" data-level="8.7.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>8.7.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>8.8</b> HE</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>8.8.1</b> estimation</a></li>
<li class="chapter" data-level="8.8.2" data-path="good.html"><a href="good.html#summary-4"><i class="fa fa-check"></i><b>8.8.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>9</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>9.1</b> ID list</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>9.1.1</b> initial selection</a></li>
<li class="chapter" data-level="9.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>9.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="9.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>9.1.3</b> final list</a></li>
<li class="chapter" data-level="9.1.4" data-path="bad.html"><a href="bad.html#pc-plot"><i class="fa fa-check"></i><b>9.1.4</b> PC plot</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bad.html"><a href="bad.html#gwas-lm"><i class="fa fa-check"></i><b>9.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="bad.html"><a href="bad.html#basic-cov"><i class="fa fa-check"></i><b>9.2.1</b> basic cov</a></li>
<li class="chapter" data-level="9.2.2" data-path="bad.html"><a href="bad.html#basic-cov-pc"><i class="fa fa-check"></i><b>9.2.2</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="bad.html"><a href="bad.html#gwas-bolt-lmm"><i class="fa fa-check"></i><b>9.3</b> GWAS-bolt-lmm</a></li>
<li class="chapter" data-level="9.4" data-path="bad.html"><a href="bad.html#correct-genotypes"><i class="fa fa-check"></i><b>9.4</b> correct genotypes</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="bad.html"><a href="bad.html#cal-aver2"><i class="fa fa-check"></i><b>9.4.1</b> cal-aver2</a></li>
<li class="chapter" data-level="9.4.2" data-path="bad.html"><a href="bad.html#compare-changes-in-aver2"><i class="fa fa-check"></i><b>9.4.2</b> compare changes in aver2</a></li>
<li class="chapter" data-level="9.4.3" data-path="bad.html"><a href="bad.html#chisq-aver2"><i class="fa fa-check"></i><b>9.4.3</b> chisq ~ aver2</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="bad.html"><a href="bad.html#chisq-aver2_j-1"><i class="fa fa-check"></i><b>9.5</b> chisq ~ aver2_j</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="bad.html"><a href="bad.html#calc-aver2_j"><i class="fa fa-check"></i><b>9.5.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="9.5.2" data-path="bad.html"><a href="bad.html#bolt-lmm"><i class="fa fa-check"></i><b>9.5.2</b> bolt-lmm</a></li>
<li class="chapter" data-level="9.5.3" data-path="bad.html"><a href="bad.html#basic-cov-pc-1"><i class="fa fa-check"></i><b>9.5.3</b> basic cov + PC</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>9.6</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>9.6.1</b> under gcta</a></li>
<li class="chapter" data-level="9.6.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>9.6.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="9.6.3" data-path="bad.html"><a href="bad.html#summary-5"><i class="fa fa-check"></i><b>9.6.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>9.7</b> REML</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>9.7.1</b> making grms</a></li>
<li class="chapter" data-level="9.7.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>9.7.2</b> fast-reml</a></li>
<li class="chapter" data-level="9.7.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>9.7.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>9.8</b> HE</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>9.8.1</b> estimation</a></li>
<li class="chapter" data-level="9.8.2" data-path="bad.html"><a href="bad.html#summary-6"><i class="fa fa-check"></i><b>9.8.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>10</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>10.1</b> total N = 337k</a></li>
<li class="chapter" data-level="10.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>10.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="10.3" data-path="ukbb.html"><a href="ukbb.html#gwas-100k"><i class="fa fa-check"></i><b>10.3</b> GWAS-100k</a></li>
<li class="chapter" data-level="10.4" data-path="ukbb.html"><a href="ukbb.html#gwas-337k"><i class="fa fa-check"></i><b>10.4</b> GWAS-337k</a></li>
<li class="chapter" data-level="10.5" data-path="ukbb.html"><a href="ukbb.html#ldsc-100k"><i class="fa fa-check"></i><b>10.5</b> ldsc-100k</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>10.5.1</b> under gcta</a></li>
<li class="chapter" data-level="10.5.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>10.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="10.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-7"><i class="fa fa-check"></i><b>10.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="ukbb.html"><a href="ukbb.html#ldsc-337k"><i class="fa fa-check"></i><b>10.6</b> ldsc-337k</a></li>
<li class="chapter" data-level="10.7" data-path="ukbb.html"><a href="ukbb.html#aver2_j-337k"><i class="fa fa-check"></i><b>10.7</b> aver2_j-337k</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="ukbb.html"><a href="ukbb.html#calc"><i class="fa fa-check"></i><b>10.7.1</b> calc</a></li>
<li class="chapter" data-level="10.7.2" data-path="ukbb.html"><a href="ukbb.html#organize-data-1"><i class="fa fa-check"></i><b>10.7.2</b> organize data</a></li>
<li class="chapter" data-level="10.7.3" data-path="ukbb.html"><a href="ukbb.html#chisq-aver2_j-2"><i class="fa fa-check"></i><b>10.7.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>10.8</b> HE</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>10.8.1</b> making grms</a></li>
<li class="chapter" data-level="10.8.2" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>10.8.2</b> estimation</a></li>
<li class="chapter" data-level="10.8.3" data-path="ukbb.html"><a href="ukbb.html#summary-8"><i class="fa fa-check"></i><b>10.8.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>11</b> control GWAS</a>
<ul>
<li class="chapter" data-level="11.1" data-path="control.html"><a href="control.html#id-list"><i class="fa fa-check"></i><b>11.1</b> ID list</a></li>
<li class="chapter" data-level="11.2" data-path="control.html"><a href="control.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>11.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="11.3" data-path="control.html"><a href="control.html#gwas-1"><i class="fa fa-check"></i><b>11.3</b> GWAS</a></li>
<li class="chapter" data-level="11.4" data-path="control.html"><a href="control.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>11.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="control.html"><a href="control.html#under-gcta-3"><i class="fa fa-check"></i><b>11.4.1</b> under gcta</a></li>
<li class="chapter" data-level="11.4.2" data-path="control.html"><a href="control.html#under-ldak-thin-3"><i class="fa fa-check"></i><b>11.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="11.4.3" data-path="control.html"><a href="control.html#summary-9"><i class="fa fa-check"></i><b>11.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="control.html"><a href="control.html#he-3"><i class="fa fa-check"></i><b>11.5</b> HE</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="control.html"><a href="control.html#making-grms-3"><i class="fa fa-check"></i><b>11.5.1</b> making grms</a></li>
<li class="chapter" data-level="11.5.2" data-path="control.html"><a href="control.html#estimation-3"><i class="fa fa-check"></i><b>11.5.2</b> estimation</a></li>
<li class="chapter" data-level="11.5.3" data-path="control.html"><a href="control.html#summary-10"><i class="fa fa-check"></i><b>11.5.3</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="previous-gwas.html"><a href="previous-gwas.html"><i class="fa fa-check"></i><b>12</b> previous GWAS</a>
<ul>
<li class="chapter" data-level="12.1" data-path="previous-gwas.html"><a href="previous-gwas.html#qc"><i class="fa fa-check"></i><b>12.1</b> QC</a></li>
<li class="chapter" data-level="12.2" data-path="previous-gwas.html"><a href="previous-gwas.html#gwas-telomere-length"><i class="fa fa-check"></i><b>12.2</b> gwas-telomere length</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="previous-gwas.html"><a href="previous-gwas.html#aver2_j"><i class="fa fa-check"></i><b>12.2.1</b> aver2_j</a></li>
<li class="chapter" data-level="12.2.2" data-path="previous-gwas.html"><a href="previous-gwas.html#organize-data-2"><i class="fa fa-check"></i><b>12.2.2</b> organize data</a></li>
<li class="chapter" data-level="12.2.3" data-path="previous-gwas.html"><a href="previous-gwas.html#chisq-aver2_j-3"><i class="fa fa-check"></i><b>12.2.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="previous-gwas.html"><a href="previous-gwas.html#pr-interval-gwas"><i class="fa fa-check"></i><b>12.3</b> PR interval GWAS</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="previous-gwas.html"><a href="previous-gwas.html#aver2_j-1"><i class="fa fa-check"></i><b>12.3.1</b> aver2_j</a></li>
<li class="chapter" data-level="12.3.2" data-path="previous-gwas.html"><a href="previous-gwas.html#organize-data-3"><i class="fa fa-check"></i><b>12.3.2</b> organize data</a></li>
<li class="chapter" data-level="12.3.3" data-path="previous-gwas.html"><a href="previous-gwas.html#chisq-aver2_j-4"><i class="fa fa-check"></i><b>12.3.3</b> chisq ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="previous-gwas.html"><a href="previous-gwas.html#ben-neale-pan-ukbb"><i class="fa fa-check"></i><b>12.4</b> Ben Neale Pan-UKBB</a></li>
<li class="chapter" data-level="12.5" data-path="previous-gwas.html"><a href="previous-gwas.html#notesconcerns"><i class="fa fa-check"></i><b>12.5</b> notes/concerns</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html"><i class="fa fa-check"></i><b>13</b> GWAS: White British + Irish</a>
<ul>
<li class="chapter" data-level="13.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#id-list-1"><i class="fa fa-check"></i><b>13.1</b> ID list</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ids-who-have-no-missing-data"><i class="fa fa-check"></i><b>13.1.1</b> Ids who have no missing data</a></li>
<li class="chapter" data-level="13.1.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#relatedness-filtering-1"><i class="fa fa-check"></i><b>13.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="13.1.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#pc-plot-1"><i class="fa fa-check"></i><b>13.1.3</b> PC plot</a></li>
<li class="chapter" data-level="13.1.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#phenotypic-differences"><i class="fa fa-check"></i><b>13.1.4</b> phenotypic differences</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#gwas-lm-1"><i class="fa fa-check"></i><b>13.2</b> GWAS-lm</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#basic-covariates"><i class="fa fa-check"></i><b>13.2.1</b> basic covariates</a></li>
<li class="chapter" data-level="13.2.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#basic-covariates-pcs"><i class="fa fa-check"></i><b>13.2.2</b> basic covariates + PCs</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#chisq-aver2_j-5"><i class="fa fa-check"></i><b>13.3</b> chisq ~ aver2_j</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#calc-aver2_j-1"><i class="fa fa-check"></i><b>13.3.1</b> calc aver2_j</a></li>
<li class="chapter" data-level="13.3.2" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#organize-data-4"><i class="fa fa-check"></i><b>13.3.2</b> organize data</a></li>
<li class="chapter" data-level="13.3.3" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#detect-confounding-wt-pcs"><i class="fa fa-check"></i><b>13.3.3</b> detect confounding: w/t PCs</a></li>
<li class="chapter" data-level="13.3.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#detect-confounding-with-pcs"><i class="fa fa-check"></i><b>13.3.4</b> detect confounding: with PCs</a></li>
<li class="chapter" data-level="13.3.5" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#inflation-good-gwas-vs.-control-vs.-british-irish"><i class="fa fa-check"></i><b>13.3.5</b> inflation: good gwas vs. control vs. british-irish</a></li>
<li class="chapter" data-level="13.3.6" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#inflation-aver2"><i class="fa fa-check"></i><b>13.3.6</b> inflation | aver2</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="gwas-white-british-irish.html"><a href="gwas-white-british-irish.html#ideas-to-explore-to-do-list"><i class="fa fa-check"></i><b>13.4</b> Ideas to explore/ to do list:</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="related-individuals.html"><a href="related-individuals.html"><i class="fa fa-check"></i><b>14</b> related individuals</a>
<ul>
<li class="chapter" data-level="14.1" data-path="related-individuals.html"><a href="related-individuals.html#genotyped-snps"><i class="fa fa-check"></i><b>14.1</b> genotyped SNPs</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-2"><i class="fa fa-check"></i><b>14.1.1</b> aver2_j</a></li>
<li class="chapter" data-level="14.1.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-2"><i class="fa fa-check"></i><b>14.1.2</b> gwas</a></li>
<li class="chapter" data-level="14.1.3" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-5"><i class="fa fa-check"></i><b>14.1.3</b> organize data</a></li>
<li class="chapter" data-level="14.1.4" data-path="related-individuals.html"><a href="related-individuals.html#summary-11"><i class="fa fa-check"></i><b>14.1.4</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="related-individuals.html"><a href="related-individuals.html#hapmap3-snps"><i class="fa fa-check"></i><b>14.2</b> hapmap3 SNPs</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype-data"><i class="fa fa-check"></i><b>14.2.1</b> genotype data</a></li>
<li class="chapter" data-level="14.2.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-3"><i class="fa fa-check"></i><b>14.2.2</b> gwas</a></li>
<li class="chapter" data-level="14.2.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-3"><i class="fa fa-check"></i><b>14.2.3</b> aver2_j</a></li>
<li class="chapter" data-level="14.2.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-6"><i class="fa fa-check"></i><b>14.2.4</b> organize data</a></li>
<li class="chapter" data-level="14.2.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-6"><i class="fa fa-check"></i><b>14.2.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="14.2.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j"><i class="fa fa-check"></i><b>14.2.6</b> inflation ~ aver2_j</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="related-individuals.html"><a href="related-individuals.html#mix-unrel-rel"><i class="fa fa-check"></i><b>14.3</b> mix unrel &amp; rel</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="related-individuals.html"><a href="related-individuals.html#genotype"><i class="fa fa-check"></i><b>14.3.1</b> genotype</a></li>
<li class="chapter" data-level="14.3.2" data-path="related-individuals.html"><a href="related-individuals.html#gwas-4"><i class="fa fa-check"></i><b>14.3.2</b> gwas</a></li>
<li class="chapter" data-level="14.3.3" data-path="related-individuals.html"><a href="related-individuals.html#aver2_j-4"><i class="fa fa-check"></i><b>14.3.3</b> aver2_j</a></li>
<li class="chapter" data-level="14.3.4" data-path="related-individuals.html"><a href="related-individuals.html#organize-data-7"><i class="fa fa-check"></i><b>14.3.4</b> organize data</a></li>
<li class="chapter" data-level="14.3.5" data-path="related-individuals.html"><a href="related-individuals.html#chisq-aver2_j-7"><i class="fa fa-check"></i><b>14.3.5</b> chisq ~ aver2_j</a></li>
<li class="chapter" data-level="14.3.6" data-path="related-individuals.html"><a href="related-individuals.html#inflation-aver2_j-1"><i class="fa fa-check"></i><b>14.3.6</b> inflation ~ aver2_j</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html"><i class="fa fa-check"></i><b>15</b> compute <span class="math inline">\(\sum_{i,j}^{m_1, m_2}r^2_{i,j}\)</span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwas-all-qced-snps"><i class="fa fa-check"></i><b>15.1</b> good GWAS-all qced snps</a></li>
<li class="chapter" data-level="15.2" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#good-gwass--ldak-thin-snps"><i class="fa fa-check"></i><b>15.2</b> good GWASs- ldak-thin snps</a></li>
<li class="chapter" data-level="15.3" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#bad-gwass-all-qced-snps"><i class="fa fa-check"></i><b>15.3</b> bad GWASs-all qced snps</a></li>
<li class="chapter" data-level="15.4" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#summary-12"><i class="fa fa-check"></i><b>15.4</b> summary</a></li>
<li class="chapter" data-level="15.5" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#aver2j"><i class="fa fa-check"></i><b>15.5</b> compute aver2_j</a></li>
<li class="chapter" data-level="15.6" data-path="compute-sum_ijm_1-m_2r2_ij.html"><a href="compute-sum_ijm_1-m_2r2_ij.html#mixed-pop-gwas-with-pc-as-covariates"><i class="fa fa-check"></i><b>15.6</b> mixed pop GWAS with PC as covariates</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="assortative-mating.html"><a href="assortative-mating.html"><i class="fa fa-check"></i><b>16</b> Assortative mating</a>
<ul>
<li class="chapter" data-level="16.1" data-path="assortative-mating.html"><a href="assortative-mating.html#test-the-idea"><i class="fa fa-check"></i><b>16.1</b> Test the idea</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="assortative-mating.html"><a href="assortative-mating.html#st-try"><i class="fa fa-check"></i><b>16.1.1</b> 1st try</a></li>
<li class="chapter" data-level="16.1.2" data-path="assortative-mating.html"><a href="assortative-mating.html#nd-try"><i class="fa fa-check"></i><b>16.1.2</b> 2nd try</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html"><i class="fa fa-check"></i><b>17</b> Reference Panel: 1k Genome</a>
<ul>
<li class="chapter" data-level="17.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#common-snplist"><i class="fa fa-check"></i><b>17.1</b> common snplist</a></li>
<li class="chapter" data-level="17.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#compute-aver2"><i class="fa fa-check"></i><b>17.2</b> compute aver2</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-1"><i class="fa fa-check"></i><b>17.2.1</b> bad gwas</a></li>
<li class="chapter" data-level="17.2.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding"><i class="fa fa-check"></i><b>17.2.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="17.2.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-1"><i class="fa fa-check"></i><b>17.2.3</b> good gwas</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#detect-confounding"><i class="fa fa-check"></i><b>17.3</b> detect confounding</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#bad-gwas-2"><i class="fa fa-check"></i><b>17.3.1</b> bad gwas</a></li>
<li class="chapter" data-level="17.3.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#varying-levels-of-confounding-1"><i class="fa fa-check"></i><b>17.3.2</b> varying levels of confounding</a></li>
<li class="chapter" data-level="17.3.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#good-gwas-2"><i class="fa fa-check"></i><b>17.3.3</b> good gwas</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#estimate-inflation"><i class="fa fa-check"></i><b>17.4</b> estimate inflation</a></li>
<li class="chapter" data-level="17.5" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#stratified-aver2"><i class="fa fa-check"></i><b>17.5</b> stratified aver2</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#calc-aver2"><i class="fa fa-check"></i><b>17.5.1</b> calc aver2</a></li>
<li class="chapter" data-level="17.5.2" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#organize-data-8"><i class="fa fa-check"></i><b>17.5.2</b> organize data</a></li>
<li class="chapter" data-level="17.5.3" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#plot-aver2-of-pairwise-mixture-pops"><i class="fa fa-check"></i><b>17.5.3</b> plot aver2 of pairwise mixture pops</a></li>
<li class="chapter" data-level="17.5.4" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#chisq-1-x-aver2"><i class="fa fa-check"></i><b>17.5.4</b> chisq ~ 1 x aver2</a></li>
<li class="chapter" data-level="17.5.5" data-path="reference-panel-1k-genome.html"><a href="reference-panel-1k-genome.html#chisq-multi-aver2"><i class="fa fa-check"></i><b>17.5.5</b> chisq ~ multi-aver2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html"><i class="fa fa-check"></i><b>18</b> Fine-scale population stratification</a>
<ul>
<li class="chapter" data-level="18.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#birth-location-data"><i class="fa fa-check"></i><b>18.1</b> birth location data</a></li>
<li class="chapter" data-level="18.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#pca-of-337k"><i class="fa fa-check"></i><b>18.2</b> pca of 337k</a></li>
<li class="chapter" data-level="18.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#birth-place-gwas"><i class="fa fa-check"></i><b>18.3</b> birth place gwas</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-5"><i class="fa fa-check"></i><b>18.3.1</b> gwas</a></li>
<li class="chapter" data-level="18.3.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#chisq-aver2-1"><i class="fa fa-check"></i><b>18.3.2</b> chisq ~ aver2</a></li>
<li class="chapter" data-level="18.3.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#detect-inflation-using-1kg"><i class="fa fa-check"></i><b>18.3.3</b> detect inflation using 1kg</a></li>
<li class="chapter" data-level="18.3.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-results"><i class="fa fa-check"></i><b>18.3.4</b> gwas results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#gwas-based-on-pc-clusters"><i class="fa fa-check"></i><b>18.4</b> GWAS based on PC clusters</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-lists"><i class="fa fa-check"></i><b>18.4.1</b> id lists</a></li>
<li class="chapter" data-level="18.4.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-list-for-bad-gwas2"><i class="fa fa-check"></i><b>18.4.2</b> id list for bad gwas2</a></li>
<li class="chapter" data-level="18.4.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#id-list-for-bad-gwas3"><i class="fa fa-check"></i><b>18.4.3</b> id list for bad gwas3</a></li>
<li class="chapter" data-level="18.4.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-3"><i class="fa fa-check"></i><b>18.4.4</b> bad gwas</a></li>
<li class="chapter" data-level="18.4.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2"><i class="fa fa-check"></i><b>18.4.5</b> bad gwas#2</a></li>
<li class="chapter" data-level="18.4.6" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3"><i class="fa fa-check"></i><b>18.4.6</b> bad gwas#3</a></li>
<li class="chapter" data-level="18.4.7" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-3"><i class="fa fa-check"></i><b>18.4.7</b> good gwas</a></li>
<li class="chapter" data-level="18.4.8" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-1"><i class="fa fa-check"></i><b>18.4.8</b> control gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#compute-aver2-1"><i class="fa fa-check"></i><b>18.5</b> compute aver2</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-4"><i class="fa fa-check"></i><b>18.5.1</b> bad-gwas</a></li>
<li class="chapter" data-level="18.5.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2-1"><i class="fa fa-check"></i><b>18.5.2</b> bad-gwas#2</a></li>
<li class="chapter" data-level="18.5.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3-1"><i class="fa fa-check"></i><b>18.5.3</b> bad-gwas#3</a></li>
<li class="chapter" data-level="18.5.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-4"><i class="fa fa-check"></i><b>18.5.4</b> good-gwas</a></li>
<li class="chapter" data-level="18.5.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-2"><i class="fa fa-check"></i><b>18.5.5</b> control-gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#chisq-aver2-2"><i class="fa fa-check"></i><b>18.6</b> chisq ~ aver2</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas-5"><i class="fa fa-check"></i><b>18.6.1</b> bad gwas</a></li>
<li class="chapter" data-level="18.6.2" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas2-2"><i class="fa fa-check"></i><b>18.6.2</b> bad gwas#2</a></li>
<li class="chapter" data-level="18.6.3" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#bad-gwas3-2"><i class="fa fa-check"></i><b>18.6.3</b> bad gwas#3</a></li>
<li class="chapter" data-level="18.6.4" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#good-gwas-5"><i class="fa fa-check"></i><b>18.6.4</b> good gwas</a></li>
<li class="chapter" data-level="18.6.5" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#control-gwas-3"><i class="fa fa-check"></i><b>18.6.5</b> control gwas</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="fine-scale-population-stratification.html"><a href="fine-scale-population-stratification.html#inflation-aver2-1"><i class="fa fa-check"></i><b>18.7</b> inflation ~ aver2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GWAS Quality Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gwas-white-british-irish" class="section level1" number="13">
<h1><span class="header-section-number">13</span> GWAS: White British + Irish</h1>
<p>Previously we showed that for the bad gwas that uses white British and a mixture of black &amp; Asians, our test works.
Here we do GWAS using a sample that contains white British &amp; Irish, who have more subtle difference in ancestry compared to British vs. black &amp; Asians.
We want to know 1) if there is an inflation in the test statistics ; 2) if there is, can our method detect inflation?</p>
<div id="id-list-1" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> ID list</h2>
<p>We want a list of genetically unrelated white Irish.
1. get an id list of all Irish people (based on self-reported).
2. construct grm &amp; remove related individuals -&gt; id list of unrelated Irish.
3. mix White British with White Irish. N = 100k</p>
<p>Note. The self-reported ethnicity has been extracted and stored in <code>phen/covariates.phen</code> (see the <code>extract covariates</code> part of section <a href="good.html#good">8</a>).</p>
<div id="ids-who-have-no-missing-data" class="section level3" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Ids who have no missing data</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb99-1"><a href="gwas-white-british-irish.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract white, asian &amp; black from ukbb----------------------------------------</span></span>
<span id="cb99-2"><a href="gwas-white-british-irish.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span>
<span id="cb99-3"><a href="gwas-white-british-irish.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>read.table<span class="kw">(</span><span class="st">&quot;phen/covariates.phen&quot;</span><span class="ex">,</span> header=T, stringsAsFactors = F<span class="kw">)</span></span>
<span id="cb99-4"><a href="gwas-white-british-irish.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># White Irish (1002)</span></span>
<span id="cb99-5"><a href="gwas-white-british-irish.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="va">dat</span><span class="op">=</span>dat[complete.cases<span class="kw">(</span><span class="ex">dat</span><span class="kw">)</span><span class="ex">,]</span></span>
<span id="cb99-6"><a href="gwas-white-british-irish.html#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="va">irish</span><span class="op">=</span>1002</span>
<span id="cb99-7"><a href="gwas-white-british-irish.html#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>dat[dat<span class="va">$ethnicity</span>%in%irish,] <span class="co"># 12,743</span></span>
<span id="cb99-8"><a href="gwas-white-british-irish.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="ex">write.table</span><span class="er">(</span><span class="va">out</span><span class="op">[</span>,<span class="st">&quot;eid&quot;</span><span class="op">]</span><span class="ex">,</span> <span class="st">&quot;irish-complete-cov.id&quot;</span>, col.names=F, row.names=F, quote=F<span class="kw">)</span></span>
<span id="cb99-9"><a href="gwas-white-british-irish.html#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="gwas-white-british-irish.html#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co"># overlapping Irish across 14 traits--------------------------------------------</span></span>
<span id="cb99-11"><a href="gwas-white-british-irish.html#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> irish-complete-cov.id overlap-irish-complete-cov.id</span>
<span id="cb99-12"><a href="gwas-white-british-irish.html#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>phen/continuous-traits/</span>
<span id="cb99-13"><a href="gwas-white-british-irish.html#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb99-14"><a href="gwas-white-british-irish.html#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> overlap-irish-complete-cov.id temp</span>
<span id="cb99-15"><a href="gwas-white-british-irish.html#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1];next}($1 in a){print $1, $2}&#39;</span> temp <span class="va">$dir</span>/<span class="va">$tt</span>.raw.pheno <span class="op">&gt;</span> overlap-irish-complete-cov.id</span>
<span id="cb99-16"><a href="gwas-white-british-irish.html#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> overlap-irish-complete-cov.id <span class="co"># N = 7,156</span></span>
<span id="cb99-17"><a href="gwas-white-british-irish.html#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$tt</span></span>
<span id="cb99-18"><a href="gwas-white-british-irish.html#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb99-19"><a href="gwas-white-british-irish.html#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> temp</span></code></pre></div>
</div>
<div id="relatedness-filtering-1" class="section level3" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> relatedness filtering</h3>
<p>Here we want to make bfiles for this particular mix population. The idea is to include british and irish together, so that when we do relatedness filtering and GWAS analyses later, we can just use –keep to select participants.
Note previously we have a list of overlapping unrelated individuals. They are in overlap-white-complete-cov.id. See section <a href="good.html#good">8</a>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb100-1"><a href="gwas-white-british-irish.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------</span></span>
<span id="cb100-2"><a href="gwas-white-british-irish.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0. make bfiles</span></span>
<span id="cb100-3"><a href="gwas-white-british-irish.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------</span></span>
<span id="cb100-4"><a href="gwas-white-british-irish.html#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="gwas-white-british-irish.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># id lists</span></span>
<span id="cb100-6"><a href="gwas-white-british-irish.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="va">british</span><span class="op">=</span>overlap-white-complete-cov.id <span class="co"># N=147,008</span></span>
<span id="cb100-7"><a href="gwas-white-british-irish.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="va">irish</span><span class="op">=</span>overlap-irish-complete-cov.id <span class="co"># N=7,156</span></span>
<span id="cb100-8"><a href="gwas-white-british-irish.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{print $0}&#39;</span> <span class="va">$british</span> <span class="va">$irish</span> <span class="op">&gt;</span> overlap-british-irish-complete-cov.id <span class="co"># 154,164    </span></span>
<span id="cb100-9"><a href="gwas-white-british-irish.html#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="gwas-white-british-irish.html#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co"># bfiles by chr</span></span>
<span id="cb100-11"><a href="gwas-white-british-irish.html#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-12"><a href="gwas-white-british-irish.html#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb100-13"><a href="gwas-white-british-irish.html#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb100-14"><a href="gwas-white-british-irish.html#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb100-15"><a href="gwas-white-british-irish.html#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb100-16"><a href="gwas-white-british-irish.html#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb100-17"><a href="gwas-white-british-irish.html#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb100-18"><a href="gwas-white-british-irish.html#cb100-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-19"><a href="gwas-white-british-irish.html#cb100-19" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb100-20"><a href="gwas-white-british-irish.html#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../overlap-british-irish-complete-cov.id </span><span class="dt">\</span></span>
<span id="cb100-21"><a href="gwas-white-british-irish.html#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../gen/snps-unrel-inds.use </span><span class="dt">\</span></span>
<span id="cb100-22"><a href="gwas-white-british-irish.html#cb100-22" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb100-23"><a href="gwas-white-british-irish.html#cb100-23" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb100-24"><a href="gwas-white-british-irish.html#cb100-24" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb100-25"><a href="gwas-white-british-irish.html#cb100-25" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3 </span><span class="dt">\</span></span>
<span id="cb100-26"><a href="gwas-white-british-irish.html#cb100-26" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb100-27"><a href="gwas-white-british-irish.html#cb100-27" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb100-28"><a href="gwas-white-british-irish.html#cb100-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-29"><a href="gwas-white-british-irish.html#cb100-29" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb100-30"><a href="gwas-white-british-irish.html#cb100-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-31"><a href="gwas-white-british-irish.html#cb100-31" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$i</span>.sh</span>
<span id="cb100-32"><a href="gwas-white-british-irish.html#cb100-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/mkbfile-british-irish</span>
<span id="cb100-33"><a href="gwas-white-british-irish.html#cb100-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-34"><a href="gwas-white-british-irish.html#cb100-34" aria-hidden="true" tabindex="-1"></a><span class="co"># merge bfiles</span></span>
<span id="cb100-35"><a href="gwas-white-british-irish.html#cb100-35" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile.list</span>
<span id="cb100-36"><a href="gwas-white-british-irish.html#cb100-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-37"><a href="gwas-white-british-irish.html#cb100-37" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span>bfile.list</span>
<span id="cb100-38"><a href="gwas-white-british-irish.html#cb100-38" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb100-39"><a href="gwas-white-british-irish.html#cb100-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-40"><a href="gwas-white-british-irish.html#cb100-40" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb100-41"><a href="gwas-white-british-irish.html#cb100-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb100-42"><a href="gwas-white-british-irish.html#cb100-42" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb100-43"><a href="gwas-white-british-irish.html#cb100-43" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb100-44"><a href="gwas-white-british-irish.html#cb100-44" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb100-45"><a href="gwas-white-british-irish.html#cb100-45" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb100-46"><a href="gwas-white-british-irish.html#cb100-46" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-british-irish </span><span class="dt">\</span></span>
<span id="cb100-47"><a href="gwas-white-british-irish.html#cb100-47" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile.list </span><span class="dt">\</span></span>
<span id="cb100-48"><a href="gwas-white-british-irish.html#cb100-48" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb100-49"><a href="gwas-white-british-irish.html#cb100-49" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb100-50"><a href="gwas-white-british-irish.html#cb100-50" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/merge-mbfiles-british-irish.sh</span>
<span id="cb100-51"><a href="gwas-white-british-irish.html#cb100-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-52"><a href="gwas-white-british-irish.html#cb100-52" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb100-53"><a href="gwas-white-british-irish.html#cb100-53" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/merge-mbfiles-british-irish.sh <span class="op">&gt;</span>../job-records/merge-mbfiles-british-irish</span>
<span id="cb100-54"><a href="gwas-white-british-irish.html#cb100-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-55"><a href="gwas-white-british-irish.html#cb100-55" aria-hidden="true" tabindex="-1"></a><span class="co">#-------</span></span>
<span id="cb100-56"><a href="gwas-white-british-irish.html#cb100-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. prune SNPs</span></span>
<span id="cb100-57"><a href="gwas-white-british-irish.html#cb100-57" aria-hidden="true" tabindex="-1"></a><span class="co">#-------</span></span>
<span id="cb100-58"><a href="gwas-white-british-irish.html#cb100-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-59"><a href="gwas-white-british-irish.html#cb100-59" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> thin-irish</span>
<span id="cb100-60"><a href="gwas-white-british-irish.html#cb100-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-61"><a href="gwas-white-british-irish.html#cb100-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-62"><a href="gwas-white-british-irish.html#cb100-62" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb100-63"><a href="gwas-white-british-irish.html#cb100-63" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb100-64"><a href="gwas-white-british-irish.html#cb100-64" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 10G</span></span>
<span id="cb100-65"><a href="gwas-white-british-irish.html#cb100-65" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 4</span></span>
<span id="cb100-66"><a href="gwas-white-british-irish.html#cb100-66" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 5:0:0</span></span>
<span id="cb100-67"><a href="gwas-white-british-irish.html#cb100-67" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb100-68"><a href="gwas-white-british-irish.html#cb100-68" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 4 </span><span class="dt">\</span></span>
<span id="cb100-69"><a href="gwas-white-british-irish.html#cb100-69" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-prune 0.05 </span><span class="dt">\</span></span>
<span id="cb100-70"><a href="gwas-white-british-irish.html#cb100-70" aria-hidden="true" tabindex="-1"></a><span class="st">          --window-kb 1000 </span><span class="dt">\</span></span>
<span id="cb100-71"><a href="gwas-white-british-irish.html#cb100-71" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../overlap-irish-complete-cov.id </span><span class="dt">\</span></span>
<span id="cb100-72"><a href="gwas-white-british-irish.html#cb100-72" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-british-irish </span><span class="dt">\</span></span>
<span id="cb100-73"><a href="gwas-white-british-irish.html#cb100-73" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb100-74"><a href="gwas-white-british-irish.html#cb100-74" aria-hidden="true" tabindex="-1"></a><span class="st">          --thin ../thin-irish/thin-chr</span><span class="va">$j</span></span>
<span id="cb100-75"><a href="gwas-white-british-irish.html#cb100-75" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>  <span class="op">&gt;</span> sh_script/thin<span class="va">$j</span></span>
<span id="cb100-76"><a href="gwas-white-british-irish.html#cb100-76" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb100-77"><a href="gwas-white-british-irish.html#cb100-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-78"><a href="gwas-white-british-irish.html#cb100-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-79"><a href="gwas-white-british-irish.html#cb100-79" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/thin<span class="va">$j</span></span>
<span id="cb100-80"><a href="gwas-white-british-irish.html#cb100-80" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/thin-snps-irish</span>
<span id="cb100-81"><a href="gwas-white-british-irish.html#cb100-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-82"><a href="gwas-white-british-irish.html#cb100-82" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------</span></span>
<span id="cb100-83"><a href="gwas-white-british-irish.html#cb100-83" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. kinship matrix under GCTA</span></span>
<span id="cb100-84"><a href="gwas-white-british-irish.html#cb100-84" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------</span></span>
<span id="cb100-85"><a href="gwas-white-british-irish.html#cb100-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-86"><a href="gwas-white-british-irish.html#cb100-86" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> kinship-irish</span>
<span id="cb100-87"><a href="gwas-white-british-irish.html#cb100-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-88"><a href="gwas-white-british-irish.html#cb100-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-89"><a href="gwas-white-british-irish.html#cb100-89" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb100-90"><a href="gwas-white-british-irish.html#cb100-90" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb100-91"><a href="gwas-white-british-irish.html#cb100-91" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb100-92"><a href="gwas-white-british-irish.html#cb100-92" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb100-93"><a href="gwas-white-british-irish.html#cb100-93" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb100-94"><a href="gwas-white-british-irish.html#cb100-94" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb100-95"><a href="gwas-white-british-irish.html#cb100-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-96"><a href="gwas-white-british-irish.html#cb100-96" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb100-97"><a href="gwas-white-british-irish.html#cb100-97" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-kins-direct ../kinship-irish/irish-gcta-thin</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb100-98"><a href="gwas-white-british-irish.html#cb100-98" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-british-irish </span><span class="dt">\</span></span>
<span id="cb100-99"><a href="gwas-white-british-irish.html#cb100-99" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../overlap-irish-complete-cov.id</span><span class="dt">\</span></span>
<span id="cb100-100"><a href="gwas-white-british-irish.html#cb100-100" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../thin-irish/thin-chr</span><span class="va">$j</span><span class="st">.in </span><span class="dt">\</span></span>
<span id="cb100-101"><a href="gwas-white-british-irish.html#cb100-101" aria-hidden="true" tabindex="-1"></a><span class="st">          --chr </span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb100-102"><a href="gwas-white-british-irish.html#cb100-102" aria-hidden="true" tabindex="-1"></a><span class="st">          --power -1 </span><span class="dt">\</span></span>
<span id="cb100-103"><a href="gwas-white-british-irish.html#cb100-103" aria-hidden="true" tabindex="-1"></a><span class="st">          --ignore-weights YES </span><span class="dt">\</span></span>
<span id="cb100-104"><a href="gwas-white-british-irish.html#cb100-104" aria-hidden="true" tabindex="-1"></a><span class="st">          --single YES</span></span>
<span id="cb100-105"><a href="gwas-white-british-irish.html#cb100-105" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> sh_script/irish-grm<span class="va">$j</span></span>
<span id="cb100-106"><a href="gwas-white-british-irish.html#cb100-106" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb100-107"><a href="gwas-white-british-irish.html#cb100-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-108"><a href="gwas-white-british-irish.html#cb100-108" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files</span></span>
<span id="cb100-109"><a href="gwas-white-british-irish.html#cb100-109" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-110"><a href="gwas-white-british-irish.html#cb100-110" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/irish-grm<span class="va">$j</span></span>
<span id="cb100-111"><a href="gwas-white-british-irish.html#cb100-111" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/grm-irish</span>
<span id="cb100-112"><a href="gwas-white-british-irish.html#cb100-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-113"><a href="gwas-white-british-irish.html#cb100-113" aria-hidden="true" tabindex="-1"></a><span class="co"># merge grms</span></span>
<span id="cb100-114"><a href="gwas-white-british-irish.html#cb100-114" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> irish-grm.list</span>
<span id="cb100-115"><a href="gwas-white-british-irish.html#cb100-115" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb100-116"><a href="gwas-white-british-irish.html#cb100-116" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;../kinship-irish/irish-gcta-thin</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> irish-grm.list</span>
<span id="cb100-117"><a href="gwas-white-british-irish.html#cb100-117" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb100-118"><a href="gwas-white-british-irish.html#cb100-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-119"><a href="gwas-white-british-irish.html#cb100-119" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb100-120"><a href="gwas-white-british-irish.html#cb100-120" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb100-121"><a href="gwas-white-british-irish.html#cb100-121" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb100-122"><a href="gwas-white-british-irish.html#cb100-122" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 80G</span></span>
<span id="cb100-123"><a href="gwas-white-british-irish.html#cb100-123" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 10</span></span>
<span id="cb100-124"><a href="gwas-white-british-irish.html#cb100-124" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 12:0:0</span></span>
<span id="cb100-125"><a href="gwas-white-british-irish.html#cb100-125" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --add-grm ../kinship-irish/irish-gcta-thin --mgrm ../irish-grm.list</span></span>
<span id="cb100-126"><a href="gwas-white-british-irish.html#cb100-126" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/irish-grm.sh</span>
<span id="cb100-127"><a href="gwas-white-british-irish.html#cb100-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-128"><a href="gwas-white-british-irish.html#cb100-128" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/irish-grm.sh <span class="op">&gt;</span> ../job-records/grm-merge</span>
<span id="cb100-129"><a href="gwas-white-british-irish.html#cb100-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-130"><a href="gwas-white-british-irish.html#cb100-130" aria-hidden="true" tabindex="-1"></a><span class="co">#can now delete per-chr files</span></span>
<span id="cb100-131"><a href="gwas-white-british-irish.html#cb100-131" aria-hidden="true" tabindex="-1"></a><span class="co">#rm *gcta-thin{1..22}.*</span></span>
<span id="cb100-132"><a href="gwas-white-british-irish.html#cb100-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-133"><a href="gwas-white-british-irish.html#cb100-133" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------</span></span>
<span id="cb100-134"><a href="gwas-white-british-irish.html#cb100-134" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Relatedness filtering </span></span>
<span id="cb100-135"><a href="gwas-white-british-irish.html#cb100-135" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------</span></span>
<span id="cb100-136"><a href="gwas-white-british-irish.html#cb100-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-137"><a href="gwas-white-british-irish.html#cb100-137" aria-hidden="true" tabindex="-1"></a><span class="co"># relatedness filtering</span></span>
<span id="cb100-138"><a href="gwas-white-british-irish.html#cb100-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-139"><a href="gwas-white-british-irish.html#cb100-139" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb100-140"><a href="gwas-white-british-irish.html#cb100-140" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb100-141"><a href="gwas-white-british-irish.html#cb100-141" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb100-142"><a href="gwas-white-british-irish.html#cb100-142" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb100-143"><a href="gwas-white-british-irish.html#cb100-143" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb100-144"><a href="gwas-white-british-irish.html#cb100-144" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 2:0:0</span></span>
<span id="cb100-145"><a href="gwas-white-british-irish.html#cb100-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-146"><a href="gwas-white-british-irish.html#cb100-146" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --filter ../relatedness/irish-cut.05 </span><span class="dt">\</span></span>
<span id="cb100-147"><a href="gwas-white-british-irish.html#cb100-147" aria-hidden="true" tabindex="-1"></a><span class="st">          --grm ../kinship-irish/irish-gcta-thin </span><span class="dt">\</span></span>
<span id="cb100-148"><a href="gwas-white-british-irish.html#cb100-148" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-rel 0.05 </span><span class="dt">\</span></span>
<span id="cb100-149"><a href="gwas-white-british-irish.html#cb100-149" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3</span></span>
<span id="cb100-150"><a href="gwas-white-british-irish.html#cb100-150" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/irish-rel-cut.05.sh</span>
<span id="cb100-151"><a href="gwas-white-british-irish.html#cb100-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-152"><a href="gwas-white-british-irish.html#cb100-152" aria-hidden="true" tabindex="-1"></a><span class="co"># submit script</span></span>
<span id="cb100-153"><a href="gwas-white-british-irish.html#cb100-153" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/irish-rel-cut.05.sh <span class="op">&gt;</span> ../job-records/relatedness-filtering-irish</span>
<span id="cb100-154"><a href="gwas-white-british-irish.html#cb100-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-155"><a href="gwas-white-british-irish.html#cb100-155" aria-hidden="true" tabindex="-1"></a><span class="co"># remaining individuals</span></span>
<span id="cb100-156"><a href="gwas-white-british-irish.html#cb100-156" aria-hidden="true" tabindex="-1"></a><span class="co"># irish-cut.05.keep N = 6,632 </span></span>
<span id="cb100-157"><a href="gwas-white-british-irish.html#cb100-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-158"><a href="gwas-white-british-irish.html#cb100-158" aria-hidden="true" tabindex="-1"></a><span class="co"># mix 93,368 british with irish--------------------------------------------------------------</span></span>
<span id="cb100-159"><a href="gwas-white-british-irish.html#cb100-159" aria-hidden="true" tabindex="-1"></a><span class="co">#awk &#39;(NR==FNR) {a[$1] ;next} ($1 in a) {print $0}&#39;  gen/geno-british-irish.fam rand.100000 &gt; check</span></span>
<span id="cb100-160"><a href="gwas-white-british-irish.html#cb100-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-161"><a href="gwas-white-british-irish.html#cb100-161" aria-hidden="true" tabindex="-1"></a><span class="ex">shuf</span> rand.100000 <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 93368 <span class="op">&gt;</span> british.rand.93368</span>
<span id="cb100-162"><a href="gwas-white-british-irish.html#cb100-162" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> british.rand.93368 relatedness/irish-cut.05.keep <span class="op">&gt;</span> british-irish-gwas.id</span></code></pre></div>
</div>
<div id="pc-plot-1" class="section level3" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> PC plot</h3>
<p>Here we want to check if there is any meaningful ancestry difference between british &amp; irish.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="gwas-white-british-irish.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb101-2"><a href="gwas-white-british-irish.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># id</span></span>
<span id="cb101-3"><a href="gwas-white-british-irish.html#cb101-3" aria-hidden="true" tabindex="-1"></a>british<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;british.rand.93368&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb101-4"><a href="gwas-white-british-irish.html#cb101-4" aria-hidden="true" tabindex="-1"></a>irish<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;relatedness/irish-cut.05.keep&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb101-5"><a href="gwas-white-british-irish.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cov</span></span>
<span id="cb101-6"><a href="gwas-white-british-irish.html#cb101-6" aria-hidden="true" tabindex="-1"></a>cov<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;phen/covariates.phen&quot;</span>, <span class="at">col_names=</span>T)</span>
<span id="cb101-7"><a href="gwas-white-british-irish.html#cb101-7" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">=</span><span class="fu">match</span>(british<span class="sc">$</span>V1, cov<span class="sc">$</span>eid)</span>
<span id="cb101-8"><a href="gwas-white-british-irish.html#cb101-8" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>V1, cov<span class="sc">$</span>eid)</span>
<span id="cb101-9"><a href="gwas-white-british-irish.html#cb101-9" aria-hidden="true" tabindex="-1"></a>british<span class="ot">=</span>cov[m1,<span class="fu">c</span>(<span class="st">&quot;eid&quot;</span>, <span class="st">&quot;pc1&quot;</span>, <span class="st">&quot;pc2&quot;</span>)]</span>
<span id="cb101-10"><a href="gwas-white-british-irish.html#cb101-10" aria-hidden="true" tabindex="-1"></a>british<span class="sc">$</span>british<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb101-11"><a href="gwas-white-british-irish.html#cb101-11" aria-hidden="true" tabindex="-1"></a>irish<span class="ot">=</span>cov[m2,<span class="fu">c</span>(<span class="st">&quot;eid&quot;</span>, <span class="st">&quot;pc1&quot;</span>, <span class="st">&quot;pc2&quot;</span>)]</span>
<span id="cb101-12"><a href="gwas-white-british-irish.html#cb101-12" aria-hidden="true" tabindex="-1"></a>irish<span class="sc">$</span>british<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb101-13"><a href="gwas-white-british-irish.html#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="gwas-white-british-irish.html#cb101-14" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">rbind</span>(british,irish)</span>
<span id="cb101-15"><a href="gwas-white-british-irish.html#cb101-15" aria-hidden="true" tabindex="-1"></a>pc1_ave<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>pc1,<span class="at">INDEX=</span>dat<span class="sc">$</span>british, mean)</span>
<span id="cb101-16"><a href="gwas-white-british-irish.html#cb101-16" aria-hidden="true" tabindex="-1"></a>pc2_ave<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>pc2,<span class="at">INDEX=</span>dat<span class="sc">$</span>british, mean)</span>
<span id="cb101-17"><a href="gwas-white-british-irish.html#cb101-17" aria-hidden="true" tabindex="-1"></a>pc1_se<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>pc1,<span class="at">INDEX=</span>dat<span class="sc">$</span>british, sd)</span>
<span id="cb101-18"><a href="gwas-white-british-irish.html#cb101-18" aria-hidden="true" tabindex="-1"></a>pc2_se<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>pc2,<span class="at">INDEX=</span>dat<span class="sc">$</span>british, sd)</span>
<span id="cb101-19"><a href="gwas-white-british-irish.html#cb101-19" aria-hidden="true" tabindex="-1"></a>ave<span class="ot">=</span><span class="fu">cbind</span>(pc1_ave,pc2_ave)</span>
<span id="cb101-20"><a href="gwas-white-british-irish.html#cb101-20" aria-hidden="true" tabindex="-1"></a>se<span class="ot">=</span><span class="fu">cbind</span>(pc1_se,pc2_se)</span>
<span id="cb101-21"><a href="gwas-white-british-irish.html#cb101-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-22"><a href="gwas-white-british-irish.html#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb101-23"><a href="gwas-white-british-irish.html#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/british-irish-pc1-vs-pc2.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb101-24"><a href="gwas-white-british-irish.html#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb101-25"><a href="gwas-white-british-irish.html#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>pc1[dat<span class="sc">$</span>british<span class="sc">==</span><span class="dv">1</span>], dat<span class="sc">$</span>pc2[dat<span class="sc">$</span>british<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb101-26"><a href="gwas-white-british-irish.html#cb101-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;1st PC&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;2nd PC&quot;</span>,</span>
<span id="cb101-27"><a href="gwas-white-british-irish.html#cb101-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="st">&quot;PC1 vs PC2&quot;</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb101-28"><a href="gwas-white-british-irish.html#cb101-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;lightgray&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb101-29"><a href="gwas-white-british-irish.html#cb101-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-30"><a href="gwas-white-british-irish.html#cb101-30" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>pc1[dat<span class="sc">$</span>british<span class="sc">==</span><span class="dv">0</span>],dat<span class="sc">$</span>pc2[dat<span class="sc">$</span>british<span class="sc">==</span><span class="dv">0</span>], </span>
<span id="cb101-31"><a href="gwas-white-british-irish.html#cb101-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pch=</span><span class="dv">16</span>,  <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb101-32"><a href="gwas-white-british-irish.html#cb101-32" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ave[<span class="dv">1</span>,<span class="dv">1</span>], ave[<span class="dv">1</span>,<span class="dv">2</span>], <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb101-33"><a href="gwas-white-british-irish.html#cb101-33" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ave[<span class="dv">2</span>,<span class="dv">1</span>], ave[<span class="dv">2</span>,<span class="dv">2</span>], <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;red&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb101-34"><a href="gwas-white-british-irish.html#cb101-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-35"><a href="gwas-white-british-irish.html#cb101-35" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="phenotypic-differences" class="section level3" number="13.1.4">
<h3><span class="header-section-number">13.1.4</span> phenotypic differences</h3>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="gwas-white-british-irish.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb102-2"><a href="gwas-white-british-irish.html#cb102-2" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb102-3"><a href="gwas-white-british-irish.html#cb102-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb102-4"><a href="gwas-white-british-irish.html#cb102-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb102-5"><a href="gwas-white-british-irish.html#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="gwas-white-british-irish.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb102-7"><a href="gwas-white-british-irish.html#cb102-7" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb102-8"><a href="gwas-white-british-irish.html#cb102-8" aria-hidden="true" tabindex="-1"></a>  phen<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;phen/continuous-traits/&quot;</span>,trait,<span class="st">&quot;.raw.pheno&quot;</span>), <span class="at">col_names=</span>F)</span>
<span id="cb102-9"><a href="gwas-white-british-irish.html#cb102-9" aria-hidden="true" tabindex="-1"></a>  british<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;british.rand.93368&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb102-10"><a href="gwas-white-british-irish.html#cb102-10" aria-hidden="true" tabindex="-1"></a>  irish<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;relatedness/irish-cut.05.keep&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb102-11"><a href="gwas-white-british-irish.html#cb102-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-12"><a href="gwas-white-british-irish.html#cb102-12" aria-hidden="true" tabindex="-1"></a>  m1<span class="ot">=</span><span class="fu">match</span>(british<span class="sc">$</span>V1, phen<span class="sc">$</span>X1)</span>
<span id="cb102-13"><a href="gwas-white-british-irish.html#cb102-13" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>V1, phen<span class="sc">$</span>X1)</span>
<span id="cb102-14"><a href="gwas-white-british-irish.html#cb102-14" aria-hidden="true" tabindex="-1"></a>  british<span class="ot">=</span>phen[m1,<span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X3&quot;</span>)]</span>
<span id="cb102-15"><a href="gwas-white-british-irish.html#cb102-15" aria-hidden="true" tabindex="-1"></a>  british<span class="sc">$</span>british<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb102-16"><a href="gwas-white-british-irish.html#cb102-16" aria-hidden="true" tabindex="-1"></a>  irish<span class="ot">=</span>phen[m2,<span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X3&quot;</span>)]</span>
<span id="cb102-17"><a href="gwas-white-british-irish.html#cb102-17" aria-hidden="true" tabindex="-1"></a>  irish<span class="sc">$</span>british<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb102-18"><a href="gwas-white-british-irish.html#cb102-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-19"><a href="gwas-white-british-irish.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">rbind</span>(british,irish)</span>
<span id="cb102-20"><a href="gwas-white-british-irish.html#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(dat)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;phen&quot;</span>, <span class="st">&quot;british&quot;</span>)</span>
<span id="cb102-21"><a href="gwas-white-british-irish.html#cb102-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-22"><a href="gwas-white-british-irish.html#cb102-22" aria-hidden="true" tabindex="-1"></a>  ave<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>phen,<span class="at">INDEX=</span>dat<span class="sc">$</span>british, mean)</span>
<span id="cb102-23"><a href="gwas-white-british-irish.html#cb102-23" aria-hidden="true" tabindex="-1"></a>  sd<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>phen,<span class="at">INDEX=</span>dat<span class="sc">$</span>british, sd)</span>
<span id="cb102-24"><a href="gwas-white-british-irish.html#cb102-24" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>phen,<span class="at">INDEX=</span>dat<span class="sc">$</span>british, length)</span>
<span id="cb102-25"><a href="gwas-white-british-irish.html#cb102-25" aria-hidden="true" tabindex="-1"></a>  compare<span class="ot">=</span><span class="fu">aov</span>(phen<span class="sc">~</span>british, <span class="at">data=</span>dat)</span>
<span id="cb102-26"><a href="gwas-white-british-irish.html#cb102-26" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">summary</span>(compare)[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">&#39;Pr(&gt;F)&#39;</span>[<span class="dv">1</span>]</span>
<span id="cb102-27"><a href="gwas-white-british-irish.html#cb102-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-28"><a href="gwas-white-british-irish.html#cb102-28" aria-hidden="true" tabindex="-1"></a>  out0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait, </span>
<span id="cb102-29"><a href="gwas-white-british-irish.html#cb102-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ave_british=</span>ave[<span class="dv">2</span>],</span>
<span id="cb102-30"><a href="gwas-white-british-irish.html#cb102-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ave_irisih=</span>ave[<span class="dv">1</span>],</span>
<span id="cb102-31"><a href="gwas-white-british-irish.html#cb102-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sd_british=</span>sd[<span class="dv">2</span>],</span>
<span id="cb102-32"><a href="gwas-white-british-irish.html#cb102-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sd_irish=</span>sd[<span class="dv">1</span>],</span>
<span id="cb102-33"><a href="gwas-white-british-irish.html#cb102-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p=</span>p)</span>
<span id="cb102-34"><a href="gwas-white-british-irish.html#cb102-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-35"><a href="gwas-white-british-irish.html#cb102-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){out<span class="ot">=</span>out0} <span class="cf">else</span>{out<span class="ot">=</span><span class="fu">rbind</span>(out,out0)}</span>
<span id="cb102-36"><a href="gwas-white-british-irish.html#cb102-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="gwas-lm-1" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> GWAS-lm</h2>
<div id="basic-covariates" class="section level3" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> basic covariates</h3>
<p>We use basic covariates only: age, sex and townsend.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb103-1"><a href="gwas-white-british-irish.html#cb103-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-2"><a href="gwas-white-british-irish.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># gwas------------------------------------------------------------------------------</span></span>
<span id="cb103-3"><a href="gwas-white-british-irish.html#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="gwas-white-british-irish.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-british-irish </span>
<span id="cb103-5"><a href="gwas-white-british-irish.html#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="gwas-white-british-irish.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb103-7"><a href="gwas-white-british-irish.html#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb103-8"><a href="gwas-white-british-irish.html#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb103-9"><a href="gwas-white-british-irish.html#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb103-10"><a href="gwas-white-british-irish.html#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 8G</span></span>
<span id="cb103-11"><a href="gwas-white-british-irish.html#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb103-12"><a href="gwas-white-british-irish.html#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 10:0:0</span></span>
<span id="cb103-13"><a href="gwas-white-british-irish.html#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="gwas-white-british-irish.html#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear ../gwas-british-irish/</span><span class="va">$i</span><span class="st">-linear </span><span class="dt">\</span></span>
<span id="cb103-15"><a href="gwas-white-british-irish.html#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb103-16"><a href="gwas-white-british-irish.html#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-british-irish </span><span class="dt">\</span></span>
<span id="cb103-17"><a href="gwas-white-british-irish.html#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../british-irish-gwas.id </span><span class="dt">\</span></span>
<span id="cb103-18"><a href="gwas-white-british-irish.html#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-unrel-inds.use </span><span class="dt">\</span></span>
<span id="cb103-19"><a href="gwas-white-british-irish.html#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar ../phen/basic-covariates.use </span><span class="dt">\</span></span>
<span id="cb103-20"><a href="gwas-white-british-irish.html#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb103-21"><a href="gwas-white-british-irish.html#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb103-22"><a href="gwas-white-british-irish.html#cb103-22" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb103-23"><a href="gwas-white-british-irish.html#cb103-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-24"><a href="gwas-white-british-irish.html#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files</span></span>
<span id="cb103-25"><a href="gwas-white-british-irish.html#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb103-26"><a href="gwas-white-british-irish.html#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear.sh</span>
<span id="cb103-27"><a href="gwas-white-british-irish.html#cb103-27" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-british-irish</span></code></pre></div>
</div>
<div id="basic-covariates-pcs" class="section level3" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> basic covariates + PCs</h3>
<p>Same as for the bad GWAS, here we add PCs as covariates in GWAS model, one at a time, and to check if inflation in GWAS persists. Why? Irish and British are genetically similar, but in the above we found that when mixing Irish and British, inflation is evident in some traits. We want to find out if the inflation is actually related to population stratification or false positive. If it is related to population stratification, the inflation would be gone after correcting phenotypes for population stratification.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb104-1"><a href="gwas-white-british-irish.html#cb104-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-2"><a href="gwas-white-british-irish.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb104-3"><a href="gwas-white-british-irish.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-british-irish-<span class="va">$j</span><span class="st">&#39;PC&#39;</span></span>
<span id="cb104-4"><a href="gwas-white-british-irish.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb104-5"><a href="gwas-white-british-irish.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../gwas-british-irish-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>/<span class="va">$i</span>-linear</span>
<span id="cb104-6"><a href="gwas-white-british-irish.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="va">cov</span><span class="op">=</span>../phen/covariates-basic-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.use</span>
<span id="cb104-7"><a href="gwas-white-british-irish.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb104-8"><a href="gwas-white-british-irish.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb104-9"><a href="gwas-white-british-irish.html#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb104-10"><a href="gwas-white-british-irish.html#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 6G</span></span>
<span id="cb104-11"><a href="gwas-white-british-irish.html#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 2</span></span>
<span id="cb104-12"><a href="gwas-white-british-irish.html#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 6:0:0</span></span>
<span id="cb104-13"><a href="gwas-white-british-irish.html#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="gwas-white-british-irish.html#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --linear </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb104-15"><a href="gwas-white-british-irish.html#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="st">          --pheno ../phen/continuous-traits/</span><span class="va">$i</span><span class="st">.raw.pheno </span><span class="dt">\</span></span>
<span id="cb104-16"><a href="gwas-white-british-irish.html#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile ../gen/geno-british-irish </span><span class="dt">\</span></span>
<span id="cb104-17"><a href="gwas-white-british-irish.html#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="st">          --covar </span><span class="va">$cov</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb104-18"><a href="gwas-white-british-irish.html#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep ../british-irish-gwas.id </span><span class="dt">\</span></span>
<span id="cb104-19"><a href="gwas-white-british-irish.html#cb104-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --extract ../gen/snps-unrel-inds.use </span><span class="dt">\</span></span>
<span id="cb104-20"><a href="gwas-white-british-irish.html#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 2 </span><span class="dt">\</span></span>
<span id="cb104-21"><a href="gwas-white-british-irish.html#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.sh</span>
<span id="cb104-22"><a href="gwas-white-british-irish.html#cb104-22" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb104-23"><a href="gwas-white-british-irish.html#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb104-24"><a href="gwas-white-british-irish.html#cb104-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-25"><a href="gwas-white-british-irish.html#cb104-25" aria-hidden="true" tabindex="-1"></a><span class="co"># submit files------------------------------------------------------------------</span></span>
<span id="cb104-26"><a href="gwas-white-british-irish.html#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb104-27"><a href="gwas-white-british-irish.html#cb104-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb104-28"><a href="gwas-white-british-irish.html#cb104-28" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/<span class="va">$i</span>-linear-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.sh</span>
<span id="cb104-29"><a href="gwas-white-british-irish.html#cb104-29" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb104-30"><a href="gwas-white-british-irish.html#cb104-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span><span class="op">&gt;</span>../job-records/gwas-british-irish-pc</span></code></pre></div>
</div>
</div>
<div id="chisq-aver2_j-5" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> chisq ~ aver2_j</h2>
<div id="calc-aver2_j-1" class="section level3" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> calc aver2_j</h3>
<p>We use the same snp lists as for the good and bad GWASs (see section <a href="compute-sum_ijm_1-m_2r2_ij.html#aver2j">15.5</a>):
<code>left-snps-unrel-inds-10k</code> &amp; <code>right-snps-unrel-inds-10k</code>.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb105-1"><a href="gwas-white-british-irish.html#cb105-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2"><a href="gwas-white-british-irish.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># new directory</span></span>
<span id="cb105-3"><a href="gwas-white-british-irish.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> inflation/british-irish</span>
<span id="cb105-4"><a href="gwas-white-british-irish.html#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="gwas-white-british-irish.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># to calc aver2 for lista-------------------------------------------------------</span></span>
<span id="cb105-6"><a href="gwas-white-british-irish.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/left-snps-unrel-inds-10k</span>
<span id="cb105-7"><a href="gwas-white-british-irish.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/right-snps-unrel-inds-10k</span>
<span id="cb105-8"><a href="gwas-white-british-irish.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../british-irish-gwas.id </span>
<span id="cb105-9"><a href="gwas-white-british-irish.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-british-irish</span>
<span id="cb105-10"><a href="gwas-white-british-irish.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/british-irish/aver2-lista</span>
<span id="cb105-11"><a href="gwas-white-british-irish.html#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="gwas-white-british-irish.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb105-13"><a href="gwas-white-british-irish.html#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb105-14"><a href="gwas-white-british-irish.html#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb105-15"><a href="gwas-white-british-irish.html#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb105-16"><a href="gwas-white-british-irish.html#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb105-17"><a href="gwas-white-british-irish.html#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:40:0</span></span>
<span id="cb105-18"><a href="gwas-white-british-irish.html#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb105-19"><a href="gwas-white-british-irish.html#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-20"><a href="gwas-white-british-irish.html#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-21"><a href="gwas-white-british-irish.html#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-22"><a href="gwas-white-british-irish.html#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$lista</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-23"><a href="gwas-white-british-irish.html#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$listb</span></span>
<span id="cb105-24"><a href="gwas-white-british-irish.html#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-aver2-lista</span>
<span id="cb105-25"><a href="gwas-white-british-irish.html#cb105-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-26"><a href="gwas-white-british-irish.html#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co"># job submission</span></span>
<span id="cb105-27"><a href="gwas-white-british-irish.html#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-aver2-lista <span class="op">&gt;</span>../job-records/calc-aver2-british-irish</span>
<span id="cb105-28"><a href="gwas-white-british-irish.html#cb105-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-29"><a href="gwas-white-british-irish.html#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co"># to calc aver2 for listb-------------------------------------------------------</span></span>
<span id="cb105-30"><a href="gwas-white-british-irish.html#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="va">lista</span><span class="op">=</span>../inflation/left-snps-unrel-inds-10k</span>
<span id="cb105-31"><a href="gwas-white-british-irish.html#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="va">listb</span><span class="op">=</span>../inflation/right-snps-unrel-inds-10k</span>
<span id="cb105-32"><a href="gwas-white-british-irish.html#cb105-32" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>../british-irish-gwas.id </span>
<span id="cb105-33"><a href="gwas-white-british-irish.html#cb105-33" aria-hidden="true" tabindex="-1"></a><span class="va">bfile</span><span class="op">=</span>../gen/geno-british-irish</span>
<span id="cb105-34"><a href="gwas-white-british-irish.html#cb105-34" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>../inflation/british-irish/aver2-listb</span>
<span id="cb105-35"><a href="gwas-white-british-irish.html#cb105-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-36"><a href="gwas-white-british-irish.html#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb105-37"><a href="gwas-white-british-irish.html#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb105-38"><a href="gwas-white-british-irish.html#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb105-39"><a href="gwas-white-british-irish.html#cb105-39" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 30G</span></span>
<span id="cb105-40"><a href="gwas-white-british-irish.html#cb105-40" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 7</span></span>
<span id="cb105-41"><a href="gwas-white-british-irish.html#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 00:40:0</span></span>
<span id="cb105-42"><a href="gwas-white-british-irish.html#cb105-42" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.2 --max-threads 7 </span><span class="dt">\</span></span>
<span id="cb105-43"><a href="gwas-white-british-irish.html#cb105-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --calc-inflation </span><span class="va">$out</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-44"><a href="gwas-white-british-irish.html#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="st">          --keep </span><span class="va">$id</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-45"><a href="gwas-white-british-irish.html#cb105-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --bfile </span><span class="va">$bfile</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-46"><a href="gwas-white-british-irish.html#cb105-46" aria-hidden="true" tabindex="-1"></a><span class="st">          --lista </span><span class="va">$listb</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb105-47"><a href="gwas-white-british-irish.html#cb105-47" aria-hidden="true" tabindex="-1"></a><span class="st">          --listb </span><span class="va">$lista</span></span>
<span id="cb105-48"><a href="gwas-white-british-irish.html#cb105-48" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span>sh_script/calc-aver2-listb</span>
<span id="cb105-49"><a href="gwas-white-british-irish.html#cb105-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-50"><a href="gwas-white-british-irish.html#cb105-50" aria-hidden="true" tabindex="-1"></a><span class="co"># job submission</span></span>
<span id="cb105-51"><a href="gwas-white-british-irish.html#cb105-51" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/calc-aver2-listb <span class="op">&gt;</span>../job-records/calc-aver2-listb-british-irish</span>
<span id="cb105-52"><a href="gwas-white-british-irish.html#cb105-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-53"><a href="gwas-white-british-irish.html#cb105-53" aria-hidden="true" tabindex="-1"></a><span class="co"># merge aver2 of the two lists--------------------------------------------------</span></span>
<span id="cb105-54"><a href="gwas-white-british-irish.html#cb105-54" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>inflation/british-irish</span>
<span id="cb105-55"><a href="gwas-white-british-irish.html#cb105-55" aria-hidden="true" tabindex="-1"></a><span class="va">a</span><span class="op">=</span><span class="va">$dir</span>/aver2-lista.rjk2.average</span>
<span id="cb105-56"><a href="gwas-white-british-irish.html#cb105-56" aria-hidden="true" tabindex="-1"></a><span class="va">b</span><span class="op">=</span><span class="va">$dir</span>/aver2-listb.rjk2.average</span>
<span id="cb105-57"><a href="gwas-white-british-irish.html#cb105-57" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span><span class="va">$dir</span>/british-irish.aver2</span>
<span id="cb105-58"><a href="gwas-white-british-irish.html#cb105-58" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;FNR &gt; 1 {print $1, $2}&#39;</span>  <span class="va">$a</span> <span class="va">$b</span> <span class="op">&gt;</span> <span class="va">$out</span></span></code></pre></div>
</div>
<div id="organize-data-4" class="section level3" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> organize data</h3>
<div class="sourceCode" id="cb106"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb106-1"><a href="gwas-white-british-irish.html#cb106-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-2"><a href="gwas-white-british-irish.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb106-3"><a href="gwas-white-british-irish.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract LD score</span></span>
<span id="cb106-4"><a href="gwas-white-british-irish.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb106-5"><a href="gwas-white-british-irish.html#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="gwas-white-british-irish.html#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co"># convert snp list to rs system ------------------------------------------------</span></span>
<span id="cb106-7"><a href="gwas-white-british-irish.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="va">infile</span><span class="op">=</span>gen/snps-unrel-inds.use</span>
<span id="cb106-8"><a href="gwas-white-british-irish.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="va">outfile</span><span class="op">=</span>gen/snps-unrel-inds.use-rs</span>
<span id="cb106-9"><a href="gwas-white-british-irish.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$1]; next}</span></span>
<span id="cb106-10"><a href="gwas-white-british-irish.html#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="st">     ($1 in a){print $1, $2}&#39;</span> <span class="va">$infile</span> doug/ukbb.ldsc  <span class="op">&gt;</span> <span class="va">$outfile</span></span>
<span id="cb106-11"><a href="gwas-white-british-irish.html#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="gwas-white-british-irish.html#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  extract ld scores -----------------------------------------------------------</span></span>
<span id="cb106-13"><a href="gwas-white-british-irish.html#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="va">dir</span><span class="op">=</span>ldsc/eur_w_ld_chr</span>
<span id="cb106-14"><a href="gwas-white-british-irish.html#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chrom <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb106-15"><a href="gwas-white-british-irish.html#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> <span class="va">$dir</span>/<span class="va">$chrom</span>.l2.ldscore.gz <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $2, $6}&#39;</span> <span class="op">&gt;</span> ldscore</span>
<span id="cb106-16"><a href="gwas-white-british-irish.html#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;(NR==FNR){a[$2]; b[$2]=$1; next}</span></span>
<span id="cb106-17"><a href="gwas-white-british-irish.html#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="st">      ($1 in a){print b[$1], $2}&#39;</span> gen/snps-unrel-inds.use-rs ldscore <span class="op">&gt;</span> temp</span>
<span id="cb106-18"><a href="gwas-white-british-irish.html#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$chrom</span> <span class="ot">-eq</span> 1 <span class="bu">]</span></span>
<span id="cb106-19"><a href="gwas-white-british-irish.html#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="cf">then</span> </span>
<span id="cb106-20"><a href="gwas-white-british-irish.html#cb106-20" aria-hidden="true" tabindex="-1"></a> <span class="fu">mv</span> temp snps-unrel-inds.ldscore</span>
<span id="cb106-21"><a href="gwas-white-british-irish.html#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb106-22"><a href="gwas-white-british-irish.html#cb106-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span> snps-unrel-inds.ldscore temp <span class="op">&gt;</span> temp2</span>
<span id="cb106-23"><a href="gwas-white-british-irish.html#cb106-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">mv</span> temp2 snps-unrel-inds.ldscore</span>
<span id="cb106-24"><a href="gwas-white-british-irish.html#cb106-24" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb106-25"><a href="gwas-white-british-irish.html#cb106-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$chrom</span></span>
<span id="cb106-26"><a href="gwas-white-british-irish.html#cb106-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb106-27"><a href="gwas-white-british-irish.html#cb106-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-28"><a href="gwas-white-british-irish.html#cb106-28" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb106-29"><a href="gwas-white-british-irish.html#cb106-29" aria-hidden="true" tabindex="-1"></a><span class="co"># putting information together</span></span>
<span id="cb106-30"><a href="gwas-white-british-irish.html#cb106-30" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb106-31"><a href="gwas-white-british-irish.html#cb106-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-32"><a href="gwas-white-british-irish.html#cb106-32" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-british-irish-out</span>
<span id="cb106-33"><a href="gwas-white-british-irish.html#cb106-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-34"><a href="gwas-white-british-irish.html#cb106-34" aria-hidden="true" tabindex="-1"></a><span class="va">outdir</span><span class="op">=</span>gwas-british-irish-out</span>
<span id="cb106-35"><a href="gwas-white-british-irish.html#cb106-35" aria-hidden="true" tabindex="-1"></a><span class="va">indir</span><span class="op">=</span>gwas-british-irish</span>
<span id="cb106-36"><a href="gwas-white-british-irish.html#cb106-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-37"><a href="gwas-white-british-irish.html#cb106-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb106-38"><a href="gwas-white-british-irish.html#cb106-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-39"><a href="gwas-white-british-irish.html#cb106-39" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span><span class="va">$indir</span>/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb106-40"><a href="gwas-white-british-irish.html#cb106-40" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>inflation/british-irish/british-irish.aver2</span>
<span id="cb106-41"><a href="gwas-white-british-irish.html#cb106-41" aria-hidden="true" tabindex="-1"></a><span class="va">ldsc</span><span class="op">=</span>snps-unrel-inds.ldscore</span>
<span id="cb106-42"><a href="gwas-white-british-irish.html#cb106-42" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span><span class="va">$outdir</span>/<span class="va">$trait</span>.out</span>
<span id="cb106-43"><a href="gwas-white-british-irish.html#cb106-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-44"><a href="gwas-white-british-irish.html#cb106-44" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp</span>
<span id="cb106-45"><a href="gwas-white-british-irish.html#cb106-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-46"><a href="gwas-white-british-irish.html#cb106-46" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb106-47"><a href="gwas-white-british-irish.html#cb106-47" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb106-48"><a href="gwas-white-british-irish.html#cb106-48" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$ldsc</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/ldsc.tmp</span>
<span id="cb106-49"><a href="gwas-white-british-irish.html#cb106-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-50"><a href="gwas-white-british-irish.html#cb106-50" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb106-51"><a href="gwas-white-british-irish.html#cb106-51" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb106-52"><a href="gwas-white-british-irish.html#cb106-52" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb106-53"><a href="gwas-white-british-irish.html#cb106-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-54"><a href="gwas-white-british-irish.html#cb106-54" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb106-55"><a href="gwas-white-british-irish.html#cb106-55" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb106-56"><a href="gwas-white-british-irish.html#cb106-56" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb106-57"><a href="gwas-white-british-irish.html#cb106-57" aria-hidden="true" tabindex="-1"></a>      tmp/ldsc.tmp <span class="dt">\</span></span>
<span id="cb106-58"><a href="gwas-white-british-irish.html#cb106-58" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb106-59"><a href="gwas-white-british-irish.html#cb106-59" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2;ldsc&quot;}</span></span>
<span id="cb106-60"><a href="gwas-white-british-irish.html#cb106-60" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb106-61"><a href="gwas-white-british-irish.html#cb106-61" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb106-62"><a href="gwas-white-british-irish.html#cb106-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-63"><a href="gwas-white-british-irish.html#cb106-63" aria-hidden="true" tabindex="-1"></a><span class="co"># varying # of PCs-------------------------------------------------------------</span></span>
<span id="cb106-64"><a href="gwas-white-british-irish.html#cb106-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-65"><a href="gwas-white-british-irish.html#cb106-65" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> gwas-british-irish-pc-out</span>
<span id="cb106-66"><a href="gwas-white-british-irish.html#cb106-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-67"><a href="gwas-white-british-irish.html#cb106-67" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb106-68"><a href="gwas-white-british-irish.html#cb106-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trait <span class="kw">in</span> <span class="dt">{awake</span><span class="op">,</span><span class="dt">bmi</span><span class="op">,</span><span class="dt">chron</span><span class="op">,</span><span class="dt">ever</span><span class="op">,</span><span class="dt">fvc</span><span class="op">,</span><span class="dt">height</span><span class="op">,</span><span class="dt">imp</span><span class="op">,</span><span class="dt">neur</span><span class="op">,</span><span class="dt">pulse</span><span class="op">,</span><span class="dt">quals</span><span class="op">,</span><span class="dt">reaction</span><span class="op">,</span><span class="dt">sbp</span><span class="op">,</span><span class="dt">snoring</span><span class="op">,</span><span class="dt">hyper}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb106-69"><a href="gwas-white-british-irish.html#cb106-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-70"><a href="gwas-white-british-irish.html#cb106-70" aria-hidden="true" tabindex="-1"></a><span class="va">gwas</span><span class="op">=</span>gwas-british-irish-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>/<span class="va">$trait</span>-linear.summaries</span>
<span id="cb106-71"><a href="gwas-white-british-irish.html#cb106-71" aria-hidden="true" tabindex="-1"></a><span class="va">aver2</span><span class="op">=</span>inflation/british-irish/british-irish.aver2</span>
<span id="cb106-72"><a href="gwas-white-british-irish.html#cb106-72" aria-hidden="true" tabindex="-1"></a><span class="va">ldsc</span><span class="op">=</span>snps-unrel-inds.ldscore</span>
<span id="cb106-73"><a href="gwas-white-british-irish.html#cb106-73" aria-hidden="true" tabindex="-1"></a><span class="va">out</span><span class="op">=</span>gwas-british-irish-pc-out/<span class="va">$trait</span>-<span class="va">$j</span><span class="st">&#39;PC&#39;</span>.out</span>
<span id="cb106-74"><a href="gwas-white-british-irish.html#cb106-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-75"><a href="gwas-white-british-irish.html#cb106-75" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR&gt;1 {print $1, $5}&#39;</span> <span class="va">$gwas</span> <span class="op">&gt;</span> tmp/gwas.tmp</span>
<span id="cb106-76"><a href="gwas-white-british-irish.html#cb106-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-77"><a href="gwas-white-british-irish.html#cb106-77" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb106-78"><a href="gwas-white-british-irish.html#cb106-78" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb106-79"><a href="gwas-white-british-irish.html#cb106-79" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$ldsc</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/ldsc.tmp</span>
<span id="cb106-80"><a href="gwas-white-british-irish.html#cb106-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-81"><a href="gwas-white-british-irish.html#cb106-81" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;NR==FNR {a[$1]; b[$1]=$2; next} </span></span>
<span id="cb106-82"><a href="gwas-white-british-irish.html#cb106-82" aria-hidden="true" tabindex="-1"></a><span class="st">     {if ($1 in a) print b[$1]; </span></span>
<span id="cb106-83"><a href="gwas-white-british-irish.html#cb106-83" aria-hidden="true" tabindex="-1"></a><span class="st">     else print &quot;NA&quot; }&#39;</span> <span class="va">$aver2</span> tmp/gwas.tmp <span class="op">&gt;</span> tmp/aver2.tmp</span>
<span id="cb106-84"><a href="gwas-white-british-irish.html#cb106-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-85"><a href="gwas-white-british-irish.html#cb106-85" aria-hidden="true" tabindex="-1"></a><span class="co"># put info together</span></span>
<span id="cb106-86"><a href="gwas-white-british-irish.html#cb106-86" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> tmp/gwas.tmp <span class="dt">\</span></span>
<span id="cb106-87"><a href="gwas-white-british-irish.html#cb106-87" aria-hidden="true" tabindex="-1"></a>      tmp/aver2.tmp <span class="dt">\</span></span>
<span id="cb106-88"><a href="gwas-white-british-irish.html#cb106-88" aria-hidden="true" tabindex="-1"></a>      tmp/ldsc.tmp <span class="dt">\</span></span>
<span id="cb106-89"><a href="gwas-white-british-irish.html#cb106-89" aria-hidden="true" tabindex="-1"></a>      <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;BEGIN{OFS=&quot;;&quot; ; </span></span>
<span id="cb106-90"><a href="gwas-white-british-irish.html#cb106-90" aria-hidden="true" tabindex="-1"></a><span class="st">                  print &quot;snp;chisq;aver2;ldsc&quot;}</span></span>
<span id="cb106-91"><a href="gwas-white-british-irish.html#cb106-91" aria-hidden="true" tabindex="-1"></a><span class="st">             {$1=$1}1&#39;</span> <span class="op">&gt;</span> <span class="va">$out</span></span>
<span id="cb106-92"><a href="gwas-white-british-irish.html#cb106-92" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb106-93"><a href="gwas-white-british-irish.html#cb106-93" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="detect-confounding-wt-pcs" class="section level3" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> detect confounding: w/t PCs</h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="gwas-white-british-irish.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb107-2"><a href="gwas-white-british-irish.html#cb107-2" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb107-3"><a href="gwas-white-british-irish.html#cb107-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb107-4"><a href="gwas-white-british-irish.html#cb107-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb107-5"><a href="gwas-white-british-irish.html#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="gwas-white-british-irish.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-aver2-bin-british-irish.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb107-7"><a href="gwas-white-british-irish.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>)</span>
<span id="cb107-8"><a href="gwas-white-british-irish.html#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="gwas-white-british-irish.html#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb107-10"><a href="gwas-white-british-irish.html#cb107-10" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb107-11"><a href="gwas-white-british-irish.html#cb107-11" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-british-irish-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb107-12"><a href="gwas-white-british-irish.html#cb107-12" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb107-13"><a href="gwas-white-british-irish.html#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="gwas-white-british-irish.html#cb107-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb107-15"><a href="gwas-white-british-irish.html#cb107-15" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2 <span class="sc">+</span> ldsc,<span class="at">data=</span>dat)</span>
<span id="cb107-16"><a href="gwas-white-british-irish.html#cb107-16" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>]</span>
<span id="cb107-17"><a href="gwas-white-british-irish.html#cb107-17" aria-hidden="true" tabindex="-1"></a>  p_sci<span class="ot">=</span><span class="fu">formatC</span>(p, <span class="at">format=</span><span class="st">&quot;e&quot;</span>, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb107-18"><a href="gwas-white-british-irish.html#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="gwas-white-british-irish.html#cb107-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb107-20"><a href="gwas-white-british-irish.html#cb107-20" aria-hidden="true" tabindex="-1"></a>  cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb107-21"><a href="gwas-white-british-irish.html#cb107-21" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb107-22"><a href="gwas-white-british-irish.html#cb107-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-23"><a href="gwas-white-british-irish.html#cb107-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb107-24"><a href="gwas-white-british-irish.html#cb107-24" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">chisq_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>chisq,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb107-25"><a href="gwas-white-british-irish.html#cb107-25" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb107-26"><a href="gwas-white-british-irish.html#cb107-26" aria-hidden="true" tabindex="-1"></a>  px<span class="ot">=</span><span class="fu">min</span>(out<span class="sc">$</span>bin_val)</span>
<span id="cb107-27"><a href="gwas-white-british-irish.html#cb107-27" aria-hidden="true" tabindex="-1"></a>  py<span class="ot">=</span><span class="fu">max</span>(out<span class="sc">$</span>chisq_ave)</span>
<span id="cb107-28"><a href="gwas-white-british-irish.html#cb107-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-29"><a href="gwas-white-british-irish.html#cb107-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb107-30"><a href="gwas-white-british-irish.html#cb107-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>bin_val, out<span class="sc">$</span>chisq_ave,</span>
<span id="cb107-31"><a href="gwas-white-british-irish.html#cb107-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;ave r2 bin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;mean chisq&quot;</span>,</span>
<span id="cb107-32"><a href="gwas-white-british-irish.html#cb107-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb107-33"><a href="gwas-white-british-irish.html#cb107-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb107-34"><a href="gwas-white-british-irish.html#cb107-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(chisq <span class="sc">~</span> aver2,<span class="at">data=</span>dat),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb107-35"><a href="gwas-white-british-irish.html#cb107-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(p<span class="sc">&lt;</span><span class="fl">0.01</span>){<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci),</span>
<span id="cb107-36"><a href="gwas-white-british-irish.html#cb107-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb107-37"><a href="gwas-white-british-irish.html#cb107-37" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {<span class="fu">text</span>(px, py, <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_sci), </span>
<span id="cb107-38"><a href="gwas-white-british-irish.html#cb107-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>)}</span>
<span id="cb107-39"><a href="gwas-white-british-irish.html#cb107-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-40"><a href="gwas-white-british-irish.html#cb107-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-41"><a href="gwas-white-british-irish.html#cb107-41" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb107-42"><a href="gwas-white-british-irish.html#cb107-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-43"><a href="gwas-white-british-irish.html#cb107-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-44"><a href="gwas-white-british-irish.html#cb107-44" aria-hidden="true" tabindex="-1"></a><span class="co">#-----slope estimate from the full model----------------------------------------</span></span>
<span id="cb107-45"><a href="gwas-white-british-irish.html#cb107-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-46"><a href="gwas-white-british-irish.html#cb107-46" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb107-47"><a href="gwas-white-british-irish.html#cb107-47" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb107-48"><a href="gwas-white-british-irish.html#cb107-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb107-49"><a href="gwas-white-british-irish.html#cb107-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb107-50"><a href="gwas-white-british-irish.html#cb107-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-51"><a href="gwas-white-british-irish.html#cb107-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-52"><a href="gwas-white-british-irish.html#cb107-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb107-53"><a href="gwas-white-british-irish.html#cb107-53" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb107-54"><a href="gwas-white-british-irish.html#cb107-54" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-british-irish-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb107-55"><a href="gwas-white-british-irish.html#cb107-55" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb107-56"><a href="gwas-white-british-irish.html#cb107-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-57"><a href="gwas-white-british-irish.html#cb107-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb107-58"><a href="gwas-white-british-irish.html#cb107-58" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2 <span class="sc">+</span> ldsc ,<span class="at">data=</span>dat)</span>
<span id="cb107-59"><a href="gwas-white-british-irish.html#cb107-59" aria-hidden="true" tabindex="-1"></a>  out0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb107-60"><a href="gwas-white-british-irish.html#cb107-60" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>])</span>
<span id="cb107-61"><a href="gwas-white-british-irish.html#cb107-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){out<span class="ot">=</span>out0} <span class="cf">else</span> {out<span class="ot">=</span><span class="fu">rbind</span>(out,out0)}</span>
<span id="cb107-62"><a href="gwas-white-british-irish.html#cb107-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-63"><a href="gwas-white-british-irish.html#cb107-63" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="detect-confounding-with-pcs" class="section level3" number="13.3.4">
<h3><span class="header-section-number">13.3.4</span> detect confounding: with PCs</h3>
<p>Note: significant slope until the first four PCs are included as the covariates in the GWAS model. This indicates the significant slope found above genuinely relates to population stratification; not false positives.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="gwas-white-british-irish.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb108-2"><a href="gwas-white-british-irish.html#cb108-2" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb108-3"><a href="gwas-white-british-irish.html#cb108-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb108-4"><a href="gwas-white-british-irish.html#cb108-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb108-5"><a href="gwas-white-british-irish.html#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="gwas-white-british-irish.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb108-7"><a href="gwas-white-british-irish.html#cb108-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-8"><a href="gwas-white-british-irish.html#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb108-9"><a href="gwas-white-british-irish.html#cb108-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb108-10"><a href="gwas-white-british-irish.html#cb108-10" aria-hidden="true" tabindex="-1"></a>    trait<span class="ot">=</span>traits[i]</span>
<span id="cb108-11"><a href="gwas-white-british-irish.html#cb108-11" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-british-irish-pc-out/&quot;</span>,trait,<span class="st">&quot;-&quot;</span>,j,<span class="st">&quot;PC.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb108-12"><a href="gwas-white-british-irish.html#cb108-12" aria-hidden="true" tabindex="-1"></a>    dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb108-13"><a href="gwas-white-british-irish.html#cb108-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-14"><a href="gwas-white-british-irish.html#cb108-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># linear model</span></span>
<span id="cb108-15"><a href="gwas-white-british-irish.html#cb108-15" aria-hidden="true" tabindex="-1"></a>    mod<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> aver2 <span class="sc">+</span> ldsc ,<span class="at">data=</span>dat)</span>
<span id="cb108-16"><a href="gwas-white-british-irish.html#cb108-16" aria-hidden="true" tabindex="-1"></a>    out0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,</span>
<span id="cb108-17"><a href="gwas-white-british-irish.html#cb108-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pc=</span>j,</span>
<span id="cb108-18"><a href="gwas-white-british-irish.html#cb108-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">p=</span><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[,<span class="dv">4</span>][<span class="dv">2</span>])</span>
<span id="cb108-19"><a href="gwas-white-british-irish.html#cb108-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> j<span class="sc">==</span><span class="dv">1</span>){out<span class="ot">=</span>out0} <span class="cf">else</span> {out<span class="ot">=</span><span class="fu">rbind</span>(out,out0)}</span>
<span id="cb108-20"><a href="gwas-white-british-irish.html#cb108-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-21"><a href="gwas-white-british-irish.html#cb108-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb108-22"><a href="gwas-white-british-irish.html#cb108-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-23"><a href="gwas-white-british-irish.html#cb108-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-24"><a href="gwas-white-british-irish.html#cb108-24" aria-hidden="true" tabindex="-1"></a>sel<span class="ot">=</span>out[out<span class="sc">$</span>pc<span class="sc">==</span><span class="dv">4</span>,]</span>
<span id="cb108-25"><a href="gwas-white-british-irish.html#cb108-25" aria-hidden="true" tabindex="-1"></a>sel<span class="sc">$</span>sig<span class="ot">=</span>sel<span class="sc">$</span>p<span class="sc">&lt;</span><span class="fl">0.01</span><span class="sc">/</span><span class="dv">14</span></span>
<span id="cb108-26"><a href="gwas-white-british-irish.html#cb108-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-27"><a href="gwas-white-british-irish.html#cb108-27" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(out,<span class="st">&quot;summary/chisq-aver2-full-model-british-irisih-pc.out&quot;</span>, <span class="at">col.names=</span>T, <span class="at">row.names=</span>F, <span class="at">quote=</span>F)</span></code></pre></div>
</div>
<div id="inflation-good-gwas-vs.-control-vs.-british-irish" class="section level3" number="13.3.5">
<h3><span class="header-section-number">13.3.5</span> inflation: good gwas vs. control vs. british-irish</h3>
<ol style="list-style-type: decimal">
<li>Is there any evidence of inflation? british-irish vs. good gwas; good vs. control gwas.
Do this for all traits.
Note: to be a STRICK control, the british part need to be the same as for the british-irish mix.</li>
</ol>
<p>Need to draw QQ plot</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="gwas-white-british-irish.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb109-2"><a href="gwas-white-british-irish.html#cb109-2" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb109-3"><a href="gwas-white-british-irish.html#cb109-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb109-4"><a href="gwas-white-british-irish.html#cb109-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb109-5"><a href="gwas-white-british-irish.html#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="gwas-white-british-irish.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-ave-good-control-british-irish.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb109-7"><a href="gwas-white-british-irish.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>, <span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb109-8"><a href="gwas-white-british-irish.html#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="gwas-white-british-irish.html#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb109-10"><a href="gwas-white-british-irish.html#cb109-10" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb109-11"><a href="gwas-white-british-irish.html#cb109-11" aria-hidden="true" tabindex="-1"></a>  good<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;unrelated/gwas-good-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb109-12"><a href="gwas-white-british-irish.html#cb109-12" aria-hidden="true" tabindex="-1"></a>  control<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-control/&quot;</span>,trait,<span class="st">&quot;-linear.summaries&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb109-13"><a href="gwas-white-british-irish.html#cb109-13" aria-hidden="true" tabindex="-1"></a>  irish<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-british-irish-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb109-14"><a href="gwas-white-british-irish.html#cb109-14" aria-hidden="true" tabindex="-1"></a>  irish<span class="ot">=</span>irish[<span class="fu">complete.cases</span>(irish),] <span class="co"># only use SNPs with aver2 </span></span>
<span id="cb109-15"><a href="gwas-white-british-irish.html#cb109-15" aria-hidden="true" tabindex="-1"></a>  m1<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>snp, good<span class="sc">$</span>snp)</span>
<span id="cb109-16"><a href="gwas-white-british-irish.html#cb109-16" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>snp, control<span class="sc">$</span>Predictor)</span>
<span id="cb109-17"><a href="gwas-white-british-irish.html#cb109-17" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>irish<span class="sc">$</span>snp,</span>
<span id="cb109-18"><a href="gwas-white-british-irish.html#cb109-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">irish=</span>irish<span class="sc">$</span>chisq,</span>
<span id="cb109-19"><a href="gwas-white-british-irish.html#cb109-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">good=</span>good<span class="sc">$</span>chisq[m1],</span>
<span id="cb109-20"><a href="gwas-white-british-irish.html#cb109-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control=</span>control<span class="sc">$</span>Stat[m2],</span>
<span id="cb109-21"><a href="gwas-white-british-irish.html#cb109-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">aver2=</span>irish<span class="sc">$</span>aver2)</span>
<span id="cb109-22"><a href="gwas-white-british-irish.html#cb109-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-23"><a href="gwas-white-british-irish.html#cb109-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb109-24"><a href="gwas-white-british-irish.html#cb109-24" aria-hidden="true" tabindex="-1"></a>  cutoff<span class="ot">=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>aver2, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>), <span class="at">na.rm=</span>T)</span>
<span id="cb109-25"><a href="gwas-white-british-irish.html#cb109-25" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>bin<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>aver2, <span class="at">breaks=</span>cutoff, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cutoff)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb109-26"><a href="gwas-white-british-irish.html#cb109-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-27"><a href="gwas-white-british-irish.html#cb109-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average chisq by bin values</span></span>
<span id="cb109-28"><a href="gwas-white-british-irish.html#cb109-28" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">good_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>good,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean),</span>
<span id="cb109-29"><a href="gwas-white-british-irish.html#cb109-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>irish,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean),</span>
<span id="cb109-30"><a href="gwas-white-british-irish.html#cb109-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">irish_ave=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>control,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean))</span>
<span id="cb109-31"><a href="gwas-white-british-irish.html#cb109-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-32"><a href="gwas-white-british-irish.html#cb109-32" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>bin_val<span class="ot">=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>aver2,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin, mean)</span>
<span id="cb109-33"><a href="gwas-white-british-irish.html#cb109-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-34"><a href="gwas-white-british-irish.html#cb109-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb109-35"><a href="gwas-white-british-irish.html#cb109-35" aria-hidden="true" tabindex="-1"></a>  start<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(out<span class="sc">$</span>good_ave,out<span class="sc">$</span>control_ave,out<span class="sc">$</span>irish_ave), <span class="at">na.rm=</span>T)</span>
<span id="cb109-36"><a href="gwas-white-british-irish.html#cb109-36" aria-hidden="true" tabindex="-1"></a>  end<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(out<span class="sc">$</span>good_ave,out<span class="sc">$</span>control_ave,out<span class="sc">$</span>irish_ave), <span class="at">na.rm=</span>T)</span>
<span id="cb109-37"><a href="gwas-white-british-irish.html#cb109-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>good_ave, out<span class="sc">$</span>irish_ave,</span>
<span id="cb109-38"><a href="gwas-white-british-irish.html#cb109-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;chisq from good gwas&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;chisq&quot;</span>,</span>
<span id="cb109-39"><a href="gwas-white-british-irish.html#cb109-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(start,end), <span class="at">ylim=</span><span class="fu">c</span>(start,end),</span>
<span id="cb109-40"><a href="gwas-white-british-irish.html#cb109-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb109-41"><a href="gwas-white-british-irish.html#cb109-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb109-42"><a href="gwas-white-british-irish.html#cb109-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(out<span class="sc">$</span>good_ave, out<span class="sc">$</span>control_ave,<span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  </span>
<span id="cb109-43"><a href="gwas-white-british-irish.html#cb109-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb109-44"><a href="gwas-white-british-irish.html#cb109-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span> ,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb109-45"><a href="gwas-white-british-irish.html#cb109-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-46"><a href="gwas-white-british-irish.html#cb109-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-47"><a href="gwas-white-british-irish.html#cb109-47" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb109-48"><a href="gwas-white-british-irish.html#cb109-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-49"><a href="gwas-white-british-irish.html#cb109-49" aria-hidden="true" tabindex="-1"></a><span class="co"># qq plots ---------------------------------------------------------------------</span></span>
<span id="cb109-50"><a href="gwas-white-british-irish.html#cb109-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-51"><a href="gwas-white-british-irish.html#cb109-51" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;fig/chisq-qqplot-good-control-british-irish.png&quot;</span>, <span class="at">res=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">30</span>, <span class="at">units=</span><span class="st">&quot;cm&quot;</span>)</span>
<span id="cb109-52"><a href="gwas-white-british-irish.html#cb109-52" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>, <span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb109-53"><a href="gwas-white-british-irish.html#cb109-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-54"><a href="gwas-white-british-irish.html#cb109-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb109-55"><a href="gwas-white-british-irish.html#cb109-55" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb109-56"><a href="gwas-white-british-irish.html#cb109-56" aria-hidden="true" tabindex="-1"></a>  good<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;unrelated/gwas-good-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb109-57"><a href="gwas-white-british-irish.html#cb109-57" aria-hidden="true" tabindex="-1"></a>  control<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-control/&quot;</span>,trait,<span class="st">&quot;-linear.summaries&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb109-58"><a href="gwas-white-british-irish.html#cb109-58" aria-hidden="true" tabindex="-1"></a>  irish<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-british-irish-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb109-59"><a href="gwas-white-british-irish.html#cb109-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#irish=irish[complete.cases(irish),] # only use SNPs with aver2 </span></span>
<span id="cb109-60"><a href="gwas-white-british-irish.html#cb109-60" aria-hidden="true" tabindex="-1"></a>  m1<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>snp, good<span class="sc">$</span>snp)</span>
<span id="cb109-61"><a href="gwas-white-british-irish.html#cb109-61" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>snp, control<span class="sc">$</span>Predictor)</span>
<span id="cb109-62"><a href="gwas-white-british-irish.html#cb109-62" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>irish<span class="sc">$</span>snp,</span>
<span id="cb109-63"><a href="gwas-white-british-irish.html#cb109-63" aria-hidden="true" tabindex="-1"></a>                 <span class="at">irish=</span>irish<span class="sc">$</span>chisq,</span>
<span id="cb109-64"><a href="gwas-white-british-irish.html#cb109-64" aria-hidden="true" tabindex="-1"></a>                 <span class="at">good=</span>good<span class="sc">$</span>chisq[m1],</span>
<span id="cb109-65"><a href="gwas-white-british-irish.html#cb109-65" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control=</span>control<span class="sc">$</span>Stat[m2],</span>
<span id="cb109-66"><a href="gwas-white-british-irish.html#cb109-66" aria-hidden="true" tabindex="-1"></a>                 <span class="at">aver2=</span>irish<span class="sc">$</span>aver2)</span>
<span id="cb109-67"><a href="gwas-white-british-irish.html#cb109-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-68"><a href="gwas-white-british-irish.html#cb109-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin a variable by quantile</span></span>
<span id="cb109-69"><a href="gwas-white-british-irish.html#cb109-69" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">good=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>good, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>), <span class="at">na.rm=</span>T),</span>
<span id="cb109-70"><a href="gwas-white-british-irish.html#cb109-70" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>control, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>), <span class="at">na.rm=</span>T),</span>
<span id="cb109-71"><a href="gwas-white-british-irish.html#cb109-71" aria-hidden="true" tabindex="-1"></a>                  <span class="at">irish=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>irish, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>), <span class="at">na.rm=</span>T))</span>
<span id="cb109-72"><a href="gwas-white-british-irish.html#cb109-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-73"><a href="gwas-white-british-irish.html#cb109-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb109-74"><a href="gwas-white-british-irish.html#cb109-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#start=min(c(good_q,control_q,irish_q), na.rm=T)</span></span>
<span id="cb109-75"><a href="gwas-white-british-irish.html#cb109-75" aria-hidden="true" tabindex="-1"></a>  <span class="co">#end=max(c(good_q,control_q,irish_q), na.rm=T)</span></span>
<span id="cb109-76"><a href="gwas-white-british-irish.html#cb109-76" aria-hidden="true" tabindex="-1"></a>  remove<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">dim</span>(out)[<span class="dv">1</span>])</span>
<span id="cb109-77"><a href="gwas-white-british-irish.html#cb109-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(out<span class="sc">$</span>good[<span class="sc">-</span>remove], out<span class="sc">$</span>irish[<span class="sc">-</span>remove],</span>
<span id="cb109-78"><a href="gwas-white-british-irish.html#cb109-78" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;quantiles of chisq: good gwas&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;quantiles of chisq&quot;</span>,</span>
<span id="cb109-79"><a href="gwas-white-british-irish.html#cb109-79" aria-hidden="true" tabindex="-1"></a>           <span class="co">#xlim=c(start,end), ylim=c(start,end),</span></span>
<span id="cb109-80"><a href="gwas-white-british-irish.html#cb109-80" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span>trait, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb109-81"><a href="gwas-white-british-irish.html#cb109-81" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb109-82"><a href="gwas-white-british-irish.html#cb109-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(out<span class="sc">$</span>good[<span class="sc">-</span>remove], out<span class="sc">$</span>control[<span class="sc">-</span>remove],<span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">21</span>,  </span>
<span id="cb109-83"><a href="gwas-white-british-irish.html#cb109-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">bg=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb109-84"><a href="gwas-white-british-irish.html#cb109-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span> ,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb109-85"><a href="gwas-white-british-irish.html#cb109-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-86"><a href="gwas-white-british-irish.html#cb109-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-87"><a href="gwas-white-british-irish.html#cb109-87" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb109-88"><a href="gwas-white-british-irish.html#cb109-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-89"><a href="gwas-white-british-irish.html#cb109-89" aria-hidden="true" tabindex="-1"></a><span class="do">## Under the null, what chisq(1) is significant?</span></span>
<span id="cb109-90"><a href="gwas-white-british-irish.html#cb109-90" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="fl">0.99</span>, <span class="dv">1</span>, <span class="at">lower.tail=</span>T)</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="gwas-white-british-irish.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using histograms to show inflation</span></span>
<span id="cb110-2"><a href="gwas-white-british-irish.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyr)</span>
<span id="cb110-3"><a href="gwas-white-british-irish.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb110-4"><a href="gwas-white-british-irish.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb110-5"><a href="gwas-white-british-irish.html#cb110-5" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb110-6"><a href="gwas-white-british-irish.html#cb110-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb110-7"><a href="gwas-white-british-irish.html#cb110-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb110-8"><a href="gwas-white-british-irish.html#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="gwas-white-british-irish.html#cb110-9" aria-hidden="true" tabindex="-1"></a>trait<span class="ot">=</span>traits[<span class="dv">8</span>]</span>
<span id="cb110-10"><a href="gwas-white-british-irish.html#cb110-10" aria-hidden="true" tabindex="-1"></a>good<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;unrelated/gwas-good-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb110-11"><a href="gwas-white-british-irish.html#cb110-11" aria-hidden="true" tabindex="-1"></a>control<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-control/&quot;</span>,trait,<span class="st">&quot;-linear.summaries&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb110-12"><a href="gwas-white-british-irish.html#cb110-12" aria-hidden="true" tabindex="-1"></a>irish<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-british-irish-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb110-13"><a href="gwas-white-british-irish.html#cb110-13" aria-hidden="true" tabindex="-1"></a>irish<span class="ot">=</span>irish[<span class="fu">complete.cases</span>(irish),] <span class="co"># only use SNPs with aver2 </span></span>
<span id="cb110-14"><a href="gwas-white-british-irish.html#cb110-14" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>snp, good<span class="sc">$</span>snp)</span>
<span id="cb110-15"><a href="gwas-white-british-irish.html#cb110-15" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">=</span><span class="fu">match</span>(irish<span class="sc">$</span>snp, control<span class="sc">$</span>Predictor)</span>
<span id="cb110-16"><a href="gwas-white-british-irish.html#cb110-16" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">snp=</span>irish<span class="sc">$</span>snp,</span>
<span id="cb110-17"><a href="gwas-white-british-irish.html#cb110-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">irish=</span>irish<span class="sc">$</span>chisq,</span>
<span id="cb110-18"><a href="gwas-white-british-irish.html#cb110-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">good=</span>good<span class="sc">$</span>chisq[m1],</span>
<span id="cb110-19"><a href="gwas-white-british-irish.html#cb110-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">control=</span>control<span class="sc">$</span>Stat[m2])</span>
<span id="cb110-20"><a href="gwas-white-british-irish.html#cb110-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-21"><a href="gwas-white-british-irish.html#cb110-21" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb110-22"><a href="gwas-white-british-irish.html#cb110-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-23"><a href="gwas-white-british-irish.html#cb110-23" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles</span></span>
<span id="cb110-24"><a href="gwas-white-british-irish.html#cb110-24" aria-hidden="true" tabindex="-1"></a>q<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">good=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>good, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">na.rm=</span>T),</span>
<span id="cb110-25"><a href="gwas-white-british-irish.html#cb110-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">control=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>control, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">na.rm=</span>T),</span>
<span id="cb110-26"><a href="gwas-white-british-irish.html#cb110-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">irish=</span><span class="fu">quantile</span>(dat<span class="sc">$</span>irish, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">na.rm=</span>T))</span>
<span id="cb110-27"><a href="gwas-white-british-irish.html#cb110-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-28"><a href="gwas-white-british-irish.html#cb110-28" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>bin_good<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>good, <span class="at">breaks=</span>q<span class="sc">$</span>good, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(q<span class="sc">$</span>good)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb110-29"><a href="gwas-white-british-irish.html#cb110-29" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>bin_control<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>control, <span class="at">breaks=</span>q<span class="sc">$</span>control, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(q<span class="sc">$</span>control)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb110-30"><a href="gwas-white-british-irish.html#cb110-30" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>bin_irish<span class="ot">=</span><span class="fu">cut</span>(dat<span class="sc">$</span>irish, <span class="at">breaks=</span>q<span class="sc">$</span>irish, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(q<span class="sc">$</span>irish)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb110-31"><a href="gwas-white-british-irish.html#cb110-31" aria-hidden="true" tabindex="-1"></a><span class="co"># average chisq by bin values</span></span>
<span id="cb110-32"><a href="gwas-white-british-irish.html#cb110-32" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">good=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>good,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_good, mean),</span>
<span id="cb110-33"><a href="gwas-white-british-irish.html#cb110-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">control=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>control,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_control, mean),</span>
<span id="cb110-34"><a href="gwas-white-british-irish.html#cb110-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">irish=</span><span class="fu">tapply</span>(dat<span class="sc">$</span>irish,<span class="at">INDEX=</span>dat<span class="sc">$</span>bin_irish, mean))</span>
<span id="cb110-35"><a href="gwas-white-british-irish.html#cb110-35" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>control_good<span class="ot">=</span>out<span class="sc">$</span>control<span class="sc">-</span>out<span class="sc">$</span>good</span>
<span id="cb110-36"><a href="gwas-white-british-irish.html#cb110-36" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>irish_good<span class="ot">=</span>out<span class="sc">$</span>irish<span class="sc">-</span>out<span class="sc">$</span>good</span>
<span id="cb110-37"><a href="gwas-white-british-irish.html#cb110-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-38"><a href="gwas-white-british-irish.html#cb110-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-39"><a href="gwas-white-british-irish.html#cb110-39" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">ggplot</span>(dat_long[sel,], <span class="fu">aes</span>(chisq,<span class="at">fill=</span>gwas)) <span class="sc">+</span> </span>
<span id="cb110-40"><a href="gwas-white-british-irish.html#cb110-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb110-41"><a href="gwas-white-british-irish.html#cb110-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_histogram(alpha = 0.5, position = &#39;identity&#39;) +</span></span>
<span id="cb110-42"><a href="gwas-white-british-irish.html#cb110-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb110-43"><a href="gwas-white-british-irish.html#cb110-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-44"><a href="gwas-white-british-irish.html#cb110-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-45"><a href="gwas-white-british-irish.html#cb110-45" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(<span class="st">&quot;fig/hist-chisq-irish-good.png&quot;</span>),</span>
<span id="cb110-46"><a href="gwas-white-british-irish.html#cb110-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">30</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res=</span><span class="dv">600</span>)</span>
<span id="cb110-47"><a href="gwas-white-british-irish.html#cb110-47" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb110-48"><a href="gwas-white-british-irish.html#cb110-48" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="inflation-aver2" class="section level3" number="13.3.6">
<h3><span class="header-section-number">13.3.6</span> inflation | aver2</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="gwas-white-british-irish.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract p-values </span></span>
<span id="cb111-2"><a href="gwas-white-british-irish.html#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="gwas-white-british-irish.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vroom)</span>
<span id="cb111-4"><a href="gwas-white-british-irish.html#cb111-4" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;awake&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;chron&quot;</span>,<span class="st">&quot;ever&quot;</span>,</span>
<span id="cb111-5"><a href="gwas-white-british-irish.html#cb111-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;neur&quot;</span>,<span class="st">&quot;pulse&quot;</span>,<span class="st">&quot;quals&quot;</span>, <span class="st">&quot;fvc&quot;</span>, <span class="st">&quot;height&quot;</span>,<span class="st">&quot;imp&quot;</span>, </span>
<span id="cb111-6"><a href="gwas-white-british-irish.html#cb111-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;reaction&quot;</span>,<span class="st">&quot;sbp&quot;</span>,<span class="st">&quot;snoring&quot;</span>,<span class="st">&quot;hyper&quot;</span>)</span>
<span id="cb111-7"><a href="gwas-white-british-irish.html#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="gwas-white-british-irish.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traits)){</span>
<span id="cb111-9"><a href="gwas-white-british-irish.html#cb111-9" aria-hidden="true" tabindex="-1"></a>  trait<span class="ot">=</span>traits[i]</span>
<span id="cb111-10"><a href="gwas-white-british-irish.html#cb111-10" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span><span class="fu">vroom</span>(<span class="fu">paste0</span>(<span class="st">&quot;gwas-british-irish-out/&quot;</span>,trait,<span class="st">&quot;.out&quot;</span>), <span class="at">col_names=</span>T)</span>
<span id="cb111-11"><a href="gwas-white-british-irish.html#cb111-11" aria-hidden="true" tabindex="-1"></a>  sel<span class="ot">=</span>dat[<span class="fu">complete.cases</span>(dat),]</span>
<span id="cb111-12"><a href="gwas-white-british-irish.html#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="gwas-white-british-irish.html#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb111-14"><a href="gwas-white-british-irish.html#cb111-14" aria-hidden="true" tabindex="-1"></a>  mod1<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> ldsc,<span class="at">data=</span>dat) <span class="co"># ldsc using all snps with a ldscore</span></span>
<span id="cb111-15"><a href="gwas-white-british-irish.html#cb111-15" aria-hidden="true" tabindex="-1"></a>  mod1<span class="fl">.2</span><span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> ldsc,<span class="at">data=</span>sel) <span class="co"># ldsc using the 20k snps with aver2</span></span>
<span id="cb111-16"><a href="gwas-white-british-irish.html#cb111-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mod2=lm(chisq ~ aver2,data=dat)</span></span>
<span id="cb111-17"><a href="gwas-white-british-irish.html#cb111-17" aria-hidden="true" tabindex="-1"></a>  mod3<span class="ot">=</span><span class="fu">lm</span>(chisq <span class="sc">~</span> ldsc <span class="sc">+</span> aver2,<span class="at">data=</span>sel)</span>
<span id="cb111-18"><a href="gwas-white-british-irish.html#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="gwas-white-british-irish.html#cb111-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># new method</span></span>
<span id="cb111-20"><a href="gwas-white-british-irish.html#cb111-20" aria-hidden="true" tabindex="-1"></a>  p0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait,<span class="fu">t</span>(<span class="fu">summary</span>(mod3)<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>]))</span>
<span id="cb111-21"><a href="gwas-white-british-irish.html#cb111-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(p0)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]<span class="ot">=</span><span class="fu">row.names</span>(<span class="fu">summary</span>(mod3)<span class="sc">$</span>coefficients)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb111-22"><a href="gwas-white-british-irish.html#cb111-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ldsc </span></span>
<span id="cb111-23"><a href="gwas-white-british-irish.html#cb111-23" aria-hidden="true" tabindex="-1"></a>  ldsc0<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">trait=</span>trait, </span>
<span id="cb111-24"><a href="gwas-white-british-irish.html#cb111-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">intercept_all=</span><span class="fu">summary</span>(mod1)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb111-25"><a href="gwas-white-british-irish.html#cb111-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se_all=</span><span class="fu">summary</span>(mod1)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb111-26"><a href="gwas-white-british-irish.html#cb111-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">intercept_20k=</span><span class="fu">summary</span>(mod1<span class="fl">.2</span>)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb111-27"><a href="gwas-white-british-irish.html#cb111-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se_20k=</span><span class="fu">summary</span>(mod1<span class="fl">.2</span>)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb111-28"><a href="gwas-white-british-irish.html#cb111-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){p<span class="ot">=</span>p0; ldsc<span class="ot">=</span>ldsc0} <span class="cf">else</span> {p<span class="ot">=</span><span class="fu">rbind</span>(p,p0); ldsc<span class="ot">=</span><span class="fu">rbind</span>(ldsc, ldsc0)}</span>
<span id="cb111-29"><a href="gwas-white-british-irish.html#cb111-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-30"><a href="gwas-white-british-irish.html#cb111-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-31"><a href="gwas-white-british-irish.html#cb111-31" aria-hidden="true" tabindex="-1"></a>threshold<span class="ot">=</span><span class="fl">0.01</span><span class="sc">/</span><span class="dv">14</span></span>
<span id="cb111-32"><a href="gwas-white-british-irish.html#cb111-32" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>sig<span class="ot">=</span>p<span class="sc">$</span>aver2<span class="sc">&lt;=</span>threshold</span>
<span id="cb111-33"><a href="gwas-white-british-irish.html#cb111-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-34"><a href="gwas-white-british-irish.html#cb111-34" aria-hidden="true" tabindex="-1"></a>ldsc<span class="sc">$</span>wald_p_all<span class="ot">=</span><span class="fu">pchisq</span>(((ldsc<span class="sc">$</span>intercept_all<span class="dv">-1</span>)<span class="sc">/</span>ldsc<span class="sc">$</span>se_all)<span class="sc">^</span><span class="dv">2</span>, <span class="at">df=</span><span class="dv">1</span>, <span class="at">lower.tail=</span>F)</span>
<span id="cb111-35"><a href="gwas-white-british-irish.html#cb111-35" aria-hidden="true" tabindex="-1"></a>ldsc<span class="sc">$</span>sig_all<span class="ot">=</span>ldsc<span class="sc">$</span>wald_p_all<span class="sc">&lt;=</span>threshold</span>
<span id="cb111-36"><a href="gwas-white-british-irish.html#cb111-36" aria-hidden="true" tabindex="-1"></a>ldsc<span class="sc">$</span>wald_p_20k<span class="ot">=</span><span class="fu">pchisq</span>(((ldsc<span class="sc">$</span>intercept_20k<span class="dv">-1</span>)<span class="sc">/</span>ldsc<span class="sc">$</span>se_20k)<span class="sc">^</span><span class="dv">2</span>, <span class="at">df=</span><span class="dv">1</span>, <span class="at">lower.tail=</span>F)</span>
<span id="cb111-37"><a href="gwas-white-british-irish.html#cb111-37" aria-hidden="true" tabindex="-1"></a>ldsc<span class="sc">$</span>sig_20k<span class="ot">=</span>ldsc<span class="sc">$</span>wald_p_20k<span class="sc">&lt;=</span>threshold</span></code></pre></div>
</div>
</div>
<div id="ideas-to-explore-to-do-list" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Ideas to explore/ to do list:</h2>
<ol style="list-style-type: decimal">
<li><p>Plot PC1 &amp; PC2 of the study samples to show the extent to which these study samples differ in ancestry.</p></li>
<li><p>genobatch &amp; test centre were not included as covariates in GWASs. Should they be included?</p></li>
<li><p>sketch the gwas QC steps and check with Doug if any steps need to be redone.</p></li>
<li><p>lista vs. listb. Currently based on 10k snps from each side of the genome. Why right vs. left? Should we come up with a simpler way and redo the analyses?</p></li>
<li><p>predicted inflation: maybe only need to check the snps with sig chisq: if the adjusted chisq align with the good chisq.</p></li>
<li><p>QQ plots. good vs. control vs. mix</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="previous-gwas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="related-individuals.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04.6-bad-gwas-Irish.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
