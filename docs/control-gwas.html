<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 control GWAS | Quality control</title>
  <meta name="description" content="6 control GWAS | Quality control" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6 control GWAS | Quality control" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 control GWAS | Quality control" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ukbb.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quality Control Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Info</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#topic"><i class="fa fa-check"></i><b>1.1</b> Topic</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#frequently-used-commands"><i class="fa fa-check"></i><b>1.2</b> Frequently used commands</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summaries.html"><a href="summaries.html"><i class="fa fa-check"></i><b>2</b> Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summaries.html"><a href="summaries.html#good-gwas"><i class="fa fa-check"></i><b>2.1</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher"><i class="fa fa-check"></i><b>2.1.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.1.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression"><i class="fa fa-check"></i><b>2.1.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summaries.html"><a href="summaries.html#bad-gwas"><i class="fa fa-check"></i><b>2.2</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-1"><i class="fa fa-check"></i><b>2.2.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.2.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-1"><i class="fa fa-check"></i><b>2.2.2</b> Haseman Elston Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summaries.html"><a href="summaries.html#ukbb-recommended"><i class="fa fa-check"></i><b>2.3</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summaries.html"><a href="summaries.html#ldsc-sumher-2"><i class="fa fa-check"></i><b>2.3.1</b> ldsc &amp; sumher</a></li>
<li class="chapter" data-level="2.3.2" data-path="summaries.html"><a href="summaries.html#haseman-elston-regression-2"><i class="fa fa-check"></i><b>2.3.2</b> Haseman Elston Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="good.html"><a href="good.html"><i class="fa fa-check"></i><b>3</b> Good GWAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="good.html"><a href="good.html#goodid"><i class="fa fa-check"></i><b>3.1</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="3.2" data-path="good.html"><a href="good.html#extract-covariates"><i class="fa fa-check"></i><b>3.2</b> extract covariates</a></li>
<li class="chapter" data-level="3.3" data-path="good.html"><a href="good.html#gwas"><i class="fa fa-check"></i><b>3.3</b> GWAS</a></li>
<li class="chapter" data-level="3.4" data-path="good.html"><a href="good.html#ldsc-intercept"><i class="fa fa-check"></i><b>3.4</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="good.html"><a href="good.html#under-gcta"><i class="fa fa-check"></i><b>3.4.1</b> under gcta</a></li>
<li class="chapter" data-level="3.4.2" data-path="good.html"><a href="good.html#under-ldak-thin"><i class="fa fa-check"></i><b>3.4.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="3.4.3" data-path="good.html"><a href="good.html#summary"><i class="fa fa-check"></i><b>3.4.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="good.html"><a href="good.html#reml"><i class="fa fa-check"></i><b>3.5</b> REML</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="good.html"><a href="good.html#making-grms"><i class="fa fa-check"></i><b>3.5.1</b> making grms</a></li>
<li class="chapter" data-level="3.5.2" data-path="good.html"><a href="good.html#fast-reml"><i class="fa fa-check"></i><b>3.5.2</b> fast-reml</a></li>
<li class="chapter" data-level="3.5.3" data-path="good.html"><a href="good.html#inflation-test"><i class="fa fa-check"></i><b>3.5.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="good.html"><a href="good.html#he"><i class="fa fa-check"></i><b>3.6</b> HE</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="good.html"><a href="good.html#estimation"><i class="fa fa-check"></i><b>3.6.1</b> estimation</a></li>
<li class="chapter" data-level="3.6.2" data-path="good.html"><a href="good.html#summary-1"><i class="fa fa-check"></i><b>3.6.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bad.html"><a href="bad.html"><i class="fa fa-check"></i><b>4</b> Bad GWAS</a>
<ul>
<li class="chapter" data-level="4.1" data-path="bad.html"><a href="bad.html#badid"><i class="fa fa-check"></i><b>4.1</b> ID list</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="bad.html"><a href="bad.html#initial-selection"><i class="fa fa-check"></i><b>4.1.1</b> initial selection</a></li>
<li class="chapter" data-level="4.1.2" data-path="bad.html"><a href="bad.html#relatedness-filtering"><i class="fa fa-check"></i><b>4.1.2</b> relatedness filtering</a></li>
<li class="chapter" data-level="4.1.3" data-path="bad.html"><a href="bad.html#final-list"><i class="fa fa-check"></i><b>4.1.3</b> final list</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bad.html"><a href="bad.html#gwas-1"><i class="fa fa-check"></i><b>4.2</b> GWAS</a></li>
<li class="chapter" data-level="4.3" data-path="bad.html"><a href="bad.html#ldsc-intercept-1"><i class="fa fa-check"></i><b>4.3</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="bad.html"><a href="bad.html#under-gcta-1"><i class="fa fa-check"></i><b>4.3.1</b> under gcta</a></li>
<li class="chapter" data-level="4.3.2" data-path="bad.html"><a href="bad.html#under-ldak-thin-1"><i class="fa fa-check"></i><b>4.3.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="4.3.3" data-path="bad.html"><a href="bad.html#summary-2"><i class="fa fa-check"></i><b>4.3.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bad.html"><a href="bad.html#reml-1"><i class="fa fa-check"></i><b>4.4</b> REML</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="bad.html"><a href="bad.html#making-grms-1"><i class="fa fa-check"></i><b>4.4.1</b> making grms</a></li>
<li class="chapter" data-level="4.4.2" data-path="bad.html"><a href="bad.html#fast-reml-1"><i class="fa fa-check"></i><b>4.4.2</b> fast-reml</a></li>
<li class="chapter" data-level="4.4.3" data-path="bad.html"><a href="bad.html#inflation-test-1"><i class="fa fa-check"></i><b>4.4.3</b> inflation test</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="bad.html"><a href="bad.html#he-1"><i class="fa fa-check"></i><b>4.5</b> HE</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="bad.html"><a href="bad.html#estimation-1"><i class="fa fa-check"></i><b>4.5.1</b> estimation</a></li>
<li class="chapter" data-level="4.5.2" data-path="bad.html"><a href="bad.html#summary-3"><i class="fa fa-check"></i><b>4.5.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ukbb.html"><a href="ukbb.html"><i class="fa fa-check"></i><b>5</b> UKBB recommended</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ukbb.html"><a href="ukbb.html#total-n-337k"><i class="fa fa-check"></i><b>5.1</b> total N = 337k</a></li>
<li class="chapter" data-level="5.2" data-path="ukbb.html"><a href="ukbb.html#qc-of-hp3-snps"><i class="fa fa-check"></i><b>5.2</b> QC of hp3 SNPs</a></li>
<li class="chapter" data-level="5.3" data-path="ukbb.html"><a href="ukbb.html#making-grms-2"><i class="fa fa-check"></i><b>5.3</b> making grms</a></li>
<li class="chapter" data-level="5.4" data-path="ukbb.html"><a href="ukbb.html#gwas-2"><i class="fa fa-check"></i><b>5.4</b> GWAS</a></li>
<li class="chapter" data-level="5.5" data-path="ukbb.html"><a href="ukbb.html#ldsc-intercept-2"><i class="fa fa-check"></i><b>5.5</b> ldsc intercept</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="ukbb.html"><a href="ukbb.html#under-gcta-2"><i class="fa fa-check"></i><b>5.5.1</b> under gcta</a></li>
<li class="chapter" data-level="5.5.2" data-path="ukbb.html"><a href="ukbb.html#under-ldak-thin-2"><i class="fa fa-check"></i><b>5.5.2</b> under ldak-thin</a></li>
<li class="chapter" data-level="5.5.3" data-path="ukbb.html"><a href="ukbb.html#summary-4"><i class="fa fa-check"></i><b>5.5.3</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ukbb.html"><a href="ukbb.html#he-2"><i class="fa fa-check"></i><b>5.6</b> HE</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ukbb.html"><a href="ukbb.html#estimation-2"><i class="fa fa-check"></i><b>5.6.1</b> estimation</a></li>
<li class="chapter" data-level="5.6.2" data-path="ukbb.html"><a href="ukbb.html#summary-5"><i class="fa fa-check"></i><b>5.6.2</b> summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="control-gwas.html"><a href="control-gwas.html"><i class="fa fa-check"></i><b>6</b> control GWAS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="control-gwas.html"><a href="control-gwas.html#id-list"><i class="fa fa-check"></i><b>6.1</b> ID list</a></li>
<li class="chapter" data-level="6.2" data-path="control-gwas.html"><a href="control-gwas.html#qc-of-hp3-snps-1"><i class="fa fa-check"></i><b>6.2</b> QC of hp3 SNPs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quality control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="control-gwas" class="section level1" number="6">
<h1><span class="header-section-number">6</span> control GWAS</h1>
<p>Here we want to do GWASs that will serve as the control group of the good GWASs. Recall for the bad GWASs (section <a href="bad.html#bad">4</a>), we have a total of 100k individuals, which consist of 93,528 unrelated white British and 6,472 blacks and Asians. We observed inflation of the test statistics. Although unlikely, it is still possible that some of the inflation is due to random errors. To rule out this possibility [to ascertain that the observed inflation is due to population stratification, not random errors], we used the same 93,528 unrelated white British but replaced the 6,472 blacks and Asians with unrelated white British that are not included in the good GWASs.</p>
<div id="id-list" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> ID list</h2>
<p>We used previously obtained id lists (see section <a href="good.html#goodid">3.1</a> for the good GWAS id list and section <a href="bad.html#badid">4.1</a> for the bad GWAS id list ) to derive the id list for the control GWASs. These are:</p>
<ul>
<li><code>overlap-complete-cases.id</code>: N = 147,008. Unrelated white British who have no missing data for all 14 traits and covariates.</li>
<li><code>rand.100000</code>: ID list for the good gwas. Randomly selected from <code>overlap-complete-cases.id</code><br />
</li>
<li><code>white.rand.93528</code>: unrelated whites as a part of the bad gwas ID list. Randomly selected from <code>rand.100000</code></li>
</ul>
<p>Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>identify IDs from <code>overlap-complete-cases.id</code> not included in <code>rand.100000</code>.</li>
<li>randomly select 6,472 from the identified IDs.</li>
<li>combine <code>white.rand.93528</code> with the randomly selected 6,472 IDs.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="control-gwas.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">100</span>)</span>
<span id="cb1-2"><a href="control-gwas.html#cb1-2" aria-hidden="true" tabindex="-1"></a>id1<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;unrelated/overlap-complete-cases.id&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb1-3"><a href="control-gwas.html#cb1-3" aria-hidden="true" tabindex="-1"></a>id2<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;unrelated/rand.100000&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb1-4"><a href="control-gwas.html#cb1-4" aria-hidden="true" tabindex="-1"></a>id3<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;white.rand.93528&quot;</span>, <span class="at">header=</span>F)</span>
<span id="cb1-5"><a href="control-gwas.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="control-gwas.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pool for selection</span></span>
<span id="cb1-7"><a href="control-gwas.html#cb1-7" aria-hidden="true" tabindex="-1"></a>common<span class="ot">=</span><span class="fu">intersect</span>(id1<span class="sc">$</span>V1, id2<span class="sc">$</span>V1)</span>
<span id="cb1-8"><a href="control-gwas.html#cb1-8" aria-hidden="true" tabindex="-1"></a>pool<span class="ot">=</span>id1[<span class="sc">!</span>id1<span class="sc">$</span>V1<span class="sc">%in%</span>common,]</span>
<span id="cb1-9"><a href="control-gwas.html#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="control-gwas.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly select 6,472 from the pool</span></span>
<span id="cb1-11"><a href="control-gwas.html#cb1-11" aria-hidden="true" tabindex="-1"></a>sel<span class="ot">=</span>pool[<span class="fu">sample</span>(<span class="fu">dim</span>(pool)[<span class="dv">1</span>], <span class="dv">6472</span>, <span class="at">replace=</span>F),]</span>
<span id="cb1-12"><a href="control-gwas.html#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="control-gwas.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  combine with &#39;white.rand.93528&#39;</span></span>
<span id="cb1-14"><a href="control-gwas.html#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">rbind</span>(sel,id3), <span class="st">&#39;control-gwas.id&#39;</span>, <span class="at">quote=</span>F, <span class="at">row.names=</span>F, <span class="at">col.names=</span>F)</span></code></pre></div>
</div>
<div id="qc-of-hp3-snps-1" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> QC of hp3 SNPs</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="control-gwas.html#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="control-gwas.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QC SNPs-----------------------------------------------------------------------</span></span>
<span id="cb2-3"><a href="control-gwas.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stating number of SNPs= 1,184,423 </span></span>
<span id="cb2-4"><a href="control-gwas.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-5"><a href="control-gwas.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb2-6"><a href="control-gwas.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb2-7"><a href="control-gwas.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb2-8"><a href="control-gwas.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb2-9"><a href="control-gwas.html#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb2-10"><a href="control-gwas.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 1:0:0</span></span>
<span id="cb2-11"><a href="control-gwas.html#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="control-gwas.html#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="st">./plink2 --pfile ../gen/geno_plink/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-13"><a href="control-gwas.html#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="st">         --keep ../control-gwas.id </span><span class="dt">\</span></span>
<span id="cb2-14"><a href="control-gwas.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="st">         --extract ../doug/ukbb.ldsc </span><span class="dt">\</span></span>
<span id="cb2-15"><a href="control-gwas.html#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="st">         --hwe 0.0001 </span><span class="dt">\</span></span>
<span id="cb2-16"><a href="control-gwas.html#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="st">         --hard-call-threshold .05 </span><span class="dt">\</span></span>
<span id="cb2-17"><a href="control-gwas.html#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="st">         --mach-r2-filter 0.8 2 </span><span class="dt">\</span></span>
<span id="cb2-18"><a href="control-gwas.html#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="st">         --make-bed </span><span class="dt">\</span></span>
<span id="cb2-19"><a href="control-gwas.html#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="st">         --memory 20000 </span><span class="dt">\</span></span>
<span id="cb2-20"><a href="control-gwas.html#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="st">         --out ../gen/tmp/bhr</span><span class="va">$j</span><span class="st"> </span><span class="dt">\</span></span>
<span id="cb2-21"><a href="control-gwas.html#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="st">         --threads 3</span></span>
<span id="cb2-22"><a href="control-gwas.html#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb2-23"><a href="control-gwas.html#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-24"><a href="control-gwas.html#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="control-gwas.html#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># submit jobs</span></span>
<span id="cb2-26"><a href="control-gwas.html#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-27"><a href="control-gwas.html#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/chr<span class="va">$j</span>.sh</span>
<span id="cb2-28"><a href="control-gwas.html#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span> <span class="op">&gt;</span> ../job-records/qc-control-gwas</span>
<span id="cb2-29"><a href="control-gwas.html#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="control-gwas.html#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># merge files</span></span>
<span id="cb2-31"><a href="control-gwas.html#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> bfile-control-gwas.list</span>
<span id="cb2-32"><a href="control-gwas.html#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">22</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-33"><a href="control-gwas.html#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>  <span class="st">&quot;../gen/tmp/bhr</span><span class="va">$j</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span>bfile-control-gwas.list</span>
<span id="cb2-34"><a href="control-gwas.html#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-35"><a href="control-gwas.html#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="control-gwas.html#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;#&quot;&#39;!&#39;&quot;/bin/bash</span></span>
<span id="cb2-37"><a href="control-gwas.html#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --constraint </span><span class="dt">\&quot;</span><span class="st">s04|s05</span><span class="dt">\&quot;</span></span>
<span id="cb2-38"><a href="control-gwas.html#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --partition normal</span></span>
<span id="cb2-39"><a href="control-gwas.html#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH --mem 20G</span></span>
<span id="cb2-40"><a href="control-gwas.html#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -c 3</span></span>
<span id="cb2-41"><a href="control-gwas.html#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="st">#SBATCH -t 40:0:0</span></span>
<span id="cb2-42"><a href="control-gwas.html#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="st">./ldak5.1 --make-bed ../gen/geno-control </span><span class="dt">\</span></span>
<span id="cb2-43"><a href="control-gwas.html#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="st">          --mbfile ../gen/bfile-control-gwas.list </span><span class="dt">\</span></span>
<span id="cb2-44"><a href="control-gwas.html#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="st">          --max-threads 3 </span><span class="dt">\</span></span>
<span id="cb2-45"><a href="control-gwas.html#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="st">          --exclude-dups YES  </span></span>
<span id="cb2-46"><a href="control-gwas.html#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;</span> sh_script/mbfile-control.sh</span>
<span id="cb2-47"><a href="control-gwas.html#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="control-gwas.html#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co"># submit the script</span></span>
<span id="cb2-49"><a href="control-gwas.html#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> snpher ../sh_script/mbfile-control.sh <span class="op">&gt;</span>../job-records/mbfiles-control-gwas</span>
<span id="cb2-50"><a href="control-gwas.html#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="control-gwas.html#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># MAF &amp; call-rate </span></span>
<span id="cb2-52"><a href="control-gwas.html#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="op">&lt;</span> geno-control.stats <span class="st">&#39;($5&gt;.01 &amp;&amp; $6&gt;=0.95 &amp;&amp; NR&gt;1){print $1}&#39;</span> <span class="op">&gt;</span> snps-control-gwas.use</span>
<span id="cb2-53"><a href="control-gwas.html#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 1,103,209 SNPs</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ukbb.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-control-gwas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
